[0m01:18:58.327554 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DA62CDD090>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DA62D1C290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DA62A730D0>]}


============================== 01:18:58.331515 | 7ef02e9a-9bcc-4c5b-b26d-705d64b8e1ed ==============================
[0m01:18:58.331515 [info ] [MainThread]: Running with dbt=1.11.2
[0m01:18:58.334201 [debug] [MainThread]: running dbt with arguments {'static_parser': 'True', 'no_print': 'None', 'version_check': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'target_path': 'None', 'printer_width': '80', 'write_json': 'True', 'empty': 'None', 'log_cache_events': 'False', 'introspect': 'True', 'cache_selected_only': 'False', 'fail_fast': 'False', 'debug': 'False', 'log_format': 'default', 'partial_parse': 'True', 'send_anonymous_usage_stats': 'True', 'quiet': 'False', 'warn_error': 'None', 'profiles_dir': 'C:\\Users\\Lenovo\\.dbt', 'use_colors': 'True', 'indirect_selection': 'eager', 'invocation_command': 'dbt seed', 'use_experimental_parser': 'False', 'log_path': 'C:\\Users\\Lenovo\\Desktop\\Proyectos\\dbt-proyect\\ecommerce_analytics\\logs'}
[0m01:18:58.805475 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7ef02e9a-9bcc-4c5b-b26d-705d64b8e1ed', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DA62DB2D90>]}
[0m01:18:58.873653 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '7ef02e9a-9bcc-4c5b-b26d-705d64b8e1ed', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DA5F664490>]}
[0m01:18:58.879467 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m01:18:59.177898 [debug] [MainThread]: checksum: 3d40d8bbe1bef07db1c24822f2dbfff8bc07f2a48ed4fe2658a40653aec0b54b, vars: {}, profile: , target: , version: 1.11.2
[0m01:18:59.187531 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m01:18:59.188663 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '7ef02e9a-9bcc-4c5b-b26d-705d64b8e1ed', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DA62D81990>]}
[0m01:19:03.554000 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7ef02e9a-9bcc-4c5b-b26d-705d64b8e1ed', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DA63EA7610>]}
[0m01:19:03.665743 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\Lenovo\Desktop\Proyectos\dbt-proyect\ecommerce_analytics\target\manifest.json
[0m01:19:03.674121 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\Lenovo\Desktop\Proyectos\dbt-proyect\ecommerce_analytics\target\semantic_manifest.json
[0m01:19:03.742702 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7ef02e9a-9bcc-4c5b-b26d-705d64b8e1ed', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DA64817C50>]}
[0m01:19:03.742702 [info ] [MainThread]: Found 2 models, 3 seeds, 4 data tests, 471 macros
[0m01:19:03.742702 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7ef02e9a-9bcc-4c5b-b26d-705d64b8e1ed', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DA6464BF50>]}
[0m01:19:03.747751 [info ] [MainThread]: 
[0m01:19:03.747751 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m01:19:03.747751 [info ] [MainThread]: 
[0m01:19:03.747751 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m01:19:03.757229 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_dev'
[0m01:19:08.616621 [debug] [ThreadPool]: Using duckdb connection "list_dev"
[0m01:19:08.621639 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "ecommerce_analytics", "target_name": "dev", "connection_name": "list_dev"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"dev"'
    
  
  
[0m01:19:08.621639 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:19:08.653773 [debug] [ThreadPool]: SQL status: OK in 0.031 seconds
[0m01:19:08.653773 [debug] [ThreadPool]: On list_dev: Close
[0m01:19:08.653773 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev, now create_dev_main)
[0m01:19:08.653773 [debug] [ThreadPool]: Creating schema "database: "dev"
schema: "main"
"
[0m01:19:08.663474 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m01:19:08.663474 [debug] [ThreadPool]: On create_dev_main: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "ecommerce_analytics", "target_name": "dev", "connection_name": "create_dev_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='dev'
        and type='sqlite'
    
  
[0m01:19:08.663474 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m01:19:08.665615 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m01:19:08.665615 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m01:19:08.669185 [debug] [ThreadPool]: On create_dev_main: BEGIN
[0m01:19:08.669185 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m01:19:08.669185 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m01:19:08.669185 [debug] [ThreadPool]: On create_dev_main: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "ecommerce_analytics", "target_name": "dev", "connection_name": "create_dev_main"} */

    
    
        create schema if not exists "dev"."main"
    
[0m01:19:08.669185 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m01:19:08.669185 [debug] [ThreadPool]: On create_dev_main: COMMIT
[0m01:19:08.673866 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m01:19:08.673866 [debug] [ThreadPool]: On create_dev_main: COMMIT
[0m01:19:08.673866 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m01:19:08.673866 [debug] [ThreadPool]: On create_dev_main: Close
[0m01:19:08.673866 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_dev_main'
[0m01:19:08.680807 [debug] [ThreadPool]: Using duckdb connection "list_dev_main"
[0m01:19:08.680807 [debug] [ThreadPool]: On list_dev_main: BEGIN
[0m01:19:08.680807 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:19:08.680807 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m01:19:08.684213 [debug] [ThreadPool]: Using duckdb connection "list_dev_main"
[0m01:19:08.684213 [debug] [ThreadPool]: On list_dev_main: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "ecommerce_analytics", "target_name": "dev", "connection_name": "list_dev_main"} */
select
      'dev' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'dev'
  
[0m01:19:08.704704 [debug] [ThreadPool]: SQL status: OK in 0.021 seconds
[0m01:19:08.704704 [debug] [ThreadPool]: On list_dev_main: ROLLBACK
[0m01:19:08.704704 [debug] [ThreadPool]: Failed to rollback 'list_dev_main'
[0m01:19:08.704704 [debug] [ThreadPool]: On list_dev_main: Close
[0m01:19:08.704704 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7ef02e9a-9bcc-4c5b-b26d-705d64b8e1ed', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DA647A8B90>]}
[0m01:19:08.704704 [debug] [MainThread]: Using duckdb connection "master"
[0m01:19:08.704704 [debug] [MainThread]: On master: BEGIN
[0m01:19:08.704704 [debug] [MainThread]: Opening a new connection, currently in state init
[0m01:19:08.704704 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m01:19:08.704704 [debug] [MainThread]: On master: COMMIT
[0m01:19:08.704704 [debug] [MainThread]: Using duckdb connection "master"
[0m01:19:08.704704 [debug] [MainThread]: On master: COMMIT
[0m01:19:08.715177 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m01:19:08.715177 [debug] [MainThread]: On master: Close
[0m01:19:08.746005 [debug] [Thread-1 (]: Began running node seed.ecommerce_analytics.raw_customers
[0m01:19:08.746005 [info ] [Thread-1 (]: 1 of 3 START seed file main.raw_customers ...................................... [RUN]
[0m01:19:08.746005 [debug] [Thread-1 (]: Acquiring new duckdb connection 'seed.ecommerce_analytics.raw_customers'
[0m01:19:08.746005 [debug] [Thread-1 (]: Began compiling node seed.ecommerce_analytics.raw_customers
[0m01:19:08.749108 [debug] [Thread-1 (]: Began executing node seed.ecommerce_analytics.raw_customers
[0m01:19:08.775647 [debug] [Thread-1 (]: Compilation Error in seed raw_customers (seeds\raw_customers.csv)
  value was undefined because a callable raised a StopIteration exception
[0m01:19:08.779325 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7ef02e9a-9bcc-4c5b-b26d-705d64b8e1ed', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DA64AE7810>]}
[0m01:19:08.779325 [error] [Thread-1 (]: 1 of 3 ERROR loading seed file main.raw_customers .............................. [[31mERROR[0m in 0.03s]
[0m01:19:08.781073 [debug] [Thread-1 (]: Finished running node seed.ecommerce_analytics.raw_customers
[0m01:19:08.781073 [debug] [Thread-1 (]: Began running node seed.ecommerce_analytics.raw_orders
[0m01:19:08.781073 [debug] [Thread-4 (]: Marking all children of 'seed.ecommerce_analytics.raw_customers' to be skipped because of status 'error'.  Reason: Compilation Error in seed raw_customers (seeds\raw_customers.csv)
  value was undefined because a callable raised a StopIteration exception.
[0m01:19:08.783270 [info ] [Thread-1 (]: 2 of 3 START seed file main.raw_orders ......................................... [RUN]
[0m01:19:08.783270 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly seed.ecommerce_analytics.raw_customers, now seed.ecommerce_analytics.raw_orders)
[0m01:19:08.783270 [debug] [Thread-1 (]: Began compiling node seed.ecommerce_analytics.raw_orders
[0m01:19:08.783270 [debug] [Thread-1 (]: Began executing node seed.ecommerce_analytics.raw_orders
[0m01:19:08.787877 [debug] [Thread-1 (]: Compilation Error in seed raw_orders (seeds\raw_orders.csv)
  value was undefined because a callable raised a StopIteration exception
[0m01:19:08.787877 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7ef02e9a-9bcc-4c5b-b26d-705d64b8e1ed', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DA64B67590>]}
[0m01:19:08.787877 [error] [Thread-1 (]: 2 of 3 ERROR loading seed file main.raw_orders ................................. [[31mERROR[0m in 0.00s]
[0m01:19:08.787877 [debug] [Thread-1 (]: Finished running node seed.ecommerce_analytics.raw_orders
[0m01:19:08.794838 [debug] [Thread-4 (]: Marking all children of 'seed.ecommerce_analytics.raw_orders' to be skipped because of status 'error'.  Reason: Compilation Error in seed raw_orders (seeds\raw_orders.csv)
  value was undefined because a callable raised a StopIteration exception.
[0m01:19:08.787877 [debug] [Thread-1 (]: Began running node seed.ecommerce_analytics.raw_products
[0m01:19:08.794838 [info ] [Thread-1 (]: 3 of 3 START seed file main.raw_products ....................................... [RUN]
[0m01:19:08.794838 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly seed.ecommerce_analytics.raw_orders, now seed.ecommerce_analytics.raw_products)
[0m01:19:08.794838 [debug] [Thread-1 (]: Began compiling node seed.ecommerce_analytics.raw_products
[0m01:19:08.798088 [debug] [Thread-1 (]: Began executing node seed.ecommerce_analytics.raw_products
[0m01:19:08.802956 [debug] [Thread-1 (]: Compilation Error in seed raw_products (seeds\raw_products.csv)
  value was undefined because a callable raised a StopIteration exception
[0m01:19:08.803702 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7ef02e9a-9bcc-4c5b-b26d-705d64b8e1ed', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DA64AE6550>]}
[0m01:19:08.803702 [error] [Thread-1 (]: 3 of 3 ERROR loading seed file main.raw_products ............................... [[31mERROR[0m in 0.01s]
[0m01:19:08.805555 [debug] [Thread-1 (]: Finished running node seed.ecommerce_analytics.raw_products
[0m01:19:08.805555 [debug] [Thread-4 (]: Marking all children of 'seed.ecommerce_analytics.raw_products' to be skipped because of status 'error'.  Reason: Compilation Error in seed raw_products (seeds\raw_products.csv)
  value was undefined because a callable raised a StopIteration exception.
[0m01:19:08.807564 [debug] [MainThread]: Using duckdb connection "master"
[0m01:19:08.808570 [debug] [MainThread]: On master: BEGIN
[0m01:19:08.808570 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m01:19:08.808570 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m01:19:08.811472 [debug] [MainThread]: On master: COMMIT
[0m01:19:08.811472 [debug] [MainThread]: Using duckdb connection "master"
[0m01:19:08.811472 [debug] [MainThread]: On master: COMMIT
[0m01:19:08.811472 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m01:19:08.811472 [debug] [MainThread]: On master: Close
[0m01:19:08.811472 [debug] [MainThread]: Connection 'master' was properly closed.
[0m01:19:08.811472 [debug] [MainThread]: Connection 'create_dev_main' was properly closed.
[0m01:19:08.811472 [debug] [MainThread]: Connection 'list_dev_main' was properly closed.
[0m01:19:08.811472 [debug] [MainThread]: Connection 'seed.ecommerce_analytics.raw_products' was properly closed.
[0m01:19:08.811472 [info ] [MainThread]: 
[0m01:19:08.811472 [info ] [MainThread]: Finished running 3 seeds in 0 hours 0 minutes and 5.06 seconds (5.06s).
[0m01:19:08.819223 [debug] [MainThread]: Command end result
[0m01:19:08.911694 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\Lenovo\Desktop\Proyectos\dbt-proyect\ecommerce_analytics\target\manifest.json
[0m01:19:08.911694 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\Lenovo\Desktop\Proyectos\dbt-proyect\ecommerce_analytics\target\semantic_manifest.json
[0m01:19:08.922248 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\Lenovo\Desktop\Proyectos\dbt-proyect\ecommerce_analytics\target\run_results.json
[0m01:19:08.922248 [info ] [MainThread]: 
[0m01:19:08.922248 [info ] [MainThread]: [31mCompleted with 3 errors, 0 partial successes, and 0 warnings:[0m
[0m01:19:08.925239 [info ] [MainThread]: 
[0m01:19:08.925239 [error] [MainThread]: [31mFailure in seed raw_customers (seeds\raw_customers.csv)[0m
[0m01:19:08.925239 [error] [MainThread]:   Compilation Error in seed raw_customers (seeds\raw_customers.csv)
  value was undefined because a callable raised a StopIteration exception
[0m01:19:08.925239 [info ] [MainThread]: 
[0m01:19:08.925239 [error] [MainThread]: [31mFailure in seed raw_orders (seeds\raw_orders.csv)[0m
[0m01:19:08.930450 [error] [MainThread]:   Compilation Error in seed raw_orders (seeds\raw_orders.csv)
  value was undefined because a callable raised a StopIteration exception
[0m01:19:08.930450 [info ] [MainThread]: 
[0m01:19:08.932460 [error] [MainThread]: [31mFailure in seed raw_products (seeds\raw_products.csv)[0m
[0m01:19:08.934083 [error] [MainThread]:   Compilation Error in seed raw_products (seeds\raw_products.csv)
  value was undefined because a callable raised a StopIteration exception
[0m01:19:08.934998 [info ] [MainThread]: 
[0m01:19:08.936546 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=3 SKIP=0 NO-OP=0 TOTAL=3
[0m01:19:08.938880 [debug] [MainThread]: Command `dbt seed` failed at 01:19:08.938880 after 10.74 seconds
[0m01:19:08.938880 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DA5BF94C10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DA645DB4D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DA645D9790>]}
[0m01:19:08.940754 [debug] [MainThread]: Flushing usage events
[0m01:19:10.397753 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m01:25:42.520220 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000224D5C1F810>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000224D5C1F590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000224D5C17F50>]}


============================== 01:25:42.535658 | 6018daf2-3833-45f4-a6f0-b5839a48bdfc ==============================
[0m01:25:42.535658 [info ] [MainThread]: Running with dbt=1.11.2
[0m01:25:42.538708 [debug] [MainThread]: running dbt with arguments {'static_parser': 'True', 'no_print': 'None', 'version_check': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'printer_width': '80', 'write_json': 'True', 'introspect': 'True', 'log_cache_events': 'False', 'empty': 'None', 'cache_selected_only': 'False', 'log_format': 'default', 'debug': 'False', 'fail_fast': 'False', 'partial_parse': 'True', 'send_anonymous_usage_stats': 'True', 'quiet': 'False', 'warn_error': 'None', 'profiles_dir': 'C:\\Users\\Lenovo\\.dbt', 'indirect_selection': 'eager', 'use_colors': 'True', 'invocation_command': 'dbt seed', 'use_experimental_parser': 'False', 'log_path': 'C:\\Users\\Lenovo\\Desktop\\Proyectos\\dbt-proyect\\ecommerce_analytics\\logs'}
[0m01:25:43.554051 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6018daf2-3833-45f4-a6f0-b5839a48bdfc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000224D6E6B910>]}
[0m01:25:43.787181 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '6018daf2-3833-45f4-a6f0-b5839a48bdfc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000224D2628250>]}
[0m01:25:43.795635 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m01:25:44.631087 [debug] [MainThread]: checksum: 3d40d8bbe1bef07db1c24822f2dbfff8bc07f2a48ed4fe2658a40653aec0b54b, vars: {}, profile: , target: , version: 1.11.2
[0m01:25:45.243301 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 3 files changed.
[0m01:25:45.243301 [debug] [MainThread]: Partial parsing: updated file: ecommerce_analytics://seeds\raw_products.csv
[0m01:25:45.243301 [debug] [MainThread]: Partial parsing: updated file: ecommerce_analytics://seeds\raw_orders.csv
[0m01:25:45.243301 [debug] [MainThread]: Partial parsing: updated file: ecommerce_analytics://seeds\raw_customers.csv
[0m01:25:45.948933 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6018daf2-3833-45f4-a6f0-b5839a48bdfc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000224D7301690>]}
[0m01:25:46.168822 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\Lenovo\Desktop\Proyectos\dbt-proyect\ecommerce_analytics\target\manifest.json
[0m01:25:46.176683 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\Lenovo\Desktop\Proyectos\dbt-proyect\ecommerce_analytics\target\semantic_manifest.json
[0m01:25:46.359155 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6018daf2-3833-45f4-a6f0-b5839a48bdfc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000224D6DFCAD0>]}
[0m01:25:46.362642 [info ] [MainThread]: Found 2 models, 4 data tests, 3 seeds, 471 macros
[0m01:25:46.363686 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6018daf2-3833-45f4-a6f0-b5839a48bdfc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000224D6ECA690>]}
[0m01:25:46.369223 [info ] [MainThread]: 
[0m01:25:46.370731 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m01:25:46.374039 [info ] [MainThread]: 
[0m01:25:46.374039 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m01:25:46.392500 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_dev'
[0m01:25:46.636211 [debug] [ThreadPool]: Using duckdb connection "list_dev"
[0m01:25:46.636211 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "ecommerce_analytics", "target_name": "dev", "connection_name": "list_dev"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"dev"'
    
  
  
[0m01:25:46.636211 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:25:46.749031 [debug] [ThreadPool]: SQL status: OK in 0.108 seconds
[0m01:25:46.752698 [debug] [ThreadPool]: On list_dev: Close
[0m01:25:46.755767 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev, now create_dev_main)
[0m01:25:46.757500 [debug] [ThreadPool]: Creating schema "database: "dev"
schema: "main"
"
[0m01:25:46.777574 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m01:25:46.779290 [debug] [ThreadPool]: On create_dev_main: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "ecommerce_analytics", "target_name": "dev", "connection_name": "create_dev_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='dev'
        and type='sqlite'
    
  
[0m01:25:46.782371 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m01:25:46.785903 [debug] [ThreadPool]: SQL status: OK in 0.004 seconds
[0m01:25:46.790752 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m01:25:46.792779 [debug] [ThreadPool]: On create_dev_main: BEGIN
[0m01:25:46.792779 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m01:25:46.792779 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m01:25:46.792779 [debug] [ThreadPool]: On create_dev_main: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "ecommerce_analytics", "target_name": "dev", "connection_name": "create_dev_main"} */

    
    
        create schema if not exists "dev"."main"
    
[0m01:25:46.800227 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m01:25:46.802693 [debug] [ThreadPool]: On create_dev_main: COMMIT
[0m01:25:46.802693 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m01:25:46.802693 [debug] [ThreadPool]: On create_dev_main: COMMIT
[0m01:25:46.802693 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m01:25:46.810899 [debug] [ThreadPool]: On create_dev_main: Close
[0m01:25:46.815387 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_dev_main'
[0m01:25:46.834085 [debug] [ThreadPool]: Using duckdb connection "list_dev_main"
[0m01:25:46.842031 [debug] [ThreadPool]: On list_dev_main: BEGIN
[0m01:25:46.842031 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:25:46.847438 [debug] [ThreadPool]: SQL status: OK in 0.003 seconds
[0m01:25:46.848933 [debug] [ThreadPool]: Using duckdb connection "list_dev_main"
[0m01:25:46.849953 [debug] [ThreadPool]: On list_dev_main: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "ecommerce_analytics", "target_name": "dev", "connection_name": "list_dev_main"} */
select
      'dev' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'dev'
  
[0m01:25:46.910058 [debug] [ThreadPool]: SQL status: OK in 0.060 seconds
[0m01:25:46.916966 [debug] [ThreadPool]: On list_dev_main: ROLLBACK
[0m01:25:46.921054 [debug] [ThreadPool]: Failed to rollback 'list_dev_main'
[0m01:25:46.921054 [debug] [ThreadPool]: On list_dev_main: Close
[0m01:25:46.925886 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6018daf2-3833-45f4-a6f0-b5839a48bdfc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000224D5C6E110>]}
[0m01:25:46.927901 [debug] [MainThread]: Using duckdb connection "master"
[0m01:25:46.929917 [debug] [MainThread]: On master: BEGIN
[0m01:25:46.931934 [debug] [MainThread]: Opening a new connection, currently in state init
[0m01:25:46.934431 [debug] [MainThread]: SQL status: OK in 0.003 seconds
[0m01:25:46.935896 [debug] [MainThread]: On master: COMMIT
[0m01:25:46.938025 [debug] [MainThread]: Using duckdb connection "master"
[0m01:25:46.938025 [debug] [MainThread]: On master: COMMIT
[0m01:25:46.941453 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m01:25:46.943935 [debug] [MainThread]: On master: Close
[0m01:25:46.957339 [debug] [Thread-1 (]: Began running node seed.ecommerce_analytics.raw_customers
[0m01:25:46.960584 [info ] [Thread-1 (]: 1 of 3 START seed file main.raw_customers ...................................... [RUN]
[0m01:25:46.964552 [debug] [Thread-1 (]: Acquiring new duckdb connection 'seed.ecommerce_analytics.raw_customers'
[0m01:25:46.964552 [debug] [Thread-1 (]: Began compiling node seed.ecommerce_analytics.raw_customers
[0m01:25:46.966510 [debug] [Thread-1 (]: Began executing node seed.ecommerce_analytics.raw_customers
[0m01:25:47.074700 [debug] [Thread-1 (]: Using duckdb connection "seed.ecommerce_analytics.raw_customers"
[0m01:25:47.076715 [debug] [Thread-1 (]: On seed.ecommerce_analytics.raw_customers: BEGIN
[0m01:25:47.076715 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m01:25:47.076715 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m01:25:47.082990 [debug] [Thread-1 (]: Using duckdb connection "seed.ecommerce_analytics.raw_customers"
[0m01:25:47.082990 [debug] [Thread-1 (]: On seed.ecommerce_analytics.raw_customers: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "ecommerce_analytics", "target_name": "dev", "node_id": "seed.ecommerce_analytics.raw_customers"} */

    create table "dev"."main"."raw_customers" ("customer_id" integer,"first_name" text,"last_name" text,"email" text,"phone" text,"birth_date" date,"city" text,"country" text,"postal_code" integer,"segment" text,"registration_date" date,"last_login" date,"is_verified" boolean,"accepts_marketing" integer)
  
[0m01:25:47.085426 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m01:25:47.125105 [debug] [Thread-1 (]: Using duckdb connection "seed.ecommerce_analytics.raw_customers"
[0m01:25:47.133061 [debug] [Thread-1 (]: On seed.ecommerce_analytics.raw_customers: 
          COPY "dev"."main"."raw_customers" FROM 'C:\Users\Lenovo\Desktop\Proyectos\dbt-proyect\ecommerce_analytics\seeds\raw_customers.csv' (FORMAT CSV, HEADER TRUE, DELIMITER ',')
        ...
[0m01:25:47.176097 [debug] [Thread-1 (]: SQL status: OK in 0.041 seconds
[0m01:25:47.197041 [debug] [Thread-1 (]: Writing runtime SQL for node "seed.ecommerce_analytics.raw_customers"
[0m01:25:47.250889 [debug] [Thread-1 (]: On seed.ecommerce_analytics.raw_customers: COMMIT
[0m01:25:47.252606 [debug] [Thread-1 (]: Using duckdb connection "seed.ecommerce_analytics.raw_customers"
[0m01:25:47.255529 [debug] [Thread-1 (]: On seed.ecommerce_analytics.raw_customers: COMMIT
[0m01:25:47.261154 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m01:25:47.269179 [debug] [Thread-1 (]: On seed.ecommerce_analytics.raw_customers: Close
[0m01:25:47.271913 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6018daf2-3833-45f4-a6f0-b5839a48bdfc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000224D769D510>]}
[0m01:25:47.271913 [info ] [Thread-1 (]: 1 of 3 OK loaded seed file main.raw_customers .................................. [[32mINSERT 34[0m in 0.31s]
[0m01:25:47.282352 [debug] [Thread-1 (]: Finished running node seed.ecommerce_analytics.raw_customers
[0m01:25:47.282352 [debug] [Thread-1 (]: Began running node seed.ecommerce_analytics.raw_orders
[0m01:25:47.285781 [info ] [Thread-1 (]: 2 of 3 START seed file main.raw_orders ......................................... [RUN]
[0m01:25:47.290801 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly seed.ecommerce_analytics.raw_customers, now seed.ecommerce_analytics.raw_orders)
[0m01:25:47.292825 [debug] [Thread-1 (]: Began compiling node seed.ecommerce_analytics.raw_orders
[0m01:25:47.292825 [debug] [Thread-1 (]: Began executing node seed.ecommerce_analytics.raw_orders
[0m01:25:47.345960 [debug] [Thread-1 (]: Using duckdb connection "seed.ecommerce_analytics.raw_orders"
[0m01:25:47.345960 [debug] [Thread-1 (]: On seed.ecommerce_analytics.raw_orders: BEGIN
[0m01:25:47.345960 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:25:47.354098 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m01:25:47.355107 [debug] [Thread-1 (]: Using duckdb connection "seed.ecommerce_analytics.raw_orders"
[0m01:25:47.355107 [debug] [Thread-1 (]: On seed.ecommerce_analytics.raw_orders: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "ecommerce_analytics", "target_name": "dev", "node_id": "seed.ecommerce_analytics.raw_orders"} */

    create table "dev"."main"."raw_orders" ("order_id" integer,"order_number" text,"customer_id" integer,"order_date" date,"status" text,"subtotal" float8,"discount_percent" integer,"shipping_cost" integer,"tax_amount" float8,"total_amount" float8,"payment_method" text,"shipping_method" text,"promotion_id" integer,"notes" text)
  
[0m01:25:47.362863 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m01:25:47.369369 [debug] [Thread-1 (]: Using duckdb connection "seed.ecommerce_analytics.raw_orders"
[0m01:25:47.370631 [debug] [Thread-1 (]: On seed.ecommerce_analytics.raw_orders: 
          COPY "dev"."main"."raw_orders" FROM 'C:\Users\Lenovo\Desktop\Proyectos\dbt-proyect\ecommerce_analytics\seeds\raw_orders.csv' (FORMAT CSV, HEADER TRUE, DELIMITER ',')
        ...
[0m01:25:47.412241 [debug] [Thread-1 (]: SQL status: OK in 0.040 seconds
[0m01:25:47.412241 [debug] [Thread-1 (]: Writing runtime SQL for node "seed.ecommerce_analytics.raw_orders"
[0m01:25:47.420762 [debug] [Thread-1 (]: On seed.ecommerce_analytics.raw_orders: COMMIT
[0m01:25:47.426826 [debug] [Thread-1 (]: Using duckdb connection "seed.ecommerce_analytics.raw_orders"
[0m01:25:47.428597 [debug] [Thread-1 (]: On seed.ecommerce_analytics.raw_orders: COMMIT
[0m01:25:47.434866 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m01:25:47.437150 [debug] [Thread-1 (]: On seed.ecommerce_analytics.raw_orders: Close
[0m01:25:47.437150 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6018daf2-3833-45f4-a6f0-b5839a48bdfc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000224D76F78D0>]}
[0m01:25:47.437150 [info ] [Thread-1 (]: 2 of 3 OK loaded seed file main.raw_orders ..................................... [[32mINSERT 100[0m in 0.15s]
[0m01:25:47.446173 [debug] [Thread-1 (]: Finished running node seed.ecommerce_analytics.raw_orders
[0m01:25:47.447733 [debug] [Thread-1 (]: Began running node seed.ecommerce_analytics.raw_products
[0m01:25:47.447733 [info ] [Thread-1 (]: 3 of 3 START seed file main.raw_products ....................................... [RUN]
[0m01:25:47.453753 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly seed.ecommerce_analytics.raw_orders, now seed.ecommerce_analytics.raw_products)
[0m01:25:47.453753 [debug] [Thread-1 (]: Began compiling node seed.ecommerce_analytics.raw_products
[0m01:25:47.458151 [debug] [Thread-1 (]: Began executing node seed.ecommerce_analytics.raw_products
[0m01:25:47.487081 [debug] [Thread-1 (]: Using duckdb connection "seed.ecommerce_analytics.raw_products"
[0m01:25:47.489095 [debug] [Thread-1 (]: On seed.ecommerce_analytics.raw_products: BEGIN
[0m01:25:47.492589 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:25:47.494339 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m01:25:47.494339 [debug] [Thread-1 (]: Using duckdb connection "seed.ecommerce_analytics.raw_products"
[0m01:25:47.499567 [debug] [Thread-1 (]: On seed.ecommerce_analytics.raw_products: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "ecommerce_analytics", "target_name": "dev", "node_id": "seed.ecommerce_analytics.raw_products"} */

    create table "dev"."main"."raw_products" ("product_id" integer,"sku" text,"product_name" text,"description" text,"category_id" integer,"brand_id" integer,"supplier_id" integer,"price" float8,"cost" float8,"weight_kg" float8,"is_active" boolean,"created_at" date,"updated_at" date)
  
[0m01:25:47.503378 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m01:25:47.510984 [debug] [Thread-1 (]: Using duckdb connection "seed.ecommerce_analytics.raw_products"
[0m01:25:47.510984 [debug] [Thread-1 (]: On seed.ecommerce_analytics.raw_products: 
          COPY "dev"."main"."raw_products" FROM 'C:\Users\Lenovo\Desktop\Proyectos\dbt-proyect\ecommerce_analytics\seeds\raw_products.csv' (FORMAT CSV, HEADER TRUE, DELIMITER ',')
        ...
[0m01:25:47.530816 [debug] [Thread-1 (]: SQL status: OK in 0.018 seconds
[0m01:25:47.535792 [debug] [Thread-1 (]: Writing runtime SQL for node "seed.ecommerce_analytics.raw_products"
[0m01:25:47.544872 [debug] [Thread-1 (]: On seed.ecommerce_analytics.raw_products: COMMIT
[0m01:25:47.551581 [debug] [Thread-1 (]: Using duckdb connection "seed.ecommerce_analytics.raw_products"
[0m01:25:47.553448 [debug] [Thread-1 (]: On seed.ecommerce_analytics.raw_products: COMMIT
[0m01:25:47.556932 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m01:25:47.562223 [debug] [Thread-1 (]: On seed.ecommerce_analytics.raw_products: Close
[0m01:25:47.565682 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6018daf2-3833-45f4-a6f0-b5839a48bdfc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000224D7735C10>]}
[0m01:25:47.569550 [info ] [Thread-1 (]: 3 of 3 OK loaded seed file main.raw_products ................................... [[32mINSERT 20[0m in 0.11s]
[0m01:25:47.572617 [debug] [Thread-1 (]: Finished running node seed.ecommerce_analytics.raw_products
[0m01:25:47.576937 [debug] [MainThread]: Using duckdb connection "master"
[0m01:25:47.579048 [debug] [MainThread]: On master: BEGIN
[0m01:25:47.579048 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m01:25:47.585438 [debug] [MainThread]: SQL status: OK in 0.003 seconds
[0m01:25:47.585438 [debug] [MainThread]: On master: COMMIT
[0m01:25:47.585438 [debug] [MainThread]: Using duckdb connection "master"
[0m01:25:47.590984 [debug] [MainThread]: On master: COMMIT
[0m01:25:47.593496 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m01:25:47.593496 [debug] [MainThread]: On master: Close
[0m01:25:47.593496 [debug] [MainThread]: Connection 'master' was properly closed.
[0m01:25:47.593496 [debug] [MainThread]: Connection 'create_dev_main' was properly closed.
[0m01:25:47.601556 [debug] [MainThread]: Connection 'list_dev_main' was properly closed.
[0m01:25:47.604475 [debug] [MainThread]: Connection 'seed.ecommerce_analytics.raw_products' was properly closed.
[0m01:25:47.604475 [info ] [MainThread]: 
[0m01:25:47.607358 [info ] [MainThread]: Finished running 3 seeds in 0 hours 0 minutes and 1.23 seconds (1.23s).
[0m01:25:47.607358 [debug] [MainThread]: Command end result
[0m01:25:47.714526 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\Lenovo\Desktop\Proyectos\dbt-proyect\ecommerce_analytics\target\manifest.json
[0m01:25:47.723301 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\Lenovo\Desktop\Proyectos\dbt-proyect\ecommerce_analytics\target\semantic_manifest.json
[0m01:25:47.750121 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\Lenovo\Desktop\Proyectos\dbt-proyect\ecommerce_analytics\target\run_results.json
[0m01:25:47.750121 [info ] [MainThread]: 
[0m01:25:47.752297 [info ] [MainThread]: [32mCompleted successfully[0m
[0m01:25:47.756024 [info ] [MainThread]: 
[0m01:25:47.756024 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=3
[0m01:25:47.760342 [debug] [MainThread]: Command `dbt seed` succeeded at 01:25:47.760342 after 5.55 seconds
[0m01:25:47.764703 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000224CEF74C10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000224CEF74A90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000224CF26AAD0>]}
[0m01:25:47.765761 [debug] [MainThread]: Flushing usage events
[0m01:25:49.615637 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m01:26:01.451536 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D6D2BFFE90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D6D2BFCB50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D6D2BFD090>]}


============================== 01:26:01.462110 | 9ad5bafb-ba56-426b-9287-28fe3e2a40b1 ==============================
[0m01:26:01.462110 [info ] [MainThread]: Running with dbt=1.11.2
[0m01:26:01.462110 [debug] [MainThread]: running dbt with arguments {'version_check': 'True', 'no_print': 'None', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'target_path': 'None', 'printer_width': '80', 'write_json': 'True', 'introspect': 'True', 'log_cache_events': 'False', 'empty': 'None', 'cache_selected_only': 'False', 'fail_fast': 'False', 'debug': 'False', 'log_format': 'default', 'profiles_dir': 'C:\\Users\\Lenovo\\.dbt', 'send_anonymous_usage_stats': 'True', 'quiet': 'False', 'warn_error': 'None', 'partial_parse': 'True', 'use_colors': 'True', 'invocation_command': 'dbt seed', 'indirect_selection': 'eager', 'use_experimental_parser': 'False', 'log_path': 'C:\\Users\\Lenovo\\Desktop\\Proyectos\\dbt-proyect\\ecommerce_analytics\\logs'}
[0m01:26:01.785296 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9ad5bafb-ba56-426b-9287-28fe3e2a40b1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D6D2C611D0>]}
[0m01:26:01.850932 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '9ad5bafb-ba56-426b-9287-28fe3e2a40b1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D6D1BDA950>]}
[0m01:26:01.856631 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m01:26:02.142854 [debug] [MainThread]: checksum: 3d40d8bbe1bef07db1c24822f2dbfff8bc07f2a48ed4fe2658a40653aec0b54b, vars: {}, profile: , target: , version: 1.11.2
[0m01:26:02.351197 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m01:26:02.352271 [debug] [MainThread]: Nothing changed, skipping partial parsing.
[0m01:26:02.352870 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m01:26:02.427990 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9ad5bafb-ba56-426b-9287-28fe3e2a40b1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D6D41BE390>]}
[0m01:26:02.539359 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\Lenovo\Desktop\Proyectos\dbt-proyect\ecommerce_analytics\target\manifest.json
[0m01:26:02.542056 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\Lenovo\Desktop\Proyectos\dbt-proyect\ecommerce_analytics\target\semantic_manifest.json
[0m01:26:02.585120 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9ad5bafb-ba56-426b-9287-28fe3e2a40b1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D6D42F7850>]}
[0m01:26:02.585120 [info ] [MainThread]: Found 2 models, 4 data tests, 3 seeds, 471 macros
[0m01:26:02.585120 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9ad5bafb-ba56-426b-9287-28fe3e2a40b1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D6D4084210>]}
[0m01:26:02.593772 [info ] [MainThread]: 
[0m01:26:02.593772 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m01:26:02.597071 [info ] [MainThread]: 
[0m01:26:02.597672 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m01:26:02.606906 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_dev'
[0m01:26:02.765313 [debug] [ThreadPool]: Using duckdb connection "list_dev"
[0m01:26:02.765313 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "ecommerce_analytics", "target_name": "dev", "connection_name": "list_dev"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"dev"'
    
  
  
[0m01:26:02.767322 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:26:02.841038 [debug] [ThreadPool]: SQL status: OK in 0.075 seconds
[0m01:26:02.843082 [debug] [ThreadPool]: On list_dev: Close
[0m01:26:02.843082 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev, now create_dev_main)
[0m01:26:02.843082 [debug] [ThreadPool]: Creating schema "database: "dev"
schema: "main"
"
[0m01:26:02.863793 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m01:26:02.872608 [debug] [ThreadPool]: On create_dev_main: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "ecommerce_analytics", "target_name": "dev", "connection_name": "create_dev_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='dev'
        and type='sqlite'
    
  
[0m01:26:02.872608 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m01:26:02.874228 [debug] [ThreadPool]: SQL status: OK in 0.003 seconds
[0m01:26:02.874228 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m01:26:02.874228 [debug] [ThreadPool]: On create_dev_main: BEGIN
[0m01:26:02.874228 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m01:26:02.874228 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m01:26:02.874228 [debug] [ThreadPool]: On create_dev_main: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "ecommerce_analytics", "target_name": "dev", "connection_name": "create_dev_main"} */

    
    
        create schema if not exists "dev"."main"
    
[0m01:26:02.884546 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m01:26:02.884546 [debug] [ThreadPool]: On create_dev_main: COMMIT
[0m01:26:02.888320 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m01:26:02.888320 [debug] [ThreadPool]: On create_dev_main: COMMIT
[0m01:26:02.888320 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m01:26:02.888320 [debug] [ThreadPool]: On create_dev_main: Close
[0m01:26:02.888320 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_dev_main'
[0m01:26:02.902767 [debug] [ThreadPool]: Using duckdb connection "list_dev_main"
[0m01:26:02.903780 [debug] [ThreadPool]: On list_dev_main: BEGIN
[0m01:26:02.904401 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:26:02.906292 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m01:26:02.906292 [debug] [ThreadPool]: Using duckdb connection "list_dev_main"
[0m01:26:02.908313 [debug] [ThreadPool]: On list_dev_main: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "ecommerce_analytics", "target_name": "dev", "connection_name": "list_dev_main"} */
select
      'dev' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'dev'
  
[0m01:26:02.944801 [debug] [ThreadPool]: SQL status: OK in 0.037 seconds
[0m01:26:02.949400 [debug] [ThreadPool]: On list_dev_main: ROLLBACK
[0m01:26:02.952012 [debug] [ThreadPool]: Failed to rollback 'list_dev_main'
[0m01:26:02.952012 [debug] [ThreadPool]: On list_dev_main: Close
[0m01:26:02.952012 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9ad5bafb-ba56-426b-9287-28fe3e2a40b1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D6D3EE3150>]}
[0m01:26:02.957755 [debug] [MainThread]: Using duckdb connection "master"
[0m01:26:02.957755 [debug] [MainThread]: On master: BEGIN
[0m01:26:02.957755 [debug] [MainThread]: Opening a new connection, currently in state init
[0m01:26:02.957755 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m01:26:02.957755 [debug] [MainThread]: On master: COMMIT
[0m01:26:02.957755 [debug] [MainThread]: Using duckdb connection "master"
[0m01:26:02.957755 [debug] [MainThread]: On master: COMMIT
[0m01:26:02.957755 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m01:26:02.957755 [debug] [MainThread]: On master: Close
[0m01:26:02.968260 [debug] [Thread-1 (]: Began running node seed.ecommerce_analytics.raw_customers
[0m01:26:02.968260 [info ] [Thread-1 (]: 1 of 3 START seed file main.raw_customers ...................................... [RUN]
[0m01:26:02.968260 [debug] [Thread-1 (]: Acquiring new duckdb connection 'seed.ecommerce_analytics.raw_customers'
[0m01:26:02.968260 [debug] [Thread-1 (]: Began compiling node seed.ecommerce_analytics.raw_customers
[0m01:26:02.968260 [debug] [Thread-1 (]: Began executing node seed.ecommerce_analytics.raw_customers
[0m01:26:03.020362 [debug] [Thread-1 (]: Using duckdb connection "seed.ecommerce_analytics.raw_customers"
[0m01:26:03.020362 [debug] [Thread-1 (]: On seed.ecommerce_analytics.raw_customers: BEGIN
[0m01:26:03.020362 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m01:26:03.020362 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m01:26:03.020362 [debug] [Thread-1 (]: Using duckdb connection "seed.ecommerce_analytics.raw_customers"
[0m01:26:03.020362 [debug] [Thread-1 (]: On seed.ecommerce_analytics.raw_customers: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "ecommerce_analytics", "target_name": "dev", "node_id": "seed.ecommerce_analytics.raw_customers"} */
truncate table "dev"."main"."raw_customers"
[0m01:26:03.029237 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m01:26:03.043277 [debug] [Thread-1 (]: Using duckdb connection "seed.ecommerce_analytics.raw_customers"
[0m01:26:03.043277 [debug] [Thread-1 (]: On seed.ecommerce_analytics.raw_customers: 
          COPY "dev"."main"."raw_customers" FROM 'C:\Users\Lenovo\Desktop\Proyectos\dbt-proyect\ecommerce_analytics\seeds\raw_customers.csv' (FORMAT CSV, HEADER TRUE, DELIMITER ',')
        ...
[0m01:26:03.062265 [debug] [Thread-1 (]: SQL status: OK in 0.017 seconds
[0m01:26:03.072632 [debug] [Thread-1 (]: Writing runtime SQL for node "seed.ecommerce_analytics.raw_customers"
[0m01:26:03.082721 [debug] [Thread-1 (]: On seed.ecommerce_analytics.raw_customers: COMMIT
[0m01:26:03.085157 [debug] [Thread-1 (]: Using duckdb connection "seed.ecommerce_analytics.raw_customers"
[0m01:26:03.085749 [debug] [Thread-1 (]: On seed.ecommerce_analytics.raw_customers: COMMIT
[0m01:26:03.090905 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m01:26:03.092915 [debug] [Thread-1 (]: On seed.ecommerce_analytics.raw_customers: Close
[0m01:26:03.092915 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9ad5bafb-ba56-426b-9287-28fe3e2a40b1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D6D40AFE50>]}
[0m01:26:03.092915 [info ] [Thread-1 (]: 1 of 3 OK loaded seed file main.raw_customers .................................. [[32mINSERT 34[0m in 0.12s]
[0m01:26:03.092915 [debug] [Thread-1 (]: Finished running node seed.ecommerce_analytics.raw_customers
[0m01:26:03.101223 [debug] [Thread-1 (]: Began running node seed.ecommerce_analytics.raw_orders
[0m01:26:03.101824 [info ] [Thread-1 (]: 2 of 3 START seed file main.raw_orders ......................................... [RUN]
[0m01:26:03.103349 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly seed.ecommerce_analytics.raw_customers, now seed.ecommerce_analytics.raw_orders)
[0m01:26:03.103349 [debug] [Thread-1 (]: Began compiling node seed.ecommerce_analytics.raw_orders
[0m01:26:03.103349 [debug] [Thread-1 (]: Began executing node seed.ecommerce_analytics.raw_orders
[0m01:26:03.118023 [debug] [Thread-1 (]: Using duckdb connection "seed.ecommerce_analytics.raw_orders"
[0m01:26:03.119362 [debug] [Thread-1 (]: On seed.ecommerce_analytics.raw_orders: BEGIN
[0m01:26:03.120106 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:26:03.120106 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m01:26:03.120106 [debug] [Thread-1 (]: Using duckdb connection "seed.ecommerce_analytics.raw_orders"
[0m01:26:03.120106 [debug] [Thread-1 (]: On seed.ecommerce_analytics.raw_orders: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "ecommerce_analytics", "target_name": "dev", "node_id": "seed.ecommerce_analytics.raw_orders"} */
truncate table "dev"."main"."raw_orders"
[0m01:26:03.123612 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m01:26:03.124217 [debug] [Thread-1 (]: Using duckdb connection "seed.ecommerce_analytics.raw_orders"
[0m01:26:03.124217 [debug] [Thread-1 (]: On seed.ecommerce_analytics.raw_orders: 
          COPY "dev"."main"."raw_orders" FROM 'C:\Users\Lenovo\Desktop\Proyectos\dbt-proyect\ecommerce_analytics\seeds\raw_orders.csv' (FORMAT CSV, HEADER TRUE, DELIMITER ',')
        ...
[0m01:26:03.149451 [debug] [Thread-1 (]: SQL status: OK in 0.020 seconds
[0m01:26:03.151132 [debug] [Thread-1 (]: Writing runtime SQL for node "seed.ecommerce_analytics.raw_orders"
[0m01:26:03.155314 [debug] [Thread-1 (]: On seed.ecommerce_analytics.raw_orders: COMMIT
[0m01:26:03.155314 [debug] [Thread-1 (]: Using duckdb connection "seed.ecommerce_analytics.raw_orders"
[0m01:26:03.155314 [debug] [Thread-1 (]: On seed.ecommerce_analytics.raw_orders: COMMIT
[0m01:26:03.155314 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m01:26:03.155314 [debug] [Thread-1 (]: On seed.ecommerce_analytics.raw_orders: Close
[0m01:26:03.161636 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9ad5bafb-ba56-426b-9287-28fe3e2a40b1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D6CF7AB910>]}
[0m01:26:03.163541 [info ] [Thread-1 (]: 2 of 3 OK loaded seed file main.raw_orders ..................................... [[32mINSERT 100[0m in 0.06s]
[0m01:26:03.164888 [debug] [Thread-1 (]: Finished running node seed.ecommerce_analytics.raw_orders
[0m01:26:03.165904 [debug] [Thread-1 (]: Began running node seed.ecommerce_analytics.raw_products
[0m01:26:03.165904 [info ] [Thread-1 (]: 3 of 3 START seed file main.raw_products ....................................... [RUN]
[0m01:26:03.165904 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly seed.ecommerce_analytics.raw_orders, now seed.ecommerce_analytics.raw_products)
[0m01:26:03.165904 [debug] [Thread-1 (]: Began compiling node seed.ecommerce_analytics.raw_products
[0m01:26:03.169984 [debug] [Thread-1 (]: Began executing node seed.ecommerce_analytics.raw_products
[0m01:26:03.180473 [debug] [Thread-1 (]: Using duckdb connection "seed.ecommerce_analytics.raw_products"
[0m01:26:03.181209 [debug] [Thread-1 (]: On seed.ecommerce_analytics.raw_products: BEGIN
[0m01:26:03.182825 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:26:03.184903 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m01:26:03.184903 [debug] [Thread-1 (]: Using duckdb connection "seed.ecommerce_analytics.raw_products"
[0m01:26:03.186912 [debug] [Thread-1 (]: On seed.ecommerce_analytics.raw_products: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "ecommerce_analytics", "target_name": "dev", "node_id": "seed.ecommerce_analytics.raw_products"} */
truncate table "dev"."main"."raw_products"
[0m01:26:03.188204 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m01:26:03.190214 [debug] [Thread-1 (]: Using duckdb connection "seed.ecommerce_analytics.raw_products"
[0m01:26:03.190214 [debug] [Thread-1 (]: On seed.ecommerce_analytics.raw_products: 
          COPY "dev"."main"."raw_products" FROM 'C:\Users\Lenovo\Desktop\Proyectos\dbt-proyect\ecommerce_analytics\seeds\raw_products.csv' (FORMAT CSV, HEADER TRUE, DELIMITER ',')
        ...
[0m01:26:03.199353 [debug] [Thread-1 (]: SQL status: OK in 0.008 seconds
[0m01:26:03.202175 [debug] [Thread-1 (]: Writing runtime SQL for node "seed.ecommerce_analytics.raw_products"
[0m01:26:03.205363 [debug] [Thread-1 (]: On seed.ecommerce_analytics.raw_products: COMMIT
[0m01:26:03.205363 [debug] [Thread-1 (]: Using duckdb connection "seed.ecommerce_analytics.raw_products"
[0m01:26:03.205363 [debug] [Thread-1 (]: On seed.ecommerce_analytics.raw_products: COMMIT
[0m01:26:03.209984 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m01:26:03.209984 [debug] [Thread-1 (]: On seed.ecommerce_analytics.raw_products: Close
[0m01:26:03.209984 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9ad5bafb-ba56-426b-9287-28fe3e2a40b1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D6D4749010>]}
[0m01:26:03.214821 [info ] [Thread-1 (]: 3 of 3 OK loaded seed file main.raw_products ................................... [[32mINSERT 20[0m in 0.04s]
[0m01:26:03.214821 [debug] [Thread-1 (]: Finished running node seed.ecommerce_analytics.raw_products
[0m01:26:03.218352 [debug] [MainThread]: Using duckdb connection "master"
[0m01:26:03.218352 [debug] [MainThread]: On master: BEGIN
[0m01:26:03.218352 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m01:26:03.218352 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m01:26:03.218352 [debug] [MainThread]: On master: COMMIT
[0m01:26:03.218352 [debug] [MainThread]: Using duckdb connection "master"
[0m01:26:03.218352 [debug] [MainThread]: On master: COMMIT
[0m01:26:03.218352 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m01:26:03.218352 [debug] [MainThread]: On master: Close
[0m01:26:03.218352 [debug] [MainThread]: Connection 'master' was properly closed.
[0m01:26:03.218352 [debug] [MainThread]: Connection 'create_dev_main' was properly closed.
[0m01:26:03.218352 [debug] [MainThread]: Connection 'list_dev_main' was properly closed.
[0m01:26:03.218352 [debug] [MainThread]: Connection 'seed.ecommerce_analytics.raw_products' was properly closed.
[0m01:26:03.218352 [info ] [MainThread]: 
[0m01:26:03.218352 [info ] [MainThread]: Finished running 3 seeds in 0 hours 0 minutes and 0.62 seconds (0.62s).
[0m01:26:03.227421 [debug] [MainThread]: Command end result
[0m01:26:03.250356 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\Lenovo\Desktop\Proyectos\dbt-proyect\ecommerce_analytics\target\manifest.json
[0m01:26:03.250356 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\Lenovo\Desktop\Proyectos\dbt-proyect\ecommerce_analytics\target\semantic_manifest.json
[0m01:26:03.260040 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\Lenovo\Desktop\Proyectos\dbt-proyect\ecommerce_analytics\target\run_results.json
[0m01:26:03.264422 [info ] [MainThread]: 
[0m01:26:03.266455 [info ] [MainThread]: [32mCompleted successfully[0m
[0m01:26:03.266455 [info ] [MainThread]: 
[0m01:26:03.266455 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=3
[0m01:26:03.270178 [debug] [MainThread]: Command `dbt seed` succeeded at 01:26:03.270178 after 1.95 seconds
[0m01:26:03.270178 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D6D2BF79D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D6D2BF7A90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D6CBEC4A90>]}
[0m01:26:03.270178 [debug] [MainThread]: Flushing usage events
[0m01:26:04.320641 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m01:41:29.892619 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E2E8BBCA50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E2E8BBFDD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E2E8BBFC50>]}


============================== 01:41:29.903874 | 9a4275df-2584-467a-9299-a78ebf5a55fd ==============================
[0m01:41:29.903874 [info ] [MainThread]: Running with dbt=1.11.2
[0m01:41:29.903874 [debug] [MainThread]: running dbt with arguments {'static_parser': 'True', 'no_print': 'None', 'version_check': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'printer_width': '80', 'write_json': 'True', 'introspect': 'True', 'log_cache_events': 'False', 'empty': 'None', 'cache_selected_only': 'False', 'log_format': 'default', 'debug': 'False', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\Lenovo\\.dbt', 'send_anonymous_usage_stats': 'True', 'quiet': 'False', 'warn_error': 'None', 'partial_parse': 'True', 'indirect_selection': 'eager', 'invocation_command': 'dbt deps', 'use_colors': 'True', 'use_experimental_parser': 'False', 'log_path': 'C:\\Users\\Lenovo\\Desktop\\Proyectos\\dbt-proyect\\ecommerce_analytics\\logs'}
[0m01:41:30.117540 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9a4275df-2584-467a-9299-a78ebf5a55fd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E2E9D3CB50>]}
[0m01:41:30.170975 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m01:41:30.170975 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m01:41:30.179408 [debug] [MainThread]: Command `dbt deps` succeeded at 01:41:30.179408 after 0.37 seconds
[0m01:41:30.179408 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E2E8874390>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E2E1EA5010>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E2E1EA4C10>]}
[0m01:41:30.181561 [debug] [MainThread]: Flushing usage events
[0m01:41:31.529392 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m01:42:10.239930 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016758DFC4D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000167563C9090>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016758DFEE50>]}


============================== 01:42:10.239930 | 2419d753-ae76-4930-a975-cbc9e9ddc061 ==============================
[0m01:42:10.239930 [info ] [MainThread]: Running with dbt=1.11.2
[0m01:42:10.247460 [debug] [MainThread]: running dbt with arguments {'static_parser': 'True', 'no_print': 'None', 'version_check': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'target_path': 'None', 'printer_width': '80', 'write_json': 'True', 'introspect': 'True', 'log_cache_events': 'False', 'empty': 'None', 'cache_selected_only': 'False', 'log_format': 'default', 'debug': 'False', 'fail_fast': 'False', 'partial_parse': 'True', 'send_anonymous_usage_stats': 'True', 'quiet': 'False', 'warn_error': 'None', 'profiles_dir': 'C:\\Users\\Lenovo\\.dbt', 'invocation_command': 'dbt test', 'indirect_selection': 'eager', 'use_colors': 'True', 'use_experimental_parser': 'False', 'log_path': 'C:\\Users\\Lenovo\\Desktop\\Proyectos\\dbt-proyect\\ecommerce_analytics\\logs'}
[0m01:42:10.621871 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2419d753-ae76-4930-a975-cbc9e9ddc061', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016758E1B510>]}
[0m01:42:10.679946 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '2419d753-ae76-4930-a975-cbc9e9ddc061', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016755773C90>]}
[0m01:42:10.688116 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m01:42:11.015825 [debug] [MainThread]: checksum: 3d40d8bbe1bef07db1c24822f2dbfff8bc07f2a48ed4fe2658a40653aec0b54b, vars: {}, profile: , target: , version: 1.11.2
[0m01:42:11.280287 [debug] [MainThread]: Partial parsing enabled: 3 files deleted, 8 files added, 0 files changed.
[0m01:42:11.282796 [debug] [MainThread]: Partial parsing: added file: ecommerce_analytics://models\example\marts\fct_orders.sql
[0m01:42:11.284019 [debug] [MainThread]: Partial parsing: added file: ecommerce_analytics://models\example\staging\stg_orders.sql
[0m01:42:11.284631 [debug] [MainThread]: Partial parsing: added file: ecommerce_analytics://models\example\marts\dim_products.sql
[0m01:42:11.285249 [debug] [MainThread]: Partial parsing: added file: ecommerce_analytics://models\example\intermediate\int_orders_enriched.sql
[0m01:42:11.285822 [debug] [MainThread]: Partial parsing: added file: ecommerce_analytics://models\example\marts\dim_customers.sql
[0m01:42:11.286594 [debug] [MainThread]: Partial parsing: added file: ecommerce_analytics://models\example\staging\stg_customers.sql
[0m01:42:11.287138 [debug] [MainThread]: Partial parsing: added file: ecommerce_analytics://models\example\staging\stg_products.sql
[0m01:42:11.287790 [debug] [MainThread]: Partial parsing: added file: ecommerce_analytics://models\example\staging\schema.yml
[0m01:42:11.288320 [debug] [MainThread]: Partial parsing: deleted file: ecommerce_analytics://models\example\my_first_dbt_model.sql
[0m01:42:11.288851 [debug] [MainThread]: Partial parsing: deleted file: ecommerce_analytics://models\example\my_second_dbt_model.sql
[0m01:42:11.752949 [warn ] [MainThread]: [[33mWARNING[0m][MissingArgumentsPropertyInGenericTestDeprecation]: Deprecated
functionality
Found top-level arguments to test `relationships` defined on 'stg_orders' in
package 'ecommerce_analytics' (models\example\staging\schema.yml). Arguments to
generic tests should be nested under the `arguments` property.
[0m01:42:11.752949 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '2419d753-ae76-4930-a975-cbc9e9ddc061', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001675A575E90>]}
[0m01:42:11.875704 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '2419d753-ae76-4930-a975-cbc9e9ddc061', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016758E3FAD0>]}
[0m01:42:11.982383 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\Lenovo\Desktop\Proyectos\dbt-proyect\ecommerce_analytics\target\manifest.json
[0m01:42:11.982383 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\Lenovo\Desktop\Proyectos\dbt-proyect\ecommerce_analytics\target\semantic_manifest.json
[0m01:42:12.026367 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '2419d753-ae76-4930-a975-cbc9e9ddc061', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001675A83DE50>]}
[0m01:42:12.026367 [info ] [MainThread]: Found 3 seeds, 7 models, 14 data tests, 471 macros
[0m01:42:12.026367 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2419d753-ae76-4930-a975-cbc9e9ddc061', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001675A079450>]}
[0m01:42:12.030384 [info ] [MainThread]: 
[0m01:42:12.030384 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m01:42:12.030384 [info ] [MainThread]: 
[0m01:42:12.034104 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m01:42:12.040637 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_dev_main'
[0m01:42:12.129751 [debug] [ThreadPool]: Using duckdb connection "list_dev_main"
[0m01:42:12.132800 [debug] [ThreadPool]: On list_dev_main: BEGIN
[0m01:42:12.132800 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:42:12.171481 [debug] [ThreadPool]: SQL status: OK in 0.041 seconds
[0m01:42:12.171481 [debug] [ThreadPool]: Using duckdb connection "list_dev_main"
[0m01:42:12.171481 [debug] [ThreadPool]: On list_dev_main: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "ecommerce_analytics", "target_name": "dev", "connection_name": "list_dev_main"} */
select
      'dev' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'dev'
  
[0m01:42:12.207001 [debug] [ThreadPool]: SQL status: OK in 0.032 seconds
[0m01:42:12.209647 [debug] [ThreadPool]: On list_dev_main: ROLLBACK
[0m01:42:12.212166 [debug] [ThreadPool]: Failed to rollback 'list_dev_main'
[0m01:42:12.212166 [debug] [ThreadPool]: On list_dev_main: Close
[0m01:42:12.212166 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2419d753-ae76-4930-a975-cbc9e9ddc061', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016759F267D0>]}
[0m01:42:12.212166 [debug] [MainThread]: Using duckdb connection "master"
[0m01:42:12.212166 [debug] [MainThread]: On master: BEGIN
[0m01:42:12.212166 [debug] [MainThread]: Opening a new connection, currently in state init
[0m01:42:12.212166 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m01:42:12.212166 [debug] [MainThread]: On master: COMMIT
[0m01:42:12.217136 [debug] [MainThread]: Using duckdb connection "master"
[0m01:42:12.217136 [debug] [MainThread]: On master: COMMIT
[0m01:42:12.217136 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m01:42:12.217136 [debug] [MainThread]: On master: Close
[0m01:42:12.219893 [debug] [Thread-1 (]: Began running node test.ecommerce_analytics.dbt_utils_accepted_range_stg_orders_total_amount__0.2895a1f8db
[0m01:42:12.219893 [info ] [Thread-1 (]: 1 of 14 START test dbt_utils_accepted_range_stg_orders_total_amount__0 ......... [RUN]
[0m01:42:12.226268 [debug] [Thread-1 (]: Acquiring new duckdb connection 'test.ecommerce_analytics.dbt_utils_accepted_range_stg_orders_total_amount__0.2895a1f8db'
[0m01:42:12.226268 [debug] [Thread-1 (]: Began compiling node test.ecommerce_analytics.dbt_utils_accepted_range_stg_orders_total_amount__0.2895a1f8db
[0m01:42:12.242798 [debug] [Thread-1 (]: Compilation Error in test dbt_utils_accepted_range_stg_orders_total_amount__0 (models\example\staging\schema.yml)
  'dbt_utils' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m01:42:12.242798 [error] [Thread-1 (]: 1 of 14 ERROR dbt_utils_accepted_range_stg_orders_total_amount__0 .............. [[31mERROR[0m in 0.02s]
[0m01:42:12.246616 [debug] [Thread-1 (]: Finished running node test.ecommerce_analytics.dbt_utils_accepted_range_stg_orders_total_amount__0.2895a1f8db
[0m01:42:12.246616 [debug] [Thread-1 (]: Began running node test.ecommerce_analytics.dbt_utils_accepted_range_stg_products_price__0.26bfce9c9f
[0m01:42:12.248164 [debug] [Thread-4 (]: Marking all children of 'test.ecommerce_analytics.dbt_utils_accepted_range_stg_orders_total_amount__0.2895a1f8db' to be skipped because of status 'error'.  Reason: Compilation Error in test dbt_utils_accepted_range_stg_orders_total_amount__0 (models\example\staging\schema.yml)
  'dbt_utils' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps"..
[0m01:42:12.248164 [info ] [Thread-1 (]: 2 of 14 START test dbt_utils_accepted_range_stg_products_price__0 .............. [RUN]
[0m01:42:12.249183 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.ecommerce_analytics.dbt_utils_accepted_range_stg_orders_total_amount__0.2895a1f8db, now test.ecommerce_analytics.dbt_utils_accepted_range_stg_products_price__0.26bfce9c9f)
[0m01:42:12.249183 [debug] [Thread-1 (]: Began compiling node test.ecommerce_analytics.dbt_utils_accepted_range_stg_products_price__0.26bfce9c9f
[0m01:42:12.253529 [debug] [Thread-1 (]: Compilation Error in test dbt_utils_accepted_range_stg_products_price__0 (models\example\staging\schema.yml)
  'dbt_utils' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m01:42:12.258387 [error] [Thread-1 (]: 2 of 14 ERROR dbt_utils_accepted_range_stg_products_price__0 ................... [[31mERROR[0m in 0.01s]
[0m01:42:12.259646 [debug] [Thread-1 (]: Finished running node test.ecommerce_analytics.dbt_utils_accepted_range_stg_products_price__0.26bfce9c9f
[0m01:42:12.259646 [debug] [Thread-1 (]: Began running node test.ecommerce_analytics.not_null_stg_customers_customer_id.e2cfb1f9aa
[0m01:42:12.259646 [debug] [Thread-4 (]: Marking all children of 'test.ecommerce_analytics.dbt_utils_accepted_range_stg_products_price__0.26bfce9c9f' to be skipped because of status 'error'.  Reason: Compilation Error in test dbt_utils_accepted_range_stg_products_price__0 (models\example\staging\schema.yml)
  'dbt_utils' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps"..
[0m01:42:12.261099 [info ] [Thread-1 (]: 3 of 14 START test not_null_stg_customers_customer_id .......................... [RUN]
[0m01:42:12.261440 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.ecommerce_analytics.dbt_utils_accepted_range_stg_products_price__0.26bfce9c9f, now test.ecommerce_analytics.not_null_stg_customers_customer_id.e2cfb1f9aa)
[0m01:42:12.261440 [debug] [Thread-1 (]: Began compiling node test.ecommerce_analytics.not_null_stg_customers_customer_id.e2cfb1f9aa
[0m01:42:12.268776 [debug] [Thread-1 (]: Writing injected SQL for node "test.ecommerce_analytics.not_null_stg_customers_customer_id.e2cfb1f9aa"
[0m01:42:12.271448 [debug] [Thread-1 (]: Began executing node test.ecommerce_analytics.not_null_stg_customers_customer_id.e2cfb1f9aa
[0m01:42:12.293986 [debug] [Thread-1 (]: Writing runtime sql for node "test.ecommerce_analytics.not_null_stg_customers_customer_id.e2cfb1f9aa"
[0m01:42:12.302354 [debug] [Thread-1 (]: Using duckdb connection "test.ecommerce_analytics.not_null_stg_customers_customer_id.e2cfb1f9aa"
[0m01:42:12.302862 [debug] [Thread-1 (]: On test.ecommerce_analytics.not_null_stg_customers_customer_id.e2cfb1f9aa: BEGIN
[0m01:42:12.303806 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m01:42:12.306131 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m01:42:12.306131 [debug] [Thread-1 (]: Using duckdb connection "test.ecommerce_analytics.not_null_stg_customers_customer_id.e2cfb1f9aa"
[0m01:42:12.306131 [debug] [Thread-1 (]: On test.ecommerce_analytics.not_null_stg_customers_customer_id.e2cfb1f9aa: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "ecommerce_analytics", "target_name": "dev", "node_id": "test.ecommerce_analytics.not_null_stg_customers_customer_id.e2cfb1f9aa"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select customer_id
from "dev"."main"."stg_customers"
where customer_id is null



  
  
      
    ) dbt_internal_test
[0m01:42:12.312162 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "ecommerce_analytics", "target_name": "dev", "node_id": "test.ecommerce_analytics.not_null_stg_customers_customer_id.e2cfb1f9aa"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select customer_id
from "dev"."main"."stg_customers"
where customer_id is null



  
  
      
    ) dbt_internal_test
[0m01:42:12.312162 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m01:42:12.312162 [debug] [Thread-1 (]: On test.ecommerce_analytics.not_null_stg_customers_customer_id.e2cfb1f9aa: ROLLBACK
[0m01:42:12.323120 [debug] [Thread-1 (]: Failed to rollback 'test.ecommerce_analytics.not_null_stg_customers_customer_id.e2cfb1f9aa'
[0m01:42:12.323120 [debug] [Thread-1 (]: On test.ecommerce_analytics.not_null_stg_customers_customer_id.e2cfb1f9aa: Close
[0m01:42:12.326278 [debug] [Thread-1 (]: Runtime Error in test not_null_stg_customers_customer_id (models\example\staging\schema.yml)
  Catalog Error: Table with name stg_customers does not exist!
  Did you mean "raw_customers"?
  
  LINE 17: from "dev"."main"."stg_customers"
                ^
[0m01:42:12.326278 [error] [Thread-1 (]: 3 of 14 ERROR not_null_stg_customers_customer_id ............................... [[31mERROR[0m in 0.06s]
[0m01:42:12.326278 [debug] [Thread-1 (]: Finished running node test.ecommerce_analytics.not_null_stg_customers_customer_id.e2cfb1f9aa
[0m01:42:12.326278 [debug] [Thread-1 (]: Began running node test.ecommerce_analytics.not_null_stg_customers_email.d7cf761533
[0m01:42:12.326278 [debug] [Thread-4 (]: Marking all children of 'test.ecommerce_analytics.not_null_stg_customers_customer_id.e2cfb1f9aa' to be skipped because of status 'error'.  Reason: Runtime Error in test not_null_stg_customers_customer_id (models\example\staging\schema.yml)
  Catalog Error: Table with name stg_customers does not exist!
  Did you mean "raw_customers"?
  
  LINE 17: from "dev"."main"."stg_customers"
                ^.
[0m01:42:12.331073 [info ] [Thread-1 (]: 4 of 14 START test not_null_stg_customers_email ................................ [RUN]
[0m01:42:12.331073 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.ecommerce_analytics.not_null_stg_customers_customer_id.e2cfb1f9aa, now test.ecommerce_analytics.not_null_stg_customers_email.d7cf761533)
[0m01:42:12.331073 [debug] [Thread-1 (]: Began compiling node test.ecommerce_analytics.not_null_stg_customers_email.d7cf761533
[0m01:42:12.336228 [debug] [Thread-1 (]: Writing injected SQL for node "test.ecommerce_analytics.not_null_stg_customers_email.d7cf761533"
[0m01:42:12.336228 [debug] [Thread-1 (]: Began executing node test.ecommerce_analytics.not_null_stg_customers_email.d7cf761533
[0m01:42:12.342796 [debug] [Thread-1 (]: Writing runtime sql for node "test.ecommerce_analytics.not_null_stg_customers_email.d7cf761533"
[0m01:42:12.342796 [debug] [Thread-1 (]: Using duckdb connection "test.ecommerce_analytics.not_null_stg_customers_email.d7cf761533"
[0m01:42:12.342796 [debug] [Thread-1 (]: On test.ecommerce_analytics.not_null_stg_customers_email.d7cf761533: BEGIN
[0m01:42:12.342796 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:42:12.342796 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m01:42:12.342796 [debug] [Thread-1 (]: Using duckdb connection "test.ecommerce_analytics.not_null_stg_customers_email.d7cf761533"
[0m01:42:12.342796 [debug] [Thread-1 (]: On test.ecommerce_analytics.not_null_stg_customers_email.d7cf761533: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "ecommerce_analytics", "target_name": "dev", "node_id": "test.ecommerce_analytics.not_null_stg_customers_email.d7cf761533"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select email
from "dev"."main"."stg_customers"
where email is null



  
  
      
    ) dbt_internal_test
[0m01:42:12.342796 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "ecommerce_analytics", "target_name": "dev", "node_id": "test.ecommerce_analytics.not_null_stg_customers_email.d7cf761533"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select email
from "dev"."main"."stg_customers"
where email is null



  
  
      
    ) dbt_internal_test
[0m01:42:12.342796 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m01:42:12.342796 [debug] [Thread-1 (]: On test.ecommerce_analytics.not_null_stg_customers_email.d7cf761533: ROLLBACK
[0m01:42:12.342796 [debug] [Thread-1 (]: Failed to rollback 'test.ecommerce_analytics.not_null_stg_customers_email.d7cf761533'
[0m01:42:12.351934 [debug] [Thread-1 (]: On test.ecommerce_analytics.not_null_stg_customers_email.d7cf761533: Close
[0m01:42:12.353700 [debug] [Thread-1 (]: Runtime Error in test not_null_stg_customers_email (models\example\staging\schema.yml)
  Catalog Error: Table with name stg_customers does not exist!
  Did you mean "raw_customers"?
  
  LINE 17: from "dev"."main"."stg_customers"
                ^
[0m01:42:12.353700 [error] [Thread-1 (]: 4 of 14 ERROR not_null_stg_customers_email ..................................... [[31mERROR[0m in 0.02s]
[0m01:42:12.353700 [debug] [Thread-1 (]: Finished running node test.ecommerce_analytics.not_null_stg_customers_email.d7cf761533
[0m01:42:12.353700 [debug] [Thread-1 (]: Began running node test.ecommerce_analytics.not_null_stg_orders_customer_id.af79d5e4b5
[0m01:42:12.353700 [debug] [Thread-4 (]: Marking all children of 'test.ecommerce_analytics.not_null_stg_customers_email.d7cf761533' to be skipped because of status 'error'.  Reason: Runtime Error in test not_null_stg_customers_email (models\example\staging\schema.yml)
  Catalog Error: Table with name stg_customers does not exist!
  Did you mean "raw_customers"?
  
  LINE 17: from "dev"."main"."stg_customers"
                ^.
[0m01:42:12.359825 [info ] [Thread-1 (]: 5 of 14 START test not_null_stg_orders_customer_id ............................. [RUN]
[0m01:42:12.359825 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.ecommerce_analytics.not_null_stg_customers_email.d7cf761533, now test.ecommerce_analytics.not_null_stg_orders_customer_id.af79d5e4b5)
[0m01:42:12.359825 [debug] [Thread-1 (]: Began compiling node test.ecommerce_analytics.not_null_stg_orders_customer_id.af79d5e4b5
[0m01:42:12.362332 [debug] [Thread-1 (]: Writing injected SQL for node "test.ecommerce_analytics.not_null_stg_orders_customer_id.af79d5e4b5"
[0m01:42:12.362332 [debug] [Thread-1 (]: Began executing node test.ecommerce_analytics.not_null_stg_orders_customer_id.af79d5e4b5
[0m01:42:12.370698 [debug] [Thread-1 (]: Writing runtime sql for node "test.ecommerce_analytics.not_null_stg_orders_customer_id.af79d5e4b5"
[0m01:42:12.372711 [debug] [Thread-1 (]: Using duckdb connection "test.ecommerce_analytics.not_null_stg_orders_customer_id.af79d5e4b5"
[0m01:42:12.372711 [debug] [Thread-1 (]: On test.ecommerce_analytics.not_null_stg_orders_customer_id.af79d5e4b5: BEGIN
[0m01:42:12.372711 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:42:12.372711 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m01:42:12.372711 [debug] [Thread-1 (]: Using duckdb connection "test.ecommerce_analytics.not_null_stg_orders_customer_id.af79d5e4b5"
[0m01:42:12.372711 [debug] [Thread-1 (]: On test.ecommerce_analytics.not_null_stg_orders_customer_id.af79d5e4b5: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "ecommerce_analytics", "target_name": "dev", "node_id": "test.ecommerce_analytics.not_null_stg_orders_customer_id.af79d5e4b5"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select customer_id
from "dev"."main"."stg_orders"
where customer_id is null



  
  
      
    ) dbt_internal_test
[0m01:42:12.372711 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "ecommerce_analytics", "target_name": "dev", "node_id": "test.ecommerce_analytics.not_null_stg_orders_customer_id.af79d5e4b5"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select customer_id
from "dev"."main"."stg_orders"
where customer_id is null



  
  
      
    ) dbt_internal_test
[0m01:42:12.372711 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m01:42:12.372711 [debug] [Thread-1 (]: On test.ecommerce_analytics.not_null_stg_orders_customer_id.af79d5e4b5: ROLLBACK
[0m01:42:12.372711 [debug] [Thread-1 (]: Failed to rollback 'test.ecommerce_analytics.not_null_stg_orders_customer_id.af79d5e4b5'
[0m01:42:12.372711 [debug] [Thread-1 (]: On test.ecommerce_analytics.not_null_stg_orders_customer_id.af79d5e4b5: Close
[0m01:42:12.372711 [debug] [Thread-1 (]: Runtime Error in test not_null_stg_orders_customer_id (models\example\staging\schema.yml)
  Catalog Error: Table with name stg_orders does not exist!
  Did you mean "raw_orders"?
  
  LINE 17: from "dev"."main"."stg_orders"
                ^
[0m01:42:12.383096 [error] [Thread-1 (]: 5 of 14 ERROR not_null_stg_orders_customer_id .................................. [[31mERROR[0m in 0.01s]
[0m01:42:12.384350 [debug] [Thread-1 (]: Finished running node test.ecommerce_analytics.not_null_stg_orders_customer_id.af79d5e4b5
[0m01:42:12.384350 [debug] [Thread-1 (]: Began running node test.ecommerce_analytics.not_null_stg_orders_order_id.81cfe2fe64
[0m01:42:12.384350 [debug] [Thread-4 (]: Marking all children of 'test.ecommerce_analytics.not_null_stg_orders_customer_id.af79d5e4b5' to be skipped because of status 'error'.  Reason: Runtime Error in test not_null_stg_orders_customer_id (models\example\staging\schema.yml)
  Catalog Error: Table with name stg_orders does not exist!
  Did you mean "raw_orders"?
  
  LINE 17: from "dev"."main"."stg_orders"
                ^.
[0m01:42:12.384350 [info ] [Thread-1 (]: 6 of 14 START test not_null_stg_orders_order_id ................................ [RUN]
[0m01:42:12.387623 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.ecommerce_analytics.not_null_stg_orders_customer_id.af79d5e4b5, now test.ecommerce_analytics.not_null_stg_orders_order_id.81cfe2fe64)
[0m01:42:12.387623 [debug] [Thread-1 (]: Began compiling node test.ecommerce_analytics.not_null_stg_orders_order_id.81cfe2fe64
[0m01:42:12.394673 [debug] [Thread-1 (]: Writing injected SQL for node "test.ecommerce_analytics.not_null_stg_orders_order_id.81cfe2fe64"
[0m01:42:12.394673 [debug] [Thread-1 (]: Began executing node test.ecommerce_analytics.not_null_stg_orders_order_id.81cfe2fe64
[0m01:42:12.394673 [debug] [Thread-1 (]: Writing runtime sql for node "test.ecommerce_analytics.not_null_stg_orders_order_id.81cfe2fe64"
[0m01:42:12.401264 [debug] [Thread-1 (]: Using duckdb connection "test.ecommerce_analytics.not_null_stg_orders_order_id.81cfe2fe64"
[0m01:42:12.402387 [debug] [Thread-1 (]: On test.ecommerce_analytics.not_null_stg_orders_order_id.81cfe2fe64: BEGIN
[0m01:42:12.402387 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:42:12.404354 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m01:42:12.404354 [debug] [Thread-1 (]: Using duckdb connection "test.ecommerce_analytics.not_null_stg_orders_order_id.81cfe2fe64"
[0m01:42:12.404354 [debug] [Thread-1 (]: On test.ecommerce_analytics.not_null_stg_orders_order_id.81cfe2fe64: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "ecommerce_analytics", "target_name": "dev", "node_id": "test.ecommerce_analytics.not_null_stg_orders_order_id.81cfe2fe64"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select order_id
from "dev"."main"."stg_orders"
where order_id is null



  
  
      
    ) dbt_internal_test
[0m01:42:12.406361 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "ecommerce_analytics", "target_name": "dev", "node_id": "test.ecommerce_analytics.not_null_stg_orders_order_id.81cfe2fe64"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select order_id
from "dev"."main"."stg_orders"
where order_id is null



  
  
      
    ) dbt_internal_test
[0m01:42:12.406361 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m01:42:12.406361 [debug] [Thread-1 (]: On test.ecommerce_analytics.not_null_stg_orders_order_id.81cfe2fe64: ROLLBACK
[0m01:42:12.406361 [debug] [Thread-1 (]: Failed to rollback 'test.ecommerce_analytics.not_null_stg_orders_order_id.81cfe2fe64'
[0m01:42:12.406361 [debug] [Thread-1 (]: On test.ecommerce_analytics.not_null_stg_orders_order_id.81cfe2fe64: Close
[0m01:42:12.413316 [debug] [Thread-1 (]: Runtime Error in test not_null_stg_orders_order_id (models\example\staging\schema.yml)
  Catalog Error: Table with name stg_orders does not exist!
  Did you mean "raw_orders"?
  
  LINE 17: from "dev"."main"."stg_orders"
                ^
[0m01:42:12.413316 [error] [Thread-1 (]: 6 of 14 ERROR not_null_stg_orders_order_id ..................................... [[31mERROR[0m in 0.03s]
[0m01:42:12.414321 [debug] [Thread-1 (]: Finished running node test.ecommerce_analytics.not_null_stg_orders_order_id.81cfe2fe64
[0m01:42:12.414321 [debug] [Thread-1 (]: Began running node test.ecommerce_analytics.not_null_stg_orders_total_amount.f31d98d41b
[0m01:42:12.414321 [debug] [Thread-4 (]: Marking all children of 'test.ecommerce_analytics.not_null_stg_orders_order_id.81cfe2fe64' to be skipped because of status 'error'.  Reason: Runtime Error in test not_null_stg_orders_order_id (models\example\staging\schema.yml)
  Catalog Error: Table with name stg_orders does not exist!
  Did you mean "raw_orders"?
  
  LINE 17: from "dev"."main"."stg_orders"
                ^.
[0m01:42:12.414321 [info ] [Thread-1 (]: 7 of 14 START test not_null_stg_orders_total_amount ............................ [RUN]
[0m01:42:12.414321 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.ecommerce_analytics.not_null_stg_orders_order_id.81cfe2fe64, now test.ecommerce_analytics.not_null_stg_orders_total_amount.f31d98d41b)
[0m01:42:12.414321 [debug] [Thread-1 (]: Began compiling node test.ecommerce_analytics.not_null_stg_orders_total_amount.f31d98d41b
[0m01:42:12.422434 [debug] [Thread-1 (]: Writing injected SQL for node "test.ecommerce_analytics.not_null_stg_orders_total_amount.f31d98d41b"
[0m01:42:12.424463 [debug] [Thread-1 (]: Began executing node test.ecommerce_analytics.not_null_stg_orders_total_amount.f31d98d41b
[0m01:42:12.429425 [debug] [Thread-1 (]: Writing runtime sql for node "test.ecommerce_analytics.not_null_stg_orders_total_amount.f31d98d41b"
[0m01:42:12.430534 [debug] [Thread-1 (]: Using duckdb connection "test.ecommerce_analytics.not_null_stg_orders_total_amount.f31d98d41b"
[0m01:42:12.430534 [debug] [Thread-1 (]: On test.ecommerce_analytics.not_null_stg_orders_total_amount.f31d98d41b: BEGIN
[0m01:42:12.430534 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:42:12.430534 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m01:42:12.430534 [debug] [Thread-1 (]: Using duckdb connection "test.ecommerce_analytics.not_null_stg_orders_total_amount.f31d98d41b"
[0m01:42:12.430534 [debug] [Thread-1 (]: On test.ecommerce_analytics.not_null_stg_orders_total_amount.f31d98d41b: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "ecommerce_analytics", "target_name": "dev", "node_id": "test.ecommerce_analytics.not_null_stg_orders_total_amount.f31d98d41b"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select total_amount
from "dev"."main"."stg_orders"
where total_amount is null



  
  
      
    ) dbt_internal_test
[0m01:42:12.434778 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "ecommerce_analytics", "target_name": "dev", "node_id": "test.ecommerce_analytics.not_null_stg_orders_total_amount.f31d98d41b"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select total_amount
from "dev"."main"."stg_orders"
where total_amount is null



  
  
      
    ) dbt_internal_test
[0m01:42:12.434778 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m01:42:12.434778 [debug] [Thread-1 (]: On test.ecommerce_analytics.not_null_stg_orders_total_amount.f31d98d41b: ROLLBACK
[0m01:42:12.437278 [debug] [Thread-1 (]: Failed to rollback 'test.ecommerce_analytics.not_null_stg_orders_total_amount.f31d98d41b'
[0m01:42:12.439787 [debug] [Thread-1 (]: On test.ecommerce_analytics.not_null_stg_orders_total_amount.f31d98d41b: Close
[0m01:42:12.439787 [debug] [Thread-1 (]: Runtime Error in test not_null_stg_orders_total_amount (models\example\staging\schema.yml)
  Catalog Error: Table with name stg_orders does not exist!
  Did you mean "raw_orders"?
  
  LINE 17: from "dev"."main"."stg_orders"
                ^
[0m01:42:12.439787 [error] [Thread-1 (]: 7 of 14 ERROR not_null_stg_orders_total_amount ................................. [[31mERROR[0m in 0.03s]
[0m01:42:12.439787 [debug] [Thread-1 (]: Finished running node test.ecommerce_analytics.not_null_stg_orders_total_amount.f31d98d41b
[0m01:42:12.444951 [debug] [Thread-4 (]: Marking all children of 'test.ecommerce_analytics.not_null_stg_orders_total_amount.f31d98d41b' to be skipped because of status 'error'.  Reason: Runtime Error in test not_null_stg_orders_total_amount (models\example\staging\schema.yml)
  Catalog Error: Table with name stg_orders does not exist!
  Did you mean "raw_orders"?
  
  LINE 17: from "dev"."main"."stg_orders"
                ^.
[0m01:42:12.444951 [debug] [Thread-1 (]: Began running node test.ecommerce_analytics.not_null_stg_products_price.2d147627d4
[0m01:42:12.444951 [info ] [Thread-1 (]: 8 of 14 START test not_null_stg_products_price ................................. [RUN]
[0m01:42:12.447079 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.ecommerce_analytics.not_null_stg_orders_total_amount.f31d98d41b, now test.ecommerce_analytics.not_null_stg_products_price.2d147627d4)
[0m01:42:12.447079 [debug] [Thread-1 (]: Began compiling node test.ecommerce_analytics.not_null_stg_products_price.2d147627d4
[0m01:42:12.447079 [debug] [Thread-1 (]: Writing injected SQL for node "test.ecommerce_analytics.not_null_stg_products_price.2d147627d4"
[0m01:42:12.453323 [debug] [Thread-1 (]: Began executing node test.ecommerce_analytics.not_null_stg_products_price.2d147627d4
[0m01:42:12.455959 [debug] [Thread-1 (]: Writing runtime sql for node "test.ecommerce_analytics.not_null_stg_products_price.2d147627d4"
[0m01:42:12.455959 [debug] [Thread-1 (]: Using duckdb connection "test.ecommerce_analytics.not_null_stg_products_price.2d147627d4"
[0m01:42:12.455959 [debug] [Thread-1 (]: On test.ecommerce_analytics.not_null_stg_products_price.2d147627d4: BEGIN
[0m01:42:12.455959 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:42:12.455959 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m01:42:12.461703 [debug] [Thread-1 (]: Using duckdb connection "test.ecommerce_analytics.not_null_stg_products_price.2d147627d4"
[0m01:42:12.461703 [debug] [Thread-1 (]: On test.ecommerce_analytics.not_null_stg_products_price.2d147627d4: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "ecommerce_analytics", "target_name": "dev", "node_id": "test.ecommerce_analytics.not_null_stg_products_price.2d147627d4"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select price
from "dev"."main"."stg_products"
where price is null



  
  
      
    ) dbt_internal_test
[0m01:42:12.461703 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "ecommerce_analytics", "target_name": "dev", "node_id": "test.ecommerce_analytics.not_null_stg_products_price.2d147627d4"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select price
from "dev"."main"."stg_products"
where price is null



  
  
      
    ) dbt_internal_test
[0m01:42:12.461703 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m01:42:12.461703 [debug] [Thread-1 (]: On test.ecommerce_analytics.not_null_stg_products_price.2d147627d4: ROLLBACK
[0m01:42:12.465479 [debug] [Thread-1 (]: Failed to rollback 'test.ecommerce_analytics.not_null_stg_products_price.2d147627d4'
[0m01:42:12.465479 [debug] [Thread-1 (]: On test.ecommerce_analytics.not_null_stg_products_price.2d147627d4: Close
[0m01:42:12.470036 [debug] [Thread-1 (]: Runtime Error in test not_null_stg_products_price (models\example\staging\schema.yml)
  Catalog Error: Table with name stg_products does not exist!
  Did you mean "raw_products"?
  
  LINE 17: from "dev"."main"."stg_products"
                ^
[0m01:42:12.471350 [error] [Thread-1 (]: 8 of 14 ERROR not_null_stg_products_price ...................................... [[31mERROR[0m in 0.02s]
[0m01:42:12.471350 [debug] [Thread-1 (]: Finished running node test.ecommerce_analytics.not_null_stg_products_price.2d147627d4
[0m01:42:12.471350 [debug] [Thread-1 (]: Began running node test.ecommerce_analytics.not_null_stg_products_product_id.6373b0acf3
[0m01:42:12.471350 [debug] [Thread-4 (]: Marking all children of 'test.ecommerce_analytics.not_null_stg_products_price.2d147627d4' to be skipped because of status 'error'.  Reason: Runtime Error in test not_null_stg_products_price (models\example\staging\schema.yml)
  Catalog Error: Table with name stg_products does not exist!
  Did you mean "raw_products"?
  
  LINE 17: from "dev"."main"."stg_products"
                ^.
[0m01:42:12.471350 [info ] [Thread-1 (]: 9 of 14 START test not_null_stg_products_product_id ............................ [RUN]
[0m01:42:12.475963 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.ecommerce_analytics.not_null_stg_products_price.2d147627d4, now test.ecommerce_analytics.not_null_stg_products_product_id.6373b0acf3)
[0m01:42:12.475963 [debug] [Thread-1 (]: Began compiling node test.ecommerce_analytics.not_null_stg_products_product_id.6373b0acf3
[0m01:42:12.478080 [debug] [Thread-1 (]: Writing injected SQL for node "test.ecommerce_analytics.not_null_stg_products_product_id.6373b0acf3"
[0m01:42:12.478080 [debug] [Thread-1 (]: Began executing node test.ecommerce_analytics.not_null_stg_products_product_id.6373b0acf3
[0m01:42:12.478080 [debug] [Thread-1 (]: Writing runtime sql for node "test.ecommerce_analytics.not_null_stg_products_product_id.6373b0acf3"
[0m01:42:12.486324 [debug] [Thread-1 (]: Using duckdb connection "test.ecommerce_analytics.not_null_stg_products_product_id.6373b0acf3"
[0m01:42:12.486871 [debug] [Thread-1 (]: On test.ecommerce_analytics.not_null_stg_products_product_id.6373b0acf3: BEGIN
[0m01:42:12.487956 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:42:12.488336 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m01:42:12.488336 [debug] [Thread-1 (]: Using duckdb connection "test.ecommerce_analytics.not_null_stg_products_product_id.6373b0acf3"
[0m01:42:12.488336 [debug] [Thread-1 (]: On test.ecommerce_analytics.not_null_stg_products_product_id.6373b0acf3: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "ecommerce_analytics", "target_name": "dev", "node_id": "test.ecommerce_analytics.not_null_stg_products_product_id.6373b0acf3"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select product_id
from "dev"."main"."stg_products"
where product_id is null



  
  
      
    ) dbt_internal_test
[0m01:42:12.488336 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "ecommerce_analytics", "target_name": "dev", "node_id": "test.ecommerce_analytics.not_null_stg_products_product_id.6373b0acf3"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select product_id
from "dev"."main"."stg_products"
where product_id is null



  
  
      
    ) dbt_internal_test
[0m01:42:12.488336 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m01:42:12.488336 [debug] [Thread-1 (]: On test.ecommerce_analytics.not_null_stg_products_product_id.6373b0acf3: ROLLBACK
[0m01:42:12.495507 [debug] [Thread-1 (]: Failed to rollback 'test.ecommerce_analytics.not_null_stg_products_product_id.6373b0acf3'
[0m01:42:12.496512 [debug] [Thread-1 (]: On test.ecommerce_analytics.not_null_stg_products_product_id.6373b0acf3: Close
[0m01:42:12.496512 [debug] [Thread-1 (]: Runtime Error in test not_null_stg_products_product_id (models\example\staging\schema.yml)
  Catalog Error: Table with name stg_products does not exist!
  Did you mean "raw_products"?
  
  LINE 17: from "dev"."main"."stg_products"
                ^
[0m01:42:12.496512 [error] [Thread-1 (]: 9 of 14 ERROR not_null_stg_products_product_id ................................. [[31mERROR[0m in 0.02s]
[0m01:42:12.496512 [debug] [Thread-1 (]: Finished running node test.ecommerce_analytics.not_null_stg_products_product_id.6373b0acf3
[0m01:42:12.496512 [debug] [Thread-1 (]: Began running node test.ecommerce_analytics.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500
[0m01:42:12.496512 [debug] [Thread-4 (]: Marking all children of 'test.ecommerce_analytics.not_null_stg_products_product_id.6373b0acf3' to be skipped because of status 'error'.  Reason: Runtime Error in test not_null_stg_products_product_id (models\example\staging\schema.yml)
  Catalog Error: Table with name stg_products does not exist!
  Did you mean "raw_products"?
  
  LINE 17: from "dev"."main"."stg_products"
                ^.
[0m01:42:12.496512 [info ] [Thread-1 (]: 10 of 14 START test relationships_stg_orders_customer_id__customer_id__ref_stg_customers_  [RUN]
[0m01:42:12.502246 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.ecommerce_analytics.not_null_stg_products_product_id.6373b0acf3, now test.ecommerce_analytics.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500)
[0m01:42:12.502246 [debug] [Thread-1 (]: Began compiling node test.ecommerce_analytics.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500
[0m01:42:12.508998 [debug] [Thread-1 (]: Writing injected SQL for node "test.ecommerce_analytics.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500"
[0m01:42:12.508998 [debug] [Thread-1 (]: Began executing node test.ecommerce_analytics.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500
[0m01:42:12.512195 [debug] [Thread-1 (]: Writing runtime sql for node "test.ecommerce_analytics.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500"
[0m01:42:12.512195 [debug] [Thread-1 (]: Using duckdb connection "test.ecommerce_analytics.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500"
[0m01:42:12.512195 [debug] [Thread-1 (]: On test.ecommerce_analytics.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500: BEGIN
[0m01:42:12.512195 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:42:12.517226 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m01:42:12.517226 [debug] [Thread-1 (]: Using duckdb connection "test.ecommerce_analytics.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500"
[0m01:42:12.517226 [debug] [Thread-1 (]: On test.ecommerce_analytics.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "ecommerce_analytics", "target_name": "dev", "node_id": "test.ecommerce_analytics.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with child as (
    select customer_id as from_field
    from "dev"."main"."stg_orders"
    where customer_id is not null
),

parent as (
    select customer_id as to_field
    from "dev"."main"."stg_customers"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



  
  
      
    ) dbt_internal_test
[0m01:42:12.521135 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "ecommerce_analytics", "target_name": "dev", "node_id": "test.ecommerce_analytics.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with child as (
    select customer_id as from_field
    from "dev"."main"."stg_orders"
    where customer_id is not null
),

parent as (
    select customer_id as to_field
    from "dev"."main"."stg_customers"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



  
  
      
    ) dbt_internal_test
[0m01:42:12.522286 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m01:42:12.522286 [debug] [Thread-1 (]: On test.ecommerce_analytics.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500: ROLLBACK
[0m01:42:12.522286 [debug] [Thread-1 (]: Failed to rollback 'test.ecommerce_analytics.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500'
[0m01:42:12.527783 [debug] [Thread-1 (]: On test.ecommerce_analytics.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500: Close
[0m01:42:12.529017 [debug] [Thread-1 (]: Runtime Error in test relationships_stg_orders_customer_id__customer_id__ref_stg_customers_ (models\example\staging\schema.yml)
  Catalog Error: Table with name stg_orders does not exist!
  Did you mean "raw_orders"?
  
  LINE 16:     from "dev"."main"."stg_orders"
                    ^
[0m01:42:12.529017 [error] [Thread-1 (]: 10 of 14 ERROR relationships_stg_orders_customer_id__customer_id__ref_stg_customers_  [[31mERROR[0m in 0.03s]
[0m01:42:12.529017 [debug] [Thread-1 (]: Finished running node test.ecommerce_analytics.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500
[0m01:42:12.529017 [debug] [Thread-1 (]: Began running node test.ecommerce_analytics.unique_stg_customers_customer_id.c7614daada
[0m01:42:12.529017 [debug] [Thread-4 (]: Marking all children of 'test.ecommerce_analytics.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500' to be skipped because of status 'error'.  Reason: Runtime Error in test relationships_stg_orders_customer_id__customer_id__ref_stg_customers_ (models\example\staging\schema.yml)
  Catalog Error: Table with name stg_orders does not exist!
  Did you mean "raw_orders"?
  
  LINE 16:     from "dev"."main"."stg_orders"
                    ^.
[0m01:42:12.529017 [info ] [Thread-1 (]: 11 of 14 START test unique_stg_customers_customer_id ........................... [RUN]
[0m01:42:12.529017 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.ecommerce_analytics.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500, now test.ecommerce_analytics.unique_stg_customers_customer_id.c7614daada)
[0m01:42:12.535767 [debug] [Thread-1 (]: Began compiling node test.ecommerce_analytics.unique_stg_customers_customer_id.c7614daada
[0m01:42:12.538013 [debug] [Thread-1 (]: Writing injected SQL for node "test.ecommerce_analytics.unique_stg_customers_customer_id.c7614daada"
[0m01:42:12.538013 [debug] [Thread-1 (]: Began executing node test.ecommerce_analytics.unique_stg_customers_customer_id.c7614daada
[0m01:42:12.538013 [debug] [Thread-1 (]: Writing runtime sql for node "test.ecommerce_analytics.unique_stg_customers_customer_id.c7614daada"
[0m01:42:12.548264 [debug] [Thread-1 (]: Using duckdb connection "test.ecommerce_analytics.unique_stg_customers_customer_id.c7614daada"
[0m01:42:12.548264 [debug] [Thread-1 (]: On test.ecommerce_analytics.unique_stg_customers_customer_id.c7614daada: BEGIN
[0m01:42:12.548264 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:42:12.548264 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m01:42:12.548264 [debug] [Thread-1 (]: Using duckdb connection "test.ecommerce_analytics.unique_stg_customers_customer_id.c7614daada"
[0m01:42:12.548264 [debug] [Thread-1 (]: On test.ecommerce_analytics.unique_stg_customers_customer_id.c7614daada: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "ecommerce_analytics", "target_name": "dev", "node_id": "test.ecommerce_analytics.unique_stg_customers_customer_id.c7614daada"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    customer_id as unique_field,
    count(*) as n_records

from "dev"."main"."stg_customers"
where customer_id is not null
group by customer_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m01:42:12.553746 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "ecommerce_analytics", "target_name": "dev", "node_id": "test.ecommerce_analytics.unique_stg_customers_customer_id.c7614daada"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    customer_id as unique_field,
    count(*) as n_records

from "dev"."main"."stg_customers"
where customer_id is not null
group by customer_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m01:42:12.554551 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m01:42:12.554551 [debug] [Thread-1 (]: On test.ecommerce_analytics.unique_stg_customers_customer_id.c7614daada: ROLLBACK
[0m01:42:12.558555 [debug] [Thread-1 (]: Failed to rollback 'test.ecommerce_analytics.unique_stg_customers_customer_id.c7614daada'
[0m01:42:12.558555 [debug] [Thread-1 (]: On test.ecommerce_analytics.unique_stg_customers_customer_id.c7614daada: Close
[0m01:42:12.560383 [debug] [Thread-1 (]: Runtime Error in test unique_stg_customers_customer_id (models\example\staging\schema.yml)
  Catalog Error: Table with name stg_customers does not exist!
  Did you mean "raw_customers"?
  
  LINE 18: from "dev"."main"."stg_customers"
                ^
[0m01:42:12.560383 [error] [Thread-1 (]: 11 of 14 ERROR unique_stg_customers_customer_id ................................ [[31mERROR[0m in 0.03s]
[0m01:42:12.560383 [debug] [Thread-1 (]: Finished running node test.ecommerce_analytics.unique_stg_customers_customer_id.c7614daada
[0m01:42:12.560383 [debug] [Thread-1 (]: Began running node test.ecommerce_analytics.unique_stg_customers_email.1ebcb2333e
[0m01:42:12.565080 [debug] [Thread-4 (]: Marking all children of 'test.ecommerce_analytics.unique_stg_customers_customer_id.c7614daada' to be skipped because of status 'error'.  Reason: Runtime Error in test unique_stg_customers_customer_id (models\example\staging\schema.yml)
  Catalog Error: Table with name stg_customers does not exist!
  Did you mean "raw_customers"?
  
  LINE 18: from "dev"."main"."stg_customers"
                ^.
[0m01:42:12.565080 [info ] [Thread-1 (]: 12 of 14 START test unique_stg_customers_email ................................. [RUN]
[0m01:42:12.565080 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.ecommerce_analytics.unique_stg_customers_customer_id.c7614daada, now test.ecommerce_analytics.unique_stg_customers_email.1ebcb2333e)
[0m01:42:12.565080 [debug] [Thread-1 (]: Began compiling node test.ecommerce_analytics.unique_stg_customers_email.1ebcb2333e
[0m01:42:12.571354 [debug] [Thread-1 (]: Writing injected SQL for node "test.ecommerce_analytics.unique_stg_customers_email.1ebcb2333e"
[0m01:42:12.571354 [debug] [Thread-1 (]: Began executing node test.ecommerce_analytics.unique_stg_customers_email.1ebcb2333e
[0m01:42:12.571354 [debug] [Thread-1 (]: Writing runtime sql for node "test.ecommerce_analytics.unique_stg_customers_email.1ebcb2333e"
[0m01:42:12.571354 [debug] [Thread-1 (]: Using duckdb connection "test.ecommerce_analytics.unique_stg_customers_email.1ebcb2333e"
[0m01:42:12.579241 [debug] [Thread-1 (]: On test.ecommerce_analytics.unique_stg_customers_email.1ebcb2333e: BEGIN
[0m01:42:12.579241 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:42:12.579241 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m01:42:12.579241 [debug] [Thread-1 (]: Using duckdb connection "test.ecommerce_analytics.unique_stg_customers_email.1ebcb2333e"
[0m01:42:12.579241 [debug] [Thread-1 (]: On test.ecommerce_analytics.unique_stg_customers_email.1ebcb2333e: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "ecommerce_analytics", "target_name": "dev", "node_id": "test.ecommerce_analytics.unique_stg_customers_email.1ebcb2333e"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    email as unique_field,
    count(*) as n_records

from "dev"."main"."stg_customers"
where email is not null
group by email
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m01:42:12.583370 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "ecommerce_analytics", "target_name": "dev", "node_id": "test.ecommerce_analytics.unique_stg_customers_email.1ebcb2333e"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    email as unique_field,
    count(*) as n_records

from "dev"."main"."stg_customers"
where email is not null
group by email
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m01:42:12.583370 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m01:42:12.583370 [debug] [Thread-1 (]: On test.ecommerce_analytics.unique_stg_customers_email.1ebcb2333e: ROLLBACK
[0m01:42:12.587923 [debug] [Thread-1 (]: Failed to rollback 'test.ecommerce_analytics.unique_stg_customers_email.1ebcb2333e'
[0m01:42:12.589587 [debug] [Thread-1 (]: On test.ecommerce_analytics.unique_stg_customers_email.1ebcb2333e: Close
[0m01:42:12.589587 [debug] [Thread-1 (]: Runtime Error in test unique_stg_customers_email (models\example\staging\schema.yml)
  Catalog Error: Table with name stg_customers does not exist!
  Did you mean "raw_customers"?
  
  LINE 18: from "dev"."main"."stg_customers"
                ^
[0m01:42:12.593254 [error] [Thread-1 (]: 12 of 14 ERROR unique_stg_customers_email ...................................... [[31mERROR[0m in 0.03s]
[0m01:42:12.593254 [debug] [Thread-1 (]: Finished running node test.ecommerce_analytics.unique_stg_customers_email.1ebcb2333e
[0m01:42:12.593254 [debug] [Thread-1 (]: Began running node test.ecommerce_analytics.unique_stg_orders_order_id.e3b841c71a
[0m01:42:12.593254 [debug] [Thread-4 (]: Marking all children of 'test.ecommerce_analytics.unique_stg_customers_email.1ebcb2333e' to be skipped because of status 'error'.  Reason: Runtime Error in test unique_stg_customers_email (models\example\staging\schema.yml)
  Catalog Error: Table with name stg_customers does not exist!
  Did you mean "raw_customers"?
  
  LINE 18: from "dev"."main"."stg_customers"
                ^.
[0m01:42:12.593254 [info ] [Thread-1 (]: 13 of 14 START test unique_stg_orders_order_id ................................. [RUN]
[0m01:42:12.593254 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.ecommerce_analytics.unique_stg_customers_email.1ebcb2333e, now test.ecommerce_analytics.unique_stg_orders_order_id.e3b841c71a)
[0m01:42:12.593254 [debug] [Thread-1 (]: Began compiling node test.ecommerce_analytics.unique_stg_orders_order_id.e3b841c71a
[0m01:42:12.604447 [debug] [Thread-1 (]: Writing injected SQL for node "test.ecommerce_analytics.unique_stg_orders_order_id.e3b841c71a"
[0m01:42:12.604447 [debug] [Thread-1 (]: Began executing node test.ecommerce_analytics.unique_stg_orders_order_id.e3b841c71a
[0m01:42:12.609727 [debug] [Thread-1 (]: Writing runtime sql for node "test.ecommerce_analytics.unique_stg_orders_order_id.e3b841c71a"
[0m01:42:12.610318 [debug] [Thread-1 (]: Using duckdb connection "test.ecommerce_analytics.unique_stg_orders_order_id.e3b841c71a"
[0m01:42:12.610318 [debug] [Thread-1 (]: On test.ecommerce_analytics.unique_stg_orders_order_id.e3b841c71a: BEGIN
[0m01:42:12.612412 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:42:12.612412 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m01:42:12.612412 [debug] [Thread-1 (]: Using duckdb connection "test.ecommerce_analytics.unique_stg_orders_order_id.e3b841c71a"
[0m01:42:12.612412 [debug] [Thread-1 (]: On test.ecommerce_analytics.unique_stg_orders_order_id.e3b841c71a: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "ecommerce_analytics", "target_name": "dev", "node_id": "test.ecommerce_analytics.unique_stg_orders_order_id.e3b841c71a"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    order_id as unique_field,
    count(*) as n_records

from "dev"."main"."stg_orders"
where order_id is not null
group by order_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m01:42:12.612412 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "ecommerce_analytics", "target_name": "dev", "node_id": "test.ecommerce_analytics.unique_stg_orders_order_id.e3b841c71a"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    order_id as unique_field,
    count(*) as n_records

from "dev"."main"."stg_orders"
where order_id is not null
group by order_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m01:42:12.612412 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m01:42:12.612412 [debug] [Thread-1 (]: On test.ecommerce_analytics.unique_stg_orders_order_id.e3b841c71a: ROLLBACK
[0m01:42:12.612412 [debug] [Thread-1 (]: Failed to rollback 'test.ecommerce_analytics.unique_stg_orders_order_id.e3b841c71a'
[0m01:42:12.619002 [debug] [Thread-1 (]: On test.ecommerce_analytics.unique_stg_orders_order_id.e3b841c71a: Close
[0m01:42:12.620693 [debug] [Thread-1 (]: Runtime Error in test unique_stg_orders_order_id (models\example\staging\schema.yml)
  Catalog Error: Table with name stg_orders does not exist!
  Did you mean "raw_orders"?
  
  LINE 18: from "dev"."main"."stg_orders"
                ^
[0m01:42:12.620693 [error] [Thread-1 (]: 13 of 14 ERROR unique_stg_orders_order_id ...................................... [[31mERROR[0m in 0.03s]
[0m01:42:12.620693 [debug] [Thread-1 (]: Finished running node test.ecommerce_analytics.unique_stg_orders_order_id.e3b841c71a
[0m01:42:12.620693 [debug] [Thread-1 (]: Began running node test.ecommerce_analytics.unique_stg_products_product_id.7d950a1467
[0m01:42:12.620693 [debug] [Thread-4 (]: Marking all children of 'test.ecommerce_analytics.unique_stg_orders_order_id.e3b841c71a' to be skipped because of status 'error'.  Reason: Runtime Error in test unique_stg_orders_order_id (models\example\staging\schema.yml)
  Catalog Error: Table with name stg_orders does not exist!
  Did you mean "raw_orders"?
  
  LINE 18: from "dev"."main"."stg_orders"
                ^.
[0m01:42:12.620693 [info ] [Thread-1 (]: 14 of 14 START test unique_stg_products_product_id ............................. [RUN]
[0m01:42:12.627102 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.ecommerce_analytics.unique_stg_orders_order_id.e3b841c71a, now test.ecommerce_analytics.unique_stg_products_product_id.7d950a1467)
[0m01:42:12.627102 [debug] [Thread-1 (]: Began compiling node test.ecommerce_analytics.unique_stg_products_product_id.7d950a1467
[0m01:42:12.631323 [debug] [Thread-1 (]: Writing injected SQL for node "test.ecommerce_analytics.unique_stg_products_product_id.7d950a1467"
[0m01:42:12.631323 [debug] [Thread-1 (]: Began executing node test.ecommerce_analytics.unique_stg_products_product_id.7d950a1467
[0m01:42:12.635860 [debug] [Thread-1 (]: Writing runtime sql for node "test.ecommerce_analytics.unique_stg_products_product_id.7d950a1467"
[0m01:42:12.638229 [debug] [Thread-1 (]: Using duckdb connection "test.ecommerce_analytics.unique_stg_products_product_id.7d950a1467"
[0m01:42:12.638229 [debug] [Thread-1 (]: On test.ecommerce_analytics.unique_stg_products_product_id.7d950a1467: BEGIN
[0m01:42:12.638229 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:42:12.641704 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m01:42:12.641704 [debug] [Thread-1 (]: Using duckdb connection "test.ecommerce_analytics.unique_stg_products_product_id.7d950a1467"
[0m01:42:12.641704 [debug] [Thread-1 (]: On test.ecommerce_analytics.unique_stg_products_product_id.7d950a1467: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "ecommerce_analytics", "target_name": "dev", "node_id": "test.ecommerce_analytics.unique_stg_products_product_id.7d950a1467"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    product_id as unique_field,
    count(*) as n_records

from "dev"."main"."stg_products"
where product_id is not null
group by product_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m01:42:12.641704 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "ecommerce_analytics", "target_name": "dev", "node_id": "test.ecommerce_analytics.unique_stg_products_product_id.7d950a1467"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    product_id as unique_field,
    count(*) as n_records

from "dev"."main"."stg_products"
where product_id is not null
group by product_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m01:42:12.644368 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m01:42:12.644368 [debug] [Thread-1 (]: On test.ecommerce_analytics.unique_stg_products_product_id.7d950a1467: ROLLBACK
[0m01:42:12.644368 [debug] [Thread-1 (]: Failed to rollback 'test.ecommerce_analytics.unique_stg_products_product_id.7d950a1467'
[0m01:42:12.644368 [debug] [Thread-1 (]: On test.ecommerce_analytics.unique_stg_products_product_id.7d950a1467: Close
[0m01:42:12.644368 [debug] [Thread-1 (]: Runtime Error in test unique_stg_products_product_id (models\example\staging\schema.yml)
  Catalog Error: Table with name stg_products does not exist!
  Did you mean "raw_products"?
  
  LINE 18: from "dev"."main"."stg_products"
                ^
[0m01:42:12.644368 [error] [Thread-1 (]: 14 of 14 ERROR unique_stg_products_product_id .................................. [[31mERROR[0m in 0.02s]
[0m01:42:12.652094 [debug] [Thread-1 (]: Finished running node test.ecommerce_analytics.unique_stg_products_product_id.7d950a1467
[0m01:42:12.652094 [debug] [Thread-4 (]: Marking all children of 'test.ecommerce_analytics.unique_stg_products_product_id.7d950a1467' to be skipped because of status 'error'.  Reason: Runtime Error in test unique_stg_products_product_id (models\example\staging\schema.yml)
  Catalog Error: Table with name stg_products does not exist!
  Did you mean "raw_products"?
  
  LINE 18: from "dev"."main"."stg_products"
                ^.
[0m01:42:12.656615 [debug] [MainThread]: Using duckdb connection "master"
[0m01:42:12.656615 [debug] [MainThread]: On master: BEGIN
[0m01:42:12.656615 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m01:42:12.656615 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m01:42:12.656615 [debug] [MainThread]: On master: COMMIT
[0m01:42:12.660233 [debug] [MainThread]: Using duckdb connection "master"
[0m01:42:12.660233 [debug] [MainThread]: On master: COMMIT
[0m01:42:12.660233 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m01:42:12.660233 [debug] [MainThread]: On master: Close
[0m01:42:12.662800 [debug] [MainThread]: Connection 'master' was properly closed.
[0m01:42:12.662800 [debug] [MainThread]: Connection 'list_dev_main' was properly closed.
[0m01:42:12.662800 [debug] [MainThread]: Connection 'test.ecommerce_analytics.unique_stg_products_product_id.7d950a1467' was properly closed.
[0m01:42:12.662800 [info ] [MainThread]: 
[0m01:42:12.662800 [info ] [MainThread]: Finished running 14 data tests in 0 hours 0 minutes and 0.63 seconds (0.63s).
[0m01:42:12.668063 [debug] [MainThread]: Command end result
[0m01:42:12.704955 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\Lenovo\Desktop\Proyectos\dbt-proyect\ecommerce_analytics\target\manifest.json
[0m01:42:12.704955 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\Lenovo\Desktop\Proyectos\dbt-proyect\ecommerce_analytics\target\semantic_manifest.json
[0m01:42:12.719017 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\Lenovo\Desktop\Proyectos\dbt-proyect\ecommerce_analytics\target\run_results.json
[0m01:42:12.719017 [info ] [MainThread]: 
[0m01:42:12.719017 [info ] [MainThread]: [31mCompleted with 14 errors, 0 partial successes, and 0 warnings:[0m
[0m01:42:12.719017 [info ] [MainThread]: 
[0m01:42:12.723077 [error] [MainThread]: [31mFailure in test dbt_utils_accepted_range_stg_orders_total_amount__0 (models\example\staging\schema.yml)[0m
[0m01:42:12.723077 [error] [MainThread]:   Compilation Error in test dbt_utils_accepted_range_stg_orders_total_amount__0 (models\example\staging\schema.yml)
  'dbt_utils' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m01:42:12.725252 [info ] [MainThread]: 
[0m01:42:12.725252 [error] [MainThread]: [31mFailure in test dbt_utils_accepted_range_stg_products_price__0 (models\example\staging\schema.yml)[0m
[0m01:42:12.725252 [error] [MainThread]:   Compilation Error in test dbt_utils_accepted_range_stg_products_price__0 (models\example\staging\schema.yml)
  'dbt_utils' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m01:42:12.725252 [info ] [MainThread]: 
[0m01:42:12.725252 [error] [MainThread]: [31mFailure in test not_null_stg_customers_customer_id (models\example\staging\schema.yml)[0m
[0m01:42:12.725252 [error] [MainThread]:   Runtime Error in test not_null_stg_customers_customer_id (models\example\staging\schema.yml)
  Catalog Error: Table with name stg_customers does not exist!
  Did you mean "raw_customers"?
  
  LINE 17: from "dev"."main"."stg_customers"
                ^
[0m01:42:12.731503 [info ] [MainThread]: 
[0m01:42:12.731503 [info ] [MainThread]:   compiled code at target\compiled\ecommerce_analytics\models\example\staging\schema.yml\not_null_stg_customers_customer_id.sql
[0m01:42:12.733096 [info ] [MainThread]: 
[0m01:42:12.734686 [error] [MainThread]: [31mFailure in test not_null_stg_customers_email (models\example\staging\schema.yml)[0m
[0m01:42:12.735692 [error] [MainThread]:   Runtime Error in test not_null_stg_customers_email (models\example\staging\schema.yml)
  Catalog Error: Table with name stg_customers does not exist!
  Did you mean "raw_customers"?
  
  LINE 17: from "dev"."main"."stg_customers"
                ^
[0m01:42:12.735692 [info ] [MainThread]: 
[0m01:42:12.737867 [info ] [MainThread]:   compiled code at target\compiled\ecommerce_analytics\models\example\staging\schema.yml\not_null_stg_customers_email.sql
[0m01:42:12.737867 [info ] [MainThread]: 
[0m01:42:12.739691 [error] [MainThread]: [31mFailure in test not_null_stg_orders_customer_id (models\example\staging\schema.yml)[0m
[0m01:42:12.741392 [error] [MainThread]:   Runtime Error in test not_null_stg_orders_customer_id (models\example\staging\schema.yml)
  Catalog Error: Table with name stg_orders does not exist!
  Did you mean "raw_orders"?
  
  LINE 17: from "dev"."main"."stg_orders"
                ^
[0m01:42:12.741392 [info ] [MainThread]: 
[0m01:42:12.741392 [info ] [MainThread]:   compiled code at target\compiled\ecommerce_analytics\models\example\staging\schema.yml\not_null_stg_orders_customer_id.sql
[0m01:42:12.741392 [info ] [MainThread]: 
[0m01:42:12.746499 [error] [MainThread]: [31mFailure in test not_null_stg_orders_order_id (models\example\staging\schema.yml)[0m
[0m01:42:12.747947 [error] [MainThread]:   Runtime Error in test not_null_stg_orders_order_id (models\example\staging\schema.yml)
  Catalog Error: Table with name stg_orders does not exist!
  Did you mean "raw_orders"?
  
  LINE 17: from "dev"."main"."stg_orders"
                ^
[0m01:42:12.747947 [info ] [MainThread]: 
[0m01:42:12.747947 [info ] [MainThread]:   compiled code at target\compiled\ecommerce_analytics\models\example\staging\schema.yml\not_null_stg_orders_order_id.sql
[0m01:42:12.747947 [info ] [MainThread]: 
[0m01:42:12.747947 [error] [MainThread]: [31mFailure in test not_null_stg_orders_total_amount (models\example\staging\schema.yml)[0m
[0m01:42:12.753151 [error] [MainThread]:   Runtime Error in test not_null_stg_orders_total_amount (models\example\staging\schema.yml)
  Catalog Error: Table with name stg_orders does not exist!
  Did you mean "raw_orders"?
  
  LINE 17: from "dev"."main"."stg_orders"
                ^
[0m01:42:12.755072 [info ] [MainThread]: 
[0m01:42:12.756079 [info ] [MainThread]:   compiled code at target\compiled\ecommerce_analytics\models\example\staging\schema.yml\not_null_stg_orders_total_amount.sql
[0m01:42:12.756079 [info ] [MainThread]: 
[0m01:42:12.759196 [error] [MainThread]: [31mFailure in test not_null_stg_products_price (models\example\staging\schema.yml)[0m
[0m01:42:12.759196 [error] [MainThread]:   Runtime Error in test not_null_stg_products_price (models\example\staging\schema.yml)
  Catalog Error: Table with name stg_products does not exist!
  Did you mean "raw_products"?
  
  LINE 17: from "dev"."main"."stg_products"
                ^
[0m01:42:12.759196 [info ] [MainThread]: 
[0m01:42:12.759196 [info ] [MainThread]:   compiled code at target\compiled\ecommerce_analytics\models\example\staging\schema.yml\not_null_stg_products_price.sql
[0m01:42:12.759196 [info ] [MainThread]: 
[0m01:42:12.759196 [error] [MainThread]: [31mFailure in test not_null_stg_products_product_id (models\example\staging\schema.yml)[0m
[0m01:42:12.759196 [error] [MainThread]:   Runtime Error in test not_null_stg_products_product_id (models\example\staging\schema.yml)
  Catalog Error: Table with name stg_products does not exist!
  Did you mean "raw_products"?
  
  LINE 17: from "dev"."main"."stg_products"
                ^
[0m01:42:12.766339 [info ] [MainThread]: 
[0m01:42:12.766339 [info ] [MainThread]:   compiled code at target\compiled\ecommerce_analytics\models\example\staging\schema.yml\not_null_stg_products_product_id.sql
[0m01:42:12.766339 [info ] [MainThread]: 
[0m01:42:12.766339 [error] [MainThread]: [31mFailure in test relationships_stg_orders_customer_id__customer_id__ref_stg_customers_ (models\example\staging\schema.yml)[0m
[0m01:42:12.770751 [error] [MainThread]:   Runtime Error in test relationships_stg_orders_customer_id__customer_id__ref_stg_customers_ (models\example\staging\schema.yml)
  Catalog Error: Table with name stg_orders does not exist!
  Did you mean "raw_orders"?
  
  LINE 16:     from "dev"."main"."stg_orders"
                    ^
[0m01:42:12.770751 [info ] [MainThread]: 
[0m01:42:12.770751 [info ] [MainThread]:   compiled code at target\compiled\ecommerce_analytics\models\example\staging\schema.yml\relationships_stg_orders_96411fe0c89b49c3f4da955dfd358ba0.sql
[0m01:42:12.770751 [info ] [MainThread]: 
[0m01:42:12.770751 [error] [MainThread]: [31mFailure in test unique_stg_customers_customer_id (models\example\staging\schema.yml)[0m
[0m01:42:12.776709 [error] [MainThread]:   Runtime Error in test unique_stg_customers_customer_id (models\example\staging\schema.yml)
  Catalog Error: Table with name stg_customers does not exist!
  Did you mean "raw_customers"?
  
  LINE 18: from "dev"."main"."stg_customers"
                ^
[0m01:42:12.777458 [info ] [MainThread]: 
[0m01:42:12.777458 [info ] [MainThread]:   compiled code at target\compiled\ecommerce_analytics\models\example\staging\schema.yml\unique_stg_customers_customer_id.sql
[0m01:42:12.777458 [info ] [MainThread]: 
[0m01:42:12.777458 [error] [MainThread]: [31mFailure in test unique_stg_customers_email (models\example\staging\schema.yml)[0m
[0m01:42:12.777458 [error] [MainThread]:   Runtime Error in test unique_stg_customers_email (models\example\staging\schema.yml)
  Catalog Error: Table with name stg_customers does not exist!
  Did you mean "raw_customers"?
  
  LINE 18: from "dev"."main"."stg_customers"
                ^
[0m01:42:12.782301 [info ] [MainThread]: 
[0m01:42:12.783537 [info ] [MainThread]:   compiled code at target\compiled\ecommerce_analytics\models\example\staging\schema.yml\unique_stg_customers_email.sql
[0m01:42:12.783537 [info ] [MainThread]: 
[0m01:42:12.783537 [error] [MainThread]: [31mFailure in test unique_stg_orders_order_id (models\example\staging\schema.yml)[0m
[0m01:42:12.785554 [error] [MainThread]:   Runtime Error in test unique_stg_orders_order_id (models\example\staging\schema.yml)
  Catalog Error: Table with name stg_orders does not exist!
  Did you mean "raw_orders"?
  
  LINE 18: from "dev"."main"."stg_orders"
                ^
[0m01:42:12.787061 [info ] [MainThread]: 
[0m01:42:12.788295 [info ] [MainThread]:   compiled code at target\compiled\ecommerce_analytics\models\example\staging\schema.yml\unique_stg_orders_order_id.sql
[0m01:42:12.790743 [info ] [MainThread]: 
[0m01:42:12.790743 [error] [MainThread]: [31mFailure in test unique_stg_products_product_id (models\example\staging\schema.yml)[0m
[0m01:42:12.790743 [error] [MainThread]:   Runtime Error in test unique_stg_products_product_id (models\example\staging\schema.yml)
  Catalog Error: Table with name stg_products does not exist!
  Did you mean "raw_products"?
  
  LINE 18: from "dev"."main"."stg_products"
                ^
[0m01:42:12.790743 [info ] [MainThread]: 
[0m01:42:12.793655 [info ] [MainThread]:   compiled code at target\compiled\ecommerce_analytics\models\example\staging\schema.yml\unique_stg_products_product_id.sql
[0m01:42:12.793655 [info ] [MainThread]: 
[0m01:42:12.793655 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=14 SKIP=0 NO-OP=0 TOTAL=14
[0m01:42:12.793655 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- MissingArgumentsPropertyInGenericTestDeprecation: 3 occurrences
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m01:42:12.796330 [debug] [MainThread]: Command `dbt test` failed at 01:42:12.796330 after 2.70 seconds
[0m01:42:12.797773 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016752145010>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016758DF7A10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016758DF7F10>]}
[0m01:42:12.797773 [debug] [MainThread]: Flushing usage events
[0m01:42:13.920174 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m01:43:43.700898 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002DEC8F8D290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002DEC8FBB510>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002DEC8FBBA50>]}


============================== 01:43:43.711453 | ca068ddb-66ae-4794-80af-44c31ac629da ==============================
[0m01:43:43.711453 [info ] [MainThread]: Running with dbt=1.11.2
[0m01:43:43.711453 [debug] [MainThread]: running dbt with arguments {'static_parser': 'True', 'no_print': 'None', 'version_check': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'target_path': 'None', 'printer_width': '80', 'write_json': 'True', 'empty': 'None', 'log_cache_events': 'False', 'introspect': 'True', 'cache_selected_only': 'False', 'fail_fast': 'False', 'debug': 'False', 'log_format': 'default', 'partial_parse': 'True', 'send_anonymous_usage_stats': 'True', 'quiet': 'False', 'warn_error': 'None', 'profiles_dir': 'C:\\Users\\Lenovo\\.dbt', 'use_colors': 'True', 'invocation_command': 'dbt deps', 'indirect_selection': 'eager', 'use_experimental_parser': 'False', 'log_path': 'C:\\Users\\Lenovo\\Desktop\\Proyectos\\dbt-proyect\\ecommerce_analytics\\logs'}
[0m01:43:43.846877 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ca068ddb-66ae-4794-80af-44c31ac629da', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002DECA0D1510>]}
[0m01:43:43.891846 [debug] [MainThread]: Set downloads directory='C:\Users\Lenovo\AppData\Local\Temp\dbt-downloads-74n16ist'
[0m01:43:43.891846 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m01:43:44.507059 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m01:43:44.512615 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m01:43:44.827109 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m01:43:44.847770 [info ] [MainThread]: Updating lock file in file path: C:\Users\Lenovo\Desktop\Proyectos\dbt-proyect\ecommerce_analytics/package-lock.yml
[0m01:43:44.879079 [debug] [MainThread]: Set downloads directory='C:\Users\Lenovo\AppData\Local\Temp\dbt-downloads-n2u4m0g1'
[0m01:43:44.879079 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m01:43:46.173206 [info ] [MainThread]: Installed from version 1.3.0
[0m01:43:46.173206 [info ] [MainThread]: Updated version available: 1.3.3
[0m01:43:46.176923 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': 'ca068ddb-66ae-4794-80af-44c31ac629da', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002DEC5B860D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002DECA12BC50>]}
[0m01:43:46.176923 [info ] [MainThread]: 
[0m01:43:46.176923 [info ] [MainThread]: Updates available for packages: ['dbt-labs/dbt_utils']                 
Update your versions in packages.yml, then run dbt deps
[0m01:43:46.181061 [debug] [MainThread]: Command `dbt deps` succeeded at 01:43:46.179054 after 2.61 seconds
[0m01:43:46.181670 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002DEC8F87AD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002DEC8F87D50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002DEC8F87C50>]}
[0m01:43:46.182264 [debug] [MainThread]: Flushing usage events
[0m01:43:47.413295 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m01:43:56.788671 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C7A3B8C4D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C7A3BF2450>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C7A3BF0C50>]}


============================== 01:43:56.788671 | b5657af7-40bc-4130-88b7-7743435d9f89 ==============================
[0m01:43:56.788671 [info ] [MainThread]: Running with dbt=1.11.2
[0m01:43:56.794949 [debug] [MainThread]: running dbt with arguments {'version_check': 'True', 'no_print': 'None', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'target_path': 'None', 'printer_width': '80', 'write_json': 'True', 'introspect': 'True', 'log_cache_events': 'False', 'empty': 'False', 'cache_selected_only': 'False', 'log_format': 'default', 'debug': 'False', 'fail_fast': 'False', 'partial_parse': 'True', 'send_anonymous_usage_stats': 'True', 'quiet': 'False', 'warn_error': 'None', 'profiles_dir': 'C:\\Users\\Lenovo\\.dbt', 'indirect_selection': 'eager', 'invocation_command': 'dbt run', 'use_colors': 'True', 'use_experimental_parser': 'False', 'log_path': 'C:\\Users\\Lenovo\\Desktop\\Proyectos\\dbt-proyect\\ecommerce_analytics\\logs'}
[0m01:43:57.039421 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b5657af7-40bc-4130-88b7-7743435d9f89', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C7A3C658D0>]}
[0m01:43:57.110278 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b5657af7-40bc-4130-88b7-7743435d9f89', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C7A0514210>]}
[0m01:43:57.110278 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m01:43:57.387720 [debug] [MainThread]: checksum: 3d40d8bbe1bef07db1c24822f2dbfff8bc07f2a48ed4fe2658a40653aec0b54b, vars: {}, profile: , target: , version: 1.11.2
[0m01:43:57.541777 [info ] [MainThread]: Unable to do partial parsing because a project dependency has been added
[0m01:43:57.541777 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'b5657af7-40bc-4130-88b7-7743435d9f89', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C7A2B92DD0>]}
[0m01:44:00.702537 [warn ] [MainThread]: [[33mWARNING[0m][MissingArgumentsPropertyInGenericTestDeprecation]: Deprecated
functionality
Found top-level arguments to test `relationships` defined on 'stg_orders' in
package 'ecommerce_analytics' (models\example\staging\schema.yml). Arguments to
generic tests should be nested under the `arguments` property.
[0m01:44:00.702537 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'b5657af7-40bc-4130-88b7-7743435d9f89', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C7A53E7D10>]}
[0m01:44:00.901293 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b5657af7-40bc-4130-88b7-7743435d9f89', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C7A53BE9D0>]}
[0m01:44:01.017081 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\Lenovo\Desktop\Proyectos\dbt-proyect\ecommerce_analytics\target\manifest.json
[0m01:44:01.017081 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\Lenovo\Desktop\Proyectos\dbt-proyect\ecommerce_analytics\target\semantic_manifest.json
[0m01:44:01.123148 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b5657af7-40bc-4130-88b7-7743435d9f89', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C7A546EE10>]}
[0m01:44:01.123148 [info ] [MainThread]: Found 7 models, 3 seeds, 14 data tests, 587 macros
[0m01:44:01.123148 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b5657af7-40bc-4130-88b7-7743435d9f89', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C7A54F9F10>]}
[0m01:44:01.129257 [info ] [MainThread]: 
[0m01:44:01.129257 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m01:44:01.129257 [info ] [MainThread]: 
[0m01:44:01.131300 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m01:44:01.137741 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_dev'
[0m01:44:01.229609 [debug] [ThreadPool]: Using duckdb connection "list_dev"
[0m01:44:01.229609 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "ecommerce_analytics", "target_name": "dev", "connection_name": "list_dev"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"dev"'
    
  
  
[0m01:44:01.232984 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:44:01.263383 [debug] [ThreadPool]: SQL status: OK in 0.032 seconds
[0m01:44:01.263383 [debug] [ThreadPool]: On list_dev: Close
[0m01:44:01.263383 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev, now create_dev_main)
[0m01:44:01.263383 [debug] [ThreadPool]: Creating schema "database: "dev"
schema: "main"
"
[0m01:44:01.277579 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m01:44:01.277579 [debug] [ThreadPool]: On create_dev_main: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "ecommerce_analytics", "target_name": "dev", "connection_name": "create_dev_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='dev'
        and type='sqlite'
    
  
[0m01:44:01.277579 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m01:44:01.282433 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m01:44:01.284676 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m01:44:01.285835 [debug] [ThreadPool]: On create_dev_main: BEGIN
[0m01:44:01.285835 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m01:44:01.285835 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m01:44:01.285835 [debug] [ThreadPool]: On create_dev_main: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "ecommerce_analytics", "target_name": "dev", "connection_name": "create_dev_main"} */

    
    
        create schema if not exists "dev"."main"
    
[0m01:44:01.289733 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m01:44:01.289733 [debug] [ThreadPool]: On create_dev_main: COMMIT
[0m01:44:01.291809 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m01:44:01.291809 [debug] [ThreadPool]: On create_dev_main: COMMIT
[0m01:44:01.291809 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m01:44:01.291809 [debug] [ThreadPool]: On create_dev_main: Close
[0m01:44:01.295320 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_dev_main'
[0m01:44:01.301458 [debug] [ThreadPool]: Using duckdb connection "list_dev_main"
[0m01:44:01.301458 [debug] [ThreadPool]: On list_dev_main: BEGIN
[0m01:44:01.301458 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:44:01.303476 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m01:44:01.303476 [debug] [ThreadPool]: Using duckdb connection "list_dev_main"
[0m01:44:01.303476 [debug] [ThreadPool]: On list_dev_main: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "ecommerce_analytics", "target_name": "dev", "connection_name": "list_dev_main"} */
select
      'dev' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'dev'
  
[0m01:44:01.321581 [debug] [ThreadPool]: SQL status: OK in 0.018 seconds
[0m01:44:01.321581 [debug] [ThreadPool]: On list_dev_main: ROLLBACK
[0m01:44:01.326380 [debug] [ThreadPool]: Failed to rollback 'list_dev_main'
[0m01:44:01.326380 [debug] [ThreadPool]: On list_dev_main: Close
[0m01:44:01.326380 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b5657af7-40bc-4130-88b7-7743435d9f89', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C7A55A23D0>]}
[0m01:44:01.326380 [debug] [MainThread]: Using duckdb connection "master"
[0m01:44:01.326380 [debug] [MainThread]: On master: BEGIN
[0m01:44:01.326380 [debug] [MainThread]: Opening a new connection, currently in state init
[0m01:44:01.326380 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m01:44:01.326380 [debug] [MainThread]: On master: COMMIT
[0m01:44:01.331302 [debug] [MainThread]: Using duckdb connection "master"
[0m01:44:01.331302 [debug] [MainThread]: On master: COMMIT
[0m01:44:01.332141 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m01:44:01.332939 [debug] [MainThread]: On master: Close
[0m01:44:01.336624 [debug] [Thread-1 (]: Began running node model.ecommerce_analytics.stg_customers
[0m01:44:01.336624 [info ] [Thread-1 (]: 1 of 6 START sql view model main.stg_customers ................................. [RUN]
[0m01:44:01.336624 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.ecommerce_analytics.stg_customers'
[0m01:44:01.336624 [debug] [Thread-1 (]: Began compiling node model.ecommerce_analytics.stg_customers
[0m01:44:01.347566 [debug] [Thread-1 (]: Writing injected SQL for node "model.ecommerce_analytics.stg_customers"
[0m01:44:01.350752 [debug] [Thread-1 (]: Began executing node model.ecommerce_analytics.stg_customers
[0m01:44:01.388738 [debug] [Thread-1 (]: Writing runtime sql for node "model.ecommerce_analytics.stg_customers"
[0m01:44:01.389836 [debug] [Thread-1 (]: Using duckdb connection "model.ecommerce_analytics.stg_customers"
[0m01:44:01.389836 [debug] [Thread-1 (]: On model.ecommerce_analytics.stg_customers: BEGIN
[0m01:44:01.389836 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m01:44:01.389836 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m01:44:01.393834 [debug] [Thread-1 (]: Using duckdb connection "model.ecommerce_analytics.stg_customers"
[0m01:44:01.393834 [debug] [Thread-1 (]: On model.ecommerce_analytics.stg_customers: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "ecommerce_analytics", "target_name": "dev", "node_id": "model.ecommerce_analytics.stg_customers"} */

  
  create view "dev"."main"."stg_customers__dbt_tmp" as (
    WITH source AS (
    SELECT * FROM "dev"."main"."raw_customers"
),

renamed AS (
    SELECT
        customer_id,
        first_name || ' ' || last_name AS customer_name,
        email AS customer_email,
        phone,
        CAST(birth_date AS DATE) AS birth_date,
        city AS customer_city,
        country,
        postal_code,
        segment,
        CAST(registration_date AS DATE) AS registration_date,
        CAST(last_login AS DATE) AS last_login,
        is_verified,
        accepts_marketing
    FROM source
)

SELECT * FROM renamed
  );

[0m01:44:01.409555 [debug] [Thread-1 (]: SQL status: OK in 0.015 seconds
[0m01:44:01.416241 [debug] [Thread-1 (]: Using duckdb connection "model.ecommerce_analytics.stg_customers"
[0m01:44:01.416241 [debug] [Thread-1 (]: On model.ecommerce_analytics.stg_customers: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "ecommerce_analytics", "target_name": "dev", "node_id": "model.ecommerce_analytics.stg_customers"} */
alter view "dev"."main"."stg_customers__dbt_tmp" rename to "stg_customers"
[0m01:44:01.419270 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m01:44:01.421947 [debug] [Thread-1 (]: On model.ecommerce_analytics.stg_customers: COMMIT
[0m01:44:01.429292 [debug] [Thread-1 (]: Using duckdb connection "model.ecommerce_analytics.stg_customers"
[0m01:44:01.429876 [debug] [Thread-1 (]: On model.ecommerce_analytics.stg_customers: COMMIT
[0m01:44:01.433233 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m01:44:01.439675 [debug] [Thread-1 (]: Using duckdb connection "model.ecommerce_analytics.stg_customers"
[0m01:44:01.439675 [debug] [Thread-1 (]: On model.ecommerce_analytics.stg_customers: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "ecommerce_analytics", "target_name": "dev", "node_id": "model.ecommerce_analytics.stg_customers"} */

      drop view if exists "dev"."main"."stg_customers__dbt_backup" cascade
    
[0m01:44:01.439675 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m01:44:01.446185 [debug] [Thread-1 (]: On model.ecommerce_analytics.stg_customers: Close
[0m01:44:01.450268 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b5657af7-40bc-4130-88b7-7743435d9f89', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C7A5901E10>]}
[0m01:44:01.450268 [info ] [Thread-1 (]: 1 of 6 OK created sql view model main.stg_customers ............................ [[32mOK[0m in 0.11s]
[0m01:44:01.452240 [debug] [Thread-1 (]: Finished running node model.ecommerce_analytics.stg_customers
[0m01:44:01.452240 [debug] [Thread-1 (]: Began running node model.ecommerce_analytics.stg_orders
[0m01:44:01.453997 [info ] [Thread-1 (]: 2 of 6 START sql view model main.stg_orders .................................... [RUN]
[0m01:44:01.453997 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ecommerce_analytics.stg_customers, now model.ecommerce_analytics.stg_orders)
[0m01:44:01.453997 [debug] [Thread-1 (]: Began compiling node model.ecommerce_analytics.stg_orders
[0m01:44:01.453997 [debug] [Thread-1 (]: Writing injected SQL for node "model.ecommerce_analytics.stg_orders"
[0m01:44:01.460116 [debug] [Thread-1 (]: Began executing node model.ecommerce_analytics.stg_orders
[0m01:44:01.462548 [debug] [Thread-1 (]: Writing runtime sql for node "model.ecommerce_analytics.stg_orders"
[0m01:44:01.462548 [debug] [Thread-1 (]: Using duckdb connection "model.ecommerce_analytics.stg_orders"
[0m01:44:01.462548 [debug] [Thread-1 (]: On model.ecommerce_analytics.stg_orders: BEGIN
[0m01:44:01.466796 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:44:01.466796 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m01:44:01.469236 [debug] [Thread-1 (]: Using duckdb connection "model.ecommerce_analytics.stg_orders"
[0m01:44:01.470744 [debug] [Thread-1 (]: On model.ecommerce_analytics.stg_orders: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "ecommerce_analytics", "target_name": "dev", "node_id": "model.ecommerce_analytics.stg_orders"} */

  
  create view "dev"."main"."stg_orders__dbt_tmp" as (
    WITH source AS (
    SELECT * FROM "dev"."main"."raw_orders"
),

renamed AS (
    SELECT
        order_id,
        customer_id,
        product_id,
        CAST(order_date AS DATE) AS order_date,
        CAST(quantity AS INTEGER) AS quantity,
        CAST(unit_price AS DECIMAL(10,2)) AS unit_price,
        CAST(total AS DECIMAL(10,2)) AS total_amount,
        CAST(discount AS DECIMAL(10,2)) AS discount_amount
    FROM source
)

SELECT * FROM renamed
  );

[0m01:44:01.470744 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "ecommerce_analytics", "target_name": "dev", "node_id": "model.ecommerce_analytics.stg_orders"} */

  
  create view "dev"."main"."stg_orders__dbt_tmp" as (
    WITH source AS (
    SELECT * FROM "dev"."main"."raw_orders"
),

renamed AS (
    SELECT
        order_id,
        customer_id,
        product_id,
        CAST(order_date AS DATE) AS order_date,
        CAST(quantity AS INTEGER) AS quantity,
        CAST(unit_price AS DECIMAL(10,2)) AS unit_price,
        CAST(total AS DECIMAL(10,2)) AS total_amount,
        CAST(discount AS DECIMAL(10,2)) AS discount_amount
    FROM source
)

SELECT * FROM renamed
  );

[0m01:44:01.470744 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m01:44:01.470744 [debug] [Thread-1 (]: On model.ecommerce_analytics.stg_orders: ROLLBACK
[0m01:44:01.481197 [debug] [Thread-1 (]: Failed to rollback 'model.ecommerce_analytics.stg_orders'
[0m01:44:01.482160 [debug] [Thread-1 (]: On model.ecommerce_analytics.stg_orders: Close
[0m01:44:01.484002 [debug] [Thread-1 (]: Runtime Error in model stg_orders (models\example\staging\stg_orders.sql)
  Binder Error: Referenced column "product_id" not found in FROM clause!
  Candidate bindings: "promotion_id", "order_id", "customer_id", "order_date", "discount_percent"
  
  LINE 13:         product_id,
                   ^
[0m01:44:01.484002 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b5657af7-40bc-4130-88b7-7743435d9f89', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C7A58EA910>]}
[0m01:44:01.484002 [error] [Thread-1 (]: 2 of 6 ERROR creating sql view model main.stg_orders ........................... [[31mERROR[0m in 0.03s]
[0m01:44:01.484002 [debug] [Thread-1 (]: Finished running node model.ecommerce_analytics.stg_orders
[0m01:44:01.489170 [debug] [Thread-4 (]: Marking all children of 'model.ecommerce_analytics.stg_orders' to be skipped because of status 'error'.  Reason: Runtime Error in model stg_orders (models\example\staging\stg_orders.sql)
  Binder Error: Referenced column "product_id" not found in FROM clause!
  Candidate bindings: "promotion_id", "order_id", "customer_id", "order_date", "discount_percent"
  
  LINE 13:         product_id,
                   ^.
[0m01:44:01.484002 [debug] [Thread-1 (]: Began running node model.ecommerce_analytics.stg_products
[0m01:44:01.489767 [info ] [Thread-1 (]: 3 of 6 START sql view model main.stg_products .................................. [RUN]
[0m01:44:01.491784 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ecommerce_analytics.stg_orders, now model.ecommerce_analytics.stg_products)
[0m01:44:01.491784 [debug] [Thread-1 (]: Began compiling node model.ecommerce_analytics.stg_products
[0m01:44:01.497542 [debug] [Thread-1 (]: Writing injected SQL for node "model.ecommerce_analytics.stg_products"
[0m01:44:01.498814 [debug] [Thread-1 (]: Began executing node model.ecommerce_analytics.stg_products
[0m01:44:01.502132 [debug] [Thread-1 (]: Writing runtime sql for node "model.ecommerce_analytics.stg_products"
[0m01:44:01.502132 [debug] [Thread-1 (]: Using duckdb connection "model.ecommerce_analytics.stg_products"
[0m01:44:01.502132 [debug] [Thread-1 (]: On model.ecommerce_analytics.stg_products: BEGIN
[0m01:44:01.502132 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:44:01.510310 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m01:44:01.511045 [debug] [Thread-1 (]: Using duckdb connection "model.ecommerce_analytics.stg_products"
[0m01:44:01.511394 [debug] [Thread-1 (]: On model.ecommerce_analytics.stg_products: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "ecommerce_analytics", "target_name": "dev", "node_id": "model.ecommerce_analytics.stg_products"} */

  
  create view "dev"."main"."stg_products__dbt_tmp" as (
    WITH source AS (
    SELECT * FROM "dev"."main"."raw_products"
),

renamed AS (
    SELECT
        product_id,
        sku,
        product_name,
        description,
        category_id,
        brand_id,
        supplier_id,
        CAST(price AS DECIMAL(10,2)) AS price,
        CAST(cost AS DECIMAL(10,2)) AS cost,
        CAST(weight_kg AS DECIMAL(10,2)) AS weight_kg,
        is_active,
        CAST(created_at AS DATE) AS created_at,
        CAST(updated_at AS DATE) AS updated_at
    FROM source
)

SELECT * FROM renamed
  );

[0m01:44:01.513369 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m01:44:01.517572 [debug] [Thread-1 (]: Using duckdb connection "model.ecommerce_analytics.stg_products"
[0m01:44:01.517572 [debug] [Thread-1 (]: On model.ecommerce_analytics.stg_products: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "ecommerce_analytics", "target_name": "dev", "node_id": "model.ecommerce_analytics.stg_products"} */
alter view "dev"."main"."stg_products__dbt_tmp" rename to "stg_products"
[0m01:44:01.517572 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m01:44:01.521958 [debug] [Thread-1 (]: On model.ecommerce_analytics.stg_products: COMMIT
[0m01:44:01.521958 [debug] [Thread-1 (]: Using duckdb connection "model.ecommerce_analytics.stg_products"
[0m01:44:01.521958 [debug] [Thread-1 (]: On model.ecommerce_analytics.stg_products: COMMIT
[0m01:44:01.523683 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m01:44:01.527785 [debug] [Thread-1 (]: Using duckdb connection "model.ecommerce_analytics.stg_products"
[0m01:44:01.528656 [debug] [Thread-1 (]: On model.ecommerce_analytics.stg_products: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "ecommerce_analytics", "target_name": "dev", "node_id": "model.ecommerce_analytics.stg_products"} */

      drop view if exists "dev"."main"."stg_products__dbt_backup" cascade
    
[0m01:44:01.528656 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m01:44:01.528656 [debug] [Thread-1 (]: On model.ecommerce_analytics.stg_products: Close
[0m01:44:01.528656 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b5657af7-40bc-4130-88b7-7743435d9f89', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C7A59B5E10>]}
[0m01:44:01.528656 [info ] [Thread-1 (]: 3 of 6 OK created sql view model main.stg_products ............................. [[32mOK[0m in 0.04s]
[0m01:44:01.534022 [debug] [Thread-1 (]: Finished running node model.ecommerce_analytics.stg_products
[0m01:44:01.534022 [debug] [Thread-1 (]: Began running node model.ecommerce_analytics.int_orders_enriched
[0m01:44:01.534022 [info ] [Thread-1 (]: 4 of 6 SKIP relation main.int_orders_enriched .................................. [[33mSKIP[0m]
[0m01:44:01.534022 [debug] [Thread-1 (]: Finished running node model.ecommerce_analytics.int_orders_enriched
[0m01:44:01.534022 [debug] [Thread-1 (]: Began running node model.ecommerce_analytics.dim_customers
[0m01:44:01.534022 [info ] [Thread-1 (]: 5 of 6 SKIP relation main.dim_customers ........................................ [[33mSKIP[0m]
[0m01:44:01.534022 [debug] [Thread-1 (]: Finished running node model.ecommerce_analytics.dim_customers
[0m01:44:01.542074 [debug] [Thread-1 (]: Began running node model.ecommerce_analytics.dim_products
[0m01:44:01.542580 [info ] [Thread-1 (]: 6 of 6 SKIP relation main.dim_products ......................................... [[33mSKIP[0m]
[0m01:44:01.542580 [debug] [Thread-1 (]: Finished running node model.ecommerce_analytics.dim_products
[0m01:44:01.544598 [debug] [MainThread]: Using duckdb connection "master"
[0m01:44:01.546664 [debug] [MainThread]: On master: BEGIN
[0m01:44:01.546664 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m01:44:01.546664 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m01:44:01.546664 [debug] [MainThread]: On master: COMMIT
[0m01:44:01.546664 [debug] [MainThread]: Using duckdb connection "master"
[0m01:44:01.546664 [debug] [MainThread]: On master: COMMIT
[0m01:44:01.550261 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m01:44:01.551007 [debug] [MainThread]: On master: Close
[0m01:44:01.551007 [debug] [MainThread]: Connection 'master' was properly closed.
[0m01:44:01.553021 [debug] [MainThread]: Connection 'create_dev_main' was properly closed.
[0m01:44:01.553021 [debug] [MainThread]: Connection 'list_dev_main' was properly closed.
[0m01:44:01.555029 [debug] [MainThread]: Connection 'model.ecommerce_analytics.stg_products' was properly closed.
[0m01:44:01.555029 [info ] [MainThread]: 
[0m01:44:01.555029 [info ] [MainThread]: Finished running 2 table models, 4 view models in 0 hours 0 minutes and 0.42 seconds (0.42s).
[0m01:44:01.558064 [debug] [MainThread]: Command end result
[0m01:44:01.587102 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\Lenovo\Desktop\Proyectos\dbt-proyect\ecommerce_analytics\target\manifest.json
[0m01:44:01.587102 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\Lenovo\Desktop\Proyectos\dbt-proyect\ecommerce_analytics\target\semantic_manifest.json
[0m01:44:01.603804 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\Lenovo\Desktop\Proyectos\dbt-proyect\ecommerce_analytics\target\run_results.json
[0m01:44:01.603804 [info ] [MainThread]: 
[0m01:44:01.603804 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m01:44:01.606499 [info ] [MainThread]: 
[0m01:44:01.606499 [error] [MainThread]: [31mFailure in model stg_orders (models\example\staging\stg_orders.sql)[0m
[0m01:44:01.606499 [error] [MainThread]:   Runtime Error in model stg_orders (models\example\staging\stg_orders.sql)
  Binder Error: Referenced column "product_id" not found in FROM clause!
  Candidate bindings: "promotion_id", "order_id", "customer_id", "order_date", "discount_percent"
  
  LINE 13:         product_id,
                   ^
[0m01:44:01.606499 [info ] [MainThread]: 
[0m01:44:01.606499 [info ] [MainThread]:   compiled code at target\compiled\ecommerce_analytics\models\example\staging\stg_orders.sql
[0m01:44:01.606499 [info ] [MainThread]: 
[0m01:44:01.606499 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=1 SKIP=3 NO-OP=0 TOTAL=6
[0m01:44:01.611982 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- MissingArgumentsPropertyInGenericTestDeprecation: 3 occurrences
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m01:44:01.614099 [debug] [MainThread]: Command `dbt run` failed at 01:44:01.612593 after 4.91 seconds
[0m01:44:01.614607 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C79CEB4C10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C79CEB4C50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C7A3B87890>]}
[0m01:44:01.614607 [debug] [MainThread]: Flushing usage events
[0m01:44:02.775484 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m01:46:07.889816 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025D7569C4D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025D75703690>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025D75702F50>]}


============================== 01:46:07.894944 | e1091f94-34c8-4d0c-82a0-f4341b11c05d ==============================
[0m01:46:07.894944 [info ] [MainThread]: Running with dbt=1.11.2
[0m01:46:07.894944 [debug] [MainThread]: running dbt with arguments {'version_check': 'True', 'no_print': 'None', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'target_path': 'None', 'printer_width': '80', 'write_json': 'True', 'empty': 'False', 'log_cache_events': 'False', 'introspect': 'True', 'cache_selected_only': 'False', 'log_format': 'default', 'debug': 'False', 'fail_fast': 'False', 'partial_parse': 'True', 'send_anonymous_usage_stats': 'True', 'quiet': 'False', 'warn_error': 'None', 'profiles_dir': 'C:\\Users\\Lenovo\\.dbt', 'indirect_selection': 'eager', 'use_colors': 'True', 'invocation_command': 'dbt run', 'use_experimental_parser': 'False', 'log_path': 'C:\\Users\\Lenovo\\Desktop\\Proyectos\\dbt-proyect\\ecommerce_analytics\\logs'}
[0m01:46:08.161678 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e1091f94-34c8-4d0c-82a0-f4341b11c05d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025D75720790>]}
[0m01:46:08.222166 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e1091f94-34c8-4d0c-82a0-f4341b11c05d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025D72060C90>]}
[0m01:46:08.222166 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m01:46:08.459468 [debug] [MainThread]: checksum: 3d40d8bbe1bef07db1c24822f2dbfff8bc07f2a48ed4fe2658a40653aec0b54b, vars: {}, profile: , target: , version: 1.11.2
[0m01:46:08.681358 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m01:46:08.681986 [debug] [MainThread]: Partial parsing: updated file: ecommerce_analytics://models\example\staging\stg_orders.sql
[0m01:46:09.084909 [warn ] [MainThread]: [[33mWARNING[0m][MissingArgumentsPropertyInGenericTestDeprecation]: Deprecated
functionality
Found top-level arguments to test `relationships` defined on 'stg_orders' in
package 'ecommerce_analytics' (models\example\staging\schema.yml). Arguments to
generic tests should be nested under the `arguments` property.
[0m01:46:09.085579 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'e1091f94-34c8-4d0c-82a0-f4341b11c05d', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025D76E2B350>]}
[0m01:46:09.191781 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e1091f94-34c8-4d0c-82a0-f4341b11c05d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025D76786890>]}
[0m01:46:09.286098 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\Lenovo\Desktop\Proyectos\dbt-proyect\ecommerce_analytics\target\manifest.json
[0m01:46:09.290152 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\Lenovo\Desktop\Proyectos\dbt-proyect\ecommerce_analytics\target\semantic_manifest.json
[0m01:46:09.321230 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e1091f94-34c8-4d0c-82a0-f4341b11c05d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025D757034D0>]}
[0m01:46:09.321230 [info ] [MainThread]: Found 7 models, 3 seeds, 14 data tests, 587 macros
[0m01:46:09.323356 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e1091f94-34c8-4d0c-82a0-f4341b11c05d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025D76DD9390>]}
[0m01:46:09.323356 [info ] [MainThread]: 
[0m01:46:09.323356 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m01:46:09.323356 [info ] [MainThread]: 
[0m01:46:09.323356 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m01:46:09.333696 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_dev'
[0m01:46:09.422566 [debug] [ThreadPool]: Using duckdb connection "list_dev"
[0m01:46:09.422566 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "ecommerce_analytics", "target_name": "dev", "connection_name": "list_dev"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"dev"'
    
  
  
[0m01:46:09.422566 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:46:09.468945 [debug] [ThreadPool]: SQL status: OK in 0.048 seconds
[0m01:46:09.468945 [debug] [ThreadPool]: On list_dev: Close
[0m01:46:09.468945 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev, now create_dev_main)
[0m01:46:09.468945 [debug] [ThreadPool]: Creating schema "database: "dev"
schema: "main"
"
[0m01:46:09.477509 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m01:46:09.477509 [debug] [ThreadPool]: On create_dev_main: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "ecommerce_analytics", "target_name": "dev", "connection_name": "create_dev_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='dev'
        and type='sqlite'
    
  
[0m01:46:09.484361 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m01:46:09.485039 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m01:46:09.485039 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m01:46:09.488109 [debug] [ThreadPool]: On create_dev_main: BEGIN
[0m01:46:09.488109 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m01:46:09.488109 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m01:46:09.488109 [debug] [ThreadPool]: On create_dev_main: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "ecommerce_analytics", "target_name": "dev", "connection_name": "create_dev_main"} */

    
    
        create schema if not exists "dev"."main"
    
[0m01:46:09.488109 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m01:46:09.491644 [debug] [ThreadPool]: On create_dev_main: COMMIT
[0m01:46:09.491644 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m01:46:09.491644 [debug] [ThreadPool]: On create_dev_main: COMMIT
[0m01:46:09.493651 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m01:46:09.493651 [debug] [ThreadPool]: On create_dev_main: Close
[0m01:46:09.493651 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_dev_main'
[0m01:46:09.501001 [debug] [ThreadPool]: Using duckdb connection "list_dev_main"
[0m01:46:09.501001 [debug] [ThreadPool]: On list_dev_main: BEGIN
[0m01:46:09.501001 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:46:09.501001 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m01:46:09.501001 [debug] [ThreadPool]: Using duckdb connection "list_dev_main"
[0m01:46:09.503614 [debug] [ThreadPool]: On list_dev_main: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "ecommerce_analytics", "target_name": "dev", "connection_name": "list_dev_main"} */
select
      'dev' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'dev'
  
[0m01:46:09.517133 [debug] [ThreadPool]: SQL status: OK in 0.013 seconds
[0m01:46:09.517133 [debug] [ThreadPool]: On list_dev_main: ROLLBACK
[0m01:46:09.519248 [debug] [ThreadPool]: Failed to rollback 'list_dev_main'
[0m01:46:09.519248 [debug] [ThreadPool]: On list_dev_main: Close
[0m01:46:09.519248 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e1091f94-34c8-4d0c-82a0-f4341b11c05d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025D76B3E390>]}
[0m01:46:09.519248 [debug] [MainThread]: Using duckdb connection "master"
[0m01:46:09.519248 [debug] [MainThread]: On master: BEGIN
[0m01:46:09.523665 [debug] [MainThread]: Opening a new connection, currently in state init
[0m01:46:09.523665 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m01:46:09.523665 [debug] [MainThread]: On master: COMMIT
[0m01:46:09.523665 [debug] [MainThread]: Using duckdb connection "master"
[0m01:46:09.525672 [debug] [MainThread]: On master: COMMIT
[0m01:46:09.525672 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m01:46:09.525672 [debug] [MainThread]: On master: Close
[0m01:46:09.529685 [debug] [Thread-1 (]: Began running node model.ecommerce_analytics.stg_customers
[0m01:46:09.532219 [info ] [Thread-1 (]: 1 of 6 START sql view model main.stg_customers ................................. [RUN]
[0m01:46:09.532780 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.ecommerce_analytics.stg_customers'
[0m01:46:09.532780 [debug] [Thread-1 (]: Began compiling node model.ecommerce_analytics.stg_customers
[0m01:46:09.540562 [debug] [Thread-1 (]: Writing injected SQL for node "model.ecommerce_analytics.stg_customers"
[0m01:46:09.544086 [debug] [Thread-1 (]: Began executing node model.ecommerce_analytics.stg_customers
[0m01:46:09.572176 [debug] [Thread-1 (]: Writing runtime sql for node "model.ecommerce_analytics.stg_customers"
[0m01:46:09.572176 [debug] [Thread-1 (]: Using duckdb connection "model.ecommerce_analytics.stg_customers"
[0m01:46:09.579696 [debug] [Thread-1 (]: On model.ecommerce_analytics.stg_customers: BEGIN
[0m01:46:09.579696 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m01:46:09.582209 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m01:46:09.582812 [debug] [Thread-1 (]: Using duckdb connection "model.ecommerce_analytics.stg_customers"
[0m01:46:09.583369 [debug] [Thread-1 (]: On model.ecommerce_analytics.stg_customers: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "ecommerce_analytics", "target_name": "dev", "node_id": "model.ecommerce_analytics.stg_customers"} */

  
  create view "dev"."main"."stg_customers__dbt_tmp" as (
    WITH source AS (
    SELECT * FROM "dev"."main"."raw_customers"
),

renamed AS (
    SELECT
        customer_id,
        first_name || ' ' || last_name AS customer_name,
        email AS customer_email,
        phone,
        CAST(birth_date AS DATE) AS birth_date,
        city AS customer_city,
        country,
        postal_code,
        segment,
        CAST(registration_date AS DATE) AS registration_date,
        CAST(last_login AS DATE) AS last_login,
        is_verified,
        accepts_marketing
    FROM source
)

SELECT * FROM renamed
  );

[0m01:46:09.583957 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m01:46:09.589392 [debug] [Thread-1 (]: Using duckdb connection "model.ecommerce_analytics.stg_customers"
[0m01:46:09.592522 [debug] [Thread-1 (]: On model.ecommerce_analytics.stg_customers: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "ecommerce_analytics", "target_name": "dev", "node_id": "model.ecommerce_analytics.stg_customers"} */
alter view "dev"."main"."stg_customers" rename to "stg_customers__dbt_backup"
[0m01:46:09.592522 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m01:46:09.596382 [debug] [Thread-1 (]: Using duckdb connection "model.ecommerce_analytics.stg_customers"
[0m01:46:09.596382 [debug] [Thread-1 (]: On model.ecommerce_analytics.stg_customers: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "ecommerce_analytics", "target_name": "dev", "node_id": "model.ecommerce_analytics.stg_customers"} */
alter view "dev"."main"."stg_customers__dbt_tmp" rename to "stg_customers"
[0m01:46:09.596382 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m01:46:09.604573 [debug] [Thread-1 (]: On model.ecommerce_analytics.stg_customers: COMMIT
[0m01:46:09.604573 [debug] [Thread-1 (]: Using duckdb connection "model.ecommerce_analytics.stg_customers"
[0m01:46:09.604573 [debug] [Thread-1 (]: On model.ecommerce_analytics.stg_customers: COMMIT
[0m01:46:09.615156 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m01:46:09.615156 [debug] [Thread-1 (]: Using duckdb connection "model.ecommerce_analytics.stg_customers"
[0m01:46:09.615156 [debug] [Thread-1 (]: On model.ecommerce_analytics.stg_customers: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "ecommerce_analytics", "target_name": "dev", "node_id": "model.ecommerce_analytics.stg_customers"} */

      drop view if exists "dev"."main"."stg_customers__dbt_backup" cascade
    
[0m01:46:09.624021 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m01:46:09.625259 [debug] [Thread-1 (]: On model.ecommerce_analytics.stg_customers: Close
[0m01:46:09.628820 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e1091f94-34c8-4d0c-82a0-f4341b11c05d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025D772F0A90>]}
[0m01:46:09.629541 [info ] [Thread-1 (]: 1 of 6 OK created sql view model main.stg_customers ............................ [[32mOK[0m in 0.09s]
[0m01:46:09.631306 [debug] [Thread-1 (]: Finished running node model.ecommerce_analytics.stg_customers
[0m01:46:09.632399 [debug] [Thread-1 (]: Began running node model.ecommerce_analytics.stg_orders
[0m01:46:09.633503 [info ] [Thread-1 (]: 2 of 6 START sql view model main.stg_orders .................................... [RUN]
[0m01:46:09.634561 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ecommerce_analytics.stg_customers, now model.ecommerce_analytics.stg_orders)
[0m01:46:09.635089 [debug] [Thread-1 (]: Began compiling node model.ecommerce_analytics.stg_orders
[0m01:46:09.639951 [debug] [Thread-1 (]: Writing injected SQL for node "model.ecommerce_analytics.stg_orders"
[0m01:46:09.641275 [debug] [Thread-1 (]: Began executing node model.ecommerce_analytics.stg_orders
[0m01:46:09.646829 [debug] [Thread-1 (]: Writing runtime sql for node "model.ecommerce_analytics.stg_orders"
[0m01:46:09.649131 [debug] [Thread-1 (]: Using duckdb connection "model.ecommerce_analytics.stg_orders"
[0m01:46:09.649682 [debug] [Thread-1 (]: On model.ecommerce_analytics.stg_orders: BEGIN
[0m01:46:09.650212 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:46:09.651284 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m01:46:09.651820 [debug] [Thread-1 (]: Using duckdb connection "model.ecommerce_analytics.stg_orders"
[0m01:46:09.652916 [debug] [Thread-1 (]: On model.ecommerce_analytics.stg_orders: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "ecommerce_analytics", "target_name": "dev", "node_id": "model.ecommerce_analytics.stg_orders"} */

  
  create view "dev"."main"."stg_orders__dbt_tmp" as (
    WITH source AS (
    SELECT * FROM "dev"."main"."raw_orders"
),

renamed AS (
    SELECT
        order_id,
        order_number,
        customer_id,
        CAST(order_date AS DATE) AS order_date,
        status,
        CAST(subtotal AS DECIMAL(10,2)) AS subtotal,
        CAST(discount_percent AS DECIMAL(10,2)) AS discount_percent,
        CAST(shipping_cost AS DECIMAL(10,2)) AS shipping_cost,
        CAST(tax_amount AS DECIMAL(10,2)) AS tax_amount,
        CAST(total_amount AS DECIMAL(10,2)) AS total_amount,
        payment_method,
        shipping_method,
        promotion_id,
        notes
    FROM source
)

SELECT * FROM renamed
  );

[0m01:46:09.654733 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m01:46:09.659125 [debug] [Thread-1 (]: Using duckdb connection "model.ecommerce_analytics.stg_orders"
[0m01:46:09.659774 [debug] [Thread-1 (]: On model.ecommerce_analytics.stg_orders: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "ecommerce_analytics", "target_name": "dev", "node_id": "model.ecommerce_analytics.stg_orders"} */
alter view "dev"."main"."stg_orders__dbt_tmp" rename to "stg_orders"
[0m01:46:09.660912 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m01:46:09.662984 [debug] [Thread-1 (]: On model.ecommerce_analytics.stg_orders: COMMIT
[0m01:46:09.663731 [debug] [Thread-1 (]: Using duckdb connection "model.ecommerce_analytics.stg_orders"
[0m01:46:09.664496 [debug] [Thread-1 (]: On model.ecommerce_analytics.stg_orders: COMMIT
[0m01:46:09.667391 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m01:46:09.672636 [debug] [Thread-1 (]: Using duckdb connection "model.ecommerce_analytics.stg_orders"
[0m01:46:09.673574 [debug] [Thread-1 (]: On model.ecommerce_analytics.stg_orders: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "ecommerce_analytics", "target_name": "dev", "node_id": "model.ecommerce_analytics.stg_orders"} */

      drop view if exists "dev"."main"."stg_orders__dbt_backup" cascade
    
[0m01:46:09.674634 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m01:46:09.675925 [debug] [Thread-1 (]: On model.ecommerce_analytics.stg_orders: Close
[0m01:46:09.676562 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e1091f94-34c8-4d0c-82a0-f4341b11c05d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025D784A9810>]}
[0m01:46:09.677784 [info ] [Thread-1 (]: 2 of 6 OK created sql view model main.stg_orders ............................... [[32mOK[0m in 0.04s]
[0m01:46:09.678386 [debug] [Thread-1 (]: Finished running node model.ecommerce_analytics.stg_orders
[0m01:46:09.678959 [debug] [Thread-1 (]: Began running node model.ecommerce_analytics.stg_products
[0m01:46:09.679633 [info ] [Thread-1 (]: 3 of 6 START sql view model main.stg_products .................................. [RUN]
[0m01:46:09.680233 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ecommerce_analytics.stg_orders, now model.ecommerce_analytics.stg_products)
[0m01:46:09.680795 [debug] [Thread-1 (]: Began compiling node model.ecommerce_analytics.stg_products
[0m01:46:09.684418 [debug] [Thread-1 (]: Writing injected SQL for node "model.ecommerce_analytics.stg_products"
[0m01:46:09.686029 [debug] [Thread-1 (]: Began executing node model.ecommerce_analytics.stg_products
[0m01:46:09.691501 [debug] [Thread-1 (]: Writing runtime sql for node "model.ecommerce_analytics.stg_products"
[0m01:46:09.692186 [debug] [Thread-1 (]: Using duckdb connection "model.ecommerce_analytics.stg_products"
[0m01:46:09.692186 [debug] [Thread-1 (]: On model.ecommerce_analytics.stg_products: BEGIN
[0m01:46:09.692186 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:46:09.692186 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m01:46:09.692186 [debug] [Thread-1 (]: Using duckdb connection "model.ecommerce_analytics.stg_products"
[0m01:46:09.695687 [debug] [Thread-1 (]: On model.ecommerce_analytics.stg_products: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "ecommerce_analytics", "target_name": "dev", "node_id": "model.ecommerce_analytics.stg_products"} */

  
  create view "dev"."main"."stg_products__dbt_tmp" as (
    WITH source AS (
    SELECT * FROM "dev"."main"."raw_products"
),

renamed AS (
    SELECT
        product_id,
        sku,
        product_name,
        description,
        category_id,
        brand_id,
        supplier_id,
        CAST(price AS DECIMAL(10,2)) AS price,
        CAST(cost AS DECIMAL(10,2)) AS cost,
        CAST(weight_kg AS DECIMAL(10,2)) AS weight_kg,
        is_active,
        CAST(created_at AS DATE) AS created_at,
        CAST(updated_at AS DATE) AS updated_at
    FROM source
)

SELECT * FROM renamed
  );

[0m01:46:09.695687 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m01:46:09.700972 [debug] [Thread-1 (]: Using duckdb connection "model.ecommerce_analytics.stg_products"
[0m01:46:09.700972 [debug] [Thread-1 (]: On model.ecommerce_analytics.stg_products: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "ecommerce_analytics", "target_name": "dev", "node_id": "model.ecommerce_analytics.stg_products"} */
alter view "dev"."main"."stg_products" rename to "stg_products__dbt_backup"
[0m01:46:09.700972 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m01:46:09.707669 [debug] [Thread-1 (]: Using duckdb connection "model.ecommerce_analytics.stg_products"
[0m01:46:09.708373 [debug] [Thread-1 (]: On model.ecommerce_analytics.stg_products: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "ecommerce_analytics", "target_name": "dev", "node_id": "model.ecommerce_analytics.stg_products"} */
alter view "dev"."main"."stg_products__dbt_tmp" rename to "stg_products"
[0m01:46:09.709430 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m01:46:09.710829 [debug] [Thread-1 (]: On model.ecommerce_analytics.stg_products: COMMIT
[0m01:46:09.711567 [debug] [Thread-1 (]: Using duckdb connection "model.ecommerce_analytics.stg_products"
[0m01:46:09.712202 [debug] [Thread-1 (]: On model.ecommerce_analytics.stg_products: COMMIT
[0m01:46:09.714016 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m01:46:09.717555 [debug] [Thread-1 (]: Using duckdb connection "model.ecommerce_analytics.stg_products"
[0m01:46:09.718660 [debug] [Thread-1 (]: On model.ecommerce_analytics.stg_products: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "ecommerce_analytics", "target_name": "dev", "node_id": "model.ecommerce_analytics.stg_products"} */

      drop view if exists "dev"."main"."stg_products__dbt_backup" cascade
    
[0m01:46:09.720391 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m01:46:09.721675 [debug] [Thread-1 (]: On model.ecommerce_analytics.stg_products: Close
[0m01:46:09.722355 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e1091f94-34c8-4d0c-82a0-f4341b11c05d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025D77333F90>]}
[0m01:46:09.723802 [info ] [Thread-1 (]: 3 of 6 OK created sql view model main.stg_products ............................. [[32mOK[0m in 0.04s]
[0m01:46:09.723802 [debug] [Thread-1 (]: Finished running node model.ecommerce_analytics.stg_products
[0m01:46:09.726816 [debug] [Thread-1 (]: Began running node model.ecommerce_analytics.int_orders_enriched
[0m01:46:09.726816 [info ] [Thread-1 (]: 4 of 6 START sql view model main.int_orders_enriched ........................... [RUN]
[0m01:46:09.726816 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ecommerce_analytics.stg_products, now model.ecommerce_analytics.int_orders_enriched)
[0m01:46:09.726816 [debug] [Thread-1 (]: Began compiling node model.ecommerce_analytics.int_orders_enriched
[0m01:46:09.732791 [debug] [Thread-1 (]: Writing injected SQL for node "model.ecommerce_analytics.int_orders_enriched"
[0m01:46:09.732791 [debug] [Thread-1 (]: Began executing node model.ecommerce_analytics.int_orders_enriched
[0m01:46:09.740197 [debug] [Thread-1 (]: Writing runtime sql for node "model.ecommerce_analytics.int_orders_enriched"
[0m01:46:09.744643 [debug] [Thread-1 (]: Using duckdb connection "model.ecommerce_analytics.int_orders_enriched"
[0m01:46:09.744643 [debug] [Thread-1 (]: On model.ecommerce_analytics.int_orders_enriched: BEGIN
[0m01:46:09.744643 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:46:09.747824 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m01:46:09.748389 [debug] [Thread-1 (]: Using duckdb connection "model.ecommerce_analytics.int_orders_enriched"
[0m01:46:09.748389 [debug] [Thread-1 (]: On model.ecommerce_analytics.int_orders_enriched: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "ecommerce_analytics", "target_name": "dev", "node_id": "model.ecommerce_analytics.int_orders_enriched"} */

  
  create view "dev"."main"."int_orders_enriched__dbt_tmp" as (
    -- models/intermediate/int_orders_enriched.sql

WITH orders AS (
    SELECT * FROM "dev"."main"."stg_orders"
),

customers AS (
    SELECT * FROM "dev"."main"."stg_customers"
),

products AS (
    SELECT * FROM "dev"."main"."stg_products"
),

enriched AS (
    SELECT
        o.order_id,
        o.order_date,
        o.quantity,
        o.unit_price,
        o.total_amount,
        o.discount_amount,
        
        -- Customer info
        c.customer_id,
        c.customer_name,
        c.customer_email,
        c.customer_city,
        
        -- Product info
        p.product_id,
        p.product_name,
        p.category,
        
        -- Calculated fields
        DATE_TRUNC('month', o.order_date) AS order_month,
        CASE 
            WHEN o.total_amount > 100 THEN 'High Value'
            WHEN o.total_amount > 50 THEN 'Medium Value'
            ELSE 'Low Value'
        END AS order_tier
        
    FROM orders o
    LEFT JOIN customers c ON o.customer_id = c.customer_id
    LEFT JOIN products p ON o.product_id = p.product_id
)

SELECT * FROM enriched
  );

[0m01:46:09.748389 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "ecommerce_analytics", "target_name": "dev", "node_id": "model.ecommerce_analytics.int_orders_enriched"} */

  
  create view "dev"."main"."int_orders_enriched__dbt_tmp" as (
    -- models/intermediate/int_orders_enriched.sql

WITH orders AS (
    SELECT * FROM "dev"."main"."stg_orders"
),

customers AS (
    SELECT * FROM "dev"."main"."stg_customers"
),

products AS (
    SELECT * FROM "dev"."main"."stg_products"
),

enriched AS (
    SELECT
        o.order_id,
        o.order_date,
        o.quantity,
        o.unit_price,
        o.total_amount,
        o.discount_amount,
        
        -- Customer info
        c.customer_id,
        c.customer_name,
        c.customer_email,
        c.customer_city,
        
        -- Product info
        p.product_id,
        p.product_name,
        p.category,
        
        -- Calculated fields
        DATE_TRUNC('month', o.order_date) AS order_month,
        CASE 
            WHEN o.total_amount > 100 THEN 'High Value'
            WHEN o.total_amount > 50 THEN 'Medium Value'
            ELSE 'Low Value'
        END AS order_tier
        
    FROM orders o
    LEFT JOIN customers c ON o.customer_id = c.customer_id
    LEFT JOIN products p ON o.product_id = p.product_id
)

SELECT * FROM enriched
  );

[0m01:46:09.748389 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m01:46:09.748389 [debug] [Thread-1 (]: On model.ecommerce_analytics.int_orders_enriched: ROLLBACK
[0m01:46:09.758408 [debug] [Thread-1 (]: Failed to rollback 'model.ecommerce_analytics.int_orders_enriched'
[0m01:46:09.758408 [debug] [Thread-1 (]: On model.ecommerce_analytics.int_orders_enriched: Close
[0m01:46:09.763680 [debug] [Thread-1 (]: Runtime Error in model int_orders_enriched (models\example\intermediate\int_orders_enriched.sql)
  Binder Error: Values list "o" does not have a column named "product_id"
  
  LINE 49:     LEFT JOIN products p ON o.product_id = p.product_id
                                       ^
[0m01:46:09.763680 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e1091f94-34c8-4d0c-82a0-f4341b11c05d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025D77459550>]}
[0m01:46:09.763680 [error] [Thread-1 (]: 4 of 6 ERROR creating sql view model main.int_orders_enriched .................. [[31mERROR[0m in 0.04s]
[0m01:46:09.763680 [debug] [Thread-1 (]: Finished running node model.ecommerce_analytics.int_orders_enriched
[0m01:46:09.768797 [debug] [Thread-4 (]: Marking all children of 'model.ecommerce_analytics.int_orders_enriched' to be skipped because of status 'error'.  Reason: Runtime Error in model int_orders_enriched (models\example\intermediate\int_orders_enriched.sql)
  Binder Error: Values list "o" does not have a column named "product_id"
  
  LINE 49:     LEFT JOIN products p ON o.product_id = p.product_id
                                       ^.
[0m01:46:09.768797 [debug] [Thread-1 (]: Began running node model.ecommerce_analytics.dim_customers
[0m01:46:09.768797 [info ] [Thread-1 (]: 5 of 6 SKIP relation main.dim_customers ........................................ [[33mSKIP[0m]
[0m01:46:09.768797 [debug] [Thread-1 (]: Finished running node model.ecommerce_analytics.dim_customers
[0m01:46:09.772021 [debug] [Thread-1 (]: Began running node model.ecommerce_analytics.dim_products
[0m01:46:09.772606 [info ] [Thread-1 (]: 6 of 6 SKIP relation main.dim_products ......................................... [[33mSKIP[0m]
[0m01:46:09.774158 [debug] [Thread-1 (]: Finished running node model.ecommerce_analytics.dim_products
[0m01:46:09.774158 [debug] [MainThread]: Using duckdb connection "master"
[0m01:46:09.774158 [debug] [MainThread]: On master: BEGIN
[0m01:46:09.774158 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m01:46:09.779135 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m01:46:09.779135 [debug] [MainThread]: On master: COMMIT
[0m01:46:09.780023 [debug] [MainThread]: Using duckdb connection "master"
[0m01:46:09.780023 [debug] [MainThread]: On master: COMMIT
[0m01:46:09.780023 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m01:46:09.780023 [debug] [MainThread]: On master: Close
[0m01:46:09.780023 [debug] [MainThread]: Connection 'master' was properly closed.
[0m01:46:09.780023 [debug] [MainThread]: Connection 'create_dev_main' was properly closed.
[0m01:46:09.780023 [debug] [MainThread]: Connection 'list_dev_main' was properly closed.
[0m01:46:09.783161 [debug] [MainThread]: Connection 'model.ecommerce_analytics.int_orders_enriched' was properly closed.
[0m01:46:09.783827 [info ] [MainThread]: 
[0m01:46:09.783827 [info ] [MainThread]: Finished running 2 table models, 4 view models in 0 hours 0 minutes and 0.46 seconds (0.46s).
[0m01:46:09.783827 [debug] [MainThread]: Command end result
[0m01:46:09.820753 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\Lenovo\Desktop\Proyectos\dbt-proyect\ecommerce_analytics\target\manifest.json
[0m01:46:09.823874 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\Lenovo\Desktop\Proyectos\dbt-proyect\ecommerce_analytics\target\semantic_manifest.json
[0m01:46:09.831425 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\Lenovo\Desktop\Proyectos\dbt-proyect\ecommerce_analytics\target\run_results.json
[0m01:46:09.831425 [info ] [MainThread]: 
[0m01:46:09.833852 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m01:46:09.834503 [info ] [MainThread]: 
[0m01:46:09.834503 [error] [MainThread]: [31mFailure in model int_orders_enriched (models\example\intermediate\int_orders_enriched.sql)[0m
[0m01:46:09.834503 [error] [MainThread]:   Runtime Error in model int_orders_enriched (models\example\intermediate\int_orders_enriched.sql)
  Binder Error: Values list "o" does not have a column named "product_id"
  
  LINE 49:     LEFT JOIN products p ON o.product_id = p.product_id
                                       ^
[0m01:46:09.834503 [info ] [MainThread]: 
[0m01:46:09.838863 [info ] [MainThread]:   compiled code at target\compiled\ecommerce_analytics\models\example\intermediate\int_orders_enriched.sql
[0m01:46:09.840617 [info ] [MainThread]: 
[0m01:46:09.841627 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=1 SKIP=2 NO-OP=0 TOTAL=6
[0m01:46:09.843601 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- MissingArgumentsPropertyInGenericTestDeprecation: 2 occurrences
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m01:46:09.844786 [debug] [MainThread]: Command `dbt run` failed at 01:46:09.844786 after 2.04 seconds
[0m01:46:09.844786 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025D75518D50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025D6E9F4B50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025D6E9F4C90>]}
[0m01:46:09.844786 [debug] [MainThread]: Flushing usage events
[0m01:46:11.182171 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m01:47:40.040791 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015BB693C550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015BB69A1610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015BB69A1310>]}


============================== 01:47:40.051082 | 8860ea79-504c-413a-8bee-8945a2f56c98 ==============================
[0m01:47:40.051082 [info ] [MainThread]: Running with dbt=1.11.2
[0m01:47:40.051082 [debug] [MainThread]: running dbt with arguments {'version_check': 'True', 'no_print': 'None', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'printer_width': '80', 'write_json': 'True', 'introspect': 'True', 'log_cache_events': 'False', 'empty': 'False', 'cache_selected_only': 'False', 'fail_fast': 'False', 'debug': 'False', 'log_format': 'default', 'partial_parse': 'True', 'send_anonymous_usage_stats': 'True', 'quiet': 'False', 'warn_error': 'None', 'profiles_dir': 'C:\\Users\\Lenovo\\.dbt', 'indirect_selection': 'eager', 'use_colors': 'True', 'invocation_command': 'dbt run', 'use_experimental_parser': 'False', 'log_path': 'C:\\Users\\Lenovo\\Desktop\\Proyectos\\dbt-proyect\\ecommerce_analytics\\logs'}
[0m01:47:40.283431 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8860ea79-504c-413a-8bee-8945a2f56c98', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015BB7B822D0>]}
[0m01:47:40.363878 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '8860ea79-504c-413a-8bee-8945a2f56c98', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015BB32C8510>]}
[0m01:47:40.363878 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m01:47:40.609947 [debug] [MainThread]: checksum: 3d40d8bbe1bef07db1c24822f2dbfff8bc07f2a48ed4fe2658a40653aec0b54b, vars: {}, profile: , target: , version: 1.11.2
[0m01:47:40.860811 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m01:47:40.860811 [debug] [MainThread]: Partial parsing: updated file: ecommerce_analytics://models\example\intermediate\int_orders_enriched.sql
[0m01:47:41.160656 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8860ea79-504c-413a-8bee-8945a2f56c98', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015BB811DFD0>]}
[0m01:47:41.245117 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\Lenovo\Desktop\Proyectos\dbt-proyect\ecommerce_analytics\target\manifest.json
[0m01:47:41.251425 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\Lenovo\Desktop\Proyectos\dbt-proyect\ecommerce_analytics\target\semantic_manifest.json
[0m01:47:41.288368 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8860ea79-504c-413a-8bee-8945a2f56c98', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015BB81BE190>]}
[0m01:47:41.288368 [info ] [MainThread]: Found 7 models, 3 seeds, 14 data tests, 587 macros
[0m01:47:41.288368 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8860ea79-504c-413a-8bee-8945a2f56c98', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015BB8102A10>]}
[0m01:47:41.288368 [info ] [MainThread]: 
[0m01:47:41.288368 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m01:47:41.288368 [info ] [MainThread]: 
[0m01:47:41.296667 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m01:47:41.301118 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_dev'
[0m01:47:41.380429 [debug] [ThreadPool]: Using duckdb connection "list_dev"
[0m01:47:41.380429 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "ecommerce_analytics", "target_name": "dev", "connection_name": "list_dev"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"dev"'
    
  
  
[0m01:47:41.380429 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:47:41.446978 [debug] [ThreadPool]: SQL status: OK in 0.066 seconds
[0m01:47:41.446978 [debug] [ThreadPool]: On list_dev: Close
[0m01:47:41.453368 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev, now create_dev_main)
[0m01:47:41.453368 [debug] [ThreadPool]: Creating schema "database: "dev"
schema: "main"
"
[0m01:47:41.461284 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m01:47:41.461284 [debug] [ThreadPool]: On create_dev_main: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "ecommerce_analytics", "target_name": "dev", "connection_name": "create_dev_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='dev'
        and type='sqlite'
    
  
[0m01:47:41.461284 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m01:47:41.463831 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m01:47:41.463831 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m01:47:41.463831 [debug] [ThreadPool]: On create_dev_main: BEGIN
[0m01:47:41.467435 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m01:47:41.467435 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m01:47:41.467435 [debug] [ThreadPool]: On create_dev_main: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "ecommerce_analytics", "target_name": "dev", "connection_name": "create_dev_main"} */

    
    
        create schema if not exists "dev"."main"
    
[0m01:47:41.467435 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m01:47:41.467435 [debug] [ThreadPool]: On create_dev_main: COMMIT
[0m01:47:41.467435 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m01:47:41.467435 [debug] [ThreadPool]: On create_dev_main: COMMIT
[0m01:47:41.467435 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m01:47:41.467435 [debug] [ThreadPool]: On create_dev_main: Close
[0m01:47:41.473072 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_dev_main'
[0m01:47:41.474081 [debug] [ThreadPool]: Using duckdb connection "list_dev_main"
[0m01:47:41.474081 [debug] [ThreadPool]: On list_dev_main: BEGIN
[0m01:47:41.474081 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:47:41.474081 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m01:47:41.474081 [debug] [ThreadPool]: Using duckdb connection "list_dev_main"
[0m01:47:41.474081 [debug] [ThreadPool]: On list_dev_main: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "ecommerce_analytics", "target_name": "dev", "connection_name": "list_dev_main"} */
select
      'dev' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'dev'
  
[0m01:47:41.494835 [debug] [ThreadPool]: SQL status: OK in 0.013 seconds
[0m01:47:41.494835 [debug] [ThreadPool]: On list_dev_main: ROLLBACK
[0m01:47:41.494835 [debug] [ThreadPool]: Failed to rollback 'list_dev_main'
[0m01:47:41.494835 [debug] [ThreadPool]: On list_dev_main: Close
[0m01:47:41.499502 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8860ea79-504c-413a-8bee-8945a2f56c98', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015BB53E8DD0>]}
[0m01:47:41.499502 [debug] [MainThread]: Using duckdb connection "master"
[0m01:47:41.499502 [debug] [MainThread]: On master: BEGIN
[0m01:47:41.499502 [debug] [MainThread]: Opening a new connection, currently in state init
[0m01:47:41.503065 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m01:47:41.503065 [debug] [MainThread]: On master: COMMIT
[0m01:47:41.503065 [debug] [MainThread]: Using duckdb connection "master"
[0m01:47:41.503065 [debug] [MainThread]: On master: COMMIT
[0m01:47:41.503065 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m01:47:41.505070 [debug] [MainThread]: On master: Close
[0m01:47:41.505070 [debug] [Thread-1 (]: Began running node model.ecommerce_analytics.stg_customers
[0m01:47:41.505070 [info ] [Thread-1 (]: 1 of 6 START sql view model main.stg_customers ................................. [RUN]
[0m01:47:41.505070 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.ecommerce_analytics.stg_customers'
[0m01:47:41.505070 [debug] [Thread-1 (]: Began compiling node model.ecommerce_analytics.stg_customers
[0m01:47:41.518060 [debug] [Thread-1 (]: Writing injected SQL for node "model.ecommerce_analytics.stg_customers"
[0m01:47:41.521118 [debug] [Thread-1 (]: Began executing node model.ecommerce_analytics.stg_customers
[0m01:47:41.546273 [debug] [Thread-1 (]: Writing runtime sql for node "model.ecommerce_analytics.stg_customers"
[0m01:47:41.546273 [debug] [Thread-1 (]: Using duckdb connection "model.ecommerce_analytics.stg_customers"
[0m01:47:41.556371 [debug] [Thread-1 (]: On model.ecommerce_analytics.stg_customers: BEGIN
[0m01:47:41.557654 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m01:47:41.557654 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m01:47:41.557654 [debug] [Thread-1 (]: Using duckdb connection "model.ecommerce_analytics.stg_customers"
[0m01:47:41.557654 [debug] [Thread-1 (]: On model.ecommerce_analytics.stg_customers: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "ecommerce_analytics", "target_name": "dev", "node_id": "model.ecommerce_analytics.stg_customers"} */

  
  create view "dev"."main"."stg_customers__dbt_tmp" as (
    WITH source AS (
    SELECT * FROM "dev"."main"."raw_customers"
),

renamed AS (
    SELECT
        customer_id,
        first_name || ' ' || last_name AS customer_name,
        email AS customer_email,
        phone,
        CAST(birth_date AS DATE) AS birth_date,
        city AS customer_city,
        country,
        postal_code,
        segment,
        CAST(registration_date AS DATE) AS registration_date,
        CAST(last_login AS DATE) AS last_login,
        is_verified,
        accepts_marketing
    FROM source
)

SELECT * FROM renamed
  );

[0m01:47:41.557654 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m01:47:41.570887 [debug] [Thread-1 (]: Using duckdb connection "model.ecommerce_analytics.stg_customers"
[0m01:47:41.570887 [debug] [Thread-1 (]: On model.ecommerce_analytics.stg_customers: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "ecommerce_analytics", "target_name": "dev", "node_id": "model.ecommerce_analytics.stg_customers"} */
alter view "dev"."main"."stg_customers" rename to "stg_customers__dbt_backup"
[0m01:47:41.572901 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m01:47:41.577144 [debug] [Thread-1 (]: Using duckdb connection "model.ecommerce_analytics.stg_customers"
[0m01:47:41.577144 [debug] [Thread-1 (]: On model.ecommerce_analytics.stg_customers: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "ecommerce_analytics", "target_name": "dev", "node_id": "model.ecommerce_analytics.stg_customers"} */
alter view "dev"."main"."stg_customers__dbt_tmp" rename to "stg_customers"
[0m01:47:41.577144 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m01:47:41.587753 [debug] [Thread-1 (]: On model.ecommerce_analytics.stg_customers: COMMIT
[0m01:47:41.587753 [debug] [Thread-1 (]: Using duckdb connection "model.ecommerce_analytics.stg_customers"
[0m01:47:41.587753 [debug] [Thread-1 (]: On model.ecommerce_analytics.stg_customers: COMMIT
[0m01:47:41.604438 [debug] [Thread-1 (]: SQL status: OK in 0.015 seconds
[0m01:47:41.613284 [debug] [Thread-1 (]: Using duckdb connection "model.ecommerce_analytics.stg_customers"
[0m01:47:41.613284 [debug] [Thread-1 (]: On model.ecommerce_analytics.stg_customers: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "ecommerce_analytics", "target_name": "dev", "node_id": "model.ecommerce_analytics.stg_customers"} */

      drop view if exists "dev"."main"."stg_customers__dbt_backup" cascade
    
[0m01:47:41.617949 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m01:47:41.618963 [debug] [Thread-1 (]: On model.ecommerce_analytics.stg_customers: Close
[0m01:47:41.618963 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8860ea79-504c-413a-8bee-8945a2f56c98', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015BB8511E90>]}
[0m01:47:41.618963 [info ] [Thread-1 (]: 1 of 6 OK created sql view model main.stg_customers ............................ [[32mOK[0m in 0.11s]
[0m01:47:41.618963 [debug] [Thread-1 (]: Finished running node model.ecommerce_analytics.stg_customers
[0m01:47:41.618963 [debug] [Thread-1 (]: Began running node model.ecommerce_analytics.stg_orders
[0m01:47:41.618963 [info ] [Thread-1 (]: 2 of 6 START sql view model main.stg_orders .................................... [RUN]
[0m01:47:41.618963 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ecommerce_analytics.stg_customers, now model.ecommerce_analytics.stg_orders)
[0m01:47:41.618963 [debug] [Thread-1 (]: Began compiling node model.ecommerce_analytics.stg_orders
[0m01:47:41.629079 [debug] [Thread-1 (]: Writing injected SQL for node "model.ecommerce_analytics.stg_orders"
[0m01:47:41.629079 [debug] [Thread-1 (]: Began executing node model.ecommerce_analytics.stg_orders
[0m01:47:41.637419 [debug] [Thread-1 (]: Writing runtime sql for node "model.ecommerce_analytics.stg_orders"
[0m01:47:41.639485 [debug] [Thread-1 (]: Using duckdb connection "model.ecommerce_analytics.stg_orders"
[0m01:47:41.640262 [debug] [Thread-1 (]: On model.ecommerce_analytics.stg_orders: BEGIN
[0m01:47:41.640262 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:47:41.640262 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m01:47:41.640262 [debug] [Thread-1 (]: Using duckdb connection "model.ecommerce_analytics.stg_orders"
[0m01:47:41.640262 [debug] [Thread-1 (]: On model.ecommerce_analytics.stg_orders: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "ecommerce_analytics", "target_name": "dev", "node_id": "model.ecommerce_analytics.stg_orders"} */

  
  create view "dev"."main"."stg_orders__dbt_tmp" as (
    WITH source AS (
    SELECT * FROM "dev"."main"."raw_orders"
),

renamed AS (
    SELECT
        order_id,
        order_number,
        customer_id,
        CAST(order_date AS DATE) AS order_date,
        status,
        CAST(subtotal AS DECIMAL(10,2)) AS subtotal,
        CAST(discount_percent AS DECIMAL(10,2)) AS discount_percent,
        CAST(shipping_cost AS DECIMAL(10,2)) AS shipping_cost,
        CAST(tax_amount AS DECIMAL(10,2)) AS tax_amount,
        CAST(total_amount AS DECIMAL(10,2)) AS total_amount,
        payment_method,
        shipping_method,
        promotion_id,
        notes
    FROM source
)

SELECT * FROM renamed
  );

[0m01:47:41.647229 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m01:47:41.650819 [debug] [Thread-1 (]: Using duckdb connection "model.ecommerce_analytics.stg_orders"
[0m01:47:41.650819 [debug] [Thread-1 (]: On model.ecommerce_analytics.stg_orders: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "ecommerce_analytics", "target_name": "dev", "node_id": "model.ecommerce_analytics.stg_orders"} */
alter view "dev"."main"."stg_orders" rename to "stg_orders__dbt_backup"
[0m01:47:41.653331 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m01:47:41.656482 [debug] [Thread-1 (]: Using duckdb connection "model.ecommerce_analytics.stg_orders"
[0m01:47:41.656482 [debug] [Thread-1 (]: On model.ecommerce_analytics.stg_orders: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "ecommerce_analytics", "target_name": "dev", "node_id": "model.ecommerce_analytics.stg_orders"} */
alter view "dev"."main"."stg_orders__dbt_tmp" rename to "stg_orders"
[0m01:47:41.660297 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m01:47:41.662193 [debug] [Thread-1 (]: On model.ecommerce_analytics.stg_orders: COMMIT
[0m01:47:41.664414 [debug] [Thread-1 (]: Using duckdb connection "model.ecommerce_analytics.stg_orders"
[0m01:47:41.664414 [debug] [Thread-1 (]: On model.ecommerce_analytics.stg_orders: COMMIT
[0m01:47:41.664414 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m01:47:41.664414 [debug] [Thread-1 (]: Using duckdb connection "model.ecommerce_analytics.stg_orders"
[0m01:47:41.670552 [debug] [Thread-1 (]: On model.ecommerce_analytics.stg_orders: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "ecommerce_analytics", "target_name": "dev", "node_id": "model.ecommerce_analytics.stg_orders"} */

      drop view if exists "dev"."main"."stg_orders__dbt_backup" cascade
    
[0m01:47:41.670552 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m01:47:41.674252 [debug] [Thread-1 (]: On model.ecommerce_analytics.stg_orders: Close
[0m01:47:41.674252 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8860ea79-504c-413a-8bee-8945a2f56c98', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015BB8587990>]}
[0m01:47:41.676641 [info ] [Thread-1 (]: 2 of 6 OK created sql view model main.stg_orders ............................... [[32mOK[0m in 0.06s]
[0m01:47:41.676641 [debug] [Thread-1 (]: Finished running node model.ecommerce_analytics.stg_orders
[0m01:47:41.676641 [debug] [Thread-1 (]: Began running node model.ecommerce_analytics.stg_products
[0m01:47:41.676641 [info ] [Thread-1 (]: 3 of 6 START sql view model main.stg_products .................................. [RUN]
[0m01:47:41.681042 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ecommerce_analytics.stg_orders, now model.ecommerce_analytics.stg_products)
[0m01:47:41.681042 [debug] [Thread-1 (]: Began compiling node model.ecommerce_analytics.stg_products
[0m01:47:41.681042 [debug] [Thread-1 (]: Writing injected SQL for node "model.ecommerce_analytics.stg_products"
[0m01:47:41.681042 [debug] [Thread-1 (]: Began executing node model.ecommerce_analytics.stg_products
[0m01:47:41.691576 [debug] [Thread-1 (]: Writing runtime sql for node "model.ecommerce_analytics.stg_products"
[0m01:47:41.691576 [debug] [Thread-1 (]: Using duckdb connection "model.ecommerce_analytics.stg_products"
[0m01:47:41.691576 [debug] [Thread-1 (]: On model.ecommerce_analytics.stg_products: BEGIN
[0m01:47:41.695740 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:47:41.696397 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m01:47:41.698206 [debug] [Thread-1 (]: Using duckdb connection "model.ecommerce_analytics.stg_products"
[0m01:47:41.698206 [debug] [Thread-1 (]: On model.ecommerce_analytics.stg_products: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "ecommerce_analytics", "target_name": "dev", "node_id": "model.ecommerce_analytics.stg_products"} */

  
  create view "dev"."main"."stg_products__dbt_tmp" as (
    WITH source AS (
    SELECT * FROM "dev"."main"."raw_products"
),

renamed AS (
    SELECT
        product_id,
        sku,
        product_name,
        description,
        category_id,
        brand_id,
        supplier_id,
        CAST(price AS DECIMAL(10,2)) AS price,
        CAST(cost AS DECIMAL(10,2)) AS cost,
        CAST(weight_kg AS DECIMAL(10,2)) AS weight_kg,
        is_active,
        CAST(created_at AS DATE) AS created_at,
        CAST(updated_at AS DATE) AS updated_at
    FROM source
)

SELECT * FROM renamed
  );

[0m01:47:41.698206 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m01:47:41.706538 [debug] [Thread-1 (]: Using duckdb connection "model.ecommerce_analytics.stg_products"
[0m01:47:41.706538 [debug] [Thread-1 (]: On model.ecommerce_analytics.stg_products: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "ecommerce_analytics", "target_name": "dev", "node_id": "model.ecommerce_analytics.stg_products"} */
alter view "dev"."main"."stg_products" rename to "stg_products__dbt_backup"
[0m01:47:41.709220 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m01:47:41.712513 [debug] [Thread-1 (]: Using duckdb connection "model.ecommerce_analytics.stg_products"
[0m01:47:41.712513 [debug] [Thread-1 (]: On model.ecommerce_analytics.stg_products: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "ecommerce_analytics", "target_name": "dev", "node_id": "model.ecommerce_analytics.stg_products"} */
alter view "dev"."main"."stg_products__dbt_tmp" rename to "stg_products"
[0m01:47:41.712513 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m01:47:41.712513 [debug] [Thread-1 (]: On model.ecommerce_analytics.stg_products: COMMIT
[0m01:47:41.718127 [debug] [Thread-1 (]: Using duckdb connection "model.ecommerce_analytics.stg_products"
[0m01:47:41.718127 [debug] [Thread-1 (]: On model.ecommerce_analytics.stg_products: COMMIT
[0m01:47:41.718127 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m01:47:41.726341 [debug] [Thread-1 (]: Using duckdb connection "model.ecommerce_analytics.stg_products"
[0m01:47:41.726341 [debug] [Thread-1 (]: On model.ecommerce_analytics.stg_products: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "ecommerce_analytics", "target_name": "dev", "node_id": "model.ecommerce_analytics.stg_products"} */

      drop view if exists "dev"."main"."stg_products__dbt_backup" cascade
    
[0m01:47:41.726341 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m01:47:41.726341 [debug] [Thread-1 (]: On model.ecommerce_analytics.stg_products: Close
[0m01:47:41.726341 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8860ea79-504c-413a-8bee-8945a2f56c98', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015BB96171D0>]}
[0m01:47:41.733205 [info ] [Thread-1 (]: 3 of 6 OK created sql view model main.stg_products ............................. [[32mOK[0m in 0.05s]
[0m01:47:41.733205 [debug] [Thread-1 (]: Finished running node model.ecommerce_analytics.stg_products
[0m01:47:41.733205 [debug] [Thread-1 (]: Began running node model.ecommerce_analytics.int_orders_enriched
[0m01:47:41.733205 [info ] [Thread-1 (]: 4 of 6 START sql view model main.int_orders_enriched ........................... [RUN]
[0m01:47:41.733205 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ecommerce_analytics.stg_products, now model.ecommerce_analytics.int_orders_enriched)
[0m01:47:41.738353 [debug] [Thread-1 (]: Began compiling node model.ecommerce_analytics.int_orders_enriched
[0m01:47:41.741005 [debug] [Thread-1 (]: Writing injected SQL for node "model.ecommerce_analytics.int_orders_enriched"
[0m01:47:41.743867 [debug] [Thread-1 (]: Began executing node model.ecommerce_analytics.int_orders_enriched
[0m01:47:41.746795 [debug] [Thread-1 (]: Writing runtime sql for node "model.ecommerce_analytics.int_orders_enriched"
[0m01:47:41.746795 [debug] [Thread-1 (]: Using duckdb connection "model.ecommerce_analytics.int_orders_enriched"
[0m01:47:41.746795 [debug] [Thread-1 (]: On model.ecommerce_analytics.int_orders_enriched: BEGIN
[0m01:47:41.746795 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:47:41.746795 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m01:47:41.746795 [debug] [Thread-1 (]: Using duckdb connection "model.ecommerce_analytics.int_orders_enriched"
[0m01:47:41.746795 [debug] [Thread-1 (]: On model.ecommerce_analytics.int_orders_enriched: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "ecommerce_analytics", "target_name": "dev", "node_id": "model.ecommerce_analytics.int_orders_enriched"} */

  
  create view "dev"."main"."int_orders_enriched__dbt_tmp" as (
    WITH orders AS (
    SELECT * FROM "dev"."main"."stg_orders"
),

customers AS (
    SELECT * FROM "dev"."main"."stg_customers"
),

enriched AS (
    SELECT
        o.order_id,
        o.order_number,
        o.order_date,
        o.status,
        o.subtotal,
        o.discount_percent,
        o.shipping_cost,
        o.tax_amount,
        o.total_amount,
        o.payment_method,
        o.shipping_method,
        o.promotion_id,
        o.notes,
        
        -- Customer info
        c.customer_id,
        c.customer_name,
        c.customer_email,
        c.customer_city,
        
        -- Calculated fields
        DATE_TRUNC('month', o.order_date) AS order_month,
        CASE 
            WHEN o.total_amount > 1000 THEN 'High Value'
            WHEN o.total_amount > 500 THEN 'Medium Value'
            ELSE 'Low Value'
        END AS order_tier
        
    FROM orders o
    LEFT JOIN customers c ON o.customer_id = c.customer_id
)

SELECT * FROM enriched
  );

[0m01:47:41.754236 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m01:47:41.759666 [debug] [Thread-1 (]: Using duckdb connection "model.ecommerce_analytics.int_orders_enriched"
[0m01:47:41.759666 [debug] [Thread-1 (]: On model.ecommerce_analytics.int_orders_enriched: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "ecommerce_analytics", "target_name": "dev", "node_id": "model.ecommerce_analytics.int_orders_enriched"} */
alter view "dev"."main"."int_orders_enriched__dbt_tmp" rename to "int_orders_enriched"
[0m01:47:41.762061 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m01:47:41.762061 [debug] [Thread-1 (]: On model.ecommerce_analytics.int_orders_enriched: COMMIT
[0m01:47:41.764995 [debug] [Thread-1 (]: Using duckdb connection "model.ecommerce_analytics.int_orders_enriched"
[0m01:47:41.764995 [debug] [Thread-1 (]: On model.ecommerce_analytics.int_orders_enriched: COMMIT
[0m01:47:41.766071 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m01:47:41.766071 [debug] [Thread-1 (]: Using duckdb connection "model.ecommerce_analytics.int_orders_enriched"
[0m01:47:41.766071 [debug] [Thread-1 (]: On model.ecommerce_analytics.int_orders_enriched: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "ecommerce_analytics", "target_name": "dev", "node_id": "model.ecommerce_analytics.int_orders_enriched"} */

      drop view if exists "dev"."main"."int_orders_enriched__dbt_backup" cascade
    
[0m01:47:41.766071 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m01:47:41.766071 [debug] [Thread-1 (]: On model.ecommerce_analytics.int_orders_enriched: Close
[0m01:47:41.774173 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8860ea79-504c-413a-8bee-8945a2f56c98', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015BB9617450>]}
[0m01:47:41.775096 [info ] [Thread-1 (]: 4 of 6 OK created sql view model main.int_orders_enriched ...................... [[32mOK[0m in 0.03s]
[0m01:47:41.776317 [debug] [Thread-1 (]: Finished running node model.ecommerce_analytics.int_orders_enriched
[0m01:47:41.776317 [debug] [Thread-1 (]: Began running node model.ecommerce_analytics.dim_customers
[0m01:47:41.776317 [info ] [Thread-1 (]: 5 of 6 START sql table model main.dim_customers ................................ [RUN]
[0m01:47:41.776317 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ecommerce_analytics.int_orders_enriched, now model.ecommerce_analytics.dim_customers)
[0m01:47:41.776317 [debug] [Thread-1 (]: Began compiling node model.ecommerce_analytics.dim_customers
[0m01:47:41.784478 [debug] [Thread-1 (]: Writing injected SQL for node "model.ecommerce_analytics.dim_customers"
[0m01:47:41.785484 [debug] [Thread-1 (]: Began executing node model.ecommerce_analytics.dim_customers
[0m01:47:41.806950 [debug] [Thread-1 (]: Writing runtime sql for node "model.ecommerce_analytics.dim_customers"
[0m01:47:41.810046 [debug] [Thread-1 (]: Using duckdb connection "model.ecommerce_analytics.dim_customers"
[0m01:47:41.810726 [debug] [Thread-1 (]: On model.ecommerce_analytics.dim_customers: BEGIN
[0m01:47:41.810726 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:47:41.810726 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m01:47:41.810726 [debug] [Thread-1 (]: Using duckdb connection "model.ecommerce_analytics.dim_customers"
[0m01:47:41.810726 [debug] [Thread-1 (]: On model.ecommerce_analytics.dim_customers: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "ecommerce_analytics", "target_name": "dev", "node_id": "model.ecommerce_analytics.dim_customers"} */

  
    
    

    create  table
      "dev"."main"."dim_customers__dbt_tmp"
  
    as (
      

WITH customers AS (
    SELECT DISTINCT
        customer_id,
        customer_name,
        customer_email,
        customer_city
    FROM "dev"."main"."int_orders_enriched"
)

SELECT * FROM customers
    );
  
  
[0m01:47:41.848833 [debug] [Thread-1 (]: SQL status: OK in 0.035 seconds
[0m01:47:41.848833 [debug] [Thread-1 (]: Using duckdb connection "model.ecommerce_analytics.dim_customers"
[0m01:47:41.848833 [debug] [Thread-1 (]: On model.ecommerce_analytics.dim_customers: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "ecommerce_analytics", "target_name": "dev", "node_id": "model.ecommerce_analytics.dim_customers"} */
alter table "dev"."main"."dim_customers__dbt_tmp" rename to "dim_customers"
[0m01:47:41.848833 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m01:47:41.859474 [debug] [Thread-1 (]: On model.ecommerce_analytics.dim_customers: COMMIT
[0m01:47:41.859474 [debug] [Thread-1 (]: Using duckdb connection "model.ecommerce_analytics.dim_customers"
[0m01:47:41.859474 [debug] [Thread-1 (]: On model.ecommerce_analytics.dim_customers: COMMIT
[0m01:47:41.859474 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m01:47:41.865460 [debug] [Thread-1 (]: Using duckdb connection "model.ecommerce_analytics.dim_customers"
[0m01:47:41.865460 [debug] [Thread-1 (]: On model.ecommerce_analytics.dim_customers: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "ecommerce_analytics", "target_name": "dev", "node_id": "model.ecommerce_analytics.dim_customers"} */

      drop table if exists "dev"."main"."dim_customers__dbt_backup" cascade
    
[0m01:47:41.865460 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m01:47:41.870854 [debug] [Thread-1 (]: On model.ecommerce_analytics.dim_customers: Close
[0m01:47:41.870854 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8860ea79-504c-413a-8bee-8945a2f56c98', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015BB963D1D0>]}
[0m01:47:41.870854 [info ] [Thread-1 (]: 5 of 6 OK created sql table model main.dim_customers ........................... [[32mOK[0m in 0.09s]
[0m01:47:41.874454 [debug] [Thread-1 (]: Finished running node model.ecommerce_analytics.dim_customers
[0m01:47:41.874454 [debug] [Thread-1 (]: Began running node model.ecommerce_analytics.dim_products
[0m01:47:41.874454 [info ] [Thread-1 (]: 6 of 6 START sql table model main.dim_products ................................. [RUN]
[0m01:47:41.874454 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ecommerce_analytics.dim_customers, now model.ecommerce_analytics.dim_products)
[0m01:47:41.874454 [debug] [Thread-1 (]: Began compiling node model.ecommerce_analytics.dim_products
[0m01:47:41.882078 [debug] [Thread-1 (]: Writing injected SQL for node "model.ecommerce_analytics.dim_products"
[0m01:47:41.882078 [debug] [Thread-1 (]: Began executing node model.ecommerce_analytics.dim_products
[0m01:47:41.882078 [debug] [Thread-1 (]: Writing runtime sql for node "model.ecommerce_analytics.dim_products"
[0m01:47:41.890798 [debug] [Thread-1 (]: Using duckdb connection "model.ecommerce_analytics.dim_products"
[0m01:47:41.893056 [debug] [Thread-1 (]: On model.ecommerce_analytics.dim_products: BEGIN
[0m01:47:41.894041 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:47:41.894041 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m01:47:41.894041 [debug] [Thread-1 (]: Using duckdb connection "model.ecommerce_analytics.dim_products"
[0m01:47:41.894041 [debug] [Thread-1 (]: On model.ecommerce_analytics.dim_products: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "ecommerce_analytics", "target_name": "dev", "node_id": "model.ecommerce_analytics.dim_products"} */

  
    
    

    create  table
      "dev"."main"."dim_products__dbt_tmp"
  
    as (
      

WITH products AS (
    SELECT DISTINCT
        product_id,
        product_name,
        category,
        price,
        cost,
        weight_kg
    FROM "dev"."main"."int_orders_enriched"
)

SELECT * FROM products
    );
  
  
[0m01:47:41.898908 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "ecommerce_analytics", "target_name": "dev", "node_id": "model.ecommerce_analytics.dim_products"} */

  
    
    

    create  table
      "dev"."main"."dim_products__dbt_tmp"
  
    as (
      

WITH products AS (
    SELECT DISTINCT
        product_id,
        product_name,
        category,
        price,
        cost,
        weight_kg
    FROM "dev"."main"."int_orders_enriched"
)

SELECT * FROM products
    );
  
  
[0m01:47:41.898908 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m01:47:41.898908 [debug] [Thread-1 (]: On model.ecommerce_analytics.dim_products: ROLLBACK
[0m01:47:41.901440 [debug] [Thread-1 (]: Failed to rollback 'model.ecommerce_analytics.dim_products'
[0m01:47:41.901440 [debug] [Thread-1 (]: On model.ecommerce_analytics.dim_products: Close
[0m01:47:41.907837 [debug] [Thread-1 (]: Runtime Error in model dim_products (models\example\marts\dim_products.sql)
  Binder Error: Referenced column "product_id" not found in FROM clause!
  Candidate bindings: "promotion_id", "order_id", "customer_id", "customer_email", "customer_city"
  
  LINE 15:         product_id,
                   ^
[0m01:47:41.908938 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8860ea79-504c-413a-8bee-8945a2f56c98', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015BB85B1CD0>]}
[0m01:47:41.909252 [error] [Thread-1 (]: 6 of 6 ERROR creating sql table model main.dim_products ........................ [[31mERROR[0m in 0.03s]
[0m01:47:41.912010 [debug] [Thread-1 (]: Finished running node model.ecommerce_analytics.dim_products
[0m01:47:41.912010 [debug] [Thread-4 (]: Marking all children of 'model.ecommerce_analytics.dim_products' to be skipped because of status 'error'.  Reason: Runtime Error in model dim_products (models\example\marts\dim_products.sql)
  Binder Error: Referenced column "product_id" not found in FROM clause!
  Candidate bindings: "promotion_id", "order_id", "customer_id", "customer_email", "customer_city"
  
  LINE 15:         product_id,
                   ^.
[0m01:47:41.912010 [debug] [MainThread]: Using duckdb connection "master"
[0m01:47:41.912010 [debug] [MainThread]: On master: BEGIN
[0m01:47:41.915940 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m01:47:41.915940 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m01:47:41.915940 [debug] [MainThread]: On master: COMMIT
[0m01:47:41.915940 [debug] [MainThread]: Using duckdb connection "master"
[0m01:47:41.915940 [debug] [MainThread]: On master: COMMIT
[0m01:47:41.918544 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m01:47:41.919520 [debug] [MainThread]: On master: Close
[0m01:47:41.919520 [debug] [MainThread]: Connection 'master' was properly closed.
[0m01:47:41.921438 [debug] [MainThread]: Connection 'create_dev_main' was properly closed.
[0m01:47:41.922037 [debug] [MainThread]: Connection 'list_dev_main' was properly closed.
[0m01:47:41.922037 [debug] [MainThread]: Connection 'model.ecommerce_analytics.dim_products' was properly closed.
[0m01:47:41.922037 [info ] [MainThread]: 
[0m01:47:41.924109 [info ] [MainThread]: Finished running 2 table models, 4 view models in 0 hours 0 minutes and 0.63 seconds (0.63s).
[0m01:47:41.926390 [debug] [MainThread]: Command end result
[0m01:47:41.973912 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\Lenovo\Desktop\Proyectos\dbt-proyect\ecommerce_analytics\target\manifest.json
[0m01:47:41.977262 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\Lenovo\Desktop\Proyectos\dbt-proyect\ecommerce_analytics\target\semantic_manifest.json
[0m01:47:41.988233 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\Lenovo\Desktop\Proyectos\dbt-proyect\ecommerce_analytics\target\run_results.json
[0m01:47:41.988233 [info ] [MainThread]: 
[0m01:47:41.988233 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m01:47:41.990806 [info ] [MainThread]: 
[0m01:47:41.990806 [error] [MainThread]: [31mFailure in model dim_products (models\example\marts\dim_products.sql)[0m
[0m01:47:41.990806 [error] [MainThread]:   Runtime Error in model dim_products (models\example\marts\dim_products.sql)
  Binder Error: Referenced column "product_id" not found in FROM clause!
  Candidate bindings: "promotion_id", "order_id", "customer_id", "customer_email", "customer_city"
  
  LINE 15:         product_id,
                   ^
[0m01:47:41.990806 [info ] [MainThread]: 
[0m01:47:41.994591 [info ] [MainThread]:   compiled code at target\compiled\ecommerce_analytics\models\example\marts\dim_products.sql
[0m01:47:41.994591 [info ] [MainThread]: 
[0m01:47:41.996337 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=6
[0m01:47:41.997213 [debug] [MainThread]: Command `dbt run` failed at 01:47:41.997213 after 2.04 seconds
[0m01:47:41.997213 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015BB5577A90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015BAFBD4C10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015BAFBD4C50>]}
[0m01:47:41.997213 [debug] [MainThread]: Flushing usage events
[0m01:47:43.549627 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m01:48:25.135343 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001787B9DFD90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001787B9DEED0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001787B9DD150>]}


============================== 01:48:25.136551 | 3adc932d-1a30-4fd3-8a4e-d5a1aa876f52 ==============================
[0m01:48:25.136551 [info ] [MainThread]: Running with dbt=1.11.2
[0m01:48:25.136551 [debug] [MainThread]: running dbt with arguments {'static_parser': 'True', 'no_print': 'None', 'version_check': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'printer_width': '80', 'write_json': 'True', 'introspect': 'True', 'log_cache_events': 'False', 'empty': 'False', 'cache_selected_only': 'False', 'log_format': 'default', 'debug': 'False', 'fail_fast': 'False', 'partial_parse': 'True', 'send_anonymous_usage_stats': 'True', 'quiet': 'False', 'warn_error': 'None', 'profiles_dir': 'C:\\Users\\Lenovo\\.dbt', 'indirect_selection': 'eager', 'invocation_command': 'dbt run', 'use_colors': 'True', 'use_experimental_parser': 'False', 'log_path': 'C:\\Users\\Lenovo\\Desktop\\Proyectos\\dbt-proyect\\ecommerce_analytics\\logs'}
[0m01:48:25.365277 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '3adc932d-1a30-4fd3-8a4e-d5a1aa876f52', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001787BAAB9D0>]}
[0m01:48:25.429454 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '3adc932d-1a30-4fd3-8a4e-d5a1aa876f52', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017878393C90>]}
[0m01:48:25.430966 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m01:48:25.684889 [debug] [MainThread]: checksum: 3d40d8bbe1bef07db1c24822f2dbfff8bc07f2a48ed4fe2658a40653aec0b54b, vars: {}, profile: , target: , version: 1.11.2
[0m01:48:25.918260 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m01:48:25.919344 [debug] [MainThread]: Partial parsing: updated file: ecommerce_analytics://models\example\marts\dim_products.sql
[0m01:48:26.232382 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '3adc932d-1a30-4fd3-8a4e-d5a1aa876f52', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001787D19D690>]}
[0m01:48:26.323739 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\Lenovo\Desktop\Proyectos\dbt-proyect\ecommerce_analytics\target\manifest.json
[0m01:48:26.327029 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\Lenovo\Desktop\Proyectos\dbt-proyect\ecommerce_analytics\target\semantic_manifest.json
[0m01:48:26.357994 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '3adc932d-1a30-4fd3-8a4e-d5a1aa876f52', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001787D2F3E10>]}
[0m01:48:26.359098 [info ] [MainThread]: Found 7 models, 3 seeds, 14 data tests, 587 macros
[0m01:48:26.360697 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3adc932d-1a30-4fd3-8a4e-d5a1aa876f52', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001787D185390>]}
[0m01:48:26.366146 [info ] [MainThread]: 
[0m01:48:26.367242 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m01:48:26.368335 [info ] [MainThread]: 
[0m01:48:26.369401 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m01:48:26.378245 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_dev'
[0m01:48:26.471114 [debug] [ThreadPool]: Using duckdb connection "list_dev"
[0m01:48:26.471654 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "ecommerce_analytics", "target_name": "dev", "connection_name": "list_dev"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"dev"'
    
  
  
[0m01:48:26.472248 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:48:26.522547 [debug] [ThreadPool]: SQL status: OK in 0.052 seconds
[0m01:48:26.525837 [debug] [ThreadPool]: On list_dev: Close
[0m01:48:26.526975 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev, now create_dev_main)
[0m01:48:26.527572 [debug] [ThreadPool]: Creating schema "database: "dev"
schema: "main"
"
[0m01:48:26.535900 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m01:48:26.537024 [debug] [ThreadPool]: On create_dev_main: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "ecommerce_analytics", "target_name": "dev", "connection_name": "create_dev_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='dev'
        and type='sqlite'
    
  
[0m01:48:26.537563 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m01:48:26.538650 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m01:48:26.540406 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m01:48:26.540957 [debug] [ThreadPool]: On create_dev_main: BEGIN
[0m01:48:26.541485 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m01:48:26.542035 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m01:48:26.542584 [debug] [ThreadPool]: On create_dev_main: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "ecommerce_analytics", "target_name": "dev", "connection_name": "create_dev_main"} */

    
    
        create schema if not exists "dev"."main"
    
[0m01:48:26.543658 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m01:48:26.544727 [debug] [ThreadPool]: On create_dev_main: COMMIT
[0m01:48:26.545813 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m01:48:26.546350 [debug] [ThreadPool]: On create_dev_main: COMMIT
[0m01:48:26.547439 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m01:48:26.547980 [debug] [ThreadPool]: On create_dev_main: Close
[0m01:48:26.550135 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_dev_main'
[0m01:48:26.556745 [debug] [ThreadPool]: Using duckdb connection "list_dev_main"
[0m01:48:26.557285 [debug] [ThreadPool]: On list_dev_main: BEGIN
[0m01:48:26.558221 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:48:26.559982 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m01:48:26.560513 [debug] [ThreadPool]: Using duckdb connection "list_dev_main"
[0m01:48:26.560513 [debug] [ThreadPool]: On list_dev_main: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "ecommerce_analytics", "target_name": "dev", "connection_name": "list_dev_main"} */
select
      'dev' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'dev'
  
[0m01:48:26.581046 [debug] [ThreadPool]: SQL status: OK in 0.019 seconds
[0m01:48:26.582907 [debug] [ThreadPool]: On list_dev_main: ROLLBACK
[0m01:48:26.584053 [debug] [ThreadPool]: Failed to rollback 'list_dev_main'
[0m01:48:26.584607 [debug] [ThreadPool]: On list_dev_main: Close
[0m01:48:26.585161 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3adc932d-1a30-4fd3-8a4e-d5a1aa876f52', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001787B2203D0>]}
[0m01:48:26.585161 [debug] [MainThread]: Using duckdb connection "master"
[0m01:48:26.585161 [debug] [MainThread]: On master: BEGIN
[0m01:48:26.585161 [debug] [MainThread]: Opening a new connection, currently in state init
[0m01:48:26.585161 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m01:48:26.585161 [debug] [MainThread]: On master: COMMIT
[0m01:48:26.590860 [debug] [MainThread]: Using duckdb connection "master"
[0m01:48:26.591539 [debug] [MainThread]: On master: COMMIT
[0m01:48:26.592369 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m01:48:26.592941 [debug] [MainThread]: On master: Close
[0m01:48:26.594048 [debug] [Thread-1 (]: Began running node model.ecommerce_analytics.stg_customers
[0m01:48:26.597113 [info ] [Thread-1 (]: 1 of 6 START sql view model main.stg_customers ................................. [RUN]
[0m01:48:26.598890 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.ecommerce_analytics.stg_customers'
[0m01:48:26.599516 [debug] [Thread-1 (]: Began compiling node model.ecommerce_analytics.stg_customers
[0m01:48:26.610784 [debug] [Thread-1 (]: Writing injected SQL for node "model.ecommerce_analytics.stg_customers"
[0m01:48:26.611836 [debug] [Thread-1 (]: Began executing node model.ecommerce_analytics.stg_customers
[0m01:48:26.646717 [debug] [Thread-1 (]: Writing runtime sql for node "model.ecommerce_analytics.stg_customers"
[0m01:48:26.650595 [debug] [Thread-1 (]: Using duckdb connection "model.ecommerce_analytics.stg_customers"
[0m01:48:26.663090 [debug] [Thread-1 (]: On model.ecommerce_analytics.stg_customers: BEGIN
[0m01:48:26.663090 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m01:48:26.665423 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m01:48:26.666322 [debug] [Thread-1 (]: Using duckdb connection "model.ecommerce_analytics.stg_customers"
[0m01:48:26.666322 [debug] [Thread-1 (]: On model.ecommerce_analytics.stg_customers: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "ecommerce_analytics", "target_name": "dev", "node_id": "model.ecommerce_analytics.stg_customers"} */

  
  create view "dev"."main"."stg_customers__dbt_tmp" as (
    WITH source AS (
    SELECT * FROM "dev"."main"."raw_customers"
),

renamed AS (
    SELECT
        customer_id,
        first_name || ' ' || last_name AS customer_name,
        email AS customer_email,
        phone,
        CAST(birth_date AS DATE) AS birth_date,
        city AS customer_city,
        country,
        postal_code,
        segment,
        CAST(registration_date AS DATE) AS registration_date,
        CAST(last_login AS DATE) AS last_login,
        is_verified,
        accepts_marketing
    FROM source
)

SELECT * FROM renamed
  );

[0m01:48:26.666322 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m01:48:26.678200 [debug] [Thread-1 (]: Using duckdb connection "model.ecommerce_analytics.stg_customers"
[0m01:48:26.678752 [debug] [Thread-1 (]: On model.ecommerce_analytics.stg_customers: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "ecommerce_analytics", "target_name": "dev", "node_id": "model.ecommerce_analytics.stg_customers"} */
alter view "dev"."main"."stg_customers" rename to "stg_customers__dbt_backup"
[0m01:48:26.679857 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m01:48:26.684871 [debug] [Thread-1 (]: Using duckdb connection "model.ecommerce_analytics.stg_customers"
[0m01:48:26.685441 [debug] [Thread-1 (]: On model.ecommerce_analytics.stg_customers: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "ecommerce_analytics", "target_name": "dev", "node_id": "model.ecommerce_analytics.stg_customers"} */
alter view "dev"."main"."stg_customers__dbt_tmp" rename to "stg_customers"
[0m01:48:26.687090 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m01:48:26.705167 [debug] [Thread-1 (]: On model.ecommerce_analytics.stg_customers: COMMIT
[0m01:48:26.707200 [debug] [Thread-1 (]: Using duckdb connection "model.ecommerce_analytics.stg_customers"
[0m01:48:26.707200 [debug] [Thread-1 (]: On model.ecommerce_analytics.stg_customers: COMMIT
[0m01:48:26.715123 [debug] [Thread-1 (]: SQL status: OK in 0.006 seconds
[0m01:48:26.724559 [debug] [Thread-1 (]: Using duckdb connection "model.ecommerce_analytics.stg_customers"
[0m01:48:26.726216 [debug] [Thread-1 (]: On model.ecommerce_analytics.stg_customers: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "ecommerce_analytics", "target_name": "dev", "node_id": "model.ecommerce_analytics.stg_customers"} */

      drop view if exists "dev"."main"."stg_customers__dbt_backup" cascade
    
[0m01:48:26.728461 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m01:48:26.733517 [debug] [Thread-1 (]: On model.ecommerce_analytics.stg_customers: Close
[0m01:48:26.737990 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3adc932d-1a30-4fd3-8a4e-d5a1aa876f52', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001787CAE1550>]}
[0m01:48:26.738557 [info ] [Thread-1 (]: 1 of 6 OK created sql view model main.stg_customers ............................ [[32mOK[0m in 0.14s]
[0m01:48:26.738557 [debug] [Thread-1 (]: Finished running node model.ecommerce_analytics.stg_customers
[0m01:48:26.738557 [debug] [Thread-1 (]: Began running node model.ecommerce_analytics.stg_orders
[0m01:48:26.738557 [info ] [Thread-1 (]: 2 of 6 START sql view model main.stg_orders .................................... [RUN]
[0m01:48:26.743633 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ecommerce_analytics.stg_customers, now model.ecommerce_analytics.stg_orders)
[0m01:48:26.743633 [debug] [Thread-1 (]: Began compiling node model.ecommerce_analytics.stg_orders
[0m01:48:26.748805 [debug] [Thread-1 (]: Writing injected SQL for node "model.ecommerce_analytics.stg_orders"
[0m01:48:26.749495 [debug] [Thread-1 (]: Began executing node model.ecommerce_analytics.stg_orders
[0m01:48:26.749495 [debug] [Thread-1 (]: Writing runtime sql for node "model.ecommerce_analytics.stg_orders"
[0m01:48:26.749495 [debug] [Thread-1 (]: Using duckdb connection "model.ecommerce_analytics.stg_orders"
[0m01:48:26.749495 [debug] [Thread-1 (]: On model.ecommerce_analytics.stg_orders: BEGIN
[0m01:48:26.749495 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:48:26.756952 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m01:48:26.756952 [debug] [Thread-1 (]: Using duckdb connection "model.ecommerce_analytics.stg_orders"
[0m01:48:26.757579 [debug] [Thread-1 (]: On model.ecommerce_analytics.stg_orders: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "ecommerce_analytics", "target_name": "dev", "node_id": "model.ecommerce_analytics.stg_orders"} */

  
  create view "dev"."main"."stg_orders__dbt_tmp" as (
    WITH source AS (
    SELECT * FROM "dev"."main"."raw_orders"
),

renamed AS (
    SELECT
        order_id,
        order_number,
        customer_id,
        CAST(order_date AS DATE) AS order_date,
        status,
        CAST(subtotal AS DECIMAL(10,2)) AS subtotal,
        CAST(discount_percent AS DECIMAL(10,2)) AS discount_percent,
        CAST(shipping_cost AS DECIMAL(10,2)) AS shipping_cost,
        CAST(tax_amount AS DECIMAL(10,2)) AS tax_amount,
        CAST(total_amount AS DECIMAL(10,2)) AS total_amount,
        payment_method,
        shipping_method,
        promotion_id,
        notes
    FROM source
)

SELECT * FROM renamed
  );

[0m01:48:26.759403 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m01:48:26.761375 [debug] [Thread-1 (]: Using duckdb connection "model.ecommerce_analytics.stg_orders"
[0m01:48:26.761375 [debug] [Thread-1 (]: On model.ecommerce_analytics.stg_orders: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "ecommerce_analytics", "target_name": "dev", "node_id": "model.ecommerce_analytics.stg_orders"} */
alter view "dev"."main"."stg_orders" rename to "stg_orders__dbt_backup"
[0m01:48:26.764927 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m01:48:26.768054 [debug] [Thread-1 (]: Using duckdb connection "model.ecommerce_analytics.stg_orders"
[0m01:48:26.770352 [debug] [Thread-1 (]: On model.ecommerce_analytics.stg_orders: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "ecommerce_analytics", "target_name": "dev", "node_id": "model.ecommerce_analytics.stg_orders"} */
alter view "dev"."main"."stg_orders__dbt_tmp" rename to "stg_orders"
[0m01:48:26.772587 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m01:48:26.773326 [debug] [Thread-1 (]: On model.ecommerce_analytics.stg_orders: COMMIT
[0m01:48:26.775737 [debug] [Thread-1 (]: Using duckdb connection "model.ecommerce_analytics.stg_orders"
[0m01:48:26.777408 [debug] [Thread-1 (]: On model.ecommerce_analytics.stg_orders: COMMIT
[0m01:48:26.779928 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m01:48:26.784565 [debug] [Thread-1 (]: Using duckdb connection "model.ecommerce_analytics.stg_orders"
[0m01:48:26.784565 [debug] [Thread-1 (]: On model.ecommerce_analytics.stg_orders: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "ecommerce_analytics", "target_name": "dev", "node_id": "model.ecommerce_analytics.stg_orders"} */

      drop view if exists "dev"."main"."stg_orders__dbt_backup" cascade
    
[0m01:48:26.784565 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m01:48:26.788617 [debug] [Thread-1 (]: On model.ecommerce_analytics.stg_orders: Close
[0m01:48:26.791605 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3adc932d-1a30-4fd3-8a4e-d5a1aa876f52', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001787D43BE50>]}
[0m01:48:26.792254 [info ] [Thread-1 (]: 2 of 6 OK created sql view model main.stg_orders ............................... [[32mOK[0m in 0.05s]
[0m01:48:26.794654 [debug] [Thread-1 (]: Finished running node model.ecommerce_analytics.stg_orders
[0m01:48:26.795195 [debug] [Thread-1 (]: Began running node model.ecommerce_analytics.stg_products
[0m01:48:26.796952 [info ] [Thread-1 (]: 3 of 6 START sql view model main.stg_products .................................. [RUN]
[0m01:48:26.798033 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ecommerce_analytics.stg_orders, now model.ecommerce_analytics.stg_products)
[0m01:48:26.798589 [debug] [Thread-1 (]: Began compiling node model.ecommerce_analytics.stg_products
[0m01:48:26.803031 [debug] [Thread-1 (]: Writing injected SQL for node "model.ecommerce_analytics.stg_products"
[0m01:48:26.804804 [debug] [Thread-1 (]: Began executing node model.ecommerce_analytics.stg_products
[0m01:48:26.811816 [debug] [Thread-1 (]: Writing runtime sql for node "model.ecommerce_analytics.stg_products"
[0m01:48:26.813880 [debug] [Thread-1 (]: Using duckdb connection "model.ecommerce_analytics.stg_products"
[0m01:48:26.815532 [debug] [Thread-1 (]: On model.ecommerce_analytics.stg_products: BEGIN
[0m01:48:26.816689 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:48:26.817934 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m01:48:26.818475 [debug] [Thread-1 (]: Using duckdb connection "model.ecommerce_analytics.stg_products"
[0m01:48:26.819561 [debug] [Thread-1 (]: On model.ecommerce_analytics.stg_products: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "ecommerce_analytics", "target_name": "dev", "node_id": "model.ecommerce_analytics.stg_products"} */

  
  create view "dev"."main"."stg_products__dbt_tmp" as (
    WITH source AS (
    SELECT * FROM "dev"."main"."raw_products"
),

renamed AS (
    SELECT
        product_id,
        sku,
        product_name,
        description,
        category_id,
        brand_id,
        supplier_id,
        CAST(price AS DECIMAL(10,2)) AS price,
        CAST(cost AS DECIMAL(10,2)) AS cost,
        CAST(weight_kg AS DECIMAL(10,2)) AS weight_kg,
        is_active,
        CAST(created_at AS DATE) AS created_at,
        CAST(updated_at AS DATE) AS updated_at
    FROM source
)

SELECT * FROM renamed
  );

[0m01:48:26.821177 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m01:48:26.825552 [debug] [Thread-1 (]: Using duckdb connection "model.ecommerce_analytics.stg_products"
[0m01:48:26.825552 [debug] [Thread-1 (]: On model.ecommerce_analytics.stg_products: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "ecommerce_analytics", "target_name": "dev", "node_id": "model.ecommerce_analytics.stg_products"} */
alter view "dev"."main"."stg_products" rename to "stg_products__dbt_backup"
[0m01:48:26.827572 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m01:48:26.832489 [debug] [Thread-1 (]: Using duckdb connection "model.ecommerce_analytics.stg_products"
[0m01:48:26.833055 [debug] [Thread-1 (]: On model.ecommerce_analytics.stg_products: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "ecommerce_analytics", "target_name": "dev", "node_id": "model.ecommerce_analytics.stg_products"} */
alter view "dev"."main"."stg_products__dbt_tmp" rename to "stg_products"
[0m01:48:26.834849 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m01:48:26.835407 [debug] [Thread-1 (]: On model.ecommerce_analytics.stg_products: COMMIT
[0m01:48:26.835407 [debug] [Thread-1 (]: Using duckdb connection "model.ecommerce_analytics.stg_products"
[0m01:48:26.835407 [debug] [Thread-1 (]: On model.ecommerce_analytics.stg_products: COMMIT
[0m01:48:26.838014 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m01:48:26.844961 [debug] [Thread-1 (]: Using duckdb connection "model.ecommerce_analytics.stg_products"
[0m01:48:26.846053 [debug] [Thread-1 (]: On model.ecommerce_analytics.stg_products: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "ecommerce_analytics", "target_name": "dev", "node_id": "model.ecommerce_analytics.stg_products"} */

      drop view if exists "dev"."main"."stg_products__dbt_backup" cascade
    
[0m01:48:26.848318 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m01:48:26.850031 [debug] [Thread-1 (]: On model.ecommerce_analytics.stg_products: Close
[0m01:48:26.851169 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3adc932d-1a30-4fd3-8a4e-d5a1aa876f52', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001787E6B0F10>]}
[0m01:48:26.851715 [info ] [Thread-1 (]: 3 of 6 OK created sql view model main.stg_products ............................. [[32mOK[0m in 0.05s]
[0m01:48:26.852865 [debug] [Thread-1 (]: Finished running node model.ecommerce_analytics.stg_products
[0m01:48:26.853390 [debug] [Thread-1 (]: Began running node model.ecommerce_analytics.int_orders_enriched
[0m01:48:26.854503 [info ] [Thread-1 (]: 4 of 6 START sql view model main.int_orders_enriched ........................... [RUN]
[0m01:48:26.855610 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ecommerce_analytics.stg_products, now model.ecommerce_analytics.int_orders_enriched)
[0m01:48:26.856141 [debug] [Thread-1 (]: Began compiling node model.ecommerce_analytics.int_orders_enriched
[0m01:48:26.860632 [debug] [Thread-1 (]: Writing injected SQL for node "model.ecommerce_analytics.int_orders_enriched"
[0m01:48:26.862280 [debug] [Thread-1 (]: Began executing node model.ecommerce_analytics.int_orders_enriched
[0m01:48:26.866650 [debug] [Thread-1 (]: Writing runtime sql for node "model.ecommerce_analytics.int_orders_enriched"
[0m01:48:26.867765 [debug] [Thread-1 (]: Using duckdb connection "model.ecommerce_analytics.int_orders_enriched"
[0m01:48:26.867765 [debug] [Thread-1 (]: On model.ecommerce_analytics.int_orders_enriched: BEGIN
[0m01:48:26.867765 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:48:26.867765 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m01:48:26.867765 [debug] [Thread-1 (]: Using duckdb connection "model.ecommerce_analytics.int_orders_enriched"
[0m01:48:26.867765 [debug] [Thread-1 (]: On model.ecommerce_analytics.int_orders_enriched: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "ecommerce_analytics", "target_name": "dev", "node_id": "model.ecommerce_analytics.int_orders_enriched"} */

  
  create view "dev"."main"."int_orders_enriched__dbt_tmp" as (
    WITH orders AS (
    SELECT * FROM "dev"."main"."stg_orders"
),

customers AS (
    SELECT * FROM "dev"."main"."stg_customers"
),

enriched AS (
    SELECT
        o.order_id,
        o.order_number,
        o.order_date,
        o.status,
        o.subtotal,
        o.discount_percent,
        o.shipping_cost,
        o.tax_amount,
        o.total_amount,
        o.payment_method,
        o.shipping_method,
        o.promotion_id,
        o.notes,
        
        -- Customer info
        c.customer_id,
        c.customer_name,
        c.customer_email,
        c.customer_city,
        
        -- Calculated fields
        DATE_TRUNC('month', o.order_date) AS order_month,
        CASE 
            WHEN o.total_amount > 1000 THEN 'High Value'
            WHEN o.total_amount > 500 THEN 'Medium Value'
            ELSE 'Low Value'
        END AS order_tier
        
    FROM orders o
    LEFT JOIN customers c ON o.customer_id = c.customer_id
)

SELECT * FROM enriched
  );

[0m01:48:26.873938 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m01:48:26.879028 [debug] [Thread-1 (]: Using duckdb connection "model.ecommerce_analytics.int_orders_enriched"
[0m01:48:26.880125 [debug] [Thread-1 (]: On model.ecommerce_analytics.int_orders_enriched: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "ecommerce_analytics", "target_name": "dev", "node_id": "model.ecommerce_analytics.int_orders_enriched"} */
alter view "dev"."main"."int_orders_enriched" rename to "int_orders_enriched__dbt_backup"
[0m01:48:26.881237 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m01:48:26.884572 [debug] [Thread-1 (]: Using duckdb connection "model.ecommerce_analytics.int_orders_enriched"
[0m01:48:26.885671 [debug] [Thread-1 (]: On model.ecommerce_analytics.int_orders_enriched: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "ecommerce_analytics", "target_name": "dev", "node_id": "model.ecommerce_analytics.int_orders_enriched"} */
alter view "dev"."main"."int_orders_enriched__dbt_tmp" rename to "int_orders_enriched"
[0m01:48:26.886221 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m01:48:26.888368 [debug] [Thread-1 (]: On model.ecommerce_analytics.int_orders_enriched: COMMIT
[0m01:48:26.888959 [debug] [Thread-1 (]: Using duckdb connection "model.ecommerce_analytics.int_orders_enriched"
[0m01:48:26.888959 [debug] [Thread-1 (]: On model.ecommerce_analytics.int_orders_enriched: COMMIT
[0m01:48:26.892347 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m01:48:26.897329 [debug] [Thread-1 (]: Using duckdb connection "model.ecommerce_analytics.int_orders_enriched"
[0m01:48:26.897969 [debug] [Thread-1 (]: On model.ecommerce_analytics.int_orders_enriched: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "ecommerce_analytics", "target_name": "dev", "node_id": "model.ecommerce_analytics.int_orders_enriched"} */

      drop view if exists "dev"."main"."int_orders_enriched__dbt_backup" cascade
    
[0m01:48:26.900188 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m01:48:26.901269 [debug] [Thread-1 (]: On model.ecommerce_analytics.int_orders_enriched: Close
[0m01:48:26.902355 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3adc932d-1a30-4fd3-8a4e-d5a1aa876f52', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001787BA9E490>]}
[0m01:48:26.902894 [info ] [Thread-1 (]: 4 of 6 OK created sql view model main.int_orders_enriched ...................... [[32mOK[0m in 0.05s]
[0m01:48:26.903938 [debug] [Thread-1 (]: Finished running node model.ecommerce_analytics.int_orders_enriched
[0m01:48:26.905057 [debug] [Thread-1 (]: Began running node model.ecommerce_analytics.dim_products
[0m01:48:26.905599 [info ] [Thread-1 (]: 5 of 6 START sql table model main.dim_products ................................. [RUN]
[0m01:48:26.906743 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ecommerce_analytics.int_orders_enriched, now model.ecommerce_analytics.dim_products)
[0m01:48:26.907272 [debug] [Thread-1 (]: Began compiling node model.ecommerce_analytics.dim_products
[0m01:48:26.912274 [debug] [Thread-1 (]: Writing injected SQL for node "model.ecommerce_analytics.dim_products"
[0m01:48:26.913924 [debug] [Thread-1 (]: Began executing node model.ecommerce_analytics.dim_products
[0m01:48:26.936426 [debug] [Thread-1 (]: Writing runtime sql for node "model.ecommerce_analytics.dim_products"
[0m01:48:26.936426 [debug] [Thread-1 (]: Using duckdb connection "model.ecommerce_analytics.dim_products"
[0m01:48:26.938434 [debug] [Thread-1 (]: On model.ecommerce_analytics.dim_products: BEGIN
[0m01:48:26.938434 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:48:26.938434 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m01:48:26.940878 [debug] [Thread-1 (]: Using duckdb connection "model.ecommerce_analytics.dim_products"
[0m01:48:26.941438 [debug] [Thread-1 (]: On model.ecommerce_analytics.dim_products: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "ecommerce_analytics", "target_name": "dev", "node_id": "model.ecommerce_analytics.dim_products"} */

  
    
    

    create  table
      "dev"."main"."dim_products__dbt_tmp"
  
    as (
      

WITH products AS (
    SELECT DISTINCT
        product_id,
        sku,
        product_name,
        description,
        category_id,
        brand_id,
        supplier_id,
        price,
        cost,
        weight_kg,
        is_active,
        created_at,
        updated_at
    FROM "dev"."main"."stg_products"
)

SELECT * FROM products
    );
  
  
[0m01:48:26.952343 [debug] [Thread-1 (]: SQL status: OK in 0.010 seconds
[0m01:48:26.957249 [debug] [Thread-1 (]: Using duckdb connection "model.ecommerce_analytics.dim_products"
[0m01:48:26.957249 [debug] [Thread-1 (]: On model.ecommerce_analytics.dim_products: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "ecommerce_analytics", "target_name": "dev", "node_id": "model.ecommerce_analytics.dim_products"} */
alter table "dev"."main"."dim_products__dbt_tmp" rename to "dim_products"
[0m01:48:26.958954 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m01:48:26.965761 [debug] [Thread-1 (]: On model.ecommerce_analytics.dim_products: COMMIT
[0m01:48:26.966318 [debug] [Thread-1 (]: Using duckdb connection "model.ecommerce_analytics.dim_products"
[0m01:48:26.966864 [debug] [Thread-1 (]: On model.ecommerce_analytics.dim_products: COMMIT
[0m01:48:26.969563 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m01:48:26.971778 [debug] [Thread-1 (]: Using duckdb connection "model.ecommerce_analytics.dim_products"
[0m01:48:26.972503 [debug] [Thread-1 (]: On model.ecommerce_analytics.dim_products: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "ecommerce_analytics", "target_name": "dev", "node_id": "model.ecommerce_analytics.dim_products"} */

      drop table if exists "dev"."main"."dim_products__dbt_backup" cascade
    
[0m01:48:26.973707 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m01:48:26.974876 [debug] [Thread-1 (]: On model.ecommerce_analytics.dim_products: Close
[0m01:48:26.975481 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3adc932d-1a30-4fd3-8a4e-d5a1aa876f52', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001787D655110>]}
[0m01:48:26.976308 [info ] [Thread-1 (]: 5 of 6 OK created sql table model main.dim_products ............................ [[32mOK[0m in 0.07s]
[0m01:48:26.977537 [debug] [Thread-1 (]: Finished running node model.ecommerce_analytics.dim_products
[0m01:48:26.978154 [debug] [Thread-1 (]: Began running node model.ecommerce_analytics.dim_customers
[0m01:48:26.978679 [info ] [Thread-1 (]: 6 of 6 START sql table model main.dim_customers ................................ [RUN]
[0m01:48:26.979847 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ecommerce_analytics.dim_products, now model.ecommerce_analytics.dim_customers)
[0m01:48:26.980472 [debug] [Thread-1 (]: Began compiling node model.ecommerce_analytics.dim_customers
[0m01:48:26.983847 [debug] [Thread-1 (]: Writing injected SQL for node "model.ecommerce_analytics.dim_customers"
[0m01:48:26.984582 [debug] [Thread-1 (]: Began executing node model.ecommerce_analytics.dim_customers
[0m01:48:26.988036 [debug] [Thread-1 (]: Writing runtime sql for node "model.ecommerce_analytics.dim_customers"
[0m01:48:26.988036 [debug] [Thread-1 (]: Using duckdb connection "model.ecommerce_analytics.dim_customers"
[0m01:48:26.992947 [debug] [Thread-1 (]: On model.ecommerce_analytics.dim_customers: BEGIN
[0m01:48:26.993718 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:48:26.995022 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m01:48:26.996086 [debug] [Thread-1 (]: Using duckdb connection "model.ecommerce_analytics.dim_customers"
[0m01:48:26.996674 [debug] [Thread-1 (]: On model.ecommerce_analytics.dim_customers: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "ecommerce_analytics", "target_name": "dev", "node_id": "model.ecommerce_analytics.dim_customers"} */

  
    
    

    create  table
      "dev"."main"."dim_customers__dbt_tmp"
  
    as (
      

WITH customers AS (
    SELECT DISTINCT
        customer_id,
        customer_name,
        customer_email,
        customer_city
    FROM "dev"."main"."int_orders_enriched"
)

SELECT * FROM customers
    );
  
  
[0m01:48:27.005232 [debug] [Thread-1 (]: SQL status: OK in 0.008 seconds
[0m01:48:27.009430 [debug] [Thread-1 (]: Using duckdb connection "model.ecommerce_analytics.dim_customers"
[0m01:48:27.009430 [debug] [Thread-1 (]: On model.ecommerce_analytics.dim_customers: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "ecommerce_analytics", "target_name": "dev", "node_id": "model.ecommerce_analytics.dim_customers"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'main'
      AND table_name = 'dim_customers'
  
[0m01:48:27.009430 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m01:48:27.015610 [debug] [Thread-1 (]: Using duckdb connection "model.ecommerce_analytics.dim_customers"
[0m01:48:27.016152 [debug] [Thread-1 (]: On model.ecommerce_analytics.dim_customers: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "ecommerce_analytics", "target_name": "dev", "node_id": "model.ecommerce_analytics.dim_customers"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'main'
      AND table_name = 'dim_customers'
  
[0m01:48:27.018380 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m01:48:27.018929 [debug] [Thread-1 (]: Using duckdb connection "model.ecommerce_analytics.dim_customers"
[0m01:48:27.018929 [debug] [Thread-1 (]: On model.ecommerce_analytics.dim_customers: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "ecommerce_analytics", "target_name": "dev", "node_id": "model.ecommerce_analytics.dim_customers"} */
alter table "dev"."main"."dim_customers" rename to "dim_customers__dbt_backup"
[0m01:48:27.025691 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m01:48:27.029907 [debug] [Thread-1 (]: Using duckdb connection "model.ecommerce_analytics.dim_customers"
[0m01:48:27.030457 [debug] [Thread-1 (]: On model.ecommerce_analytics.dim_customers: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "ecommerce_analytics", "target_name": "dev", "node_id": "model.ecommerce_analytics.dim_customers"} */
alter table "dev"."main"."dim_customers__dbt_tmp" rename to "dim_customers"
[0m01:48:27.031562 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m01:48:27.033199 [debug] [Thread-1 (]: On model.ecommerce_analytics.dim_customers: COMMIT
[0m01:48:27.034360 [debug] [Thread-1 (]: Using duckdb connection "model.ecommerce_analytics.dim_customers"
[0m01:48:27.034937 [debug] [Thread-1 (]: On model.ecommerce_analytics.dim_customers: COMMIT
[0m01:48:27.037066 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m01:48:27.041367 [debug] [Thread-1 (]: Using duckdb connection "model.ecommerce_analytics.dim_customers"
[0m01:48:27.042219 [debug] [Thread-1 (]: On model.ecommerce_analytics.dim_customers: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "ecommerce_analytics", "target_name": "dev", "node_id": "model.ecommerce_analytics.dim_customers"} */

      drop table if exists "dev"."main"."dim_customers__dbt_backup" cascade
    
[0m01:48:27.043644 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m01:48:27.046710 [debug] [Thread-1 (]: On model.ecommerce_analytics.dim_customers: Close
[0m01:48:27.047718 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3adc932d-1a30-4fd3-8a4e-d5a1aa876f52', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001787E6DC3D0>]}
[0m01:48:27.047718 [info ] [Thread-1 (]: 6 of 6 OK created sql table model main.dim_customers ........................... [[32mOK[0m in 0.07s]
[0m01:48:27.047718 [debug] [Thread-1 (]: Finished running node model.ecommerce_analytics.dim_customers
[0m01:48:27.052274 [debug] [MainThread]: Using duckdb connection "master"
[0m01:48:27.052851 [debug] [MainThread]: On master: BEGIN
[0m01:48:27.053376 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m01:48:27.054429 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m01:48:27.055017 [debug] [MainThread]: On master: COMMIT
[0m01:48:27.055579 [debug] [MainThread]: Using duckdb connection "master"
[0m01:48:27.056112 [debug] [MainThread]: On master: COMMIT
[0m01:48:27.057265 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m01:48:27.057265 [debug] [MainThread]: On master: Close
[0m01:48:27.058927 [debug] [MainThread]: Connection 'master' was properly closed.
[0m01:48:27.059471 [debug] [MainThread]: Connection 'create_dev_main' was properly closed.
[0m01:48:27.060028 [debug] [MainThread]: Connection 'list_dev_main' was properly closed.
[0m01:48:27.060584 [debug] [MainThread]: Connection 'model.ecommerce_analytics.dim_customers' was properly closed.
[0m01:48:27.061142 [info ] [MainThread]: 
[0m01:48:27.062256 [info ] [MainThread]: Finished running 2 table models, 4 view models in 0 hours 0 minutes and 0.69 seconds (0.69s).
[0m01:48:27.064502 [debug] [MainThread]: Command end result
[0m01:48:27.107603 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\Lenovo\Desktop\Proyectos\dbt-proyect\ecommerce_analytics\target\manifest.json
[0m01:48:27.111310 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\Lenovo\Desktop\Proyectos\dbt-proyect\ecommerce_analytics\target\semantic_manifest.json
[0m01:48:27.118563 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\Lenovo\Desktop\Proyectos\dbt-proyect\ecommerce_analytics\target\run_results.json
[0m01:48:27.119100 [info ] [MainThread]: 
[0m01:48:27.119640 [info ] [MainThread]: [32mCompleted successfully[0m
[0m01:48:27.120178 [info ] [MainThread]: 
[0m01:48:27.120751 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=6
[0m01:48:27.121834 [debug] [MainThread]: Command `dbt run` succeeded at 01:48:27.121834 after 2.08 seconds
[0m01:48:27.122456 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001787BA3FFD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001787B9DEC10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001787B9DF810>]}
[0m01:48:27.123615 [debug] [MainThread]: Flushing usage events
[0m01:48:28.501950 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m01:49:11.139361 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023E2FEC7F90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023E2EEEF650>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023E2FECF9D0>]}


============================== 01:49:11.149660 | 8ff8d0b0-7660-4a82-883e-7f97b4e58292 ==============================
[0m01:49:11.149660 [info ] [MainThread]: Running with dbt=1.11.2
[0m01:49:11.149660 [debug] [MainThread]: running dbt with arguments {'static_parser': 'True', 'no_print': 'None', 'version_check': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'target_path': 'None', 'printer_width': '80', 'write_json': 'True', 'introspect': 'True', 'log_cache_events': 'False', 'empty': 'None', 'cache_selected_only': 'False', 'fail_fast': 'False', 'debug': 'False', 'log_format': 'default', 'profiles_dir': 'C:\\Users\\Lenovo\\.dbt', 'send_anonymous_usage_stats': 'True', 'quiet': 'False', 'warn_error': 'None', 'partial_parse': 'True', 'indirect_selection': 'eager', 'invocation_command': 'dbt test', 'use_colors': 'True', 'use_experimental_parser': 'False', 'log_path': 'C:\\Users\\Lenovo\\Desktop\\Proyectos\\dbt-proyect\\ecommerce_analytics\\logs'}
[0m01:49:11.372970 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8ff8d0b0-7660-4a82-883e-7f97b4e58292', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023E310A4D10>]}
[0m01:49:11.436657 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '8ff8d0b0-7660-4a82-883e-7f97b4e58292', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023E2C833DD0>]}
[0m01:49:11.441108 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m01:49:11.670282 [debug] [MainThread]: checksum: 3d40d8bbe1bef07db1c24822f2dbfff8bc07f2a48ed4fe2658a40653aec0b54b, vars: {}, profile: , target: , version: 1.11.2
[0m01:49:11.853958 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m01:49:11.853958 [debug] [MainThread]: Nothing changed, skipping partial parsing.
[0m01:49:11.853958 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m01:49:11.901975 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8ff8d0b0-7660-4a82-883e-7f97b4e58292', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023E315449D0>]}
[0m01:49:11.997044 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\Lenovo\Desktop\Proyectos\dbt-proyect\ecommerce_analytics\target\manifest.json
[0m01:49:12.002181 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\Lenovo\Desktop\Proyectos\dbt-proyect\ecommerce_analytics\target\semantic_manifest.json
[0m01:49:12.035330 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8ff8d0b0-7660-4a82-883e-7f97b4e58292', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023E3176FB10>]}
[0m01:49:12.043394 [info ] [MainThread]: Found 7 models, 3 seeds, 14 data tests, 587 macros
[0m01:49:12.043394 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8ff8d0b0-7660-4a82-883e-7f97b4e58292', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023E313BFD50>]}
[0m01:49:12.043394 [info ] [MainThread]: 
[0m01:49:12.043394 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m01:49:12.043394 [info ] [MainThread]: 
[0m01:49:12.043394 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m01:49:12.055774 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_dev_main'
[0m01:49:12.199187 [debug] [ThreadPool]: Using duckdb connection "list_dev_main"
[0m01:49:12.199699 [debug] [ThreadPool]: On list_dev_main: BEGIN
[0m01:49:12.200245 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:49:12.236152 [debug] [ThreadPool]: SQL status: OK in 0.039 seconds
[0m01:49:12.240401 [debug] [ThreadPool]: Using duckdb connection "list_dev_main"
[0m01:49:12.240961 [debug] [ThreadPool]: On list_dev_main: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "ecommerce_analytics", "target_name": "dev", "connection_name": "list_dev_main"} */
select
      'dev' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'dev'
  
[0m01:49:12.255274 [debug] [ThreadPool]: SQL status: OK in 0.014 seconds
[0m01:49:12.255274 [debug] [ThreadPool]: On list_dev_main: ROLLBACK
[0m01:49:12.255274 [debug] [ThreadPool]: Failed to rollback 'list_dev_main'
[0m01:49:12.255274 [debug] [ThreadPool]: On list_dev_main: Close
[0m01:49:12.261709 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8ff8d0b0-7660-4a82-883e-7f97b4e58292', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023E2FF8AE10>]}
[0m01:49:12.261709 [debug] [MainThread]: Using duckdb connection "master"
[0m01:49:12.261709 [debug] [MainThread]: On master: BEGIN
[0m01:49:12.261709 [debug] [MainThread]: Opening a new connection, currently in state init
[0m01:49:12.264698 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m01:49:12.264698 [debug] [MainThread]: On master: COMMIT
[0m01:49:12.264698 [debug] [MainThread]: Using duckdb connection "master"
[0m01:49:12.264698 [debug] [MainThread]: On master: COMMIT
[0m01:49:12.264698 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m01:49:12.267322 [debug] [MainThread]: On master: Close
[0m01:49:12.272132 [debug] [Thread-1 (]: Began running node test.ecommerce_analytics.dbt_utils_accepted_range_stg_orders_total_amount__0.2895a1f8db
[0m01:49:12.272132 [info ] [Thread-1 (]: 1 of 14 START test dbt_utils_accepted_range_stg_orders_total_amount__0 ......... [RUN]
[0m01:49:12.272132 [debug] [Thread-1 (]: Acquiring new duckdb connection 'test.ecommerce_analytics.dbt_utils_accepted_range_stg_orders_total_amount__0.2895a1f8db'
[0m01:49:12.272132 [debug] [Thread-1 (]: Began compiling node test.ecommerce_analytics.dbt_utils_accepted_range_stg_orders_total_amount__0.2895a1f8db
[0m01:49:12.295338 [debug] [Thread-1 (]: Writing injected SQL for node "test.ecommerce_analytics.dbt_utils_accepted_range_stg_orders_total_amount__0.2895a1f8db"
[0m01:49:12.295338 [debug] [Thread-1 (]: Began executing node test.ecommerce_analytics.dbt_utils_accepted_range_stg_orders_total_amount__0.2895a1f8db
[0m01:49:12.316021 [debug] [Thread-1 (]: Writing runtime sql for node "test.ecommerce_analytics.dbt_utils_accepted_range_stg_orders_total_amount__0.2895a1f8db"
[0m01:49:12.316021 [debug] [Thread-1 (]: Using duckdb connection "test.ecommerce_analytics.dbt_utils_accepted_range_stg_orders_total_amount__0.2895a1f8db"
[0m01:49:12.316021 [debug] [Thread-1 (]: On test.ecommerce_analytics.dbt_utils_accepted_range_stg_orders_total_amount__0.2895a1f8db: BEGIN
[0m01:49:12.322942 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m01:49:12.324025 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m01:49:12.324025 [debug] [Thread-1 (]: Using duckdb connection "test.ecommerce_analytics.dbt_utils_accepted_range_stg_orders_total_amount__0.2895a1f8db"
[0m01:49:12.324025 [debug] [Thread-1 (]: On test.ecommerce_analytics.dbt_utils_accepted_range_stg_orders_total_amount__0.2895a1f8db: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "ecommerce_analytics", "target_name": "dev", "node_id": "test.ecommerce_analytics.dbt_utils_accepted_range_stg_orders_total_amount__0.2895a1f8db"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  

with meet_condition as(
  select *
  from "dev"."main"."stg_orders"
),

validation_errors as (
  select *
  from meet_condition
  where
    -- never true, defaults to an empty result set. Exists to ensure any combo of the `or` clauses below succeeds
    1 = 2
    -- records with a value >= min_value are permitted. The `not` flips this to find records that don't meet the rule.
    or not total_amount >= 0
)

select *
from validation_errors


  
  
      
    ) dbt_internal_test
[0m01:49:12.327374 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m01:49:12.331750 [debug] [Thread-1 (]: On test.ecommerce_analytics.dbt_utils_accepted_range_stg_orders_total_amount__0.2895a1f8db: ROLLBACK
[0m01:49:12.331750 [debug] [Thread-1 (]: Failed to rollback 'test.ecommerce_analytics.dbt_utils_accepted_range_stg_orders_total_amount__0.2895a1f8db'
[0m01:49:12.334276 [debug] [Thread-1 (]: On test.ecommerce_analytics.dbt_utils_accepted_range_stg_orders_total_amount__0.2895a1f8db: Close
[0m01:49:12.334276 [info ] [Thread-1 (]: 1 of 14 PASS dbt_utils_accepted_range_stg_orders_total_amount__0 ............... [[32mPASS[0m in 0.06s]
[0m01:49:12.334276 [debug] [Thread-1 (]: Finished running node test.ecommerce_analytics.dbt_utils_accepted_range_stg_orders_total_amount__0.2895a1f8db
[0m01:49:12.334276 [debug] [Thread-1 (]: Began running node test.ecommerce_analytics.dbt_utils_accepted_range_stg_products_price__0.26bfce9c9f
[0m01:49:12.334276 [info ] [Thread-1 (]: 2 of 14 START test dbt_utils_accepted_range_stg_products_price__0 .............. [RUN]
[0m01:49:12.334276 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.ecommerce_analytics.dbt_utils_accepted_range_stg_orders_total_amount__0.2895a1f8db, now test.ecommerce_analytics.dbt_utils_accepted_range_stg_products_price__0.26bfce9c9f)
[0m01:49:12.334276 [debug] [Thread-1 (]: Began compiling node test.ecommerce_analytics.dbt_utils_accepted_range_stg_products_price__0.26bfce9c9f
[0m01:49:12.339384 [debug] [Thread-1 (]: Writing injected SQL for node "test.ecommerce_analytics.dbt_utils_accepted_range_stg_products_price__0.26bfce9c9f"
[0m01:49:12.344577 [debug] [Thread-1 (]: Began executing node test.ecommerce_analytics.dbt_utils_accepted_range_stg_products_price__0.26bfce9c9f
[0m01:49:12.348454 [debug] [Thread-1 (]: Writing runtime sql for node "test.ecommerce_analytics.dbt_utils_accepted_range_stg_products_price__0.26bfce9c9f"
[0m01:49:12.350249 [debug] [Thread-1 (]: Using duckdb connection "test.ecommerce_analytics.dbt_utils_accepted_range_stg_products_price__0.26bfce9c9f"
[0m01:49:12.350249 [debug] [Thread-1 (]: On test.ecommerce_analytics.dbt_utils_accepted_range_stg_products_price__0.26bfce9c9f: BEGIN
[0m01:49:12.350249 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:49:12.350249 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m01:49:12.353492 [debug] [Thread-1 (]: Using duckdb connection "test.ecommerce_analytics.dbt_utils_accepted_range_stg_products_price__0.26bfce9c9f"
[0m01:49:12.353492 [debug] [Thread-1 (]: On test.ecommerce_analytics.dbt_utils_accepted_range_stg_products_price__0.26bfce9c9f: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "ecommerce_analytics", "target_name": "dev", "node_id": "test.ecommerce_analytics.dbt_utils_accepted_range_stg_products_price__0.26bfce9c9f"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  

with meet_condition as(
  select *
  from "dev"."main"."stg_products"
),

validation_errors as (
  select *
  from meet_condition
  where
    -- never true, defaults to an empty result set. Exists to ensure any combo of the `or` clauses below succeeds
    1 = 2
    -- records with a value >= min_value are permitted. The `not` flips this to find records that don't meet the rule.
    or not price >= 0
)

select *
from validation_errors


  
  
      
    ) dbt_internal_test
[0m01:49:12.357367 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m01:49:12.360389 [debug] [Thread-1 (]: On test.ecommerce_analytics.dbt_utils_accepted_range_stg_products_price__0.26bfce9c9f: ROLLBACK
[0m01:49:12.362020 [debug] [Thread-1 (]: Failed to rollback 'test.ecommerce_analytics.dbt_utils_accepted_range_stg_products_price__0.26bfce9c9f'
[0m01:49:12.362020 [debug] [Thread-1 (]: On test.ecommerce_analytics.dbt_utils_accepted_range_stg_products_price__0.26bfce9c9f: Close
[0m01:49:12.362020 [info ] [Thread-1 (]: 2 of 14 PASS dbt_utils_accepted_range_stg_products_price__0 .................... [[32mPASS[0m in 0.03s]
[0m01:49:12.364608 [debug] [Thread-1 (]: Finished running node test.ecommerce_analytics.dbt_utils_accepted_range_stg_products_price__0.26bfce9c9f
[0m01:49:12.364608 [debug] [Thread-1 (]: Began running node test.ecommerce_analytics.not_null_stg_customers_customer_id.e2cfb1f9aa
[0m01:49:12.365625 [info ] [Thread-1 (]: 3 of 14 START test not_null_stg_customers_customer_id .......................... [RUN]
[0m01:49:12.366339 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.ecommerce_analytics.dbt_utils_accepted_range_stg_products_price__0.26bfce9c9f, now test.ecommerce_analytics.not_null_stg_customers_customer_id.e2cfb1f9aa)
[0m01:49:12.366339 [debug] [Thread-1 (]: Began compiling node test.ecommerce_analytics.not_null_stg_customers_customer_id.e2cfb1f9aa
[0m01:49:12.377858 [debug] [Thread-1 (]: Writing injected SQL for node "test.ecommerce_analytics.not_null_stg_customers_customer_id.e2cfb1f9aa"
[0m01:49:12.379385 [debug] [Thread-1 (]: Began executing node test.ecommerce_analytics.not_null_stg_customers_customer_id.e2cfb1f9aa
[0m01:49:12.384096 [debug] [Thread-1 (]: Writing runtime sql for node "test.ecommerce_analytics.not_null_stg_customers_customer_id.e2cfb1f9aa"
[0m01:49:12.386181 [debug] [Thread-1 (]: Using duckdb connection "test.ecommerce_analytics.not_null_stg_customers_customer_id.e2cfb1f9aa"
[0m01:49:12.387818 [debug] [Thread-1 (]: On test.ecommerce_analytics.not_null_stg_customers_customer_id.e2cfb1f9aa: BEGIN
[0m01:49:12.387818 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:49:12.387818 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m01:49:12.387818 [debug] [Thread-1 (]: Using duckdb connection "test.ecommerce_analytics.not_null_stg_customers_customer_id.e2cfb1f9aa"
[0m01:49:12.387818 [debug] [Thread-1 (]: On test.ecommerce_analytics.not_null_stg_customers_customer_id.e2cfb1f9aa: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "ecommerce_analytics", "target_name": "dev", "node_id": "test.ecommerce_analytics.not_null_stg_customers_customer_id.e2cfb1f9aa"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select customer_id
from "dev"."main"."stg_customers"
where customer_id is null



  
  
      
    ) dbt_internal_test
[0m01:49:12.391750 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m01:49:12.391750 [debug] [Thread-1 (]: On test.ecommerce_analytics.not_null_stg_customers_customer_id.e2cfb1f9aa: ROLLBACK
[0m01:49:12.395749 [debug] [Thread-1 (]: Failed to rollback 'test.ecommerce_analytics.not_null_stg_customers_customer_id.e2cfb1f9aa'
[0m01:49:12.396257 [debug] [Thread-1 (]: On test.ecommerce_analytics.not_null_stg_customers_customer_id.e2cfb1f9aa: Close
[0m01:49:12.397348 [info ] [Thread-1 (]: 3 of 14 PASS not_null_stg_customers_customer_id ................................ [[32mPASS[0m in 0.03s]
[0m01:49:12.397348 [debug] [Thread-1 (]: Finished running node test.ecommerce_analytics.not_null_stg_customers_customer_id.e2cfb1f9aa
[0m01:49:12.397348 [debug] [Thread-1 (]: Began running node test.ecommerce_analytics.not_null_stg_customers_email.d7cf761533
[0m01:49:12.397348 [info ] [Thread-1 (]: 4 of 14 START test not_null_stg_customers_email ................................ [RUN]
[0m01:49:12.397348 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.ecommerce_analytics.not_null_stg_customers_customer_id.e2cfb1f9aa, now test.ecommerce_analytics.not_null_stg_customers_email.d7cf761533)
[0m01:49:12.397348 [debug] [Thread-1 (]: Began compiling node test.ecommerce_analytics.not_null_stg_customers_email.d7cf761533
[0m01:49:12.397348 [debug] [Thread-1 (]: Writing injected SQL for node "test.ecommerce_analytics.not_null_stg_customers_email.d7cf761533"
[0m01:49:12.397348 [debug] [Thread-1 (]: Began executing node test.ecommerce_analytics.not_null_stg_customers_email.d7cf761533
[0m01:49:12.407610 [debug] [Thread-1 (]: Writing runtime sql for node "test.ecommerce_analytics.not_null_stg_customers_email.d7cf761533"
[0m01:49:12.407610 [debug] [Thread-1 (]: Using duckdb connection "test.ecommerce_analytics.not_null_stg_customers_email.d7cf761533"
[0m01:49:12.410262 [debug] [Thread-1 (]: On test.ecommerce_analytics.not_null_stg_customers_email.d7cf761533: BEGIN
[0m01:49:12.410262 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:49:12.412445 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m01:49:12.412847 [debug] [Thread-1 (]: Using duckdb connection "test.ecommerce_analytics.not_null_stg_customers_email.d7cf761533"
[0m01:49:12.412847 [debug] [Thread-1 (]: On test.ecommerce_analytics.not_null_stg_customers_email.d7cf761533: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "ecommerce_analytics", "target_name": "dev", "node_id": "test.ecommerce_analytics.not_null_stg_customers_email.d7cf761533"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select email
from "dev"."main"."stg_customers"
where email is null



  
  
      
    ) dbt_internal_test
[0m01:49:12.415124 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "ecommerce_analytics", "target_name": "dev", "node_id": "test.ecommerce_analytics.not_null_stg_customers_email.d7cf761533"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select email
from "dev"."main"."stg_customers"
where email is null



  
  
      
    ) dbt_internal_test
[0m01:49:12.415124 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m01:49:12.415124 [debug] [Thread-1 (]: On test.ecommerce_analytics.not_null_stg_customers_email.d7cf761533: ROLLBACK
[0m01:49:12.423232 [debug] [Thread-1 (]: Failed to rollback 'test.ecommerce_analytics.not_null_stg_customers_email.d7cf761533'
[0m01:49:12.423232 [debug] [Thread-1 (]: On test.ecommerce_analytics.not_null_stg_customers_email.d7cf761533: Close
[0m01:49:12.423232 [debug] [Thread-1 (]: Runtime Error in test not_null_stg_customers_email (models\example\staging\schema.yml)
  Binder Error: Referenced column "email" not found in FROM clause!
  Candidate bindings: "segment", "postal_code"
  
  LINE 18: where email is null
                 ^
[0m01:49:12.423232 [error] [Thread-1 (]: 4 of 14 ERROR not_null_stg_customers_email ..................................... [[31mERROR[0m in 0.03s]
[0m01:49:12.428848 [debug] [Thread-1 (]: Finished running node test.ecommerce_analytics.not_null_stg_customers_email.d7cf761533
[0m01:49:12.428848 [debug] [Thread-1 (]: Began running node test.ecommerce_analytics.not_null_stg_orders_customer_id.af79d5e4b5
[0m01:49:12.428848 [debug] [Thread-4 (]: Marking all children of 'test.ecommerce_analytics.not_null_stg_customers_email.d7cf761533' to be skipped because of status 'error'.  Reason: Runtime Error in test not_null_stg_customers_email (models\example\staging\schema.yml)
  Binder Error: Referenced column "email" not found in FROM clause!
  Candidate bindings: "segment", "postal_code"
  
  LINE 18: where email is null
                 ^.
[0m01:49:12.428848 [info ] [Thread-1 (]: 5 of 14 START test not_null_stg_orders_customer_id ............................. [RUN]
[0m01:49:12.428848 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.ecommerce_analytics.not_null_stg_customers_email.d7cf761533, now test.ecommerce_analytics.not_null_stg_orders_customer_id.af79d5e4b5)
[0m01:49:12.428848 [debug] [Thread-1 (]: Began compiling node test.ecommerce_analytics.not_null_stg_orders_customer_id.af79d5e4b5
[0m01:49:12.428848 [debug] [Thread-1 (]: Writing injected SQL for node "test.ecommerce_analytics.not_null_stg_orders_customer_id.af79d5e4b5"
[0m01:49:12.428848 [debug] [Thread-1 (]: Began executing node test.ecommerce_analytics.not_null_stg_orders_customer_id.af79d5e4b5
[0m01:49:12.442398 [debug] [Thread-1 (]: Writing runtime sql for node "test.ecommerce_analytics.not_null_stg_orders_customer_id.af79d5e4b5"
[0m01:49:12.442398 [debug] [Thread-1 (]: Using duckdb connection "test.ecommerce_analytics.not_null_stg_orders_customer_id.af79d5e4b5"
[0m01:49:12.442398 [debug] [Thread-1 (]: On test.ecommerce_analytics.not_null_stg_orders_customer_id.af79d5e4b5: BEGIN
[0m01:49:12.445659 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:49:12.446049 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m01:49:12.447708 [debug] [Thread-1 (]: Using duckdb connection "test.ecommerce_analytics.not_null_stg_orders_customer_id.af79d5e4b5"
[0m01:49:12.447708 [debug] [Thread-1 (]: On test.ecommerce_analytics.not_null_stg_orders_customer_id.af79d5e4b5: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "ecommerce_analytics", "target_name": "dev", "node_id": "test.ecommerce_analytics.not_null_stg_orders_customer_id.af79d5e4b5"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select customer_id
from "dev"."main"."stg_orders"
where customer_id is null



  
  
      
    ) dbt_internal_test
[0m01:49:12.449761 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m01:49:12.449761 [debug] [Thread-1 (]: On test.ecommerce_analytics.not_null_stg_orders_customer_id.af79d5e4b5: ROLLBACK
[0m01:49:12.449761 [debug] [Thread-1 (]: Failed to rollback 'test.ecommerce_analytics.not_null_stg_orders_customer_id.af79d5e4b5'
[0m01:49:12.449761 [debug] [Thread-1 (]: On test.ecommerce_analytics.not_null_stg_orders_customer_id.af79d5e4b5: Close
[0m01:49:12.449761 [info ] [Thread-1 (]: 5 of 14 PASS not_null_stg_orders_customer_id ................................... [[32mPASS[0m in 0.02s]
[0m01:49:12.455321 [debug] [Thread-1 (]: Finished running node test.ecommerce_analytics.not_null_stg_orders_customer_id.af79d5e4b5
[0m01:49:12.455321 [debug] [Thread-1 (]: Began running node test.ecommerce_analytics.not_null_stg_orders_order_id.81cfe2fe64
[0m01:49:12.455321 [info ] [Thread-1 (]: 6 of 14 START test not_null_stg_orders_order_id ................................ [RUN]
[0m01:49:12.455321 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.ecommerce_analytics.not_null_stg_orders_customer_id.af79d5e4b5, now test.ecommerce_analytics.not_null_stg_orders_order_id.81cfe2fe64)
[0m01:49:12.455321 [debug] [Thread-1 (]: Began compiling node test.ecommerce_analytics.not_null_stg_orders_order_id.81cfe2fe64
[0m01:49:12.462359 [debug] [Thread-1 (]: Writing injected SQL for node "test.ecommerce_analytics.not_null_stg_orders_order_id.81cfe2fe64"
[0m01:49:12.463022 [debug] [Thread-1 (]: Began executing node test.ecommerce_analytics.not_null_stg_orders_order_id.81cfe2fe64
[0m01:49:12.466279 [debug] [Thread-1 (]: Writing runtime sql for node "test.ecommerce_analytics.not_null_stg_orders_order_id.81cfe2fe64"
[0m01:49:12.466279 [debug] [Thread-1 (]: Using duckdb connection "test.ecommerce_analytics.not_null_stg_orders_order_id.81cfe2fe64"
[0m01:49:12.466279 [debug] [Thread-1 (]: On test.ecommerce_analytics.not_null_stg_orders_order_id.81cfe2fe64: BEGIN
[0m01:49:12.466279 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:49:12.470303 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m01:49:12.470303 [debug] [Thread-1 (]: Using duckdb connection "test.ecommerce_analytics.not_null_stg_orders_order_id.81cfe2fe64"
[0m01:49:12.470303 [debug] [Thread-1 (]: On test.ecommerce_analytics.not_null_stg_orders_order_id.81cfe2fe64: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "ecommerce_analytics", "target_name": "dev", "node_id": "test.ecommerce_analytics.not_null_stg_orders_order_id.81cfe2fe64"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select order_id
from "dev"."main"."stg_orders"
where order_id is null



  
  
      
    ) dbt_internal_test
[0m01:49:12.470303 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m01:49:12.475144 [debug] [Thread-1 (]: On test.ecommerce_analytics.not_null_stg_orders_order_id.81cfe2fe64: ROLLBACK
[0m01:49:12.475144 [debug] [Thread-1 (]: Failed to rollback 'test.ecommerce_analytics.not_null_stg_orders_order_id.81cfe2fe64'
[0m01:49:12.476898 [debug] [Thread-1 (]: On test.ecommerce_analytics.not_null_stg_orders_order_id.81cfe2fe64: Close
[0m01:49:12.476898 [info ] [Thread-1 (]: 6 of 14 PASS not_null_stg_orders_order_id ...................................... [[32mPASS[0m in 0.02s]
[0m01:49:12.478840 [debug] [Thread-1 (]: Finished running node test.ecommerce_analytics.not_null_stg_orders_order_id.81cfe2fe64
[0m01:49:12.478840 [debug] [Thread-1 (]: Began running node test.ecommerce_analytics.not_null_stg_orders_total_amount.f31d98d41b
[0m01:49:12.480848 [info ] [Thread-1 (]: 7 of 14 START test not_null_stg_orders_total_amount ............................ [RUN]
[0m01:49:12.480848 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.ecommerce_analytics.not_null_stg_orders_order_id.81cfe2fe64, now test.ecommerce_analytics.not_null_stg_orders_total_amount.f31d98d41b)
[0m01:49:12.480848 [debug] [Thread-1 (]: Began compiling node test.ecommerce_analytics.not_null_stg_orders_total_amount.f31d98d41b
[0m01:49:12.484989 [debug] [Thread-1 (]: Writing injected SQL for node "test.ecommerce_analytics.not_null_stg_orders_total_amount.f31d98d41b"
[0m01:49:12.484989 [debug] [Thread-1 (]: Began executing node test.ecommerce_analytics.not_null_stg_orders_total_amount.f31d98d41b
[0m01:49:12.491712 [debug] [Thread-1 (]: Writing runtime sql for node "test.ecommerce_analytics.not_null_stg_orders_total_amount.f31d98d41b"
[0m01:49:12.493646 [debug] [Thread-1 (]: Using duckdb connection "test.ecommerce_analytics.not_null_stg_orders_total_amount.f31d98d41b"
[0m01:49:12.495327 [debug] [Thread-1 (]: On test.ecommerce_analytics.not_null_stg_orders_total_amount.f31d98d41b: BEGIN
[0m01:49:12.495327 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:49:12.495327 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m01:49:12.495327 [debug] [Thread-1 (]: Using duckdb connection "test.ecommerce_analytics.not_null_stg_orders_total_amount.f31d98d41b"
[0m01:49:12.495327 [debug] [Thread-1 (]: On test.ecommerce_analytics.not_null_stg_orders_total_amount.f31d98d41b: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "ecommerce_analytics", "target_name": "dev", "node_id": "test.ecommerce_analytics.not_null_stg_orders_total_amount.f31d98d41b"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select total_amount
from "dev"."main"."stg_orders"
where total_amount is null



  
  
      
    ) dbt_internal_test
[0m01:49:12.501277 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m01:49:12.501277 [debug] [Thread-1 (]: On test.ecommerce_analytics.not_null_stg_orders_total_amount.f31d98d41b: ROLLBACK
[0m01:49:12.501277 [debug] [Thread-1 (]: Failed to rollback 'test.ecommerce_analytics.not_null_stg_orders_total_amount.f31d98d41b'
[0m01:49:12.501277 [debug] [Thread-1 (]: On test.ecommerce_analytics.not_null_stg_orders_total_amount.f31d98d41b: Close
[0m01:49:12.501277 [info ] [Thread-1 (]: 7 of 14 PASS not_null_stg_orders_total_amount .................................. [[32mPASS[0m in 0.02s]
[0m01:49:12.501277 [debug] [Thread-1 (]: Finished running node test.ecommerce_analytics.not_null_stg_orders_total_amount.f31d98d41b
[0m01:49:12.501277 [debug] [Thread-1 (]: Began running node test.ecommerce_analytics.not_null_stg_products_price.2d147627d4
[0m01:49:12.501277 [info ] [Thread-1 (]: 8 of 14 START test not_null_stg_products_price ................................. [RUN]
[0m01:49:12.509329 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.ecommerce_analytics.not_null_stg_orders_total_amount.f31d98d41b, now test.ecommerce_analytics.not_null_stg_products_price.2d147627d4)
[0m01:49:12.509870 [debug] [Thread-1 (]: Began compiling node test.ecommerce_analytics.not_null_stg_products_price.2d147627d4
[0m01:49:12.513010 [debug] [Thread-1 (]: Writing injected SQL for node "test.ecommerce_analytics.not_null_stg_products_price.2d147627d4"
[0m01:49:12.517737 [debug] [Thread-1 (]: Began executing node test.ecommerce_analytics.not_null_stg_products_price.2d147627d4
[0m01:49:12.521722 [debug] [Thread-1 (]: Writing runtime sql for node "test.ecommerce_analytics.not_null_stg_products_price.2d147627d4"
[0m01:49:12.521722 [debug] [Thread-1 (]: Using duckdb connection "test.ecommerce_analytics.not_null_stg_products_price.2d147627d4"
[0m01:49:12.521722 [debug] [Thread-1 (]: On test.ecommerce_analytics.not_null_stg_products_price.2d147627d4: BEGIN
[0m01:49:12.521722 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:49:12.521722 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m01:49:12.521722 [debug] [Thread-1 (]: Using duckdb connection "test.ecommerce_analytics.not_null_stg_products_price.2d147627d4"
[0m01:49:12.521722 [debug] [Thread-1 (]: On test.ecommerce_analytics.not_null_stg_products_price.2d147627d4: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "ecommerce_analytics", "target_name": "dev", "node_id": "test.ecommerce_analytics.not_null_stg_products_price.2d147627d4"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select price
from "dev"."main"."stg_products"
where price is null



  
  
      
    ) dbt_internal_test
[0m01:49:12.528308 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m01:49:12.528308 [debug] [Thread-1 (]: On test.ecommerce_analytics.not_null_stg_products_price.2d147627d4: ROLLBACK
[0m01:49:12.531957 [debug] [Thread-1 (]: Failed to rollback 'test.ecommerce_analytics.not_null_stg_products_price.2d147627d4'
[0m01:49:12.531957 [debug] [Thread-1 (]: On test.ecommerce_analytics.not_null_stg_products_price.2d147627d4: Close
[0m01:49:12.531957 [info ] [Thread-1 (]: 8 of 14 PASS not_null_stg_products_price ....................................... [[32mPASS[0m in 0.02s]
[0m01:49:12.535161 [debug] [Thread-1 (]: Finished running node test.ecommerce_analytics.not_null_stg_products_price.2d147627d4
[0m01:49:12.535161 [debug] [Thread-1 (]: Began running node test.ecommerce_analytics.not_null_stg_products_product_id.6373b0acf3
[0m01:49:12.535161 [info ] [Thread-1 (]: 9 of 14 START test not_null_stg_products_product_id ............................ [RUN]
[0m01:49:12.535161 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.ecommerce_analytics.not_null_stg_products_price.2d147627d4, now test.ecommerce_analytics.not_null_stg_products_product_id.6373b0acf3)
[0m01:49:12.535161 [debug] [Thread-1 (]: Began compiling node test.ecommerce_analytics.not_null_stg_products_product_id.6373b0acf3
[0m01:49:12.535161 [debug] [Thread-1 (]: Writing injected SQL for node "test.ecommerce_analytics.not_null_stg_products_product_id.6373b0acf3"
[0m01:49:12.542991 [debug] [Thread-1 (]: Began executing node test.ecommerce_analytics.not_null_stg_products_product_id.6373b0acf3
[0m01:49:12.543577 [debug] [Thread-1 (]: Writing runtime sql for node "test.ecommerce_analytics.not_null_stg_products_product_id.6373b0acf3"
[0m01:49:12.548200 [debug] [Thread-1 (]: Using duckdb connection "test.ecommerce_analytics.not_null_stg_products_product_id.6373b0acf3"
[0m01:49:12.548200 [debug] [Thread-1 (]: On test.ecommerce_analytics.not_null_stg_products_product_id.6373b0acf3: BEGIN
[0m01:49:12.550759 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:49:12.551849 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m01:49:12.551849 [debug] [Thread-1 (]: Using duckdb connection "test.ecommerce_analytics.not_null_stg_products_product_id.6373b0acf3"
[0m01:49:12.552975 [debug] [Thread-1 (]: On test.ecommerce_analytics.not_null_stg_products_product_id.6373b0acf3: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "ecommerce_analytics", "target_name": "dev", "node_id": "test.ecommerce_analytics.not_null_stg_products_product_id.6373b0acf3"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select product_id
from "dev"."main"."stg_products"
where product_id is null



  
  
      
    ) dbt_internal_test
[0m01:49:12.552975 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m01:49:12.552975 [debug] [Thread-1 (]: On test.ecommerce_analytics.not_null_stg_products_product_id.6373b0acf3: ROLLBACK
[0m01:49:12.556242 [debug] [Thread-1 (]: Failed to rollback 'test.ecommerce_analytics.not_null_stg_products_product_id.6373b0acf3'
[0m01:49:12.556242 [debug] [Thread-1 (]: On test.ecommerce_analytics.not_null_stg_products_product_id.6373b0acf3: Close
[0m01:49:12.556242 [info ] [Thread-1 (]: 9 of 14 PASS not_null_stg_products_product_id .................................. [[32mPASS[0m in 0.02s]
[0m01:49:12.556242 [debug] [Thread-1 (]: Finished running node test.ecommerce_analytics.not_null_stg_products_product_id.6373b0acf3
[0m01:49:12.556242 [debug] [Thread-1 (]: Began running node test.ecommerce_analytics.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500
[0m01:49:12.560241 [info ] [Thread-1 (]: 10 of 14 START test relationships_stg_orders_customer_id__customer_id__ref_stg_customers_  [RUN]
[0m01:49:12.560868 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.ecommerce_analytics.not_null_stg_products_product_id.6373b0acf3, now test.ecommerce_analytics.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500)
[0m01:49:12.560868 [debug] [Thread-1 (]: Began compiling node test.ecommerce_analytics.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500
[0m01:49:12.568489 [debug] [Thread-1 (]: Writing injected SQL for node "test.ecommerce_analytics.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500"
[0m01:49:12.568489 [debug] [Thread-1 (]: Began executing node test.ecommerce_analytics.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500
[0m01:49:12.577843 [debug] [Thread-1 (]: Writing runtime sql for node "test.ecommerce_analytics.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500"
[0m01:49:12.578657 [debug] [Thread-1 (]: Using duckdb connection "test.ecommerce_analytics.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500"
[0m01:49:12.578657 [debug] [Thread-1 (]: On test.ecommerce_analytics.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500: BEGIN
[0m01:49:12.581024 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:49:12.582307 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m01:49:12.582307 [debug] [Thread-1 (]: Using duckdb connection "test.ecommerce_analytics.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500"
[0m01:49:12.582307 [debug] [Thread-1 (]: On test.ecommerce_analytics.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "ecommerce_analytics", "target_name": "dev", "node_id": "test.ecommerce_analytics.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with child as (
    select customer_id as from_field
    from "dev"."main"."stg_orders"
    where customer_id is not null
),

parent as (
    select customer_id as to_field
    from "dev"."main"."stg_customers"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



  
  
      
    ) dbt_internal_test
[0m01:49:12.595393 [debug] [Thread-1 (]: SQL status: OK in 0.017 seconds
[0m01:49:12.595393 [debug] [Thread-1 (]: On test.ecommerce_analytics.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500: ROLLBACK
[0m01:49:12.595393 [debug] [Thread-1 (]: Failed to rollback 'test.ecommerce_analytics.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500'
[0m01:49:12.595393 [debug] [Thread-1 (]: On test.ecommerce_analytics.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500: Close
[0m01:49:12.595393 [info ] [Thread-1 (]: 10 of 14 PASS relationships_stg_orders_customer_id__customer_id__ref_stg_customers_  [[32mPASS[0m in 0.03s]
[0m01:49:12.605614 [debug] [Thread-1 (]: Finished running node test.ecommerce_analytics.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500
[0m01:49:12.605614 [debug] [Thread-1 (]: Began running node test.ecommerce_analytics.unique_stg_customers_customer_id.c7614daada
[0m01:49:12.605614 [info ] [Thread-1 (]: 11 of 14 START test unique_stg_customers_customer_id ........................... [RUN]
[0m01:49:12.605614 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.ecommerce_analytics.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500, now test.ecommerce_analytics.unique_stg_customers_customer_id.c7614daada)
[0m01:49:12.605614 [debug] [Thread-1 (]: Began compiling node test.ecommerce_analytics.unique_stg_customers_customer_id.c7614daada
[0m01:49:12.615317 [debug] [Thread-1 (]: Writing injected SQL for node "test.ecommerce_analytics.unique_stg_customers_customer_id.c7614daada"
[0m01:49:12.615317 [debug] [Thread-1 (]: Began executing node test.ecommerce_analytics.unique_stg_customers_customer_id.c7614daada
[0m01:49:12.615317 [debug] [Thread-1 (]: Writing runtime sql for node "test.ecommerce_analytics.unique_stg_customers_customer_id.c7614daada"
[0m01:49:12.615317 [debug] [Thread-1 (]: Using duckdb connection "test.ecommerce_analytics.unique_stg_customers_customer_id.c7614daada"
[0m01:49:12.615317 [debug] [Thread-1 (]: On test.ecommerce_analytics.unique_stg_customers_customer_id.c7614daada: BEGIN
[0m01:49:12.615317 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:49:12.615317 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m01:49:12.615317 [debug] [Thread-1 (]: Using duckdb connection "test.ecommerce_analytics.unique_stg_customers_customer_id.c7614daada"
[0m01:49:12.615317 [debug] [Thread-1 (]: On test.ecommerce_analytics.unique_stg_customers_customer_id.c7614daada: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "ecommerce_analytics", "target_name": "dev", "node_id": "test.ecommerce_analytics.unique_stg_customers_customer_id.c7614daada"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    customer_id as unique_field,
    count(*) as n_records

from "dev"."main"."stg_customers"
where customer_id is not null
group by customer_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m01:49:12.626833 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m01:49:12.626833 [debug] [Thread-1 (]: On test.ecommerce_analytics.unique_stg_customers_customer_id.c7614daada: ROLLBACK
[0m01:49:12.626833 [debug] [Thread-1 (]: Failed to rollback 'test.ecommerce_analytics.unique_stg_customers_customer_id.c7614daada'
[0m01:49:12.631877 [debug] [Thread-1 (]: On test.ecommerce_analytics.unique_stg_customers_customer_id.c7614daada: Close
[0m01:49:12.631877 [info ] [Thread-1 (]: 11 of 14 PASS unique_stg_customers_customer_id ................................. [[32mPASS[0m in 0.03s]
[0m01:49:12.633944 [debug] [Thread-1 (]: Finished running node test.ecommerce_analytics.unique_stg_customers_customer_id.c7614daada
[0m01:49:12.633944 [debug] [Thread-1 (]: Began running node test.ecommerce_analytics.unique_stg_customers_email.1ebcb2333e
[0m01:49:12.633944 [info ] [Thread-1 (]: 12 of 14 START test unique_stg_customers_email ................................. [RUN]
[0m01:49:12.636658 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.ecommerce_analytics.unique_stg_customers_customer_id.c7614daada, now test.ecommerce_analytics.unique_stg_customers_email.1ebcb2333e)
[0m01:49:12.636658 [debug] [Thread-1 (]: Began compiling node test.ecommerce_analytics.unique_stg_customers_email.1ebcb2333e
[0m01:49:12.636658 [debug] [Thread-1 (]: Writing injected SQL for node "test.ecommerce_analytics.unique_stg_customers_email.1ebcb2333e"
[0m01:49:12.644554 [debug] [Thread-1 (]: Began executing node test.ecommerce_analytics.unique_stg_customers_email.1ebcb2333e
[0m01:49:12.649169 [debug] [Thread-1 (]: Writing runtime sql for node "test.ecommerce_analytics.unique_stg_customers_email.1ebcb2333e"
[0m01:49:12.649169 [debug] [Thread-1 (]: Using duckdb connection "test.ecommerce_analytics.unique_stg_customers_email.1ebcb2333e"
[0m01:49:12.649169 [debug] [Thread-1 (]: On test.ecommerce_analytics.unique_stg_customers_email.1ebcb2333e: BEGIN
[0m01:49:12.652222 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:49:12.652222 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m01:49:12.652222 [debug] [Thread-1 (]: Using duckdb connection "test.ecommerce_analytics.unique_stg_customers_email.1ebcb2333e"
[0m01:49:12.652222 [debug] [Thread-1 (]: On test.ecommerce_analytics.unique_stg_customers_email.1ebcb2333e: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "ecommerce_analytics", "target_name": "dev", "node_id": "test.ecommerce_analytics.unique_stg_customers_email.1ebcb2333e"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    email as unique_field,
    count(*) as n_records

from "dev"."main"."stg_customers"
where email is not null
group by email
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m01:49:12.652222 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "ecommerce_analytics", "target_name": "dev", "node_id": "test.ecommerce_analytics.unique_stg_customers_email.1ebcb2333e"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    email as unique_field,
    count(*) as n_records

from "dev"."main"."stg_customers"
where email is not null
group by email
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m01:49:12.652222 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m01:49:12.652222 [debug] [Thread-1 (]: On test.ecommerce_analytics.unique_stg_customers_email.1ebcb2333e: ROLLBACK
[0m01:49:12.658921 [debug] [Thread-1 (]: Failed to rollback 'test.ecommerce_analytics.unique_stg_customers_email.1ebcb2333e'
[0m01:49:12.658921 [debug] [Thread-1 (]: On test.ecommerce_analytics.unique_stg_customers_email.1ebcb2333e: Close
[0m01:49:12.663152 [debug] [Thread-1 (]: Runtime Error in test unique_stg_customers_email (models\example\staging\schema.yml)
  Binder Error: Referenced column "email" not found in FROM clause!
  Candidate bindings: "segment", "postal_code"
  
  LINE 19: where email is not null
                 ^
[0m01:49:12.663152 [error] [Thread-1 (]: 12 of 14 ERROR unique_stg_customers_email ...................................... [[31mERROR[0m in 0.03s]
[0m01:49:12.664771 [debug] [Thread-1 (]: Finished running node test.ecommerce_analytics.unique_stg_customers_email.1ebcb2333e
[0m01:49:12.664771 [debug] [Thread-1 (]: Began running node test.ecommerce_analytics.unique_stg_orders_order_id.e3b841c71a
[0m01:49:12.667837 [debug] [Thread-4 (]: Marking all children of 'test.ecommerce_analytics.unique_stg_customers_email.1ebcb2333e' to be skipped because of status 'error'.  Reason: Runtime Error in test unique_stg_customers_email (models\example\staging\schema.yml)
  Binder Error: Referenced column "email" not found in FROM clause!
  Candidate bindings: "segment", "postal_code"
  
  LINE 19: where email is not null
                 ^.
[0m01:49:12.666804 [info ] [Thread-1 (]: 13 of 14 START test unique_stg_orders_order_id ................................. [RUN]
[0m01:49:12.668936 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.ecommerce_analytics.unique_stg_customers_email.1ebcb2333e, now test.ecommerce_analytics.unique_stg_orders_order_id.e3b841c71a)
[0m01:49:12.668936 [debug] [Thread-1 (]: Began compiling node test.ecommerce_analytics.unique_stg_orders_order_id.e3b841c71a
[0m01:49:12.668936 [debug] [Thread-1 (]: Writing injected SQL for node "test.ecommerce_analytics.unique_stg_orders_order_id.e3b841c71a"
[0m01:49:12.668936 [debug] [Thread-1 (]: Began executing node test.ecommerce_analytics.unique_stg_orders_order_id.e3b841c71a
[0m01:49:12.677131 [debug] [Thread-1 (]: Writing runtime sql for node "test.ecommerce_analytics.unique_stg_orders_order_id.e3b841c71a"
[0m01:49:12.679301 [debug] [Thread-1 (]: Using duckdb connection "test.ecommerce_analytics.unique_stg_orders_order_id.e3b841c71a"
[0m01:49:12.679301 [debug] [Thread-1 (]: On test.ecommerce_analytics.unique_stg_orders_order_id.e3b841c71a: BEGIN
[0m01:49:12.679301 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:49:12.682769 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m01:49:12.682769 [debug] [Thread-1 (]: Using duckdb connection "test.ecommerce_analytics.unique_stg_orders_order_id.e3b841c71a"
[0m01:49:12.682769 [debug] [Thread-1 (]: On test.ecommerce_analytics.unique_stg_orders_order_id.e3b841c71a: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "ecommerce_analytics", "target_name": "dev", "node_id": "test.ecommerce_analytics.unique_stg_orders_order_id.e3b841c71a"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    order_id as unique_field,
    count(*) as n_records

from "dev"."main"."stg_orders"
where order_id is not null
group by order_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m01:49:12.685441 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m01:49:12.685441 [debug] [Thread-1 (]: On test.ecommerce_analytics.unique_stg_orders_order_id.e3b841c71a: ROLLBACK
[0m01:49:12.685441 [debug] [Thread-1 (]: Failed to rollback 'test.ecommerce_analytics.unique_stg_orders_order_id.e3b841c71a'
[0m01:49:12.688941 [debug] [Thread-1 (]: On test.ecommerce_analytics.unique_stg_orders_order_id.e3b841c71a: Close
[0m01:49:12.689573 [info ] [Thread-1 (]: 13 of 14 PASS unique_stg_orders_order_id ....................................... [[32mPASS[0m in 0.02s]
[0m01:49:12.690569 [debug] [Thread-1 (]: Finished running node test.ecommerce_analytics.unique_stg_orders_order_id.e3b841c71a
[0m01:49:12.692478 [debug] [Thread-1 (]: Began running node test.ecommerce_analytics.unique_stg_products_product_id.7d950a1467
[0m01:49:12.692478 [info ] [Thread-1 (]: 14 of 14 START test unique_stg_products_product_id ............................. [RUN]
[0m01:49:12.693488 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.ecommerce_analytics.unique_stg_orders_order_id.e3b841c71a, now test.ecommerce_analytics.unique_stg_products_product_id.7d950a1467)
[0m01:49:12.693488 [debug] [Thread-1 (]: Began compiling node test.ecommerce_analytics.unique_stg_products_product_id.7d950a1467
[0m01:49:12.699106 [debug] [Thread-1 (]: Writing injected SQL for node "test.ecommerce_analytics.unique_stg_products_product_id.7d950a1467"
[0m01:49:12.703095 [debug] [Thread-1 (]: Began executing node test.ecommerce_analytics.unique_stg_products_product_id.7d950a1467
[0m01:49:12.703095 [debug] [Thread-1 (]: Writing runtime sql for node "test.ecommerce_analytics.unique_stg_products_product_id.7d950a1467"
[0m01:49:12.703095 [debug] [Thread-1 (]: Using duckdb connection "test.ecommerce_analytics.unique_stg_products_product_id.7d950a1467"
[0m01:49:12.703095 [debug] [Thread-1 (]: On test.ecommerce_analytics.unique_stg_products_product_id.7d950a1467: BEGIN
[0m01:49:12.709175 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:49:12.710163 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m01:49:12.710163 [debug] [Thread-1 (]: Using duckdb connection "test.ecommerce_analytics.unique_stg_products_product_id.7d950a1467"
[0m01:49:12.710163 [debug] [Thread-1 (]: On test.ecommerce_analytics.unique_stg_products_product_id.7d950a1467: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "ecommerce_analytics", "target_name": "dev", "node_id": "test.ecommerce_analytics.unique_stg_products_product_id.7d950a1467"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    product_id as unique_field,
    count(*) as n_records

from "dev"."main"."stg_products"
where product_id is not null
group by product_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m01:49:12.710163 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m01:49:12.715300 [debug] [Thread-1 (]: On test.ecommerce_analytics.unique_stg_products_product_id.7d950a1467: ROLLBACK
[0m01:49:12.717366 [debug] [Thread-1 (]: Failed to rollback 'test.ecommerce_analytics.unique_stg_products_product_id.7d950a1467'
[0m01:49:12.717817 [debug] [Thread-1 (]: On test.ecommerce_analytics.unique_stg_products_product_id.7d950a1467: Close
[0m01:49:12.717817 [info ] [Thread-1 (]: 14 of 14 PASS unique_stg_products_product_id ................................... [[32mPASS[0m in 0.02s]
[0m01:49:12.719325 [debug] [Thread-1 (]: Finished running node test.ecommerce_analytics.unique_stg_products_product_id.7d950a1467
[0m01:49:12.719325 [debug] [MainThread]: Using duckdb connection "master"
[0m01:49:12.719325 [debug] [MainThread]: On master: BEGIN
[0m01:49:12.719325 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m01:49:12.719325 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m01:49:12.719325 [debug] [MainThread]: On master: COMMIT
[0m01:49:12.719325 [debug] [MainThread]: Using duckdb connection "master"
[0m01:49:12.719325 [debug] [MainThread]: On master: COMMIT
[0m01:49:12.719325 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m01:49:12.719325 [debug] [MainThread]: On master: Close
[0m01:49:12.727187 [debug] [MainThread]: Connection 'master' was properly closed.
[0m01:49:12.727693 [debug] [MainThread]: Connection 'list_dev_main' was properly closed.
[0m01:49:12.728841 [debug] [MainThread]: Connection 'test.ecommerce_analytics.unique_stg_products_product_id.7d950a1467' was properly closed.
[0m01:49:12.729915 [info ] [MainThread]: 
[0m01:49:12.731072 [info ] [MainThread]: Finished running 14 data tests in 0 hours 0 minutes and 0.69 seconds (0.69s).
[0m01:49:12.734769 [debug] [MainThread]: Command end result
[0m01:49:12.765140 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\Lenovo\Desktop\Proyectos\dbt-proyect\ecommerce_analytics\target\manifest.json
[0m01:49:12.765140 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\Lenovo\Desktop\Proyectos\dbt-proyect\ecommerce_analytics\target\semantic_manifest.json
[0m01:49:12.777531 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\Lenovo\Desktop\Proyectos\dbt-proyect\ecommerce_analytics\target\run_results.json
[0m01:49:12.778301 [info ] [MainThread]: 
[0m01:49:12.778301 [info ] [MainThread]: [31mCompleted with 2 errors, 0 partial successes, and 0 warnings:[0m
[0m01:49:12.778301 [info ] [MainThread]: 
[0m01:49:12.781625 [error] [MainThread]: [31mFailure in test not_null_stg_customers_email (models\example\staging\schema.yml)[0m
[0m01:49:12.781625 [error] [MainThread]:   Runtime Error in test not_null_stg_customers_email (models\example\staging\schema.yml)
  Binder Error: Referenced column "email" not found in FROM clause!
  Candidate bindings: "segment", "postal_code"
  
  LINE 18: where email is null
                 ^
[0m01:49:12.781625 [info ] [MainThread]: 
[0m01:49:12.781625 [info ] [MainThread]:   compiled code at target\compiled\ecommerce_analytics\models\example\staging\schema.yml\not_null_stg_customers_email.sql
[0m01:49:12.781625 [info ] [MainThread]: 
[0m01:49:12.781625 [error] [MainThread]: [31mFailure in test unique_stg_customers_email (models\example\staging\schema.yml)[0m
[0m01:49:12.781625 [error] [MainThread]:   Runtime Error in test unique_stg_customers_email (models\example\staging\schema.yml)
  Binder Error: Referenced column "email" not found in FROM clause!
  Candidate bindings: "segment", "postal_code"
  
  LINE 19: where email is not null
                 ^
[0m01:49:12.788861 [info ] [MainThread]: 
[0m01:49:12.788861 [info ] [MainThread]:   compiled code at target\compiled\ecommerce_analytics\models\example\staging\schema.yml\unique_stg_customers_email.sql
[0m01:49:12.788861 [info ] [MainThread]: 
[0m01:49:12.790884 [info ] [MainThread]: Done. PASS=12 WARN=0 ERROR=2 SKIP=0 NO-OP=0 TOTAL=14
[0m01:49:12.791892 [debug] [MainThread]: Command `dbt test` failed at 01:49:12.791892 after 1.74 seconds
[0m01:49:12.793459 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023E29195010>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023E2FEC7B10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023E2FEC7C90>]}
[0m01:49:12.793459 [debug] [MainThread]: Flushing usage events
[0m01:49:14.126288 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m01:50:45.788592 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D0D28CE750>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D0D29326D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D0D2931190>]}


============================== 01:50:45.795815 | 82f0bd7c-e6c2-4e96-a09d-ef126d5b8660 ==============================
[0m01:50:45.795815 [info ] [MainThread]: Running with dbt=1.11.2
[0m01:50:45.799682 [debug] [MainThread]: running dbt with arguments {'static_parser': 'True', 'no_print': 'None', 'version_check': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'target_path': 'None', 'printer_width': '80', 'write_json': 'True', 'empty': 'False', 'log_cache_events': 'False', 'introspect': 'True', 'cache_selected_only': 'False', 'log_format': 'default', 'debug': 'False', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\Lenovo\\.dbt', 'send_anonymous_usage_stats': 'True', 'quiet': 'False', 'warn_error': 'None', 'partial_parse': 'True', 'indirect_selection': 'eager', 'invocation_command': 'dbt run', 'use_colors': 'True', 'use_experimental_parser': 'False', 'log_path': 'C:\\Users\\Lenovo\\Desktop\\Proyectos\\dbt-proyect\\ecommerce_analytics\\logs'}
[0m01:50:46.057945 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '82f0bd7c-e6c2-4e96-a09d-ef126d5b8660', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D0D298EED0>]}
[0m01:50:46.133355 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '82f0bd7c-e6c2-4e96-a09d-ef126d5b8660', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D0CF2441D0>]}
[0m01:50:46.136376 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m01:50:46.364433 [debug] [MainThread]: checksum: 3d40d8bbe1bef07db1c24822f2dbfff8bc07f2a48ed4fe2658a40653aec0b54b, vars: {}, profile: , target: , version: 1.11.2
[0m01:50:46.604063 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 3 files changed.
[0m01:50:46.604063 [debug] [MainThread]: Partial parsing: updated file: ecommerce_analytics://models\example\staging\schema.yml
[0m01:50:46.604063 [debug] [MainThread]: Partial parsing: updated file: ecommerce_analytics://models\example\marts\fct_orders.sql
[0m01:50:46.604063 [debug] [MainThread]: Partial parsing: updated file: ecommerce_analytics://models\example\marts\dim_customers.sql
[0m01:50:47.017525 [warn ] [MainThread]: [[33mWARNING[0m][MissingArgumentsPropertyInGenericTestDeprecation]: Deprecated
functionality
Found top-level arguments to test `relationships` defined on 'stg_orders' in
package 'ecommerce_analytics' (models\example\staging\schema.yml). Arguments to
generic tests should be nested under the `arguments` property.
[0m01:50:47.017525 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '82f0bd7c-e6c2-4e96-a09d-ef126d5b8660', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D0D3B4C690>]}
[0m01:50:47.143285 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '82f0bd7c-e6c2-4e96-a09d-ef126d5b8660', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D0D39B7350>]}
[0m01:50:47.237760 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\Lenovo\Desktop\Proyectos\dbt-proyect\ecommerce_analytics\target\manifest.json
[0m01:50:47.237760 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\Lenovo\Desktop\Proyectos\dbt-proyect\ecommerce_analytics\target\semantic_manifest.json
[0m01:50:47.276847 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '82f0bd7c-e6c2-4e96-a09d-ef126d5b8660', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D0D41726D0>]}
[0m01:50:47.279380 [info ] [MainThread]: Found 3 seeds, 7 models, 14 data tests, 587 macros
[0m01:50:47.279380 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '82f0bd7c-e6c2-4e96-a09d-ef126d5b8660', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D0D3B663D0>]}
[0m01:50:47.279380 [info ] [MainThread]: 
[0m01:50:47.279380 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m01:50:47.279380 [info ] [MainThread]: 
[0m01:50:47.279380 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m01:50:47.293237 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_dev'
[0m01:50:47.372931 [debug] [ThreadPool]: Using duckdb connection "list_dev"
[0m01:50:47.372931 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "ecommerce_analytics", "target_name": "dev", "connection_name": "list_dev"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"dev"'
    
  
  
[0m01:50:47.372931 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:50:47.385755 [debug] [ThreadPool]: SQL status: OK in 0.017 seconds
[0m01:50:47.393628 [debug] [ThreadPool]: On list_dev: Close
[0m01:50:47.393628 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev, now create_dev_main)
[0m01:50:47.396236 [debug] [ThreadPool]: Creating schema "database: "dev"
schema: "main"
"
[0m01:50:47.403882 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m01:50:47.403882 [debug] [ThreadPool]: On create_dev_main: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "ecommerce_analytics", "target_name": "dev", "connection_name": "create_dev_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='dev'
        and type='sqlite'
    
  
[0m01:50:47.403882 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m01:50:47.403882 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m01:50:47.403882 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m01:50:47.403882 [debug] [ThreadPool]: On create_dev_main: BEGIN
[0m01:50:47.403882 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m01:50:47.403882 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m01:50:47.414282 [debug] [ThreadPool]: On create_dev_main: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "ecommerce_analytics", "target_name": "dev", "connection_name": "create_dev_main"} */

    
    
        create schema if not exists "dev"."main"
    
[0m01:50:47.414282 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m01:50:47.414282 [debug] [ThreadPool]: On create_dev_main: COMMIT
[0m01:50:47.414282 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m01:50:47.414282 [debug] [ThreadPool]: On create_dev_main: COMMIT
[0m01:50:47.417699 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m01:50:47.417699 [debug] [ThreadPool]: On create_dev_main: Close
[0m01:50:47.417699 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_dev_main'
[0m01:50:47.424890 [debug] [ThreadPool]: Using duckdb connection "list_dev_main"
[0m01:50:47.427916 [debug] [ThreadPool]: On list_dev_main: BEGIN
[0m01:50:47.427916 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:50:47.427916 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m01:50:47.427916 [debug] [ThreadPool]: Using duckdb connection "list_dev_main"
[0m01:50:47.427916 [debug] [ThreadPool]: On list_dev_main: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "ecommerce_analytics", "target_name": "dev", "connection_name": "list_dev_main"} */
select
      'dev' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'dev'
  
[0m01:50:47.445372 [debug] [ThreadPool]: SQL status: OK in 0.015 seconds
[0m01:50:47.445372 [debug] [ThreadPool]: On list_dev_main: ROLLBACK
[0m01:50:47.445372 [debug] [ThreadPool]: Failed to rollback 'list_dev_main'
[0m01:50:47.445372 [debug] [ThreadPool]: On list_dev_main: Close
[0m01:50:47.449370 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '82f0bd7c-e6c2-4e96-a09d-ef126d5b8660', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D0D1946690>]}
[0m01:50:47.449370 [debug] [MainThread]: Using duckdb connection "master"
[0m01:50:47.449370 [debug] [MainThread]: On master: BEGIN
[0m01:50:47.449370 [debug] [MainThread]: Opening a new connection, currently in state init
[0m01:50:47.449370 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m01:50:47.449370 [debug] [MainThread]: On master: COMMIT
[0m01:50:47.449370 [debug] [MainThread]: Using duckdb connection "master"
[0m01:50:47.449370 [debug] [MainThread]: On master: COMMIT
[0m01:50:47.449370 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m01:50:47.449370 [debug] [MainThread]: On master: Close
[0m01:50:47.455618 [debug] [Thread-1 (]: Began running node model.ecommerce_analytics.dim_customers
[0m01:50:47.455618 [info ] [Thread-1 (]: 1 of 7 START sql view model main.dim_customers ................................. [RUN]
[0m01:50:47.459690 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.ecommerce_analytics.dim_customers'
[0m01:50:47.459690 [debug] [Thread-1 (]: Began compiling node model.ecommerce_analytics.dim_customers
[0m01:50:47.467593 [debug] [Thread-1 (]: Writing injected SQL for node "model.ecommerce_analytics.dim_customers"
[0m01:50:47.469895 [debug] [Thread-1 (]: Began executing node model.ecommerce_analytics.dim_customers
[0m01:50:47.500569 [debug] [Thread-1 (]: Writing runtime sql for node "model.ecommerce_analytics.dim_customers"
[0m01:50:47.500569 [debug] [Thread-1 (]: Using duckdb connection "model.ecommerce_analytics.dim_customers"
[0m01:50:47.500569 [debug] [Thread-1 (]: On model.ecommerce_analytics.dim_customers: BEGIN
[0m01:50:47.500569 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m01:50:47.506707 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m01:50:47.506707 [debug] [Thread-1 (]: Using duckdb connection "model.ecommerce_analytics.dim_customers"
[0m01:50:47.507802 [debug] [Thread-1 (]: On model.ecommerce_analytics.dim_customers: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "ecommerce_analytics", "target_name": "dev", "node_id": "model.ecommerce_analytics.dim_customers"} */

  
  create view "dev"."main"."dim_customers__dbt_tmp" as (
    WITH source AS (
    SELECT * FROM "dev"."main"."raw_customers"
),

renamed AS (
    SELECT
        customer_id,
        first_name || ' ' || last_name AS customer_name,
        email AS customer_email,
        phone,
        CAST(birth_date AS DATE) AS birth_date,
        city AS customer_city,
        country,
        postal_code,
        segment,
        CAST(registration_date AS DATE) AS registration_date,
        CAST(last_login AS DATE) AS last_login,
        is_verified,
        accepts_marketing
    FROM source
)

SELECT * FROM renamed
  );

[0m01:50:47.507802 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m01:50:47.514819 [debug] [Thread-1 (]: Using duckdb connection "model.ecommerce_analytics.dim_customers"
[0m01:50:47.514819 [debug] [Thread-1 (]: On model.ecommerce_analytics.dim_customers: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "ecommerce_analytics", "target_name": "dev", "node_id": "model.ecommerce_analytics.dim_customers"} */
alter table "dev"."main"."dim_customers" rename to "dim_customers__dbt_backup"
[0m01:50:47.514819 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m01:50:47.518018 [debug] [Thread-1 (]: Using duckdb connection "model.ecommerce_analytics.dim_customers"
[0m01:50:47.518018 [debug] [Thread-1 (]: On model.ecommerce_analytics.dim_customers: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "ecommerce_analytics", "target_name": "dev", "node_id": "model.ecommerce_analytics.dim_customers"} */
alter view "dev"."main"."dim_customers__dbt_tmp" rename to "dim_customers"
[0m01:50:47.523104 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m01:50:47.533610 [debug] [Thread-1 (]: On model.ecommerce_analytics.dim_customers: COMMIT
[0m01:50:47.535132 [debug] [Thread-1 (]: Using duckdb connection "model.ecommerce_analytics.dim_customers"
[0m01:50:47.535132 [debug] [Thread-1 (]: On model.ecommerce_analytics.dim_customers: COMMIT
[0m01:50:47.552374 [debug] [Thread-1 (]: SQL status: OK in 0.017 seconds
[0m01:50:47.561303 [debug] [Thread-1 (]: Using duckdb connection "model.ecommerce_analytics.dim_customers"
[0m01:50:47.561303 [debug] [Thread-1 (]: On model.ecommerce_analytics.dim_customers: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "ecommerce_analytics", "target_name": "dev", "node_id": "model.ecommerce_analytics.dim_customers"} */

      drop table if exists "dev"."main"."dim_customers__dbt_backup" cascade
    
[0m01:50:47.562818 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m01:50:47.566578 [debug] [Thread-1 (]: On model.ecommerce_analytics.dim_customers: Close
[0m01:50:47.569594 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '82f0bd7c-e6c2-4e96-a09d-ef126d5b8660', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D0D3AA5790>]}
[0m01:50:47.569594 [info ] [Thread-1 (]: 1 of 7 OK created sql view model main.dim_customers ............................ [[32mOK[0m in 0.11s]
[0m01:50:47.569594 [debug] [Thread-1 (]: Finished running node model.ecommerce_analytics.dim_customers
[0m01:50:47.569594 [debug] [Thread-1 (]: Began running node model.ecommerce_analytics.stg_customers
[0m01:50:47.569594 [info ] [Thread-1 (]: 2 of 7 START sql view model main.stg_customers ................................. [RUN]
[0m01:50:47.573347 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ecommerce_analytics.dim_customers, now model.ecommerce_analytics.stg_customers)
[0m01:50:47.573347 [debug] [Thread-1 (]: Began compiling node model.ecommerce_analytics.stg_customers
[0m01:50:47.573347 [debug] [Thread-1 (]: Writing injected SQL for node "model.ecommerce_analytics.stg_customers"
[0m01:50:47.578449 [debug] [Thread-1 (]: Began executing node model.ecommerce_analytics.stg_customers
[0m01:50:47.585231 [debug] [Thread-1 (]: Writing runtime sql for node "model.ecommerce_analytics.stg_customers"
[0m01:50:47.586633 [debug] [Thread-1 (]: Using duckdb connection "model.ecommerce_analytics.stg_customers"
[0m01:50:47.587864 [debug] [Thread-1 (]: On model.ecommerce_analytics.stg_customers: BEGIN
[0m01:50:47.587864 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:50:47.590359 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m01:50:47.591641 [debug] [Thread-1 (]: Using duckdb connection "model.ecommerce_analytics.stg_customers"
[0m01:50:47.592152 [debug] [Thread-1 (]: On model.ecommerce_analytics.stg_customers: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "ecommerce_analytics", "target_name": "dev", "node_id": "model.ecommerce_analytics.stg_customers"} */

  
  create view "dev"."main"."stg_customers__dbt_tmp" as (
    WITH source AS (
    SELECT * FROM "dev"."main"."raw_customers"
),

renamed AS (
    SELECT
        customer_id,
        first_name || ' ' || last_name AS customer_name,
        email AS customer_email,
        phone,
        CAST(birth_date AS DATE) AS birth_date,
        city AS customer_city,
        country,
        postal_code,
        segment,
        CAST(registration_date AS DATE) AS registration_date,
        CAST(last_login AS DATE) AS last_login,
        is_verified,
        accepts_marketing
    FROM source
)

SELECT * FROM renamed
  );

[0m01:50:47.593336 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m01:50:47.596524 [debug] [Thread-1 (]: Using duckdb connection "model.ecommerce_analytics.stg_customers"
[0m01:50:47.596524 [debug] [Thread-1 (]: On model.ecommerce_analytics.stg_customers: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "ecommerce_analytics", "target_name": "dev", "node_id": "model.ecommerce_analytics.stg_customers"} */
alter view "dev"."main"."stg_customers" rename to "stg_customers__dbt_backup"
[0m01:50:47.600809 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m01:50:47.600809 [debug] [Thread-1 (]: Using duckdb connection "model.ecommerce_analytics.stg_customers"
[0m01:50:47.600809 [debug] [Thread-1 (]: On model.ecommerce_analytics.stg_customers: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "ecommerce_analytics", "target_name": "dev", "node_id": "model.ecommerce_analytics.stg_customers"} */
alter view "dev"."main"."stg_customers__dbt_tmp" rename to "stg_customers"
[0m01:50:47.600809 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m01:50:47.607080 [debug] [Thread-1 (]: On model.ecommerce_analytics.stg_customers: COMMIT
[0m01:50:47.608463 [debug] [Thread-1 (]: Using duckdb connection "model.ecommerce_analytics.stg_customers"
[0m01:50:47.608463 [debug] [Thread-1 (]: On model.ecommerce_analytics.stg_customers: COMMIT
[0m01:50:47.610990 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m01:50:47.615898 [debug] [Thread-1 (]: Using duckdb connection "model.ecommerce_analytics.stg_customers"
[0m01:50:47.615898 [debug] [Thread-1 (]: On model.ecommerce_analytics.stg_customers: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "ecommerce_analytics", "target_name": "dev", "node_id": "model.ecommerce_analytics.stg_customers"} */

      drop view if exists "dev"."main"."stg_customers__dbt_backup" cascade
    
[0m01:50:47.617913 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m01:50:47.620608 [debug] [Thread-1 (]: On model.ecommerce_analytics.stg_customers: Close
[0m01:50:47.621120 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '82f0bd7c-e6c2-4e96-a09d-ef126d5b8660', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D0D4636DD0>]}
[0m01:50:47.622260 [info ] [Thread-1 (]: 2 of 7 OK created sql view model main.stg_customers ............................ [[32mOK[0m in 0.05s]
[0m01:50:47.623232 [debug] [Thread-1 (]: Finished running node model.ecommerce_analytics.stg_customers
[0m01:50:47.623794 [debug] [Thread-1 (]: Began running node model.ecommerce_analytics.stg_orders
[0m01:50:47.624560 [info ] [Thread-1 (]: 3 of 7 START sql view model main.stg_orders .................................... [RUN]
[0m01:50:47.625229 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ecommerce_analytics.stg_customers, now model.ecommerce_analytics.stg_orders)
[0m01:50:47.625229 [debug] [Thread-1 (]: Began compiling node model.ecommerce_analytics.stg_orders
[0m01:50:47.628986 [debug] [Thread-1 (]: Writing injected SQL for node "model.ecommerce_analytics.stg_orders"
[0m01:50:47.631377 [debug] [Thread-1 (]: Began executing node model.ecommerce_analytics.stg_orders
[0m01:50:47.635005 [debug] [Thread-1 (]: Writing runtime sql for node "model.ecommerce_analytics.stg_orders"
[0m01:50:47.635005 [debug] [Thread-1 (]: Using duckdb connection "model.ecommerce_analytics.stg_orders"
[0m01:50:47.638028 [debug] [Thread-1 (]: On model.ecommerce_analytics.stg_orders: BEGIN
[0m01:50:47.639670 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:50:47.640995 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m01:50:47.641518 [debug] [Thread-1 (]: Using duckdb connection "model.ecommerce_analytics.stg_orders"
[0m01:50:47.642244 [debug] [Thread-1 (]: On model.ecommerce_analytics.stg_orders: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "ecommerce_analytics", "target_name": "dev", "node_id": "model.ecommerce_analytics.stg_orders"} */

  
  create view "dev"."main"."stg_orders__dbt_tmp" as (
    WITH source AS (
    SELECT * FROM "dev"."main"."raw_orders"
),

renamed AS (
    SELECT
        order_id,
        order_number,
        customer_id,
        CAST(order_date AS DATE) AS order_date,
        status,
        CAST(subtotal AS DECIMAL(10,2)) AS subtotal,
        CAST(discount_percent AS DECIMAL(10,2)) AS discount_percent,
        CAST(shipping_cost AS DECIMAL(10,2)) AS shipping_cost,
        CAST(tax_amount AS DECIMAL(10,2)) AS tax_amount,
        CAST(total_amount AS DECIMAL(10,2)) AS total_amount,
        payment_method,
        shipping_method,
        promotion_id,
        notes
    FROM source
)

SELECT * FROM renamed
  );

[0m01:50:47.646340 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m01:50:47.646937 [debug] [Thread-1 (]: Using duckdb connection "model.ecommerce_analytics.stg_orders"
[0m01:50:47.651994 [debug] [Thread-1 (]: On model.ecommerce_analytics.stg_orders: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "ecommerce_analytics", "target_name": "dev", "node_id": "model.ecommerce_analytics.stg_orders"} */
alter view "dev"."main"."stg_orders" rename to "stg_orders__dbt_backup"
[0m01:50:47.651994 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m01:50:47.656006 [debug] [Thread-1 (]: Using duckdb connection "model.ecommerce_analytics.stg_orders"
[0m01:50:47.656006 [debug] [Thread-1 (]: On model.ecommerce_analytics.stg_orders: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "ecommerce_analytics", "target_name": "dev", "node_id": "model.ecommerce_analytics.stg_orders"} */
alter view "dev"."main"."stg_orders__dbt_tmp" rename to "stg_orders"
[0m01:50:47.659163 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m01:50:47.659163 [debug] [Thread-1 (]: On model.ecommerce_analytics.stg_orders: COMMIT
[0m01:50:47.662209 [debug] [Thread-1 (]: Using duckdb connection "model.ecommerce_analytics.stg_orders"
[0m01:50:47.663013 [debug] [Thread-1 (]: On model.ecommerce_analytics.stg_orders: COMMIT
[0m01:50:47.663013 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m01:50:47.667339 [debug] [Thread-1 (]: Using duckdb connection "model.ecommerce_analytics.stg_orders"
[0m01:50:47.669347 [debug] [Thread-1 (]: On model.ecommerce_analytics.stg_orders: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "ecommerce_analytics", "target_name": "dev", "node_id": "model.ecommerce_analytics.stg_orders"} */

      drop view if exists "dev"."main"."stg_orders__dbt_backup" cascade
    
[0m01:50:47.672092 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m01:50:47.672596 [debug] [Thread-1 (]: On model.ecommerce_analytics.stg_orders: Close
[0m01:50:47.672596 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '82f0bd7c-e6c2-4e96-a09d-ef126d5b8660', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D0D4773410>]}
[0m01:50:47.674715 [info ] [Thread-1 (]: 3 of 7 OK created sql view model main.stg_orders ............................... [[32mOK[0m in 0.05s]
[0m01:50:47.675767 [debug] [Thread-1 (]: Finished running node model.ecommerce_analytics.stg_orders
[0m01:50:47.677287 [debug] [Thread-1 (]: Began running node model.ecommerce_analytics.stg_products
[0m01:50:47.677985 [info ] [Thread-1 (]: 4 of 7 START sql view model main.stg_products .................................. [RUN]
[0m01:50:47.678980 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ecommerce_analytics.stg_orders, now model.ecommerce_analytics.stg_products)
[0m01:50:47.680447 [debug] [Thread-1 (]: Began compiling node model.ecommerce_analytics.stg_products
[0m01:50:47.682958 [debug] [Thread-1 (]: Writing injected SQL for node "model.ecommerce_analytics.stg_products"
[0m01:50:47.684950 [debug] [Thread-1 (]: Began executing node model.ecommerce_analytics.stg_products
[0m01:50:47.690163 [debug] [Thread-1 (]: Writing runtime sql for node "model.ecommerce_analytics.stg_products"
[0m01:50:47.693034 [debug] [Thread-1 (]: Using duckdb connection "model.ecommerce_analytics.stg_products"
[0m01:50:47.694705 [debug] [Thread-1 (]: On model.ecommerce_analytics.stg_products: BEGIN
[0m01:50:47.694705 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:50:47.696212 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m01:50:47.696907 [debug] [Thread-1 (]: Using duckdb connection "model.ecommerce_analytics.stg_products"
[0m01:50:47.698037 [debug] [Thread-1 (]: On model.ecommerce_analytics.stg_products: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "ecommerce_analytics", "target_name": "dev", "node_id": "model.ecommerce_analytics.stg_products"} */

  
  create view "dev"."main"."stg_products__dbt_tmp" as (
    WITH source AS (
    SELECT * FROM "dev"."main"."raw_products"
),

renamed AS (
    SELECT
        product_id,
        sku,
        product_name,
        description,
        category_id,
        brand_id,
        supplier_id,
        CAST(price AS DECIMAL(10,2)) AS price,
        CAST(cost AS DECIMAL(10,2)) AS cost,
        CAST(weight_kg AS DECIMAL(10,2)) AS weight_kg,
        is_active,
        CAST(created_at AS DATE) AS created_at,
        CAST(updated_at AS DATE) AS updated_at
    FROM source
)

SELECT * FROM renamed
  );

[0m01:50:47.699057 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m01:50:47.703337 [debug] [Thread-1 (]: Using duckdb connection "model.ecommerce_analytics.stg_products"
[0m01:50:47.703337 [debug] [Thread-1 (]: On model.ecommerce_analytics.stg_products: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "ecommerce_analytics", "target_name": "dev", "node_id": "model.ecommerce_analytics.stg_products"} */
alter view "dev"."main"."stg_products" rename to "stg_products__dbt_backup"
[0m01:50:47.704461 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m01:50:47.704461 [debug] [Thread-1 (]: Using duckdb connection "model.ecommerce_analytics.stg_products"
[0m01:50:47.704461 [debug] [Thread-1 (]: On model.ecommerce_analytics.stg_products: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "ecommerce_analytics", "target_name": "dev", "node_id": "model.ecommerce_analytics.stg_products"} */
alter view "dev"."main"."stg_products__dbt_tmp" rename to "stg_products"
[0m01:50:47.711336 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m01:50:47.713453 [debug] [Thread-1 (]: On model.ecommerce_analytics.stg_products: COMMIT
[0m01:50:47.713453 [debug] [Thread-1 (]: Using duckdb connection "model.ecommerce_analytics.stg_products"
[0m01:50:47.713453 [debug] [Thread-1 (]: On model.ecommerce_analytics.stg_products: COMMIT
[0m01:50:47.713453 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m01:50:47.713453 [debug] [Thread-1 (]: Using duckdb connection "model.ecommerce_analytics.stg_products"
[0m01:50:47.713453 [debug] [Thread-1 (]: On model.ecommerce_analytics.stg_products: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "ecommerce_analytics", "target_name": "dev", "node_id": "model.ecommerce_analytics.stg_products"} */

      drop view if exists "dev"."main"."stg_products__dbt_backup" cascade
    
[0m01:50:47.720155 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m01:50:47.722706 [debug] [Thread-1 (]: On model.ecommerce_analytics.stg_products: Close
[0m01:50:47.722706 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '82f0bd7c-e6c2-4e96-a09d-ef126d5b8660', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D0D45A1E10>]}
[0m01:50:47.723746 [info ] [Thread-1 (]: 4 of 7 OK created sql view model main.stg_products ............................. [[32mOK[0m in 0.04s]
[0m01:50:47.723746 [debug] [Thread-1 (]: Finished running node model.ecommerce_analytics.stg_products
[0m01:50:47.723746 [debug] [Thread-1 (]: Began running node model.ecommerce_analytics.int_orders_enriched
[0m01:50:47.723746 [info ] [Thread-1 (]: 5 of 7 START sql view model main.int_orders_enriched ........................... [RUN]
[0m01:50:47.723746 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ecommerce_analytics.stg_products, now model.ecommerce_analytics.int_orders_enriched)
[0m01:50:47.723746 [debug] [Thread-1 (]: Began compiling node model.ecommerce_analytics.int_orders_enriched
[0m01:50:47.728056 [debug] [Thread-1 (]: Writing injected SQL for node "model.ecommerce_analytics.int_orders_enriched"
[0m01:50:47.731622 [debug] [Thread-1 (]: Began executing node model.ecommerce_analytics.int_orders_enriched
[0m01:50:47.737157 [debug] [Thread-1 (]: Writing runtime sql for node "model.ecommerce_analytics.int_orders_enriched"
[0m01:50:47.738359 [debug] [Thread-1 (]: Using duckdb connection "model.ecommerce_analytics.int_orders_enriched"
[0m01:50:47.738359 [debug] [Thread-1 (]: On model.ecommerce_analytics.int_orders_enriched: BEGIN
[0m01:50:47.738359 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:50:47.738359 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m01:50:47.741801 [debug] [Thread-1 (]: Using duckdb connection "model.ecommerce_analytics.int_orders_enriched"
[0m01:50:47.741801 [debug] [Thread-1 (]: On model.ecommerce_analytics.int_orders_enriched: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "ecommerce_analytics", "target_name": "dev", "node_id": "model.ecommerce_analytics.int_orders_enriched"} */

  
  create view "dev"."main"."int_orders_enriched__dbt_tmp" as (
    WITH orders AS (
    SELECT * FROM "dev"."main"."stg_orders"
),

customers AS (
    SELECT * FROM "dev"."main"."stg_customers"
),

enriched AS (
    SELECT
        o.order_id,
        o.order_number,
        o.order_date,
        o.status,
        o.subtotal,
        o.discount_percent,
        o.shipping_cost,
        o.tax_amount,
        o.total_amount,
        o.payment_method,
        o.shipping_method,
        o.promotion_id,
        o.notes,
        
        -- Customer info
        c.customer_id,
        c.customer_name,
        c.customer_email,
        c.customer_city,
        
        -- Calculated fields
        DATE_TRUNC('month', o.order_date) AS order_month,
        CASE 
            WHEN o.total_amount > 1000 THEN 'High Value'
            WHEN o.total_amount > 500 THEN 'Medium Value'
            ELSE 'Low Value'
        END AS order_tier
        
    FROM orders o
    LEFT JOIN customers c ON o.customer_id = c.customer_id
)

SELECT * FROM enriched
  );

[0m01:50:47.744664 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m01:50:47.745731 [debug] [Thread-1 (]: Using duckdb connection "model.ecommerce_analytics.int_orders_enriched"
[0m01:50:47.745731 [debug] [Thread-1 (]: On model.ecommerce_analytics.int_orders_enriched: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "ecommerce_analytics", "target_name": "dev", "node_id": "model.ecommerce_analytics.int_orders_enriched"} */
alter view "dev"."main"."int_orders_enriched" rename to "int_orders_enriched__dbt_backup"
[0m01:50:47.745731 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m01:50:47.754736 [debug] [Thread-1 (]: Using duckdb connection "model.ecommerce_analytics.int_orders_enriched"
[0m01:50:47.754736 [debug] [Thread-1 (]: On model.ecommerce_analytics.int_orders_enriched: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "ecommerce_analytics", "target_name": "dev", "node_id": "model.ecommerce_analytics.int_orders_enriched"} */
alter view "dev"."main"."int_orders_enriched__dbt_tmp" rename to "int_orders_enriched"
[0m01:50:47.754736 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m01:50:47.754736 [debug] [Thread-1 (]: On model.ecommerce_analytics.int_orders_enriched: COMMIT
[0m01:50:47.754736 [debug] [Thread-1 (]: Using duckdb connection "model.ecommerce_analytics.int_orders_enriched"
[0m01:50:47.754736 [debug] [Thread-1 (]: On model.ecommerce_analytics.int_orders_enriched: COMMIT
[0m01:50:47.761291 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m01:50:47.765105 [debug] [Thread-1 (]: Using duckdb connection "model.ecommerce_analytics.int_orders_enriched"
[0m01:50:47.765105 [debug] [Thread-1 (]: On model.ecommerce_analytics.int_orders_enriched: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "ecommerce_analytics", "target_name": "dev", "node_id": "model.ecommerce_analytics.int_orders_enriched"} */

      drop view if exists "dev"."main"."int_orders_enriched__dbt_backup" cascade
    
[0m01:50:47.765105 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m01:50:47.768497 [debug] [Thread-1 (]: On model.ecommerce_analytics.int_orders_enriched: Close
[0m01:50:47.768497 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '82f0bd7c-e6c2-4e96-a09d-ef126d5b8660', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D0D57CD590>]}
[0m01:50:47.768497 [info ] [Thread-1 (]: 5 of 7 OK created sql view model main.int_orders_enriched ...................... [[32mOK[0m in 0.04s]
[0m01:50:47.768497 [debug] [Thread-1 (]: Finished running node model.ecommerce_analytics.int_orders_enriched
[0m01:50:47.768497 [debug] [Thread-1 (]: Began running node model.ecommerce_analytics.dim_products
[0m01:50:47.768497 [info ] [Thread-1 (]: 6 of 7 START sql table model main.dim_products ................................. [RUN]
[0m01:50:47.768497 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ecommerce_analytics.int_orders_enriched, now model.ecommerce_analytics.dim_products)
[0m01:50:47.768497 [debug] [Thread-1 (]: Began compiling node model.ecommerce_analytics.dim_products
[0m01:50:47.775453 [debug] [Thread-1 (]: Writing injected SQL for node "model.ecommerce_analytics.dim_products"
[0m01:50:47.778104 [debug] [Thread-1 (]: Began executing node model.ecommerce_analytics.dim_products
[0m01:50:47.796497 [debug] [Thread-1 (]: Writing runtime sql for node "model.ecommerce_analytics.dim_products"
[0m01:50:47.796497 [debug] [Thread-1 (]: Using duckdb connection "model.ecommerce_analytics.dim_products"
[0m01:50:47.796497 [debug] [Thread-1 (]: On model.ecommerce_analytics.dim_products: BEGIN
[0m01:50:47.796497 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:50:47.796497 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m01:50:47.796497 [debug] [Thread-1 (]: Using duckdb connection "model.ecommerce_analytics.dim_products"
[0m01:50:47.796497 [debug] [Thread-1 (]: On model.ecommerce_analytics.dim_products: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "ecommerce_analytics", "target_name": "dev", "node_id": "model.ecommerce_analytics.dim_products"} */

  
    
    

    create  table
      "dev"."main"."dim_products__dbt_tmp"
  
    as (
      

WITH products AS (
    SELECT DISTINCT
        product_id,
        sku,
        product_name,
        description,
        category_id,
        brand_id,
        supplier_id,
        price,
        cost,
        weight_kg,
        is_active,
        created_at,
        updated_at
    FROM "dev"."main"."stg_products"
)

SELECT * FROM products
    );
  
  
[0m01:50:47.811282 [debug] [Thread-1 (]: SQL status: OK in 0.007 seconds
[0m01:50:47.817984 [debug] [Thread-1 (]: Using duckdb connection "model.ecommerce_analytics.dim_products"
[0m01:50:47.817984 [debug] [Thread-1 (]: On model.ecommerce_analytics.dim_products: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "ecommerce_analytics", "target_name": "dev", "node_id": "model.ecommerce_analytics.dim_products"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'main'
      AND table_name = 'dim_products'
  
[0m01:50:47.817984 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m01:50:47.817984 [debug] [Thread-1 (]: Using duckdb connection "model.ecommerce_analytics.dim_products"
[0m01:50:47.817984 [debug] [Thread-1 (]: On model.ecommerce_analytics.dim_products: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "ecommerce_analytics", "target_name": "dev", "node_id": "model.ecommerce_analytics.dim_products"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'main'
      AND table_name = 'dim_products'
  
[0m01:50:47.817984 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m01:50:47.827830 [debug] [Thread-1 (]: Using duckdb connection "model.ecommerce_analytics.dim_products"
[0m01:50:47.828629 [debug] [Thread-1 (]: On model.ecommerce_analytics.dim_products: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "ecommerce_analytics", "target_name": "dev", "node_id": "model.ecommerce_analytics.dim_products"} */
alter table "dev"."main"."dim_products" rename to "dim_products__dbt_backup"
[0m01:50:47.829223 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m01:50:47.829223 [debug] [Thread-1 (]: Using duckdb connection "model.ecommerce_analytics.dim_products"
[0m01:50:47.829223 [debug] [Thread-1 (]: On model.ecommerce_analytics.dim_products: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "ecommerce_analytics", "target_name": "dev", "node_id": "model.ecommerce_analytics.dim_products"} */
alter table "dev"."main"."dim_products__dbt_tmp" rename to "dim_products"
[0m01:50:47.829223 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m01:50:47.838362 [debug] [Thread-1 (]: On model.ecommerce_analytics.dim_products: COMMIT
[0m01:50:47.838362 [debug] [Thread-1 (]: Using duckdb connection "model.ecommerce_analytics.dim_products"
[0m01:50:47.838362 [debug] [Thread-1 (]: On model.ecommerce_analytics.dim_products: COMMIT
[0m01:50:47.838362 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m01:50:47.844784 [debug] [Thread-1 (]: Using duckdb connection "model.ecommerce_analytics.dim_products"
[0m01:50:47.844784 [debug] [Thread-1 (]: On model.ecommerce_analytics.dim_products: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "ecommerce_analytics", "target_name": "dev", "node_id": "model.ecommerce_analytics.dim_products"} */

      drop table if exists "dev"."main"."dim_products__dbt_backup" cascade
    
[0m01:50:47.848534 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m01:50:47.848534 [debug] [Thread-1 (]: On model.ecommerce_analytics.dim_products: Close
[0m01:50:47.848534 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '82f0bd7c-e6c2-4e96-a09d-ef126d5b8660', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D0D57DF250>]}
[0m01:50:47.852389 [info ] [Thread-1 (]: 6 of 7 OK created sql table model main.dim_products ............................ [[32mOK[0m in 0.08s]
[0m01:50:47.852389 [debug] [Thread-1 (]: Finished running node model.ecommerce_analytics.dim_products
[0m01:50:47.852389 [debug] [Thread-1 (]: Began running node model.ecommerce_analytics.fct_orders
[0m01:50:47.852389 [info ] [Thread-1 (]: 7 of 7 START sql table model main.fct_orders ................................... [RUN]
[0m01:50:47.852389 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ecommerce_analytics.dim_products, now model.ecommerce_analytics.fct_orders)
[0m01:50:47.852389 [debug] [Thread-1 (]: Began compiling node model.ecommerce_analytics.fct_orders
[0m01:50:47.858773 [debug] [Thread-1 (]: Writing injected SQL for node "model.ecommerce_analytics.fct_orders"
[0m01:50:47.860531 [debug] [Thread-1 (]: Began executing node model.ecommerce_analytics.fct_orders
[0m01:50:47.862369 [debug] [Thread-1 (]: Writing runtime sql for node "model.ecommerce_analytics.fct_orders"
[0m01:50:47.862369 [debug] [Thread-1 (]: Using duckdb connection "model.ecommerce_analytics.fct_orders"
[0m01:50:47.862369 [debug] [Thread-1 (]: On model.ecommerce_analytics.fct_orders: BEGIN
[0m01:50:47.862369 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:50:47.869155 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m01:50:47.869842 [debug] [Thread-1 (]: Using duckdb connection "model.ecommerce_analytics.fct_orders"
[0m01:50:47.869842 [debug] [Thread-1 (]: On model.ecommerce_analytics.fct_orders: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "ecommerce_analytics", "target_name": "dev", "node_id": "model.ecommerce_analytics.fct_orders"} */

  
    
    

    create  table
      "dev"."main"."fct_orders__dbt_tmp"
  
    as (
      

WITH orders AS (
    SELECT * FROM "dev"."main"."int_orders_enriched"
)

SELECT
    order_id,
    order_date,
    order_month,
    customer_id,
    product_id,
    quantity,
    unit_price,
    total_amount,
    discount_amount,
    order_tier
FROM orders
    );
  
  
[0m01:50:47.869842 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "ecommerce_analytics", "target_name": "dev", "node_id": "model.ecommerce_analytics.fct_orders"} */

  
    
    

    create  table
      "dev"."main"."fct_orders__dbt_tmp"
  
    as (
      

WITH orders AS (
    SELECT * FROM "dev"."main"."int_orders_enriched"
)

SELECT
    order_id,
    order_date,
    order_month,
    customer_id,
    product_id,
    quantity,
    unit_price,
    total_amount,
    discount_amount,
    order_tier
FROM orders
    );
  
  
[0m01:50:47.869842 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m01:50:47.869842 [debug] [Thread-1 (]: On model.ecommerce_analytics.fct_orders: ROLLBACK
[0m01:50:47.879977 [debug] [Thread-1 (]: Failed to rollback 'model.ecommerce_analytics.fct_orders'
[0m01:50:47.879977 [debug] [Thread-1 (]: On model.ecommerce_analytics.fct_orders: Close
[0m01:50:47.879977 [debug] [Thread-1 (]: Runtime Error in model fct_orders (models\example\marts\fct_orders.sql)
  Binder Error: Referenced column "product_id" not found in FROM clause!
  Candidate bindings: "promotion_id", "order_id", "customer_id", "customer_email", "customer_city"
  
  LINE 22:     product_id,
               ^
[0m01:50:47.879977 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '82f0bd7c-e6c2-4e96-a09d-ef126d5b8660', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D0D4665A10>]}
[0m01:50:47.879977 [error] [Thread-1 (]: 7 of 7 ERROR creating sql table model main.fct_orders .......................... [[31mERROR[0m in 0.03s]
[0m01:50:47.879977 [debug] [Thread-1 (]: Finished running node model.ecommerce_analytics.fct_orders
[0m01:50:47.879977 [debug] [Thread-4 (]: Marking all children of 'model.ecommerce_analytics.fct_orders' to be skipped because of status 'error'.  Reason: Runtime Error in model fct_orders (models\example\marts\fct_orders.sql)
  Binder Error: Referenced column "product_id" not found in FROM clause!
  Candidate bindings: "promotion_id", "order_id", "customer_id", "customer_email", "customer_city"
  
  LINE 22:     product_id,
               ^.
[0m01:50:47.888964 [debug] [MainThread]: Using duckdb connection "master"
[0m01:50:47.890127 [debug] [MainThread]: On master: BEGIN
[0m01:50:47.890127 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m01:50:47.890127 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m01:50:47.890127 [debug] [MainThread]: On master: COMMIT
[0m01:50:47.890127 [debug] [MainThread]: Using duckdb connection "master"
[0m01:50:47.890127 [debug] [MainThread]: On master: COMMIT
[0m01:50:47.890127 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m01:50:47.890127 [debug] [MainThread]: On master: Close
[0m01:50:47.890127 [debug] [MainThread]: Connection 'master' was properly closed.
[0m01:50:47.890127 [debug] [MainThread]: Connection 'create_dev_main' was properly closed.
[0m01:50:47.890127 [debug] [MainThread]: Connection 'list_dev_main' was properly closed.
[0m01:50:47.890127 [debug] [MainThread]: Connection 'model.ecommerce_analytics.fct_orders' was properly closed.
[0m01:50:47.896187 [info ] [MainThread]: 
[0m01:50:47.896187 [info ] [MainThread]: Finished running 2 table models, 5 view models in 0 hours 0 minutes and 0.61 seconds (0.61s).
[0m01:50:47.900632 [debug] [MainThread]: Command end result
[0m01:50:47.935132 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\Lenovo\Desktop\Proyectos\dbt-proyect\ecommerce_analytics\target\manifest.json
[0m01:50:47.939790 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\Lenovo\Desktop\Proyectos\dbt-proyect\ecommerce_analytics\target\semantic_manifest.json
[0m01:50:47.944573 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\Lenovo\Desktop\Proyectos\dbt-proyect\ecommerce_analytics\target\run_results.json
[0m01:50:47.944573 [info ] [MainThread]: 
[0m01:50:47.944573 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m01:50:47.944573 [info ] [MainThread]: 
[0m01:50:47.953024 [error] [MainThread]: [31mFailure in model fct_orders (models\example\marts\fct_orders.sql)[0m
[0m01:50:47.953024 [error] [MainThread]:   Runtime Error in model fct_orders (models\example\marts\fct_orders.sql)
  Binder Error: Referenced column "product_id" not found in FROM clause!
  Candidate bindings: "promotion_id", "order_id", "customer_id", "customer_email", "customer_city"
  
  LINE 22:     product_id,
               ^
[0m01:50:47.953024 [info ] [MainThread]: 
[0m01:50:47.953024 [info ] [MainThread]:   compiled code at target\compiled\ecommerce_analytics\models\example\marts\fct_orders.sql
[0m01:50:47.953024 [info ] [MainThread]: 
[0m01:50:47.953024 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=7
[0m01:50:47.953024 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- MissingArgumentsPropertyInGenericTestDeprecation: 3 occurrences
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m01:50:47.962726 [debug] [MainThread]: Command `dbt run` failed at 01:50:47.960745 after 2.30 seconds
[0m01:50:47.962726 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D0D2952850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D0D14F3C90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D0CBBD4B50>]}
[0m01:50:47.962726 [debug] [MainThread]: Flushing usage events
[0m01:50:49.511372 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m01:51:39.001487 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001847E3BFFD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001847E3EF6D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001847E3EEF50>]}


============================== 01:51:39.008391 | 94060bf7-3636-415f-9b0b-afe6e828f199 ==============================
[0m01:51:39.008391 [info ] [MainThread]: Running with dbt=1.11.2
[0m01:51:39.009437 [debug] [MainThread]: running dbt with arguments {'version_check': 'True', 'no_print': 'None', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'printer_width': '80', 'write_json': 'True', 'introspect': 'True', 'log_cache_events': 'False', 'empty': 'False', 'cache_selected_only': 'False', 'fail_fast': 'False', 'debug': 'False', 'log_format': 'default', 'partial_parse': 'True', 'send_anonymous_usage_stats': 'True', 'quiet': 'False', 'warn_error': 'None', 'profiles_dir': 'C:\\Users\\Lenovo\\.dbt', 'use_colors': 'True', 'invocation_command': 'dbt run', 'indirect_selection': 'eager', 'use_experimental_parser': 'False', 'log_path': 'C:\\Users\\Lenovo\\Desktop\\Proyectos\\dbt-proyect\\ecommerce_analytics\\logs'}
[0m01:51:39.315762 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '94060bf7-3636-415f-9b0b-afe6e828f199', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001847E48A3D0>]}
[0m01:51:39.381987 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '94060bf7-3636-415f-9b0b-afe6e828f199', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001847AD80590>]}
[0m01:51:39.391681 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m01:51:39.629319 [debug] [MainThread]: checksum: 3d40d8bbe1bef07db1c24822f2dbfff8bc07f2a48ed4fe2658a40653aec0b54b, vars: {}, profile: , target: , version: 1.11.2
[0m01:51:39.900534 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m01:51:39.900534 [debug] [MainThread]: Partial parsing: updated file: ecommerce_analytics://models\example\marts\fct_orders.sql
[0m01:51:40.220139 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '94060bf7-3636-415f-9b0b-afe6e828f199', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001847FC67650>]}
[0m01:51:40.306221 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\Lenovo\Desktop\Proyectos\dbt-proyect\ecommerce_analytics\target\manifest.json
[0m01:51:40.306221 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\Lenovo\Desktop\Proyectos\dbt-proyect\ecommerce_analytics\target\semantic_manifest.json
[0m01:51:40.347621 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '94060bf7-3636-415f-9b0b-afe6e828f199', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001847E421350>]}
[0m01:51:40.347621 [info ] [MainThread]: Found 3 seeds, 7 models, 14 data tests, 587 macros
[0m01:51:40.347621 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '94060bf7-3636-415f-9b0b-afe6e828f199', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001847FAC9990>]}
[0m01:51:40.347621 [info ] [MainThread]: 
[0m01:51:40.347621 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m01:51:40.347621 [info ] [MainThread]: 
[0m01:51:40.357720 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m01:51:40.364891 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_dev'
[0m01:51:40.440528 [debug] [ThreadPool]: Using duckdb connection "list_dev"
[0m01:51:40.440528 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "ecommerce_analytics", "target_name": "dev", "connection_name": "list_dev"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"dev"'
    
  
  
[0m01:51:40.440528 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:51:40.482095 [debug] [ThreadPool]: SQL status: OK in 0.048 seconds
[0m01:51:40.492355 [debug] [ThreadPool]: On list_dev: Close
[0m01:51:40.492355 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev, now create_dev_main)
[0m01:51:40.492355 [debug] [ThreadPool]: Creating schema "database: "dev"
schema: "main"
"
[0m01:51:40.503507 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m01:51:40.504089 [debug] [ThreadPool]: On create_dev_main: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "ecommerce_analytics", "target_name": "dev", "connection_name": "create_dev_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='dev'
        and type='sqlite'
    
  
[0m01:51:40.504089 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m01:51:40.505267 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m01:51:40.505267 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m01:51:40.505267 [debug] [ThreadPool]: On create_dev_main: BEGIN
[0m01:51:40.509358 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m01:51:40.509358 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m01:51:40.509358 [debug] [ThreadPool]: On create_dev_main: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "ecommerce_analytics", "target_name": "dev", "connection_name": "create_dev_main"} */

    
    
        create schema if not exists "dev"."main"
    
[0m01:51:40.509358 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m01:51:40.512995 [debug] [ThreadPool]: On create_dev_main: COMMIT
[0m01:51:40.512995 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m01:51:40.512995 [debug] [ThreadPool]: On create_dev_main: COMMIT
[0m01:51:40.512995 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m01:51:40.512995 [debug] [ThreadPool]: On create_dev_main: Close
[0m01:51:40.512995 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_dev_main'
[0m01:51:40.524057 [debug] [ThreadPool]: Using duckdb connection "list_dev_main"
[0m01:51:40.524057 [debug] [ThreadPool]: On list_dev_main: BEGIN
[0m01:51:40.524057 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:51:40.524057 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m01:51:40.528864 [debug] [ThreadPool]: Using duckdb connection "list_dev_main"
[0m01:51:40.528864 [debug] [ThreadPool]: On list_dev_main: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "ecommerce_analytics", "target_name": "dev", "connection_name": "list_dev_main"} */
select
      'dev' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'dev'
  
[0m01:51:40.546069 [debug] [ThreadPool]: SQL status: OK in 0.019 seconds
[0m01:51:40.546069 [debug] [ThreadPool]: On list_dev_main: ROLLBACK
[0m01:51:40.546069 [debug] [ThreadPool]: Failed to rollback 'list_dev_main'
[0m01:51:40.546069 [debug] [ThreadPool]: On list_dev_main: Close
[0m01:51:40.554304 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '94060bf7-3636-415f-9b0b-afe6e828f199', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001847F83BC10>]}
[0m01:51:40.554304 [debug] [MainThread]: Using duckdb connection "master"
[0m01:51:40.554304 [debug] [MainThread]: On master: BEGIN
[0m01:51:40.556424 [debug] [MainThread]: Opening a new connection, currently in state init
[0m01:51:40.556424 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m01:51:40.556424 [debug] [MainThread]: On master: COMMIT
[0m01:51:40.556424 [debug] [MainThread]: Using duckdb connection "master"
[0m01:51:40.556424 [debug] [MainThread]: On master: COMMIT
[0m01:51:40.556424 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m01:51:40.559800 [debug] [MainThread]: On master: Close
[0m01:51:40.564689 [debug] [Thread-1 (]: Began running node model.ecommerce_analytics.dim_customers
[0m01:51:40.565710 [info ] [Thread-1 (]: 1 of 7 START sql view model main.dim_customers ................................. [RUN]
[0m01:51:40.565710 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.ecommerce_analytics.dim_customers'
[0m01:51:40.565710 [debug] [Thread-1 (]: Began compiling node model.ecommerce_analytics.dim_customers
[0m01:51:40.565710 [debug] [Thread-1 (]: Writing injected SQL for node "model.ecommerce_analytics.dim_customers"
[0m01:51:40.575244 [debug] [Thread-1 (]: Began executing node model.ecommerce_analytics.dim_customers
[0m01:51:40.606260 [debug] [Thread-1 (]: Writing runtime sql for node "model.ecommerce_analytics.dim_customers"
[0m01:51:40.606260 [debug] [Thread-1 (]: Using duckdb connection "model.ecommerce_analytics.dim_customers"
[0m01:51:40.606260 [debug] [Thread-1 (]: On model.ecommerce_analytics.dim_customers: BEGIN
[0m01:51:40.609348 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m01:51:40.610260 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m01:51:40.610260 [debug] [Thread-1 (]: Using duckdb connection "model.ecommerce_analytics.dim_customers"
[0m01:51:40.611979 [debug] [Thread-1 (]: On model.ecommerce_analytics.dim_customers: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "ecommerce_analytics", "target_name": "dev", "node_id": "model.ecommerce_analytics.dim_customers"} */

  
  create view "dev"."main"."dim_customers__dbt_tmp" as (
    WITH source AS (
    SELECT * FROM "dev"."main"."raw_customers"
),

renamed AS (
    SELECT
        customer_id,
        first_name || ' ' || last_name AS customer_name,
        email AS customer_email,
        phone,
        CAST(birth_date AS DATE) AS birth_date,
        city AS customer_city,
        country,
        postal_code,
        segment,
        CAST(registration_date AS DATE) AS registration_date,
        CAST(last_login AS DATE) AS last_login,
        is_verified,
        accepts_marketing
    FROM source
)

SELECT * FROM renamed
  );

[0m01:51:40.611979 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m01:51:40.616449 [debug] [Thread-1 (]: Using duckdb connection "model.ecommerce_analytics.dim_customers"
[0m01:51:40.616449 [debug] [Thread-1 (]: On model.ecommerce_analytics.dim_customers: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "ecommerce_analytics", "target_name": "dev", "node_id": "model.ecommerce_analytics.dim_customers"} */
alter view "dev"."main"."dim_customers" rename to "dim_customers__dbt_backup"
[0m01:51:40.616449 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m01:51:40.628530 [debug] [Thread-1 (]: Using duckdb connection "model.ecommerce_analytics.dim_customers"
[0m01:51:40.628530 [debug] [Thread-1 (]: On model.ecommerce_analytics.dim_customers: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "ecommerce_analytics", "target_name": "dev", "node_id": "model.ecommerce_analytics.dim_customers"} */
alter view "dev"."main"."dim_customers__dbt_tmp" rename to "dim_customers"
[0m01:51:40.630561 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m01:51:40.643739 [debug] [Thread-1 (]: On model.ecommerce_analytics.dim_customers: COMMIT
[0m01:51:40.643739 [debug] [Thread-1 (]: Using duckdb connection "model.ecommerce_analytics.dim_customers"
[0m01:51:40.643739 [debug] [Thread-1 (]: On model.ecommerce_analytics.dim_customers: COMMIT
[0m01:51:40.658854 [debug] [Thread-1 (]: SQL status: OK in 0.016 seconds
[0m01:51:40.669249 [debug] [Thread-1 (]: Using duckdb connection "model.ecommerce_analytics.dim_customers"
[0m01:51:40.669249 [debug] [Thread-1 (]: On model.ecommerce_analytics.dim_customers: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "ecommerce_analytics", "target_name": "dev", "node_id": "model.ecommerce_analytics.dim_customers"} */

      drop view if exists "dev"."main"."dim_customers__dbt_backup" cascade
    
[0m01:51:40.669249 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m01:51:40.674528 [debug] [Thread-1 (]: On model.ecommerce_analytics.dim_customers: Close
[0m01:51:40.674528 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '94060bf7-3636-415f-9b0b-afe6e828f199', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001847FBF5CD0>]}
[0m01:51:40.674528 [info ] [Thread-1 (]: 1 of 7 OK created sql view model main.dim_customers ............................ [[32mOK[0m in 0.11s]
[0m01:51:40.674528 [debug] [Thread-1 (]: Finished running node model.ecommerce_analytics.dim_customers
[0m01:51:40.679298 [debug] [Thread-1 (]: Began running node model.ecommerce_analytics.stg_customers
[0m01:51:40.679813 [info ] [Thread-1 (]: 2 of 7 START sql view model main.stg_customers ................................. [RUN]
[0m01:51:40.679813 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ecommerce_analytics.dim_customers, now model.ecommerce_analytics.stg_customers)
[0m01:51:40.679813 [debug] [Thread-1 (]: Began compiling node model.ecommerce_analytics.stg_customers
[0m01:51:40.679813 [debug] [Thread-1 (]: Writing injected SQL for node "model.ecommerce_analytics.stg_customers"
[0m01:51:40.679813 [debug] [Thread-1 (]: Began executing node model.ecommerce_analytics.stg_customers
[0m01:51:40.679813 [debug] [Thread-1 (]: Writing runtime sql for node "model.ecommerce_analytics.stg_customers"
[0m01:51:40.689863 [debug] [Thread-1 (]: Using duckdb connection "model.ecommerce_analytics.stg_customers"
[0m01:51:40.689863 [debug] [Thread-1 (]: On model.ecommerce_analytics.stg_customers: BEGIN
[0m01:51:40.691931 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:51:40.693404 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m01:51:40.693404 [debug] [Thread-1 (]: Using duckdb connection "model.ecommerce_analytics.stg_customers"
[0m01:51:40.693404 [debug] [Thread-1 (]: On model.ecommerce_analytics.stg_customers: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "ecommerce_analytics", "target_name": "dev", "node_id": "model.ecommerce_analytics.stg_customers"} */

  
  create view "dev"."main"."stg_customers__dbt_tmp" as (
    WITH source AS (
    SELECT * FROM "dev"."main"."raw_customers"
),

renamed AS (
    SELECT
        customer_id,
        first_name || ' ' || last_name AS customer_name,
        email AS customer_email,
        phone,
        CAST(birth_date AS DATE) AS birth_date,
        city AS customer_city,
        country,
        postal_code,
        segment,
        CAST(registration_date AS DATE) AS registration_date,
        CAST(last_login AS DATE) AS last_login,
        is_verified,
        accepts_marketing
    FROM source
)

SELECT * FROM renamed
  );

[0m01:51:40.696363 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m01:51:40.702214 [debug] [Thread-1 (]: Using duckdb connection "model.ecommerce_analytics.stg_customers"
[0m01:51:40.702214 [debug] [Thread-1 (]: On model.ecommerce_analytics.stg_customers: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "ecommerce_analytics", "target_name": "dev", "node_id": "model.ecommerce_analytics.stg_customers"} */
alter view "dev"."main"."stg_customers" rename to "stg_customers__dbt_backup"
[0m01:51:40.702214 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m01:51:40.706454 [debug] [Thread-1 (]: Using duckdb connection "model.ecommerce_analytics.stg_customers"
[0m01:51:40.706454 [debug] [Thread-1 (]: On model.ecommerce_analytics.stg_customers: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "ecommerce_analytics", "target_name": "dev", "node_id": "model.ecommerce_analytics.stg_customers"} */
alter view "dev"."main"."stg_customers__dbt_tmp" rename to "stg_customers"
[0m01:51:40.706454 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m01:51:40.706454 [debug] [Thread-1 (]: On model.ecommerce_analytics.stg_customers: COMMIT
[0m01:51:40.710997 [debug] [Thread-1 (]: Using duckdb connection "model.ecommerce_analytics.stg_customers"
[0m01:51:40.710997 [debug] [Thread-1 (]: On model.ecommerce_analytics.stg_customers: COMMIT
[0m01:51:40.713592 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m01:51:40.713592 [debug] [Thread-1 (]: Using duckdb connection "model.ecommerce_analytics.stg_customers"
[0m01:51:40.713592 [debug] [Thread-1 (]: On model.ecommerce_analytics.stg_customers: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "ecommerce_analytics", "target_name": "dev", "node_id": "model.ecommerce_analytics.stg_customers"} */

      drop view if exists "dev"."main"."stg_customers__dbt_backup" cascade
    
[0m01:51:40.713592 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m01:51:40.721465 [debug] [Thread-1 (]: On model.ecommerce_analytics.stg_customers: Close
[0m01:51:40.722659 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '94060bf7-3636-415f-9b0b-afe6e828f199', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001840005B750>]}
[0m01:51:40.722659 [info ] [Thread-1 (]: 2 of 7 OK created sql view model main.stg_customers ............................ [[32mOK[0m in 0.04s]
[0m01:51:40.722659 [debug] [Thread-1 (]: Finished running node model.ecommerce_analytics.stg_customers
[0m01:51:40.722659 [debug] [Thread-1 (]: Began running node model.ecommerce_analytics.stg_orders
[0m01:51:40.722659 [info ] [Thread-1 (]: 3 of 7 START sql view model main.stg_orders .................................... [RUN]
[0m01:51:40.726868 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ecommerce_analytics.stg_customers, now model.ecommerce_analytics.stg_orders)
[0m01:51:40.727605 [debug] [Thread-1 (]: Began compiling node model.ecommerce_analytics.stg_orders
[0m01:51:40.731742 [debug] [Thread-1 (]: Writing injected SQL for node "model.ecommerce_analytics.stg_orders"
[0m01:51:40.732768 [debug] [Thread-1 (]: Began executing node model.ecommerce_analytics.stg_orders
[0m01:51:40.732768 [debug] [Thread-1 (]: Writing runtime sql for node "model.ecommerce_analytics.stg_orders"
[0m01:51:40.732768 [debug] [Thread-1 (]: Using duckdb connection "model.ecommerce_analytics.stg_orders"
[0m01:51:40.738386 [debug] [Thread-1 (]: On model.ecommerce_analytics.stg_orders: BEGIN
[0m01:51:40.738386 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:51:40.740583 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m01:51:40.740583 [debug] [Thread-1 (]: Using duckdb connection "model.ecommerce_analytics.stg_orders"
[0m01:51:40.742091 [debug] [Thread-1 (]: On model.ecommerce_analytics.stg_orders: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "ecommerce_analytics", "target_name": "dev", "node_id": "model.ecommerce_analytics.stg_orders"} */

  
  create view "dev"."main"."stg_orders__dbt_tmp" as (
    WITH source AS (
    SELECT * FROM "dev"."main"."raw_orders"
),

renamed AS (
    SELECT
        order_id,
        order_number,
        customer_id,
        CAST(order_date AS DATE) AS order_date,
        status,
        CAST(subtotal AS DECIMAL(10,2)) AS subtotal,
        CAST(discount_percent AS DECIMAL(10,2)) AS discount_percent,
        CAST(shipping_cost AS DECIMAL(10,2)) AS shipping_cost,
        CAST(tax_amount AS DECIMAL(10,2)) AS tax_amount,
        CAST(total_amount AS DECIMAL(10,2)) AS total_amount,
        payment_method,
        shipping_method,
        promotion_id,
        notes
    FROM source
)

SELECT * FROM renamed
  );

[0m01:51:40.744871 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m01:51:40.746829 [debug] [Thread-1 (]: Using duckdb connection "model.ecommerce_analytics.stg_orders"
[0m01:51:40.746829 [debug] [Thread-1 (]: On model.ecommerce_analytics.stg_orders: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "ecommerce_analytics", "target_name": "dev", "node_id": "model.ecommerce_analytics.stg_orders"} */
alter view "dev"."main"."stg_orders" rename to "stg_orders__dbt_backup"
[0m01:51:40.746829 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m01:51:40.754609 [debug] [Thread-1 (]: Using duckdb connection "model.ecommerce_analytics.stg_orders"
[0m01:51:40.754609 [debug] [Thread-1 (]: On model.ecommerce_analytics.stg_orders: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "ecommerce_analytics", "target_name": "dev", "node_id": "model.ecommerce_analytics.stg_orders"} */
alter view "dev"."main"."stg_orders__dbt_tmp" rename to "stg_orders"
[0m01:51:40.754609 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m01:51:40.760491 [debug] [Thread-1 (]: On model.ecommerce_analytics.stg_orders: COMMIT
[0m01:51:40.760491 [debug] [Thread-1 (]: Using duckdb connection "model.ecommerce_analytics.stg_orders"
[0m01:51:40.760491 [debug] [Thread-1 (]: On model.ecommerce_analytics.stg_orders: COMMIT
[0m01:51:40.762998 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m01:51:40.767622 [debug] [Thread-1 (]: Using duckdb connection "model.ecommerce_analytics.stg_orders"
[0m01:51:40.767622 [debug] [Thread-1 (]: On model.ecommerce_analytics.stg_orders: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "ecommerce_analytics", "target_name": "dev", "node_id": "model.ecommerce_analytics.stg_orders"} */

      drop view if exists "dev"."main"."stg_orders__dbt_backup" cascade
    
[0m01:51:40.767622 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m01:51:40.770492 [debug] [Thread-1 (]: On model.ecommerce_analytics.stg_orders: Close
[0m01:51:40.770492 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '94060bf7-3636-415f-9b0b-afe6e828f199', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001840019EA10>]}
[0m01:51:40.773199 [info ] [Thread-1 (]: 3 of 7 OK created sql view model main.stg_orders ............................... [[32mOK[0m in 0.05s]
[0m01:51:40.773199 [debug] [Thread-1 (]: Finished running node model.ecommerce_analytics.stg_orders
[0m01:51:40.773199 [debug] [Thread-1 (]: Began running node model.ecommerce_analytics.stg_products
[0m01:51:40.773199 [info ] [Thread-1 (]: 4 of 7 START sql view model main.stg_products .................................. [RUN]
[0m01:51:40.777228 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ecommerce_analytics.stg_orders, now model.ecommerce_analytics.stg_products)
[0m01:51:40.777228 [debug] [Thread-1 (]: Began compiling node model.ecommerce_analytics.stg_products
[0m01:51:40.777228 [debug] [Thread-1 (]: Writing injected SQL for node "model.ecommerce_analytics.stg_products"
[0m01:51:40.777228 [debug] [Thread-1 (]: Began executing node model.ecommerce_analytics.stg_products
[0m01:51:40.788193 [debug] [Thread-1 (]: Writing runtime sql for node "model.ecommerce_analytics.stg_products"
[0m01:51:40.788968 [debug] [Thread-1 (]: Using duckdb connection "model.ecommerce_analytics.stg_products"
[0m01:51:40.788968 [debug] [Thread-1 (]: On model.ecommerce_analytics.stg_products: BEGIN
[0m01:51:40.788968 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:51:40.788968 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m01:51:40.788968 [debug] [Thread-1 (]: Using duckdb connection "model.ecommerce_analytics.stg_products"
[0m01:51:40.788968 [debug] [Thread-1 (]: On model.ecommerce_analytics.stg_products: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "ecommerce_analytics", "target_name": "dev", "node_id": "model.ecommerce_analytics.stg_products"} */

  
  create view "dev"."main"."stg_products__dbt_tmp" as (
    WITH source AS (
    SELECT * FROM "dev"."main"."raw_products"
),

renamed AS (
    SELECT
        product_id,
        sku,
        product_name,
        description,
        category_id,
        brand_id,
        supplier_id,
        CAST(price AS DECIMAL(10,2)) AS price,
        CAST(cost AS DECIMAL(10,2)) AS cost,
        CAST(weight_kg AS DECIMAL(10,2)) AS weight_kg,
        is_active,
        CAST(created_at AS DATE) AS created_at,
        CAST(updated_at AS DATE) AS updated_at
    FROM source
)

SELECT * FROM renamed
  );

[0m01:51:40.794037 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m01:51:40.794037 [debug] [Thread-1 (]: Using duckdb connection "model.ecommerce_analytics.stg_products"
[0m01:51:40.794037 [debug] [Thread-1 (]: On model.ecommerce_analytics.stg_products: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "ecommerce_analytics", "target_name": "dev", "node_id": "model.ecommerce_analytics.stg_products"} */
alter view "dev"."main"."stg_products" rename to "stg_products__dbt_backup"
[0m01:51:40.794037 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m01:51:40.804831 [debug] [Thread-1 (]: Using duckdb connection "model.ecommerce_analytics.stg_products"
[0m01:51:40.804831 [debug] [Thread-1 (]: On model.ecommerce_analytics.stg_products: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "ecommerce_analytics", "target_name": "dev", "node_id": "model.ecommerce_analytics.stg_products"} */
alter view "dev"."main"."stg_products__dbt_tmp" rename to "stg_products"
[0m01:51:40.804831 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m01:51:40.804831 [debug] [Thread-1 (]: On model.ecommerce_analytics.stg_products: COMMIT
[0m01:51:40.810381 [debug] [Thread-1 (]: Using duckdb connection "model.ecommerce_analytics.stg_products"
[0m01:51:40.810710 [debug] [Thread-1 (]: On model.ecommerce_analytics.stg_products: COMMIT
[0m01:51:40.810710 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m01:51:40.814746 [debug] [Thread-1 (]: Using duckdb connection "model.ecommerce_analytics.stg_products"
[0m01:51:40.814746 [debug] [Thread-1 (]: On model.ecommerce_analytics.stg_products: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "ecommerce_analytics", "target_name": "dev", "node_id": "model.ecommerce_analytics.stg_products"} */

      drop view if exists "dev"."main"."stg_products__dbt_backup" cascade
    
[0m01:51:40.814746 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m01:51:40.814746 [debug] [Thread-1 (]: On model.ecommerce_analytics.stg_products: Close
[0m01:51:40.814746 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '94060bf7-3636-415f-9b0b-afe6e828f199', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018400126910>]}
[0m01:51:40.814746 [info ] [Thread-1 (]: 4 of 7 OK created sql view model main.stg_products ............................. [[32mOK[0m in 0.04s]
[0m01:51:40.814746 [debug] [Thread-1 (]: Finished running node model.ecommerce_analytics.stg_products
[0m01:51:40.814746 [debug] [Thread-1 (]: Began running node model.ecommerce_analytics.int_orders_enriched
[0m01:51:40.825200 [info ] [Thread-1 (]: 5 of 7 START sql view model main.int_orders_enriched ........................... [RUN]
[0m01:51:40.826305 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ecommerce_analytics.stg_products, now model.ecommerce_analytics.int_orders_enriched)
[0m01:51:40.826925 [debug] [Thread-1 (]: Began compiling node model.ecommerce_analytics.int_orders_enriched
[0m01:51:40.828920 [debug] [Thread-1 (]: Writing injected SQL for node "model.ecommerce_analytics.int_orders_enriched"
[0m01:51:40.828920 [debug] [Thread-1 (]: Began executing node model.ecommerce_analytics.int_orders_enriched
[0m01:51:40.835666 [debug] [Thread-1 (]: Writing runtime sql for node "model.ecommerce_analytics.int_orders_enriched"
[0m01:51:40.835666 [debug] [Thread-1 (]: Using duckdb connection "model.ecommerce_analytics.int_orders_enriched"
[0m01:51:40.835666 [debug] [Thread-1 (]: On model.ecommerce_analytics.int_orders_enriched: BEGIN
[0m01:51:40.842002 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:51:40.843387 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m01:51:40.843978 [debug] [Thread-1 (]: Using duckdb connection "model.ecommerce_analytics.int_orders_enriched"
[0m01:51:40.845441 [debug] [Thread-1 (]: On model.ecommerce_analytics.int_orders_enriched: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "ecommerce_analytics", "target_name": "dev", "node_id": "model.ecommerce_analytics.int_orders_enriched"} */

  
  create view "dev"."main"."int_orders_enriched__dbt_tmp" as (
    WITH orders AS (
    SELECT * FROM "dev"."main"."stg_orders"
),

customers AS (
    SELECT * FROM "dev"."main"."stg_customers"
),

enriched AS (
    SELECT
        o.order_id,
        o.order_number,
        o.order_date,
        o.status,
        o.subtotal,
        o.discount_percent,
        o.shipping_cost,
        o.tax_amount,
        o.total_amount,
        o.payment_method,
        o.shipping_method,
        o.promotion_id,
        o.notes,
        
        -- Customer info
        c.customer_id,
        c.customer_name,
        c.customer_email,
        c.customer_city,
        
        -- Calculated fields
        DATE_TRUNC('month', o.order_date) AS order_month,
        CASE 
            WHEN o.total_amount > 1000 THEN 'High Value'
            WHEN o.total_amount > 500 THEN 'Medium Value'
            ELSE 'Low Value'
        END AS order_tier
        
    FROM orders o
    LEFT JOIN customers c ON o.customer_id = c.customer_id
)

SELECT * FROM enriched
  );

[0m01:51:40.847633 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m01:51:40.852054 [debug] [Thread-1 (]: Using duckdb connection "model.ecommerce_analytics.int_orders_enriched"
[0m01:51:40.852054 [debug] [Thread-1 (]: On model.ecommerce_analytics.int_orders_enriched: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "ecommerce_analytics", "target_name": "dev", "node_id": "model.ecommerce_analytics.int_orders_enriched"} */
alter view "dev"."main"."int_orders_enriched" rename to "int_orders_enriched__dbt_backup"
[0m01:51:40.852054 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m01:51:40.856084 [debug] [Thread-1 (]: Using duckdb connection "model.ecommerce_analytics.int_orders_enriched"
[0m01:51:40.856084 [debug] [Thread-1 (]: On model.ecommerce_analytics.int_orders_enriched: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "ecommerce_analytics", "target_name": "dev", "node_id": "model.ecommerce_analytics.int_orders_enriched"} */
alter view "dev"."main"."int_orders_enriched__dbt_tmp" rename to "int_orders_enriched"
[0m01:51:40.856084 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m01:51:40.858767 [debug] [Thread-1 (]: On model.ecommerce_analytics.int_orders_enriched: COMMIT
[0m01:51:40.860146 [debug] [Thread-1 (]: Using duckdb connection "model.ecommerce_analytics.int_orders_enriched"
[0m01:51:40.860146 [debug] [Thread-1 (]: On model.ecommerce_analytics.int_orders_enriched: COMMIT
[0m01:51:40.861661 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m01:51:40.866433 [debug] [Thread-1 (]: Using duckdb connection "model.ecommerce_analytics.int_orders_enriched"
[0m01:51:40.866433 [debug] [Thread-1 (]: On model.ecommerce_analytics.int_orders_enriched: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "ecommerce_analytics", "target_name": "dev", "node_id": "model.ecommerce_analytics.int_orders_enriched"} */

      drop view if exists "dev"."main"."int_orders_enriched__dbt_backup" cascade
    
[0m01:51:40.866433 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m01:51:40.866433 [debug] [Thread-1 (]: On model.ecommerce_analytics.int_orders_enriched: Close
[0m01:51:40.866433 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '94060bf7-3636-415f-9b0b-afe6e828f199', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000184001BD510>]}
[0m01:51:40.866433 [info ] [Thread-1 (]: 5 of 7 OK created sql view model main.int_orders_enriched ...................... [[32mOK[0m in 0.04s]
[0m01:51:40.874448 [debug] [Thread-1 (]: Finished running node model.ecommerce_analytics.int_orders_enriched
[0m01:51:40.874448 [debug] [Thread-1 (]: Began running node model.ecommerce_analytics.dim_products
[0m01:51:40.876952 [info ] [Thread-1 (]: 6 of 7 START sql table model main.dim_products ................................. [RUN]
[0m01:51:40.878453 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ecommerce_analytics.int_orders_enriched, now model.ecommerce_analytics.dim_products)
[0m01:51:40.878453 [debug] [Thread-1 (]: Began compiling node model.ecommerce_analytics.dim_products
[0m01:51:40.878453 [debug] [Thread-1 (]: Writing injected SQL for node "model.ecommerce_analytics.dim_products"
[0m01:51:40.878453 [debug] [Thread-1 (]: Began executing node model.ecommerce_analytics.dim_products
[0m01:51:40.908735 [debug] [Thread-1 (]: Writing runtime sql for node "model.ecommerce_analytics.dim_products"
[0m01:51:40.910153 [debug] [Thread-1 (]: Using duckdb connection "model.ecommerce_analytics.dim_products"
[0m01:51:40.910153 [debug] [Thread-1 (]: On model.ecommerce_analytics.dim_products: BEGIN
[0m01:51:40.910153 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:51:40.912485 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m01:51:40.912485 [debug] [Thread-1 (]: Using duckdb connection "model.ecommerce_analytics.dim_products"
[0m01:51:40.912485 [debug] [Thread-1 (]: On model.ecommerce_analytics.dim_products: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "ecommerce_analytics", "target_name": "dev", "node_id": "model.ecommerce_analytics.dim_products"} */

  
    
    

    create  table
      "dev"."main"."dim_products__dbt_tmp"
  
    as (
      

WITH products AS (
    SELECT DISTINCT
        product_id,
        sku,
        product_name,
        description,
        category_id,
        brand_id,
        supplier_id,
        price,
        cost,
        weight_kg,
        is_active,
        created_at,
        updated_at
    FROM "dev"."main"."stg_products"
)

SELECT * FROM products
    );
  
  
[0m01:51:40.919194 [debug] [Thread-1 (]: SQL status: OK in 0.007 seconds
[0m01:51:40.926938 [debug] [Thread-1 (]: Using duckdb connection "model.ecommerce_analytics.dim_products"
[0m01:51:40.928592 [debug] [Thread-1 (]: On model.ecommerce_analytics.dim_products: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "ecommerce_analytics", "target_name": "dev", "node_id": "model.ecommerce_analytics.dim_products"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'main'
      AND table_name = 'dim_products'
  
[0m01:51:40.929642 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m01:51:40.931833 [debug] [Thread-1 (]: Using duckdb connection "model.ecommerce_analytics.dim_products"
[0m01:51:40.931833 [debug] [Thread-1 (]: On model.ecommerce_analytics.dim_products: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "ecommerce_analytics", "target_name": "dev", "node_id": "model.ecommerce_analytics.dim_products"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'main'
      AND table_name = 'dim_products'
  
[0m01:51:40.933839 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m01:51:40.933839 [debug] [Thread-1 (]: Using duckdb connection "model.ecommerce_analytics.dim_products"
[0m01:51:40.933839 [debug] [Thread-1 (]: On model.ecommerce_analytics.dim_products: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "ecommerce_analytics", "target_name": "dev", "node_id": "model.ecommerce_analytics.dim_products"} */
alter table "dev"."main"."dim_products" rename to "dim_products__dbt_backup"
[0m01:51:40.933839 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m01:51:40.943677 [debug] [Thread-1 (]: Using duckdb connection "model.ecommerce_analytics.dim_products"
[0m01:51:40.943677 [debug] [Thread-1 (]: On model.ecommerce_analytics.dim_products: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "ecommerce_analytics", "target_name": "dev", "node_id": "model.ecommerce_analytics.dim_products"} */
alter table "dev"."main"."dim_products__dbt_tmp" rename to "dim_products"
[0m01:51:40.943677 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m01:51:40.943677 [debug] [Thread-1 (]: On model.ecommerce_analytics.dim_products: COMMIT
[0m01:51:40.950569 [debug] [Thread-1 (]: Using duckdb connection "model.ecommerce_analytics.dim_products"
[0m01:51:40.950569 [debug] [Thread-1 (]: On model.ecommerce_analytics.dim_products: COMMIT
[0m01:51:40.950569 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m01:51:40.958952 [debug] [Thread-1 (]: Using duckdb connection "model.ecommerce_analytics.dim_products"
[0m01:51:40.960958 [debug] [Thread-1 (]: On model.ecommerce_analytics.dim_products: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "ecommerce_analytics", "target_name": "dev", "node_id": "model.ecommerce_analytics.dim_products"} */

      drop table if exists "dev"."main"."dim_products__dbt_backup" cascade
    
[0m01:51:40.962979 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m01:51:40.965988 [debug] [Thread-1 (]: On model.ecommerce_analytics.dim_products: Close
[0m01:51:40.967028 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '94060bf7-3636-415f-9b0b-afe6e828f199', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001840019F990>]}
[0m01:51:40.967028 [info ] [Thread-1 (]: 6 of 7 OK created sql table model main.dim_products ............................ [[32mOK[0m in 0.09s]
[0m01:51:40.969035 [debug] [Thread-1 (]: Finished running node model.ecommerce_analytics.dim_products
[0m01:51:40.969035 [debug] [Thread-1 (]: Began running node model.ecommerce_analytics.fct_orders
[0m01:51:40.969035 [info ] [Thread-1 (]: 7 of 7 START sql table model main.fct_orders ................................... [RUN]
[0m01:51:40.971541 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ecommerce_analytics.dim_products, now model.ecommerce_analytics.fct_orders)
[0m01:51:40.971541 [debug] [Thread-1 (]: Began compiling node model.ecommerce_analytics.fct_orders
[0m01:51:40.977444 [debug] [Thread-1 (]: Writing injected SQL for node "model.ecommerce_analytics.fct_orders"
[0m01:51:40.977444 [debug] [Thread-1 (]: Began executing node model.ecommerce_analytics.fct_orders
[0m01:51:40.983747 [debug] [Thread-1 (]: Writing runtime sql for node "model.ecommerce_analytics.fct_orders"
[0m01:51:40.985757 [debug] [Thread-1 (]: Using duckdb connection "model.ecommerce_analytics.fct_orders"
[0m01:51:40.985757 [debug] [Thread-1 (]: On model.ecommerce_analytics.fct_orders: BEGIN
[0m01:51:40.985757 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:51:40.987765 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m01:51:40.987765 [debug] [Thread-1 (]: Using duckdb connection "model.ecommerce_analytics.fct_orders"
[0m01:51:40.987765 [debug] [Thread-1 (]: On model.ecommerce_analytics.fct_orders: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "ecommerce_analytics", "target_name": "dev", "node_id": "model.ecommerce_analytics.fct_orders"} */

  
    
    

    create  table
      "dev"."main"."fct_orders__dbt_tmp"
  
    as (
      

WITH orders AS (
    SELECT * FROM "dev"."main"."int_orders_enriched"
)

SELECT
    order_id,
    order_number,
    order_date,
    order_month,
    customer_id,
    promotion_id,
    subtotal,
    discount_percent,
    shipping_cost,
    tax_amount,
    total_amount,
    payment_method,
    shipping_method,
    order_tier
FROM orders
    );
  
  
[0m01:51:41.000235 [debug] [Thread-1 (]: SQL status: OK in 0.010 seconds
[0m01:51:41.004825 [debug] [Thread-1 (]: Using duckdb connection "model.ecommerce_analytics.fct_orders"
[0m01:51:41.004825 [debug] [Thread-1 (]: On model.ecommerce_analytics.fct_orders: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "ecommerce_analytics", "target_name": "dev", "node_id": "model.ecommerce_analytics.fct_orders"} */
alter table "dev"."main"."fct_orders__dbt_tmp" rename to "fct_orders"
[0m01:51:41.004825 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m01:51:41.006829 [debug] [Thread-1 (]: On model.ecommerce_analytics.fct_orders: COMMIT
[0m01:51:41.008575 [debug] [Thread-1 (]: Using duckdb connection "model.ecommerce_analytics.fct_orders"
[0m01:51:41.008575 [debug] [Thread-1 (]: On model.ecommerce_analytics.fct_orders: COMMIT
[0m01:51:41.010580 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m01:51:41.013090 [debug] [Thread-1 (]: Using duckdb connection "model.ecommerce_analytics.fct_orders"
[0m01:51:41.013090 [debug] [Thread-1 (]: On model.ecommerce_analytics.fct_orders: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "ecommerce_analytics", "target_name": "dev", "node_id": "model.ecommerce_analytics.fct_orders"} */

      drop table if exists "dev"."main"."fct_orders__dbt_backup" cascade
    
[0m01:51:41.015247 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m01:51:41.016995 [debug] [Thread-1 (]: On model.ecommerce_analytics.fct_orders: Close
[0m01:51:41.016995 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '94060bf7-3636-415f-9b0b-afe6e828f199', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001840019EDD0>]}
[0m01:51:41.016995 [info ] [Thread-1 (]: 7 of 7 OK created sql table model main.fct_orders .............................. [[32mOK[0m in 0.05s]
[0m01:51:41.019001 [debug] [Thread-1 (]: Finished running node model.ecommerce_analytics.fct_orders
[0m01:51:41.021008 [debug] [MainThread]: Using duckdb connection "master"
[0m01:51:41.021008 [debug] [MainThread]: On master: BEGIN
[0m01:51:41.021008 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m01:51:41.021008 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m01:51:41.023514 [debug] [MainThread]: On master: COMMIT
[0m01:51:41.023514 [debug] [MainThread]: Using duckdb connection "master"
[0m01:51:41.023514 [debug] [MainThread]: On master: COMMIT
[0m01:51:41.025259 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m01:51:41.025259 [debug] [MainThread]: On master: Close
[0m01:51:41.025259 [debug] [MainThread]: Connection 'master' was properly closed.
[0m01:51:41.025259 [debug] [MainThread]: Connection 'create_dev_main' was properly closed.
[0m01:51:41.025259 [debug] [MainThread]: Connection 'list_dev_main' was properly closed.
[0m01:51:41.027264 [debug] [MainThread]: Connection 'model.ecommerce_analytics.fct_orders' was properly closed.
[0m01:51:41.027264 [info ] [MainThread]: 
[0m01:51:41.027264 [info ] [MainThread]: Finished running 2 table models, 5 view models in 0 hours 0 minutes and 0.68 seconds (0.68s).
[0m01:51:41.031291 [debug] [MainThread]: Command end result
[0m01:51:41.070063 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\Lenovo\Desktop\Proyectos\dbt-proyect\ecommerce_analytics\target\manifest.json
[0m01:51:41.074072 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\Lenovo\Desktop\Proyectos\dbt-proyect\ecommerce_analytics\target\semantic_manifest.json
[0m01:51:41.079698 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\Lenovo\Desktop\Proyectos\dbt-proyect\ecommerce_analytics\target\run_results.json
[0m01:51:41.081702 [info ] [MainThread]: 
[0m01:51:41.081702 [info ] [MainThread]: [32mCompleted successfully[0m
[0m01:51:41.083709 [info ] [MainThread]: 
[0m01:51:41.083709 [info ] [MainThread]: Done. PASS=7 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=7
[0m01:51:41.086249 [debug] [MainThread]: Command `dbt run` succeeded at 01:51:41.086249 after 2.20 seconds
[0m01:51:41.086249 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001847E3B7B50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001847E3B7A90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001847E3B7ED0>]}
[0m01:51:41.088609 [debug] [MainThread]: Flushing usage events
[0m01:51:42.443877 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m01:51:47.587636 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029F2A8CC4D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029F2A8FF850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029F2A8CF810>]}


============================== 01:51:47.592844 | 447544c2-9592-460b-8caa-3a028dd8bd30 ==============================
[0m01:51:47.592844 [info ] [MainThread]: Running with dbt=1.11.2
[0m01:51:47.594468 [debug] [MainThread]: running dbt with arguments {'static_parser': 'True', 'no_print': 'None', 'version_check': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'printer_width': '80', 'write_json': 'True', 'introspect': 'True', 'log_cache_events': 'False', 'empty': 'None', 'cache_selected_only': 'False', 'log_format': 'default', 'debug': 'False', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\Lenovo\\.dbt', 'send_anonymous_usage_stats': 'True', 'quiet': 'False', 'warn_error': 'None', 'partial_parse': 'True', 'use_colors': 'True', 'indirect_selection': 'eager', 'invocation_command': 'dbt test', 'use_experimental_parser': 'False', 'log_path': 'C:\\Users\\Lenovo\\Desktop\\Proyectos\\dbt-proyect\\ecommerce_analytics\\logs'}
[0m01:51:47.809110 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '447544c2-9592-460b-8caa-3a028dd8bd30', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029F274E4210>]}
[0m01:51:47.871874 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '447544c2-9592-460b-8caa-3a028dd8bd30', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029F272680D0>]}
[0m01:51:47.881999 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m01:51:48.100202 [debug] [MainThread]: checksum: 3d40d8bbe1bef07db1c24822f2dbfff8bc07f2a48ed4fe2658a40653aec0b54b, vars: {}, profile: , target: , version: 1.11.2
[0m01:51:48.305718 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m01:51:48.305718 [debug] [MainThread]: Nothing changed, skipping partial parsing.
[0m01:51:48.305718 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m01:51:48.359799 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '447544c2-9592-460b-8caa-3a028dd8bd30', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029F2C007F90>]}
[0m01:51:48.448729 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\Lenovo\Desktop\Proyectos\dbt-proyect\ecommerce_analytics\target\manifest.json
[0m01:51:48.448729 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\Lenovo\Desktop\Proyectos\dbt-proyect\ecommerce_analytics\target\semantic_manifest.json
[0m01:51:48.549575 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '447544c2-9592-460b-8caa-3a028dd8bd30', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029F2BABF250>]}
[0m01:51:48.549575 [info ] [MainThread]: Found 3 seeds, 7 models, 14 data tests, 587 macros
[0m01:51:48.549575 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '447544c2-9592-460b-8caa-3a028dd8bd30', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029F2BF08150>]}
[0m01:51:48.557296 [info ] [MainThread]: 
[0m01:51:48.557296 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m01:51:48.557296 [info ] [MainThread]: 
[0m01:51:48.560745 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m01:51:48.568923 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_dev_main'
[0m01:51:48.640821 [debug] [ThreadPool]: Using duckdb connection "list_dev_main"
[0m01:51:48.644912 [debug] [ThreadPool]: On list_dev_main: BEGIN
[0m01:51:48.644912 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:51:48.694372 [debug] [ThreadPool]: SQL status: OK in 0.049 seconds
[0m01:51:48.694372 [debug] [ThreadPool]: Using duckdb connection "list_dev_main"
[0m01:51:48.694372 [debug] [ThreadPool]: On list_dev_main: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "ecommerce_analytics", "target_name": "dev", "connection_name": "list_dev_main"} */
select
      'dev' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'dev'
  
[0m01:51:48.712646 [debug] [ThreadPool]: SQL status: OK in 0.016 seconds
[0m01:51:48.712646 [debug] [ThreadPool]: On list_dev_main: ROLLBACK
[0m01:51:48.712646 [debug] [ThreadPool]: Failed to rollback 'list_dev_main'
[0m01:51:48.712646 [debug] [ThreadPool]: On list_dev_main: Close
[0m01:51:48.712646 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '447544c2-9592-460b-8caa-3a028dd8bd30', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029F2BD5CB10>]}
[0m01:51:48.712646 [debug] [MainThread]: Using duckdb connection "master"
[0m01:51:48.712646 [debug] [MainThread]: On master: BEGIN
[0m01:51:48.712646 [debug] [MainThread]: Opening a new connection, currently in state init
[0m01:51:48.712646 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m01:51:48.712646 [debug] [MainThread]: On master: COMMIT
[0m01:51:48.712646 [debug] [MainThread]: Using duckdb connection "master"
[0m01:51:48.720453 [debug] [MainThread]: On master: COMMIT
[0m01:51:48.721191 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m01:51:48.721707 [debug] [MainThread]: On master: Close
[0m01:51:48.723288 [debug] [Thread-1 (]: Began running node test.ecommerce_analytics.dbt_utils_accepted_range_stg_orders_total_amount__0.2895a1f8db
[0m01:51:48.723288 [info ] [Thread-1 (]: 1 of 14 START test dbt_utils_accepted_range_stg_orders_total_amount__0 ......... [RUN]
[0m01:51:48.723288 [debug] [Thread-1 (]: Acquiring new duckdb connection 'test.ecommerce_analytics.dbt_utils_accepted_range_stg_orders_total_amount__0.2895a1f8db'
[0m01:51:48.723288 [debug] [Thread-1 (]: Began compiling node test.ecommerce_analytics.dbt_utils_accepted_range_stg_orders_total_amount__0.2895a1f8db
[0m01:51:48.748023 [debug] [Thread-1 (]: Writing injected SQL for node "test.ecommerce_analytics.dbt_utils_accepted_range_stg_orders_total_amount__0.2895a1f8db"
[0m01:51:48.750031 [debug] [Thread-1 (]: Began executing node test.ecommerce_analytics.dbt_utils_accepted_range_stg_orders_total_amount__0.2895a1f8db
[0m01:51:48.771488 [debug] [Thread-1 (]: Writing runtime sql for node "test.ecommerce_analytics.dbt_utils_accepted_range_stg_orders_total_amount__0.2895a1f8db"
[0m01:51:48.771488 [debug] [Thread-1 (]: Using duckdb connection "test.ecommerce_analytics.dbt_utils_accepted_range_stg_orders_total_amount__0.2895a1f8db"
[0m01:51:48.773235 [debug] [Thread-1 (]: On test.ecommerce_analytics.dbt_utils_accepted_range_stg_orders_total_amount__0.2895a1f8db: BEGIN
[0m01:51:48.774567 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m01:51:48.774567 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m01:51:48.774567 [debug] [Thread-1 (]: Using duckdb connection "test.ecommerce_analytics.dbt_utils_accepted_range_stg_orders_total_amount__0.2895a1f8db"
[0m01:51:48.774567 [debug] [Thread-1 (]: On test.ecommerce_analytics.dbt_utils_accepted_range_stg_orders_total_amount__0.2895a1f8db: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "ecommerce_analytics", "target_name": "dev", "node_id": "test.ecommerce_analytics.dbt_utils_accepted_range_stg_orders_total_amount__0.2895a1f8db"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  

with meet_condition as(
  select *
  from "dev"."main"."stg_orders"
),

validation_errors as (
  select *
  from meet_condition
  where
    -- never true, defaults to an empty result set. Exists to ensure any combo of the `or` clauses below succeeds
    1 = 2
    -- records with a value >= min_value are permitted. The `not` flips this to find records that don't meet the rule.
    or not total_amount >= 0
)

select *
from validation_errors


  
  
      
    ) dbt_internal_test
[0m01:51:48.774567 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m01:51:48.780773 [debug] [Thread-1 (]: On test.ecommerce_analytics.dbt_utils_accepted_range_stg_orders_total_amount__0.2895a1f8db: ROLLBACK
[0m01:51:48.780773 [debug] [Thread-1 (]: Failed to rollback 'test.ecommerce_analytics.dbt_utils_accepted_range_stg_orders_total_amount__0.2895a1f8db'
[0m01:51:48.780773 [debug] [Thread-1 (]: On test.ecommerce_analytics.dbt_utils_accepted_range_stg_orders_total_amount__0.2895a1f8db: Close
[0m01:51:48.784799 [info ] [Thread-1 (]: 1 of 14 PASS dbt_utils_accepted_range_stg_orders_total_amount__0 ............... [[32mPASS[0m in 0.06s]
[0m01:51:48.785293 [debug] [Thread-1 (]: Finished running node test.ecommerce_analytics.dbt_utils_accepted_range_stg_orders_total_amount__0.2895a1f8db
[0m01:51:48.785293 [debug] [Thread-1 (]: Began running node test.ecommerce_analytics.dbt_utils_accepted_range_stg_products_price__0.26bfce9c9f
[0m01:51:48.785293 [info ] [Thread-1 (]: 2 of 14 START test dbt_utils_accepted_range_stg_products_price__0 .............. [RUN]
[0m01:51:48.788950 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.ecommerce_analytics.dbt_utils_accepted_range_stg_orders_total_amount__0.2895a1f8db, now test.ecommerce_analytics.dbt_utils_accepted_range_stg_products_price__0.26bfce9c9f)
[0m01:51:48.789682 [debug] [Thread-1 (]: Began compiling node test.ecommerce_analytics.dbt_utils_accepted_range_stg_products_price__0.26bfce9c9f
[0m01:51:48.795419 [debug] [Thread-1 (]: Writing injected SQL for node "test.ecommerce_analytics.dbt_utils_accepted_range_stg_products_price__0.26bfce9c9f"
[0m01:51:48.797177 [debug] [Thread-1 (]: Began executing node test.ecommerce_analytics.dbt_utils_accepted_range_stg_products_price__0.26bfce9c9f
[0m01:51:48.797177 [debug] [Thread-1 (]: Writing runtime sql for node "test.ecommerce_analytics.dbt_utils_accepted_range_stg_products_price__0.26bfce9c9f"
[0m01:51:48.797177 [debug] [Thread-1 (]: Using duckdb connection "test.ecommerce_analytics.dbt_utils_accepted_range_stg_products_price__0.26bfce9c9f"
[0m01:51:48.797177 [debug] [Thread-1 (]: On test.ecommerce_analytics.dbt_utils_accepted_range_stg_products_price__0.26bfce9c9f: BEGIN
[0m01:51:48.797177 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:51:48.797177 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m01:51:48.797177 [debug] [Thread-1 (]: Using duckdb connection "test.ecommerce_analytics.dbt_utils_accepted_range_stg_products_price__0.26bfce9c9f"
[0m01:51:48.797177 [debug] [Thread-1 (]: On test.ecommerce_analytics.dbt_utils_accepted_range_stg_products_price__0.26bfce9c9f: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "ecommerce_analytics", "target_name": "dev", "node_id": "test.ecommerce_analytics.dbt_utils_accepted_range_stg_products_price__0.26bfce9c9f"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  

with meet_condition as(
  select *
  from "dev"."main"."stg_products"
),

validation_errors as (
  select *
  from meet_condition
  where
    -- never true, defaults to an empty result set. Exists to ensure any combo of the `or` clauses below succeeds
    1 = 2
    -- records with a value >= min_value are permitted. The `not` flips this to find records that don't meet the rule.
    or not price >= 0
)

select *
from validation_errors


  
  
      
    ) dbt_internal_test
[0m01:51:48.806612 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m01:51:48.808415 [debug] [Thread-1 (]: On test.ecommerce_analytics.dbt_utils_accepted_range_stg_products_price__0.26bfce9c9f: ROLLBACK
[0m01:51:48.808415 [debug] [Thread-1 (]: Failed to rollback 'test.ecommerce_analytics.dbt_utils_accepted_range_stg_products_price__0.26bfce9c9f'
[0m01:51:48.812179 [debug] [Thread-1 (]: On test.ecommerce_analytics.dbt_utils_accepted_range_stg_products_price__0.26bfce9c9f: Close
[0m01:51:48.812895 [info ] [Thread-1 (]: 2 of 14 PASS dbt_utils_accepted_range_stg_products_price__0 .................... [[32mPASS[0m in 0.03s]
[0m01:51:48.814425 [debug] [Thread-1 (]: Finished running node test.ecommerce_analytics.dbt_utils_accepted_range_stg_products_price__0.26bfce9c9f
[0m01:51:48.815751 [debug] [Thread-1 (]: Began running node test.ecommerce_analytics.not_null_stg_customers_customer_id.e2cfb1f9aa
[0m01:51:48.816135 [info ] [Thread-1 (]: 3 of 14 START test not_null_stg_customers_customer_id .......................... [RUN]
[0m01:51:48.816135 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.ecommerce_analytics.dbt_utils_accepted_range_stg_products_price__0.26bfce9c9f, now test.ecommerce_analytics.not_null_stg_customers_customer_id.e2cfb1f9aa)
[0m01:51:48.816135 [debug] [Thread-1 (]: Began compiling node test.ecommerce_analytics.not_null_stg_customers_customer_id.e2cfb1f9aa
[0m01:51:48.828216 [debug] [Thread-1 (]: Writing injected SQL for node "test.ecommerce_analytics.not_null_stg_customers_customer_id.e2cfb1f9aa"
[0m01:51:48.830224 [debug] [Thread-1 (]: Began executing node test.ecommerce_analytics.not_null_stg_customers_customer_id.e2cfb1f9aa
[0m01:51:48.831208 [debug] [Thread-1 (]: Writing runtime sql for node "test.ecommerce_analytics.not_null_stg_customers_customer_id.e2cfb1f9aa"
[0m01:51:48.831208 [debug] [Thread-1 (]: Using duckdb connection "test.ecommerce_analytics.not_null_stg_customers_customer_id.e2cfb1f9aa"
[0m01:51:48.831208 [debug] [Thread-1 (]: On test.ecommerce_analytics.not_null_stg_customers_customer_id.e2cfb1f9aa: BEGIN
[0m01:51:48.831208 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:51:48.836918 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m01:51:48.837596 [debug] [Thread-1 (]: Using duckdb connection "test.ecommerce_analytics.not_null_stg_customers_customer_id.e2cfb1f9aa"
[0m01:51:48.837596 [debug] [Thread-1 (]: On test.ecommerce_analytics.not_null_stg_customers_customer_id.e2cfb1f9aa: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "ecommerce_analytics", "target_name": "dev", "node_id": "test.ecommerce_analytics.not_null_stg_customers_customer_id.e2cfb1f9aa"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select customer_id
from "dev"."main"."stg_customers"
where customer_id is null



  
  
      
    ) dbt_internal_test
[0m01:51:48.839476 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m01:51:48.843042 [debug] [Thread-1 (]: On test.ecommerce_analytics.not_null_stg_customers_customer_id.e2cfb1f9aa: ROLLBACK
[0m01:51:48.845159 [debug] [Thread-1 (]: Failed to rollback 'test.ecommerce_analytics.not_null_stg_customers_customer_id.e2cfb1f9aa'
[0m01:51:48.845159 [debug] [Thread-1 (]: On test.ecommerce_analytics.not_null_stg_customers_customer_id.e2cfb1f9aa: Close
[0m01:51:48.845159 [info ] [Thread-1 (]: 3 of 14 PASS not_null_stg_customers_customer_id ................................ [[32mPASS[0m in 0.03s]
[0m01:51:48.847422 [debug] [Thread-1 (]: Finished running node test.ecommerce_analytics.not_null_stg_customers_customer_id.e2cfb1f9aa
[0m01:51:48.847422 [debug] [Thread-1 (]: Began running node test.ecommerce_analytics.not_null_stg_customers_email.d7cf761533
[0m01:51:48.847422 [info ] [Thread-1 (]: 4 of 14 START test not_null_stg_customers_email ................................ [RUN]
[0m01:51:48.847422 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.ecommerce_analytics.not_null_stg_customers_customer_id.e2cfb1f9aa, now test.ecommerce_analytics.not_null_stg_customers_email.d7cf761533)
[0m01:51:48.847422 [debug] [Thread-1 (]: Began compiling node test.ecommerce_analytics.not_null_stg_customers_email.d7cf761533
[0m01:51:48.847422 [debug] [Thread-1 (]: Writing injected SQL for node "test.ecommerce_analytics.not_null_stg_customers_email.d7cf761533"
[0m01:51:48.859145 [debug] [Thread-1 (]: Began executing node test.ecommerce_analytics.not_null_stg_customers_email.d7cf761533
[0m01:51:48.861695 [debug] [Thread-1 (]: Writing runtime sql for node "test.ecommerce_analytics.not_null_stg_customers_email.d7cf761533"
[0m01:51:48.861695 [debug] [Thread-1 (]: Using duckdb connection "test.ecommerce_analytics.not_null_stg_customers_email.d7cf761533"
[0m01:51:48.861695 [debug] [Thread-1 (]: On test.ecommerce_analytics.not_null_stg_customers_email.d7cf761533: BEGIN
[0m01:51:48.865805 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:51:48.865805 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m01:51:48.865805 [debug] [Thread-1 (]: Using duckdb connection "test.ecommerce_analytics.not_null_stg_customers_email.d7cf761533"
[0m01:51:48.867810 [debug] [Thread-1 (]: On test.ecommerce_analytics.not_null_stg_customers_email.d7cf761533: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "ecommerce_analytics", "target_name": "dev", "node_id": "test.ecommerce_analytics.not_null_stg_customers_email.d7cf761533"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select email
from "dev"."main"."stg_customers"
where email is null



  
  
      
    ) dbt_internal_test
[0m01:51:48.870240 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "ecommerce_analytics", "target_name": "dev", "node_id": "test.ecommerce_analytics.not_null_stg_customers_email.d7cf761533"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select email
from "dev"."main"."stg_customers"
where email is null



  
  
      
    ) dbt_internal_test
[0m01:51:48.870240 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m01:51:48.870240 [debug] [Thread-1 (]: On test.ecommerce_analytics.not_null_stg_customers_email.d7cf761533: ROLLBACK
[0m01:51:48.875880 [debug] [Thread-1 (]: Failed to rollback 'test.ecommerce_analytics.not_null_stg_customers_email.d7cf761533'
[0m01:51:48.878467 [debug] [Thread-1 (]: On test.ecommerce_analytics.not_null_stg_customers_email.d7cf761533: Close
[0m01:51:48.881073 [debug] [Thread-1 (]: Runtime Error in test not_null_stg_customers_email (models\example\staging\schema.yml)
  Binder Error: Referenced column "email" not found in FROM clause!
  Candidate bindings: "segment", "postal_code"
  
  LINE 18: where email is null
                 ^
[0m01:51:48.881073 [error] [Thread-1 (]: 4 of 14 ERROR not_null_stg_customers_email ..................................... [[31mERROR[0m in 0.03s]
[0m01:51:48.881073 [debug] [Thread-1 (]: Finished running node test.ecommerce_analytics.not_null_stg_customers_email.d7cf761533
[0m01:51:48.881073 [debug] [Thread-1 (]: Began running node test.ecommerce_analytics.not_null_stg_orders_customer_id.af79d5e4b5
[0m01:51:48.881073 [debug] [Thread-4 (]: Marking all children of 'test.ecommerce_analytics.not_null_stg_customers_email.d7cf761533' to be skipped because of status 'error'.  Reason: Runtime Error in test not_null_stg_customers_email (models\example\staging\schema.yml)
  Binder Error: Referenced column "email" not found in FROM clause!
  Candidate bindings: "segment", "postal_code"
  
  LINE 18: where email is null
                 ^.
[0m01:51:48.881073 [info ] [Thread-1 (]: 5 of 14 START test not_null_stg_orders_customer_id ............................. [RUN]
[0m01:51:48.881073 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.ecommerce_analytics.not_null_stg_customers_email.d7cf761533, now test.ecommerce_analytics.not_null_stg_orders_customer_id.af79d5e4b5)
[0m01:51:48.881073 [debug] [Thread-1 (]: Began compiling node test.ecommerce_analytics.not_null_stg_orders_customer_id.af79d5e4b5
[0m01:51:48.892259 [debug] [Thread-1 (]: Writing injected SQL for node "test.ecommerce_analytics.not_null_stg_orders_customer_id.af79d5e4b5"
[0m01:51:48.892259 [debug] [Thread-1 (]: Began executing node test.ecommerce_analytics.not_null_stg_orders_customer_id.af79d5e4b5
[0m01:51:48.896792 [debug] [Thread-1 (]: Writing runtime sql for node "test.ecommerce_analytics.not_null_stg_orders_customer_id.af79d5e4b5"
[0m01:51:48.899972 [debug] [Thread-1 (]: Using duckdb connection "test.ecommerce_analytics.not_null_stg_orders_customer_id.af79d5e4b5"
[0m01:51:48.899972 [debug] [Thread-1 (]: On test.ecommerce_analytics.not_null_stg_orders_customer_id.af79d5e4b5: BEGIN
[0m01:51:48.899972 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:51:48.899972 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m01:51:48.899972 [debug] [Thread-1 (]: Using duckdb connection "test.ecommerce_analytics.not_null_stg_orders_customer_id.af79d5e4b5"
[0m01:51:48.899972 [debug] [Thread-1 (]: On test.ecommerce_analytics.not_null_stg_orders_customer_id.af79d5e4b5: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "ecommerce_analytics", "target_name": "dev", "node_id": "test.ecommerce_analytics.not_null_stg_orders_customer_id.af79d5e4b5"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select customer_id
from "dev"."main"."stg_orders"
where customer_id is null



  
  
      
    ) dbt_internal_test
[0m01:51:48.899972 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m01:51:48.907617 [debug] [Thread-1 (]: On test.ecommerce_analytics.not_null_stg_orders_customer_id.af79d5e4b5: ROLLBACK
[0m01:51:48.907617 [debug] [Thread-1 (]: Failed to rollback 'test.ecommerce_analytics.not_null_stg_orders_customer_id.af79d5e4b5'
[0m01:51:48.907617 [debug] [Thread-1 (]: On test.ecommerce_analytics.not_null_stg_orders_customer_id.af79d5e4b5: Close
[0m01:51:48.909588 [info ] [Thread-1 (]: 5 of 14 PASS not_null_stg_orders_customer_id ................................... [[32mPASS[0m in 0.03s]
[0m01:51:48.909588 [debug] [Thread-1 (]: Finished running node test.ecommerce_analytics.not_null_stg_orders_customer_id.af79d5e4b5
[0m01:51:48.909588 [debug] [Thread-1 (]: Began running node test.ecommerce_analytics.not_null_stg_orders_order_id.81cfe2fe64
[0m01:51:48.913521 [info ] [Thread-1 (]: 6 of 14 START test not_null_stg_orders_order_id ................................ [RUN]
[0m01:51:48.914833 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.ecommerce_analytics.not_null_stg_orders_customer_id.af79d5e4b5, now test.ecommerce_analytics.not_null_stg_orders_order_id.81cfe2fe64)
[0m01:51:48.915400 [debug] [Thread-1 (]: Began compiling node test.ecommerce_analytics.not_null_stg_orders_order_id.81cfe2fe64
[0m01:51:48.920196 [debug] [Thread-1 (]: Writing injected SQL for node "test.ecommerce_analytics.not_null_stg_orders_order_id.81cfe2fe64"
[0m01:51:48.922545 [debug] [Thread-1 (]: Began executing node test.ecommerce_analytics.not_null_stg_orders_order_id.81cfe2fe64
[0m01:51:48.926309 [debug] [Thread-1 (]: Writing runtime sql for node "test.ecommerce_analytics.not_null_stg_orders_order_id.81cfe2fe64"
[0m01:51:48.929954 [debug] [Thread-1 (]: Using duckdb connection "test.ecommerce_analytics.not_null_stg_orders_order_id.81cfe2fe64"
[0m01:51:48.929954 [debug] [Thread-1 (]: On test.ecommerce_analytics.not_null_stg_orders_order_id.81cfe2fe64: BEGIN
[0m01:51:48.930974 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:51:48.932096 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m01:51:48.932096 [debug] [Thread-1 (]: Using duckdb connection "test.ecommerce_analytics.not_null_stg_orders_order_id.81cfe2fe64"
[0m01:51:48.932096 [debug] [Thread-1 (]: On test.ecommerce_analytics.not_null_stg_orders_order_id.81cfe2fe64: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "ecommerce_analytics", "target_name": "dev", "node_id": "test.ecommerce_analytics.not_null_stg_orders_order_id.81cfe2fe64"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select order_id
from "dev"."main"."stg_orders"
where order_id is null



  
  
      
    ) dbt_internal_test
[0m01:51:48.934120 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m01:51:48.936696 [debug] [Thread-1 (]: On test.ecommerce_analytics.not_null_stg_orders_order_id.81cfe2fe64: ROLLBACK
[0m01:51:48.936696 [debug] [Thread-1 (]: Failed to rollback 'test.ecommerce_analytics.not_null_stg_orders_order_id.81cfe2fe64'
[0m01:51:48.936696 [debug] [Thread-1 (]: On test.ecommerce_analytics.not_null_stg_orders_order_id.81cfe2fe64: Close
[0m01:51:48.936696 [info ] [Thread-1 (]: 6 of 14 PASS not_null_stg_orders_order_id ...................................... [[32mPASS[0m in 0.02s]
[0m01:51:48.940705 [debug] [Thread-1 (]: Finished running node test.ecommerce_analytics.not_null_stg_orders_order_id.81cfe2fe64
[0m01:51:48.941217 [debug] [Thread-1 (]: Began running node test.ecommerce_analytics.not_null_stg_orders_total_amount.f31d98d41b
[0m01:51:48.941217 [info ] [Thread-1 (]: 7 of 14 START test not_null_stg_orders_total_amount ............................ [RUN]
[0m01:51:48.942601 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.ecommerce_analytics.not_null_stg_orders_order_id.81cfe2fe64, now test.ecommerce_analytics.not_null_stg_orders_total_amount.f31d98d41b)
[0m01:51:48.942601 [debug] [Thread-1 (]: Began compiling node test.ecommerce_analytics.not_null_stg_orders_total_amount.f31d98d41b
[0m01:51:48.942601 [debug] [Thread-1 (]: Writing injected SQL for node "test.ecommerce_analytics.not_null_stg_orders_total_amount.f31d98d41b"
[0m01:51:48.942601 [debug] [Thread-1 (]: Began executing node test.ecommerce_analytics.not_null_stg_orders_total_amount.f31d98d41b
[0m01:51:48.952143 [debug] [Thread-1 (]: Writing runtime sql for node "test.ecommerce_analytics.not_null_stg_orders_total_amount.f31d98d41b"
[0m01:51:48.956343 [debug] [Thread-1 (]: Using duckdb connection "test.ecommerce_analytics.not_null_stg_orders_total_amount.f31d98d41b"
[0m01:51:48.956343 [debug] [Thread-1 (]: On test.ecommerce_analytics.not_null_stg_orders_total_amount.f31d98d41b: BEGIN
[0m01:51:48.958352 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:51:48.958352 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m01:51:48.960363 [debug] [Thread-1 (]: Using duckdb connection "test.ecommerce_analytics.not_null_stg_orders_total_amount.f31d98d41b"
[0m01:51:48.960363 [debug] [Thread-1 (]: On test.ecommerce_analytics.not_null_stg_orders_total_amount.f31d98d41b: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "ecommerce_analytics", "target_name": "dev", "node_id": "test.ecommerce_analytics.not_null_stg_orders_total_amount.f31d98d41b"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select total_amount
from "dev"."main"."stg_orders"
where total_amount is null



  
  
      
    ) dbt_internal_test
[0m01:51:48.961872 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m01:51:48.963952 [debug] [Thread-1 (]: On test.ecommerce_analytics.not_null_stg_orders_total_amount.f31d98d41b: ROLLBACK
[0m01:51:48.965958 [debug] [Thread-1 (]: Failed to rollback 'test.ecommerce_analytics.not_null_stg_orders_total_amount.f31d98d41b'
[0m01:51:48.965958 [debug] [Thread-1 (]: On test.ecommerce_analytics.not_null_stg_orders_total_amount.f31d98d41b: Close
[0m01:51:48.965958 [info ] [Thread-1 (]: 7 of 14 PASS not_null_stg_orders_total_amount .................................. [[32mPASS[0m in 0.02s]
[0m01:51:48.967964 [debug] [Thread-1 (]: Finished running node test.ecommerce_analytics.not_null_stg_orders_total_amount.f31d98d41b
[0m01:51:48.967964 [debug] [Thread-1 (]: Began running node test.ecommerce_analytics.not_null_stg_products_price.2d147627d4
[0m01:51:48.969969 [info ] [Thread-1 (]: 8 of 14 START test not_null_stg_products_price ................................. [RUN]
[0m01:51:48.970607 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.ecommerce_analytics.not_null_stg_orders_total_amount.f31d98d41b, now test.ecommerce_analytics.not_null_stg_products_price.2d147627d4)
[0m01:51:48.970607 [debug] [Thread-1 (]: Began compiling node test.ecommerce_analytics.not_null_stg_products_price.2d147627d4
[0m01:51:48.976161 [debug] [Thread-1 (]: Writing injected SQL for node "test.ecommerce_analytics.not_null_stg_products_price.2d147627d4"
[0m01:51:48.978167 [debug] [Thread-1 (]: Began executing node test.ecommerce_analytics.not_null_stg_products_price.2d147627d4
[0m01:51:48.982368 [debug] [Thread-1 (]: Writing runtime sql for node "test.ecommerce_analytics.not_null_stg_products_price.2d147627d4"
[0m01:51:48.984474 [debug] [Thread-1 (]: Using duckdb connection "test.ecommerce_analytics.not_null_stg_products_price.2d147627d4"
[0m01:51:48.984474 [debug] [Thread-1 (]: On test.ecommerce_analytics.not_null_stg_products_price.2d147627d4: BEGIN
[0m01:51:48.984474 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:51:48.986483 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m01:51:48.986483 [debug] [Thread-1 (]: Using duckdb connection "test.ecommerce_analytics.not_null_stg_products_price.2d147627d4"
[0m01:51:48.988860 [debug] [Thread-1 (]: On test.ecommerce_analytics.not_null_stg_products_price.2d147627d4: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "ecommerce_analytics", "target_name": "dev", "node_id": "test.ecommerce_analytics.not_null_stg_products_price.2d147627d4"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select price
from "dev"."main"."stg_products"
where price is null



  
  
      
    ) dbt_internal_test
[0m01:51:48.988860 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m01:51:48.993713 [debug] [Thread-1 (]: On test.ecommerce_analytics.not_null_stg_products_price.2d147627d4: ROLLBACK
[0m01:51:48.995724 [debug] [Thread-1 (]: Failed to rollback 'test.ecommerce_analytics.not_null_stg_products_price.2d147627d4'
[0m01:51:48.995724 [debug] [Thread-1 (]: On test.ecommerce_analytics.not_null_stg_products_price.2d147627d4: Close
[0m01:51:48.995724 [info ] [Thread-1 (]: 8 of 14 PASS not_null_stg_products_price ....................................... [[32mPASS[0m in 0.03s]
[0m01:51:48.995724 [debug] [Thread-1 (]: Finished running node test.ecommerce_analytics.not_null_stg_products_price.2d147627d4
[0m01:51:48.995724 [debug] [Thread-1 (]: Began running node test.ecommerce_analytics.not_null_stg_products_product_id.6373b0acf3
[0m01:51:48.995724 [info ] [Thread-1 (]: 9 of 14 START test not_null_stg_products_product_id ............................ [RUN]
[0m01:51:49.001141 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.ecommerce_analytics.not_null_stg_products_price.2d147627d4, now test.ecommerce_analytics.not_null_stg_products_product_id.6373b0acf3)
[0m01:51:49.001141 [debug] [Thread-1 (]: Began compiling node test.ecommerce_analytics.not_null_stg_products_product_id.6373b0acf3
[0m01:51:49.005259 [debug] [Thread-1 (]: Writing injected SQL for node "test.ecommerce_analytics.not_null_stg_products_product_id.6373b0acf3"
[0m01:51:49.007686 [debug] [Thread-1 (]: Began executing node test.ecommerce_analytics.not_null_stg_products_product_id.6373b0acf3
[0m01:51:49.008628 [debug] [Thread-1 (]: Writing runtime sql for node "test.ecommerce_analytics.not_null_stg_products_product_id.6373b0acf3"
[0m01:51:49.013362 [debug] [Thread-1 (]: Using duckdb connection "test.ecommerce_analytics.not_null_stg_products_product_id.6373b0acf3"
[0m01:51:49.013362 [debug] [Thread-1 (]: On test.ecommerce_analytics.not_null_stg_products_product_id.6373b0acf3: BEGIN
[0m01:51:49.013362 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:51:49.013362 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m01:51:49.013362 [debug] [Thread-1 (]: Using duckdb connection "test.ecommerce_analytics.not_null_stg_products_product_id.6373b0acf3"
[0m01:51:49.013362 [debug] [Thread-1 (]: On test.ecommerce_analytics.not_null_stg_products_product_id.6373b0acf3: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "ecommerce_analytics", "target_name": "dev", "node_id": "test.ecommerce_analytics.not_null_stg_products_product_id.6373b0acf3"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select product_id
from "dev"."main"."stg_products"
where product_id is null



  
  
      
    ) dbt_internal_test
[0m01:51:49.017082 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m01:51:49.017082 [debug] [Thread-1 (]: On test.ecommerce_analytics.not_null_stg_products_product_id.6373b0acf3: ROLLBACK
[0m01:51:49.021219 [debug] [Thread-1 (]: Failed to rollback 'test.ecommerce_analytics.not_null_stg_products_product_id.6373b0acf3'
[0m01:51:49.021219 [debug] [Thread-1 (]: On test.ecommerce_analytics.not_null_stg_products_product_id.6373b0acf3: Close
[0m01:51:49.021219 [info ] [Thread-1 (]: 9 of 14 PASS not_null_stg_products_product_id .................................. [[32mPASS[0m in 0.02s]
[0m01:51:49.021219 [debug] [Thread-1 (]: Finished running node test.ecommerce_analytics.not_null_stg_products_product_id.6373b0acf3
[0m01:51:49.024388 [debug] [Thread-1 (]: Began running node test.ecommerce_analytics.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500
[0m01:51:49.024388 [info ] [Thread-1 (]: 10 of 14 START test relationships_stg_orders_customer_id__customer_id__ref_stg_customers_  [RUN]
[0m01:51:49.026396 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.ecommerce_analytics.not_null_stg_products_product_id.6373b0acf3, now test.ecommerce_analytics.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500)
[0m01:51:49.026396 [debug] [Thread-1 (]: Began compiling node test.ecommerce_analytics.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500
[0m01:51:49.035605 [debug] [Thread-1 (]: Writing injected SQL for node "test.ecommerce_analytics.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500"
[0m01:51:49.035605 [debug] [Thread-1 (]: Began executing node test.ecommerce_analytics.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500
[0m01:51:49.044912 [debug] [Thread-1 (]: Writing runtime sql for node "test.ecommerce_analytics.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500"
[0m01:51:49.045552 [debug] [Thread-1 (]: Using duckdb connection "test.ecommerce_analytics.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500"
[0m01:51:49.045552 [debug] [Thread-1 (]: On test.ecommerce_analytics.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500: BEGIN
[0m01:51:49.045552 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:51:49.045552 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m01:51:49.045552 [debug] [Thread-1 (]: Using duckdb connection "test.ecommerce_analytics.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500"
[0m01:51:49.045552 [debug] [Thread-1 (]: On test.ecommerce_analytics.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "ecommerce_analytics", "target_name": "dev", "node_id": "test.ecommerce_analytics.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with child as (
    select customer_id as from_field
    from "dev"."main"."stg_orders"
    where customer_id is not null
),

parent as (
    select customer_id as to_field
    from "dev"."main"."stg_customers"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



  
  
      
    ) dbt_internal_test
[0m01:51:49.045552 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m01:51:49.055917 [debug] [Thread-1 (]: On test.ecommerce_analytics.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500: ROLLBACK
[0m01:51:49.057333 [debug] [Thread-1 (]: Failed to rollback 'test.ecommerce_analytics.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500'
[0m01:51:49.058171 [debug] [Thread-1 (]: On test.ecommerce_analytics.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500: Close
[0m01:51:49.059225 [info ] [Thread-1 (]: 10 of 14 PASS relationships_stg_orders_customer_id__customer_id__ref_stg_customers_  [[32mPASS[0m in 0.03s]
[0m01:51:49.059225 [debug] [Thread-1 (]: Finished running node test.ecommerce_analytics.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500
[0m01:51:49.059225 [debug] [Thread-1 (]: Began running node test.ecommerce_analytics.unique_stg_customers_customer_id.c7614daada
[0m01:51:49.059225 [info ] [Thread-1 (]: 11 of 14 START test unique_stg_customers_customer_id ........................... [RUN]
[0m01:51:49.059225 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.ecommerce_analytics.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500, now test.ecommerce_analytics.unique_stg_customers_customer_id.c7614daada)
[0m01:51:49.059225 [debug] [Thread-1 (]: Began compiling node test.ecommerce_analytics.unique_stg_customers_customer_id.c7614daada
[0m01:51:49.065612 [debug] [Thread-1 (]: Writing injected SQL for node "test.ecommerce_analytics.unique_stg_customers_customer_id.c7614daada"
[0m01:51:49.074461 [debug] [Thread-1 (]: Began executing node test.ecommerce_analytics.unique_stg_customers_customer_id.c7614daada
[0m01:51:49.078853 [debug] [Thread-1 (]: Writing runtime sql for node "test.ecommerce_analytics.unique_stg_customers_customer_id.c7614daada"
[0m01:51:49.081374 [debug] [Thread-1 (]: Using duckdb connection "test.ecommerce_analytics.unique_stg_customers_customer_id.c7614daada"
[0m01:51:49.082415 [debug] [Thread-1 (]: On test.ecommerce_analytics.unique_stg_customers_customer_id.c7614daada: BEGIN
[0m01:51:49.082415 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:51:49.082415 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m01:51:49.082415 [debug] [Thread-1 (]: Using duckdb connection "test.ecommerce_analytics.unique_stg_customers_customer_id.c7614daada"
[0m01:51:49.082415 [debug] [Thread-1 (]: On test.ecommerce_analytics.unique_stg_customers_customer_id.c7614daada: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "ecommerce_analytics", "target_name": "dev", "node_id": "test.ecommerce_analytics.unique_stg_customers_customer_id.c7614daada"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    customer_id as unique_field,
    count(*) as n_records

from "dev"."main"."stg_customers"
where customer_id is not null
group by customer_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m01:51:49.088563 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m01:51:49.090568 [debug] [Thread-1 (]: On test.ecommerce_analytics.unique_stg_customers_customer_id.c7614daada: ROLLBACK
[0m01:51:49.091151 [debug] [Thread-1 (]: Failed to rollback 'test.ecommerce_analytics.unique_stg_customers_customer_id.c7614daada'
[0m01:51:49.091722 [debug] [Thread-1 (]: On test.ecommerce_analytics.unique_stg_customers_customer_id.c7614daada: Close
[0m01:51:49.091722 [info ] [Thread-1 (]: 11 of 14 PASS unique_stg_customers_customer_id ................................. [[32mPASS[0m in 0.03s]
[0m01:51:49.091722 [debug] [Thread-1 (]: Finished running node test.ecommerce_analytics.unique_stg_customers_customer_id.c7614daada
[0m01:51:49.091722 [debug] [Thread-1 (]: Began running node test.ecommerce_analytics.unique_stg_customers_email.1ebcb2333e
[0m01:51:49.091722 [info ] [Thread-1 (]: 12 of 14 START test unique_stg_customers_email ................................. [RUN]
[0m01:51:49.091722 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.ecommerce_analytics.unique_stg_customers_customer_id.c7614daada, now test.ecommerce_analytics.unique_stg_customers_email.1ebcb2333e)
[0m01:51:49.096765 [debug] [Thread-1 (]: Began compiling node test.ecommerce_analytics.unique_stg_customers_email.1ebcb2333e
[0m01:51:49.098901 [debug] [Thread-1 (]: Writing injected SQL for node "test.ecommerce_analytics.unique_stg_customers_email.1ebcb2333e"
[0m01:51:49.098901 [debug] [Thread-1 (]: Began executing node test.ecommerce_analytics.unique_stg_customers_email.1ebcb2333e
[0m01:51:49.098901 [debug] [Thread-1 (]: Writing runtime sql for node "test.ecommerce_analytics.unique_stg_customers_email.1ebcb2333e"
[0m01:51:49.107241 [debug] [Thread-1 (]: Using duckdb connection "test.ecommerce_analytics.unique_stg_customers_email.1ebcb2333e"
[0m01:51:49.107724 [debug] [Thread-1 (]: On test.ecommerce_analytics.unique_stg_customers_email.1ebcb2333e: BEGIN
[0m01:51:49.107724 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:51:49.107724 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m01:51:49.107724 [debug] [Thread-1 (]: Using duckdb connection "test.ecommerce_analytics.unique_stg_customers_email.1ebcb2333e"
[0m01:51:49.107724 [debug] [Thread-1 (]: On test.ecommerce_analytics.unique_stg_customers_email.1ebcb2333e: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "ecommerce_analytics", "target_name": "dev", "node_id": "test.ecommerce_analytics.unique_stg_customers_email.1ebcb2333e"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    email as unique_field,
    count(*) as n_records

from "dev"."main"."stg_customers"
where email is not null
group by email
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m01:51:49.112544 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "ecommerce_analytics", "target_name": "dev", "node_id": "test.ecommerce_analytics.unique_stg_customers_email.1ebcb2333e"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    email as unique_field,
    count(*) as n_records

from "dev"."main"."stg_customers"
where email is not null
group by email
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m01:51:49.112544 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m01:51:49.112544 [debug] [Thread-1 (]: On test.ecommerce_analytics.unique_stg_customers_email.1ebcb2333e: ROLLBACK
[0m01:51:49.115579 [debug] [Thread-1 (]: Failed to rollback 'test.ecommerce_analytics.unique_stg_customers_email.1ebcb2333e'
[0m01:51:49.115579 [debug] [Thread-1 (]: On test.ecommerce_analytics.unique_stg_customers_email.1ebcb2333e: Close
[0m01:51:49.119956 [debug] [Thread-1 (]: Runtime Error in test unique_stg_customers_email (models\example\staging\schema.yml)
  Binder Error: Referenced column "email" not found in FROM clause!
  Candidate bindings: "segment", "postal_code"
  
  LINE 19: where email is not null
                 ^
[0m01:51:49.119956 [error] [Thread-1 (]: 12 of 14 ERROR unique_stg_customers_email ...................................... [[31mERROR[0m in 0.03s]
[0m01:51:49.119956 [debug] [Thread-1 (]: Finished running node test.ecommerce_analytics.unique_stg_customers_email.1ebcb2333e
[0m01:51:49.119956 [debug] [Thread-1 (]: Began running node test.ecommerce_analytics.unique_stg_orders_order_id.e3b841c71a
[0m01:51:49.123348 [debug] [Thread-4 (]: Marking all children of 'test.ecommerce_analytics.unique_stg_customers_email.1ebcb2333e' to be skipped because of status 'error'.  Reason: Runtime Error in test unique_stg_customers_email (models\example\staging\schema.yml)
  Binder Error: Referenced column "email" not found in FROM clause!
  Candidate bindings: "segment", "postal_code"
  
  LINE 19: where email is not null
                 ^.
[0m01:51:49.123348 [info ] [Thread-1 (]: 13 of 14 START test unique_stg_orders_order_id ................................. [RUN]
[0m01:51:49.125100 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.ecommerce_analytics.unique_stg_customers_email.1ebcb2333e, now test.ecommerce_analytics.unique_stg_orders_order_id.e3b841c71a)
[0m01:51:49.125100 [debug] [Thread-1 (]: Began compiling node test.ecommerce_analytics.unique_stg_orders_order_id.e3b841c71a
[0m01:51:49.132374 [debug] [Thread-1 (]: Writing injected SQL for node "test.ecommerce_analytics.unique_stg_orders_order_id.e3b841c71a"
[0m01:51:49.132374 [debug] [Thread-1 (]: Began executing node test.ecommerce_analytics.unique_stg_orders_order_id.e3b841c71a
[0m01:51:49.136387 [debug] [Thread-1 (]: Writing runtime sql for node "test.ecommerce_analytics.unique_stg_orders_order_id.e3b841c71a"
[0m01:51:49.136387 [debug] [Thread-1 (]: Using duckdb connection "test.ecommerce_analytics.unique_stg_orders_order_id.e3b841c71a"
[0m01:51:49.136387 [debug] [Thread-1 (]: On test.ecommerce_analytics.unique_stg_orders_order_id.e3b841c71a: BEGIN
[0m01:51:49.138398 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:51:49.138398 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m01:51:49.140215 [debug] [Thread-1 (]: Using duckdb connection "test.ecommerce_analytics.unique_stg_orders_order_id.e3b841c71a"
[0m01:51:49.141109 [debug] [Thread-1 (]: On test.ecommerce_analytics.unique_stg_orders_order_id.e3b841c71a: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "ecommerce_analytics", "target_name": "dev", "node_id": "test.ecommerce_analytics.unique_stg_orders_order_id.e3b841c71a"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    order_id as unique_field,
    count(*) as n_records

from "dev"."main"."stg_orders"
where order_id is not null
group by order_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m01:51:49.141109 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m01:51:49.144884 [debug] [Thread-1 (]: On test.ecommerce_analytics.unique_stg_orders_order_id.e3b841c71a: ROLLBACK
[0m01:51:49.144884 [debug] [Thread-1 (]: Failed to rollback 'test.ecommerce_analytics.unique_stg_orders_order_id.e3b841c71a'
[0m01:51:49.144884 [debug] [Thread-1 (]: On test.ecommerce_analytics.unique_stg_orders_order_id.e3b841c71a: Close
[0m01:51:49.147760 [info ] [Thread-1 (]: 13 of 14 PASS unique_stg_orders_order_id ....................................... [[32mPASS[0m in 0.02s]
[0m01:51:49.149382 [debug] [Thread-1 (]: Finished running node test.ecommerce_analytics.unique_stg_orders_order_id.e3b841c71a
[0m01:51:49.149382 [debug] [Thread-1 (]: Began running node test.ecommerce_analytics.unique_stg_products_product_id.7d950a1467
[0m01:51:49.149382 [info ] [Thread-1 (]: 14 of 14 START test unique_stg_products_product_id ............................. [RUN]
[0m01:51:49.151399 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.ecommerce_analytics.unique_stg_orders_order_id.e3b841c71a, now test.ecommerce_analytics.unique_stg_products_product_id.7d950a1467)
[0m01:51:49.151399 [debug] [Thread-1 (]: Began compiling node test.ecommerce_analytics.unique_stg_products_product_id.7d950a1467
[0m01:51:49.156078 [debug] [Thread-1 (]: Writing injected SQL for node "test.ecommerce_analytics.unique_stg_products_product_id.7d950a1467"
[0m01:51:49.157860 [debug] [Thread-1 (]: Began executing node test.ecommerce_analytics.unique_stg_products_product_id.7d950a1467
[0m01:51:49.162595 [debug] [Thread-1 (]: Writing runtime sql for node "test.ecommerce_analytics.unique_stg_products_product_id.7d950a1467"
[0m01:51:49.164261 [debug] [Thread-1 (]: Using duckdb connection "test.ecommerce_analytics.unique_stg_products_product_id.7d950a1467"
[0m01:51:49.164261 [debug] [Thread-1 (]: On test.ecommerce_analytics.unique_stg_products_product_id.7d950a1467: BEGIN
[0m01:51:49.164261 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:51:49.164261 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m01:51:49.164261 [debug] [Thread-1 (]: Using duckdb connection "test.ecommerce_analytics.unique_stg_products_product_id.7d950a1467"
[0m01:51:49.164261 [debug] [Thread-1 (]: On test.ecommerce_analytics.unique_stg_products_product_id.7d950a1467: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "ecommerce_analytics", "target_name": "dev", "node_id": "test.ecommerce_analytics.unique_stg_products_product_id.7d950a1467"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    product_id as unique_field,
    count(*) as n_records

from "dev"."main"."stg_products"
where product_id is not null
group by product_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m01:51:49.169954 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m01:51:49.171903 [debug] [Thread-1 (]: On test.ecommerce_analytics.unique_stg_products_product_id.7d950a1467: ROLLBACK
[0m01:51:49.171903 [debug] [Thread-1 (]: Failed to rollback 'test.ecommerce_analytics.unique_stg_products_product_id.7d950a1467'
[0m01:51:49.171903 [debug] [Thread-1 (]: On test.ecommerce_analytics.unique_stg_products_product_id.7d950a1467: Close
[0m01:51:49.174312 [info ] [Thread-1 (]: 14 of 14 PASS unique_stg_products_product_id ................................... [[32mPASS[0m in 0.02s]
[0m01:51:49.175933 [debug] [Thread-1 (]: Finished running node test.ecommerce_analytics.unique_stg_products_product_id.7d950a1467
[0m01:51:49.175933 [debug] [MainThread]: Using duckdb connection "master"
[0m01:51:49.175933 [debug] [MainThread]: On master: BEGIN
[0m01:51:49.179568 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m01:51:49.179568 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m01:51:49.181571 [debug] [MainThread]: On master: COMMIT
[0m01:51:49.181571 [debug] [MainThread]: Using duckdb connection "master"
[0m01:51:49.181571 [debug] [MainThread]: On master: COMMIT
[0m01:51:49.181571 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m01:51:49.181571 [debug] [MainThread]: On master: Close
[0m01:51:49.181571 [debug] [MainThread]: Connection 'master' was properly closed.
[0m01:51:49.181571 [debug] [MainThread]: Connection 'list_dev_main' was properly closed.
[0m01:51:49.181571 [debug] [MainThread]: Connection 'test.ecommerce_analytics.unique_stg_products_product_id.7d950a1467' was properly closed.
[0m01:51:49.181571 [info ] [MainThread]: 
[0m01:51:49.181571 [info ] [MainThread]: Finished running 14 data tests in 0 hours 0 minutes and 0.62 seconds (0.62s).
[0m01:51:49.189900 [debug] [MainThread]: Command end result
[0m01:51:49.224392 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\Lenovo\Desktop\Proyectos\dbt-proyect\ecommerce_analytics\target\manifest.json
[0m01:51:49.231227 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\Lenovo\Desktop\Proyectos\dbt-proyect\ecommerce_analytics\target\semantic_manifest.json
[0m01:51:49.237485 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\Lenovo\Desktop\Proyectos\dbt-proyect\ecommerce_analytics\target\run_results.json
[0m01:51:49.237485 [info ] [MainThread]: 
[0m01:51:49.241198 [info ] [MainThread]: [31mCompleted with 2 errors, 0 partial successes, and 0 warnings:[0m
[0m01:51:49.241705 [info ] [MainThread]: 
[0m01:51:49.241705 [error] [MainThread]: [31mFailure in test not_null_stg_customers_email (models\example\staging\schema.yml)[0m
[0m01:51:49.241705 [error] [MainThread]:   Runtime Error in test not_null_stg_customers_email (models\example\staging\schema.yml)
  Binder Error: Referenced column "email" not found in FROM clause!
  Candidate bindings: "segment", "postal_code"
  
  LINE 18: where email is null
                 ^
[0m01:51:49.245918 [info ] [MainThread]: 
[0m01:51:49.245918 [info ] [MainThread]:   compiled code at target\compiled\ecommerce_analytics\models\example\staging\schema.yml\not_null_stg_customers_email.sql
[0m01:51:49.245918 [info ] [MainThread]: 
[0m01:51:49.245918 [error] [MainThread]: [31mFailure in test unique_stg_customers_email (models\example\staging\schema.yml)[0m
[0m01:51:49.245918 [error] [MainThread]:   Runtime Error in test unique_stg_customers_email (models\example\staging\schema.yml)
  Binder Error: Referenced column "email" not found in FROM clause!
  Candidate bindings: "segment", "postal_code"
  
  LINE 19: where email is not null
                 ^
[0m01:51:49.245918 [info ] [MainThread]: 
[0m01:51:49.252324 [info ] [MainThread]:   compiled code at target\compiled\ecommerce_analytics\models\example\staging\schema.yml\unique_stg_customers_email.sql
[0m01:51:49.253726 [info ] [MainThread]: 
[0m01:51:49.253726 [info ] [MainThread]: Done. PASS=12 WARN=0 ERROR=2 SKIP=0 NO-OP=0 TOTAL=14
[0m01:51:49.253726 [debug] [MainThread]: Command `dbt test` failed at 01:51:49.253726 after 1.76 seconds
[0m01:51:49.257240 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029F29507A90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029F23C44B50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029F23C44C90>]}
[0m01:51:49.257240 [debug] [MainThread]: Flushing usage events
[0m01:51:50.634177 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m01:53:11.384266 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000010CCC32C4D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000010CCC361A90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000010CCC32D090>]}


============================== 01:53:11.387408 | 0d183589-3f22-4564-bfe7-1c842b4ce357 ==============================
[0m01:53:11.387408 [info ] [MainThread]: Running with dbt=1.11.2
[0m01:53:11.389577 [debug] [MainThread]: running dbt with arguments {'version_check': 'True', 'no_print': 'None', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'target_path': 'None', 'printer_width': '80', 'write_json': 'True', 'empty': 'False', 'log_cache_events': 'False', 'introspect': 'True', 'cache_selected_only': 'False', 'log_format': 'default', 'debug': 'False', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\Lenovo\\.dbt', 'send_anonymous_usage_stats': 'True', 'quiet': 'False', 'warn_error': 'None', 'partial_parse': 'True', 'use_colors': 'True', 'indirect_selection': 'eager', 'invocation_command': 'dbt run', 'use_experimental_parser': 'False', 'log_path': 'C:\\Users\\Lenovo\\Desktop\\Proyectos\\dbt-proyect\\ecommerce_analytics\\logs'}
[0m01:53:11.635060 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0d183589-3f22-4564-bfe7-1c842b4ce357', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000010CCC4069D0>]}
[0m01:53:11.701061 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '0d183589-3f22-4564-bfe7-1c842b4ce357', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000010CC8CC3DD0>]}
[0m01:53:11.705163 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m01:53:11.944749 [debug] [MainThread]: checksum: 3d40d8bbe1bef07db1c24822f2dbfff8bc07f2a48ed4fe2658a40653aec0b54b, vars: {}, profile: , target: , version: 1.11.2
[0m01:53:12.168289 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m01:53:12.168289 [debug] [MainThread]: Partial parsing: updated file: ecommerce_analytics://models\example\staging\schema.yml
[0m01:53:12.572841 [warn ] [MainThread]: [[33mWARNING[0m][MissingArgumentsPropertyInGenericTestDeprecation]: Deprecated
functionality
Found top-level arguments to test `relationships` defined on 'stg_orders' in
package 'ecommerce_analytics' (models\example\staging\schema.yml). Arguments to
generic tests should be nested under the `arguments` property.
[0m01:53:12.574096 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '0d183589-3f22-4564-bfe7-1c842b4ce357', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000010CCDB65550>]}
[0m01:53:12.697736 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0d183589-3f22-4564-bfe7-1c842b4ce357', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000010CCDABF9D0>]}
[0m01:53:12.789229 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\Lenovo\Desktop\Proyectos\dbt-proyect\ecommerce_analytics\target\manifest.json
[0m01:53:12.798968 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\Lenovo\Desktop\Proyectos\dbt-proyect\ecommerce_analytics\target\semantic_manifest.json
[0m01:53:12.829767 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0d183589-3f22-4564-bfe7-1c842b4ce357', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000010CCDC94E90>]}
[0m01:53:12.829767 [info ] [MainThread]: Found 3 seeds, 7 models, 14 data tests, 587 macros
[0m01:53:12.829767 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0d183589-3f22-4564-bfe7-1c842b4ce357', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000010CCC3344D0>]}
[0m01:53:12.829767 [info ] [MainThread]: 
[0m01:53:12.837392 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m01:53:12.837392 [info ] [MainThread]: 
[0m01:53:12.839835 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m01:53:12.850219 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_dev'
[0m01:53:12.929514 [debug] [ThreadPool]: Using duckdb connection "list_dev"
[0m01:53:12.929514 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "ecommerce_analytics", "target_name": "dev", "connection_name": "list_dev"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"dev"'
    
  
  
[0m01:53:12.929514 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:53:12.956177 [debug] [ThreadPool]: SQL status: OK in 0.022 seconds
[0m01:53:12.956177 [debug] [ThreadPool]: On list_dev: Close
[0m01:53:12.956177 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev, now create_dev_main)
[0m01:53:12.956177 [debug] [ThreadPool]: Creating schema "database: "dev"
schema: "main"
"
[0m01:53:12.966560 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m01:53:12.966560 [debug] [ThreadPool]: On create_dev_main: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "ecommerce_analytics", "target_name": "dev", "connection_name": "create_dev_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='dev'
        and type='sqlite'
    
  
[0m01:53:12.966560 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m01:53:12.966560 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m01:53:12.966560 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m01:53:12.966560 [debug] [ThreadPool]: On create_dev_main: BEGIN
[0m01:53:12.975809 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m01:53:12.976449 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m01:53:12.976449 [debug] [ThreadPool]: On create_dev_main: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "ecommerce_analytics", "target_name": "dev", "connection_name": "create_dev_main"} */

    
    
        create schema if not exists "dev"."main"
    
[0m01:53:12.976449 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m01:53:12.976449 [debug] [ThreadPool]: On create_dev_main: COMMIT
[0m01:53:12.976449 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m01:53:12.976449 [debug] [ThreadPool]: On create_dev_main: COMMIT
[0m01:53:12.976449 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m01:53:12.976449 [debug] [ThreadPool]: On create_dev_main: Close
[0m01:53:12.982433 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_dev_main'
[0m01:53:12.987998 [debug] [ThreadPool]: Using duckdb connection "list_dev_main"
[0m01:53:12.987998 [debug] [ThreadPool]: On list_dev_main: BEGIN
[0m01:53:12.987998 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:53:12.987998 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m01:53:12.987998 [debug] [ThreadPool]: Using duckdb connection "list_dev_main"
[0m01:53:12.987998 [debug] [ThreadPool]: On list_dev_main: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "ecommerce_analytics", "target_name": "dev", "connection_name": "list_dev_main"} */
select
      'dev' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'dev'
  
[0m01:53:13.007368 [debug] [ThreadPool]: SQL status: OK in 0.014 seconds
[0m01:53:13.007368 [debug] [ThreadPool]: On list_dev_main: ROLLBACK
[0m01:53:13.007368 [debug] [ThreadPool]: Failed to rollback 'list_dev_main'
[0m01:53:13.007368 [debug] [ThreadPool]: On list_dev_main: Close
[0m01:53:13.007368 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0d183589-3f22-4564-bfe7-1c842b4ce357', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000010CCDFA3A50>]}
[0m01:53:13.013226 [debug] [MainThread]: Using duckdb connection "master"
[0m01:53:13.013766 [debug] [MainThread]: On master: BEGIN
[0m01:53:13.013766 [debug] [MainThread]: Opening a new connection, currently in state init
[0m01:53:13.013766 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m01:53:13.013766 [debug] [MainThread]: On master: COMMIT
[0m01:53:13.013766 [debug] [MainThread]: Using duckdb connection "master"
[0m01:53:13.013766 [debug] [MainThread]: On master: COMMIT
[0m01:53:13.013766 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m01:53:13.013766 [debug] [MainThread]: On master: Close
[0m01:53:13.017585 [debug] [Thread-1 (]: Began running node model.ecommerce_analytics.dim_customers
[0m01:53:13.023038 [info ] [Thread-1 (]: 1 of 7 START sql view model main.dim_customers ................................. [RUN]
[0m01:53:13.023038 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.ecommerce_analytics.dim_customers'
[0m01:53:13.023038 [debug] [Thread-1 (]: Began compiling node model.ecommerce_analytics.dim_customers
[0m01:53:13.031920 [debug] [Thread-1 (]: Writing injected SQL for node "model.ecommerce_analytics.dim_customers"
[0m01:53:13.034128 [debug] [Thread-1 (]: Began executing node model.ecommerce_analytics.dim_customers
[0m01:53:13.069012 [debug] [Thread-1 (]: Writing runtime sql for node "model.ecommerce_analytics.dim_customers"
[0m01:53:13.070773 [debug] [Thread-1 (]: Using duckdb connection "model.ecommerce_analytics.dim_customers"
[0m01:53:13.070773 [debug] [Thread-1 (]: On model.ecommerce_analytics.dim_customers: BEGIN
[0m01:53:13.070773 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m01:53:13.070773 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m01:53:13.070773 [debug] [Thread-1 (]: Using duckdb connection "model.ecommerce_analytics.dim_customers"
[0m01:53:13.070773 [debug] [Thread-1 (]: On model.ecommerce_analytics.dim_customers: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "ecommerce_analytics", "target_name": "dev", "node_id": "model.ecommerce_analytics.dim_customers"} */

  
  create view "dev"."main"."dim_customers__dbt_tmp" as (
    WITH source AS (
    SELECT * FROM "dev"."main"."raw_customers"
),

renamed AS (
    SELECT
        customer_id,
        first_name || ' ' || last_name AS customer_name,
        email AS customer_email,
        phone,
        CAST(birth_date AS DATE) AS birth_date,
        city AS customer_city,
        country,
        postal_code,
        segment,
        CAST(registration_date AS DATE) AS registration_date,
        CAST(last_login AS DATE) AS last_login,
        is_verified,
        accepts_marketing
    FROM source
)

SELECT * FROM renamed
  );

[0m01:53:13.070773 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m01:53:13.080011 [debug] [Thread-1 (]: Using duckdb connection "model.ecommerce_analytics.dim_customers"
[0m01:53:13.080011 [debug] [Thread-1 (]: On model.ecommerce_analytics.dim_customers: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "ecommerce_analytics", "target_name": "dev", "node_id": "model.ecommerce_analytics.dim_customers"} */
alter view "dev"."main"."dim_customers" rename to "dim_customers__dbt_backup"
[0m01:53:13.080011 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m01:53:13.080011 [debug] [Thread-1 (]: Using duckdb connection "model.ecommerce_analytics.dim_customers"
[0m01:53:13.080011 [debug] [Thread-1 (]: On model.ecommerce_analytics.dim_customers: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "ecommerce_analytics", "target_name": "dev", "node_id": "model.ecommerce_analytics.dim_customers"} */
alter view "dev"."main"."dim_customers__dbt_tmp" rename to "dim_customers"
[0m01:53:13.080011 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m01:53:13.097558 [debug] [Thread-1 (]: On model.ecommerce_analytics.dim_customers: COMMIT
[0m01:53:13.097558 [debug] [Thread-1 (]: Using duckdb connection "model.ecommerce_analytics.dim_customers"
[0m01:53:13.097558 [debug] [Thread-1 (]: On model.ecommerce_analytics.dim_customers: COMMIT
[0m01:53:13.113198 [debug] [Thread-1 (]: SQL status: OK in 0.015 seconds
[0m01:53:13.120722 [debug] [Thread-1 (]: Using duckdb connection "model.ecommerce_analytics.dim_customers"
[0m01:53:13.121227 [debug] [Thread-1 (]: On model.ecommerce_analytics.dim_customers: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "ecommerce_analytics", "target_name": "dev", "node_id": "model.ecommerce_analytics.dim_customers"} */

      drop view if exists "dev"."main"."dim_customers__dbt_backup" cascade
    
[0m01:53:13.121227 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m01:53:13.121227 [debug] [Thread-1 (]: On model.ecommerce_analytics.dim_customers: Close
[0m01:53:13.129552 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0d183589-3f22-4564-bfe7-1c842b4ce357', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000010CCD987450>]}
[0m01:53:13.129552 [info ] [Thread-1 (]: 1 of 7 OK created sql view model main.dim_customers ............................ [[32mOK[0m in 0.10s]
[0m01:53:13.131572 [debug] [Thread-1 (]: Finished running node model.ecommerce_analytics.dim_customers
[0m01:53:13.131572 [debug] [Thread-1 (]: Began running node model.ecommerce_analytics.stg_customers
[0m01:53:13.131572 [info ] [Thread-1 (]: 2 of 7 START sql view model main.stg_customers ................................. [RUN]
[0m01:53:13.134808 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ecommerce_analytics.dim_customers, now model.ecommerce_analytics.stg_customers)
[0m01:53:13.134808 [debug] [Thread-1 (]: Began compiling node model.ecommerce_analytics.stg_customers
[0m01:53:13.134808 [debug] [Thread-1 (]: Writing injected SQL for node "model.ecommerce_analytics.stg_customers"
[0m01:53:13.134808 [debug] [Thread-1 (]: Began executing node model.ecommerce_analytics.stg_customers
[0m01:53:13.147167 [debug] [Thread-1 (]: Writing runtime sql for node "model.ecommerce_analytics.stg_customers"
[0m01:53:13.148821 [debug] [Thread-1 (]: Using duckdb connection "model.ecommerce_analytics.stg_customers"
[0m01:53:13.148821 [debug] [Thread-1 (]: On model.ecommerce_analytics.stg_customers: BEGIN
[0m01:53:13.148821 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:53:13.151331 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m01:53:13.152352 [debug] [Thread-1 (]: Using duckdb connection "model.ecommerce_analytics.stg_customers"
[0m01:53:13.152352 [debug] [Thread-1 (]: On model.ecommerce_analytics.stg_customers: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "ecommerce_analytics", "target_name": "dev", "node_id": "model.ecommerce_analytics.stg_customers"} */

  
  create view "dev"."main"."stg_customers__dbt_tmp" as (
    WITH source AS (
    SELECT * FROM "dev"."main"."raw_customers"
),

renamed AS (
    SELECT
        customer_id,
        first_name || ' ' || last_name AS customer_name,
        email AS customer_email,
        phone,
        CAST(birth_date AS DATE) AS birth_date,
        city AS customer_city,
        country,
        postal_code,
        segment,
        CAST(registration_date AS DATE) AS registration_date,
        CAST(last_login AS DATE) AS last_login,
        is_verified,
        accepts_marketing
    FROM source
)

SELECT * FROM renamed
  );

[0m01:53:13.155064 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m01:53:13.156308 [debug] [Thread-1 (]: Using duckdb connection "model.ecommerce_analytics.stg_customers"
[0m01:53:13.156308 [debug] [Thread-1 (]: On model.ecommerce_analytics.stg_customers: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "ecommerce_analytics", "target_name": "dev", "node_id": "model.ecommerce_analytics.stg_customers"} */
alter view "dev"."main"."stg_customers" rename to "stg_customers__dbt_backup"
[0m01:53:13.160024 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m01:53:13.162838 [debug] [Thread-1 (]: Using duckdb connection "model.ecommerce_analytics.stg_customers"
[0m01:53:13.162838 [debug] [Thread-1 (]: On model.ecommerce_analytics.stg_customers: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "ecommerce_analytics", "target_name": "dev", "node_id": "model.ecommerce_analytics.stg_customers"} */
alter view "dev"."main"."stg_customers__dbt_tmp" rename to "stg_customers"
[0m01:53:13.162838 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m01:53:13.162838 [debug] [Thread-1 (]: On model.ecommerce_analytics.stg_customers: COMMIT
[0m01:53:13.162838 [debug] [Thread-1 (]: Using duckdb connection "model.ecommerce_analytics.stg_customers"
[0m01:53:13.162838 [debug] [Thread-1 (]: On model.ecommerce_analytics.stg_customers: COMMIT
[0m01:53:13.170903 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m01:53:13.173419 [debug] [Thread-1 (]: Using duckdb connection "model.ecommerce_analytics.stg_customers"
[0m01:53:13.173419 [debug] [Thread-1 (]: On model.ecommerce_analytics.stg_customers: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "ecommerce_analytics", "target_name": "dev", "node_id": "model.ecommerce_analytics.stg_customers"} */

      drop view if exists "dev"."main"."stg_customers__dbt_backup" cascade
    
[0m01:53:13.176038 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m01:53:13.179435 [debug] [Thread-1 (]: On model.ecommerce_analytics.stg_customers: Close
[0m01:53:13.179435 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0d183589-3f22-4564-bfe7-1c842b4ce357', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000010CCDB23010>]}
[0m01:53:13.179435 [info ] [Thread-1 (]: 2 of 7 OK created sql view model main.stg_customers ............................ [[32mOK[0m in 0.05s]
[0m01:53:13.179435 [debug] [Thread-1 (]: Finished running node model.ecommerce_analytics.stg_customers
[0m01:53:13.179435 [debug] [Thread-1 (]: Began running node model.ecommerce_analytics.stg_orders
[0m01:53:13.183651 [info ] [Thread-1 (]: 3 of 7 START sql view model main.stg_orders .................................... [RUN]
[0m01:53:13.183651 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ecommerce_analytics.stg_customers, now model.ecommerce_analytics.stg_orders)
[0m01:53:13.183651 [debug] [Thread-1 (]: Began compiling node model.ecommerce_analytics.stg_orders
[0m01:53:13.188223 [debug] [Thread-1 (]: Writing injected SQL for node "model.ecommerce_analytics.stg_orders"
[0m01:53:13.188223 [debug] [Thread-1 (]: Began executing node model.ecommerce_analytics.stg_orders
[0m01:53:13.191705 [debug] [Thread-1 (]: Writing runtime sql for node "model.ecommerce_analytics.stg_orders"
[0m01:53:13.194949 [debug] [Thread-1 (]: Using duckdb connection "model.ecommerce_analytics.stg_orders"
[0m01:53:13.196020 [debug] [Thread-1 (]: On model.ecommerce_analytics.stg_orders: BEGIN
[0m01:53:13.196020 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:53:13.196020 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m01:53:13.196020 [debug] [Thread-1 (]: Using duckdb connection "model.ecommerce_analytics.stg_orders"
[0m01:53:13.196020 [debug] [Thread-1 (]: On model.ecommerce_analytics.stg_orders: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "ecommerce_analytics", "target_name": "dev", "node_id": "model.ecommerce_analytics.stg_orders"} */

  
  create view "dev"."main"."stg_orders__dbt_tmp" as (
    WITH source AS (
    SELECT * FROM "dev"."main"."raw_orders"
),

renamed AS (
    SELECT
        order_id,
        order_number,
        customer_id,
        CAST(order_date AS DATE) AS order_date,
        status,
        CAST(subtotal AS DECIMAL(10,2)) AS subtotal,
        CAST(discount_percent AS DECIMAL(10,2)) AS discount_percent,
        CAST(shipping_cost AS DECIMAL(10,2)) AS shipping_cost,
        CAST(tax_amount AS DECIMAL(10,2)) AS tax_amount,
        CAST(total_amount AS DECIMAL(10,2)) AS total_amount,
        payment_method,
        shipping_method,
        promotion_id,
        notes
    FROM source
)

SELECT * FROM renamed
  );

[0m01:53:13.199199 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m01:53:13.205658 [debug] [Thread-1 (]: Using duckdb connection "model.ecommerce_analytics.stg_orders"
[0m01:53:13.205658 [debug] [Thread-1 (]: On model.ecommerce_analytics.stg_orders: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "ecommerce_analytics", "target_name": "dev", "node_id": "model.ecommerce_analytics.stg_orders"} */
alter view "dev"."main"."stg_orders" rename to "stg_orders__dbt_backup"
[0m01:53:13.207242 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m01:53:13.207242 [debug] [Thread-1 (]: Using duckdb connection "model.ecommerce_analytics.stg_orders"
[0m01:53:13.210773 [debug] [Thread-1 (]: On model.ecommerce_analytics.stg_orders: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "ecommerce_analytics", "target_name": "dev", "node_id": "model.ecommerce_analytics.stg_orders"} */
alter view "dev"."main"."stg_orders__dbt_tmp" rename to "stg_orders"
[0m01:53:13.210773 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m01:53:13.213813 [debug] [Thread-1 (]: On model.ecommerce_analytics.stg_orders: COMMIT
[0m01:53:13.215326 [debug] [Thread-1 (]: Using duckdb connection "model.ecommerce_analytics.stg_orders"
[0m01:53:13.215326 [debug] [Thread-1 (]: On model.ecommerce_analytics.stg_orders: COMMIT
[0m01:53:13.215326 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m01:53:13.215326 [debug] [Thread-1 (]: Using duckdb connection "model.ecommerce_analytics.stg_orders"
[0m01:53:13.215326 [debug] [Thread-1 (]: On model.ecommerce_analytics.stg_orders: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "ecommerce_analytics", "target_name": "dev", "node_id": "model.ecommerce_analytics.stg_orders"} */

      drop view if exists "dev"."main"."stg_orders__dbt_backup" cascade
    
[0m01:53:13.225748 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m01:53:13.227515 [debug] [Thread-1 (]: On model.ecommerce_analytics.stg_orders: Close
[0m01:53:13.228813 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0d183589-3f22-4564-bfe7-1c842b4ce357', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000010CCF2077D0>]}
[0m01:53:13.229872 [info ] [Thread-1 (]: 3 of 7 OK created sql view model main.stg_orders ............................... [[32mOK[0m in 0.05s]
[0m01:53:13.229872 [debug] [Thread-1 (]: Finished running node model.ecommerce_analytics.stg_orders
[0m01:53:13.229872 [debug] [Thread-1 (]: Began running node model.ecommerce_analytics.stg_products
[0m01:53:13.229872 [info ] [Thread-1 (]: 4 of 7 START sql view model main.stg_products .................................. [RUN]
[0m01:53:13.229872 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ecommerce_analytics.stg_orders, now model.ecommerce_analytics.stg_products)
[0m01:53:13.229872 [debug] [Thread-1 (]: Began compiling node model.ecommerce_analytics.stg_products
[0m01:53:13.237971 [debug] [Thread-1 (]: Writing injected SQL for node "model.ecommerce_analytics.stg_products"
[0m01:53:13.239981 [debug] [Thread-1 (]: Began executing node model.ecommerce_analytics.stg_products
[0m01:53:13.246401 [debug] [Thread-1 (]: Writing runtime sql for node "model.ecommerce_analytics.stg_products"
[0m01:53:13.247643 [debug] [Thread-1 (]: Using duckdb connection "model.ecommerce_analytics.stg_products"
[0m01:53:13.247643 [debug] [Thread-1 (]: On model.ecommerce_analytics.stg_products: BEGIN
[0m01:53:13.250154 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:53:13.250154 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m01:53:13.252164 [debug] [Thread-1 (]: Using duckdb connection "model.ecommerce_analytics.stg_products"
[0m01:53:13.252863 [debug] [Thread-1 (]: On model.ecommerce_analytics.stg_products: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "ecommerce_analytics", "target_name": "dev", "node_id": "model.ecommerce_analytics.stg_products"} */

  
  create view "dev"."main"."stg_products__dbt_tmp" as (
    WITH source AS (
    SELECT * FROM "dev"."main"."raw_products"
),

renamed AS (
    SELECT
        product_id,
        sku,
        product_name,
        description,
        category_id,
        brand_id,
        supplier_id,
        CAST(price AS DECIMAL(10,2)) AS price,
        CAST(cost AS DECIMAL(10,2)) AS cost,
        CAST(weight_kg AS DECIMAL(10,2)) AS weight_kg,
        is_active,
        CAST(created_at AS DATE) AS created_at,
        CAST(updated_at AS DATE) AS updated_at
    FROM source
)

SELECT * FROM renamed
  );

[0m01:53:13.254720 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m01:53:13.258482 [debug] [Thread-1 (]: Using duckdb connection "model.ecommerce_analytics.stg_products"
[0m01:53:13.258482 [debug] [Thread-1 (]: On model.ecommerce_analytics.stg_products: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "ecommerce_analytics", "target_name": "dev", "node_id": "model.ecommerce_analytics.stg_products"} */
alter view "dev"."main"."stg_products" rename to "stg_products__dbt_backup"
[0m01:53:13.258482 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m01:53:13.264484 [debug] [Thread-1 (]: Using duckdb connection "model.ecommerce_analytics.stg_products"
[0m01:53:13.264484 [debug] [Thread-1 (]: On model.ecommerce_analytics.stg_products: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "ecommerce_analytics", "target_name": "dev", "node_id": "model.ecommerce_analytics.stg_products"} */
alter view "dev"."main"."stg_products__dbt_tmp" rename to "stg_products"
[0m01:53:13.267042 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m01:53:13.267042 [debug] [Thread-1 (]: On model.ecommerce_analytics.stg_products: COMMIT
[0m01:53:13.267042 [debug] [Thread-1 (]: Using duckdb connection "model.ecommerce_analytics.stg_products"
[0m01:53:13.267042 [debug] [Thread-1 (]: On model.ecommerce_analytics.stg_products: COMMIT
[0m01:53:13.267042 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m01:53:13.275019 [debug] [Thread-1 (]: Using duckdb connection "model.ecommerce_analytics.stg_products"
[0m01:53:13.275019 [debug] [Thread-1 (]: On model.ecommerce_analytics.stg_products: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "ecommerce_analytics", "target_name": "dev", "node_id": "model.ecommerce_analytics.stg_products"} */

      drop view if exists "dev"."main"."stg_products__dbt_backup" cascade
    
[0m01:53:13.277217 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m01:53:13.278763 [debug] [Thread-1 (]: On model.ecommerce_analytics.stg_products: Close
[0m01:53:13.279842 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0d183589-3f22-4564-bfe7-1c842b4ce357', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000010CCBAEE650>]}
[0m01:53:13.279842 [info ] [Thread-1 (]: 4 of 7 OK created sql view model main.stg_products ............................. [[32mOK[0m in 0.05s]
[0m01:53:13.279842 [debug] [Thread-1 (]: Finished running node model.ecommerce_analytics.stg_products
[0m01:53:13.279842 [debug] [Thread-1 (]: Began running node model.ecommerce_analytics.int_orders_enriched
[0m01:53:13.279842 [info ] [Thread-1 (]: 5 of 7 START sql view model main.int_orders_enriched ........................... [RUN]
[0m01:53:13.279842 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ecommerce_analytics.stg_products, now model.ecommerce_analytics.int_orders_enriched)
[0m01:53:13.279842 [debug] [Thread-1 (]: Began compiling node model.ecommerce_analytics.int_orders_enriched
[0m01:53:13.290433 [debug] [Thread-1 (]: Writing injected SQL for node "model.ecommerce_analytics.int_orders_enriched"
[0m01:53:13.291118 [debug] [Thread-1 (]: Began executing node model.ecommerce_analytics.int_orders_enriched
[0m01:53:13.298003 [debug] [Thread-1 (]: Writing runtime sql for node "model.ecommerce_analytics.int_orders_enriched"
[0m01:53:13.298003 [debug] [Thread-1 (]: Using duckdb connection "model.ecommerce_analytics.int_orders_enriched"
[0m01:53:13.298003 [debug] [Thread-1 (]: On model.ecommerce_analytics.int_orders_enriched: BEGIN
[0m01:53:13.301742 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:53:13.301742 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m01:53:13.301742 [debug] [Thread-1 (]: Using duckdb connection "model.ecommerce_analytics.int_orders_enriched"
[0m01:53:13.303751 [debug] [Thread-1 (]: On model.ecommerce_analytics.int_orders_enriched: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "ecommerce_analytics", "target_name": "dev", "node_id": "model.ecommerce_analytics.int_orders_enriched"} */

  
  create view "dev"."main"."int_orders_enriched__dbt_tmp" as (
    WITH orders AS (
    SELECT * FROM "dev"."main"."stg_orders"
),

customers AS (
    SELECT * FROM "dev"."main"."stg_customers"
),

enriched AS (
    SELECT
        o.order_id,
        o.order_number,
        o.order_date,
        o.status,
        o.subtotal,
        o.discount_percent,
        o.shipping_cost,
        o.tax_amount,
        o.total_amount,
        o.payment_method,
        o.shipping_method,
        o.promotion_id,
        o.notes,
        
        -- Customer info
        c.customer_id,
        c.customer_name,
        c.customer_email,
        c.customer_city,
        
        -- Calculated fields
        DATE_TRUNC('month', o.order_date) AS order_month,
        CASE 
            WHEN o.total_amount > 1000 THEN 'High Value'
            WHEN o.total_amount > 500 THEN 'Medium Value'
            ELSE 'Low Value'
        END AS order_tier
        
    FROM orders o
    LEFT JOIN customers c ON o.customer_id = c.customer_id
)

SELECT * FROM enriched
  );

[0m01:53:13.307800 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m01:53:13.308311 [debug] [Thread-1 (]: Using duckdb connection "model.ecommerce_analytics.int_orders_enriched"
[0m01:53:13.308311 [debug] [Thread-1 (]: On model.ecommerce_analytics.int_orders_enriched: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "ecommerce_analytics", "target_name": "dev", "node_id": "model.ecommerce_analytics.int_orders_enriched"} */
alter view "dev"."main"."int_orders_enriched" rename to "int_orders_enriched__dbt_backup"
[0m01:53:13.313848 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m01:53:13.318601 [debug] [Thread-1 (]: Using duckdb connection "model.ecommerce_analytics.int_orders_enriched"
[0m01:53:13.318601 [debug] [Thread-1 (]: On model.ecommerce_analytics.int_orders_enriched: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "ecommerce_analytics", "target_name": "dev", "node_id": "model.ecommerce_analytics.int_orders_enriched"} */
alter view "dev"."main"."int_orders_enriched__dbt_tmp" rename to "int_orders_enriched"
[0m01:53:13.318601 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m01:53:13.318601 [debug] [Thread-1 (]: On model.ecommerce_analytics.int_orders_enriched: COMMIT
[0m01:53:13.318601 [debug] [Thread-1 (]: Using duckdb connection "model.ecommerce_analytics.int_orders_enriched"
[0m01:53:13.318601 [debug] [Thread-1 (]: On model.ecommerce_analytics.int_orders_enriched: COMMIT
[0m01:53:13.318601 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m01:53:13.330013 [debug] [Thread-1 (]: Using duckdb connection "model.ecommerce_analytics.int_orders_enriched"
[0m01:53:13.330013 [debug] [Thread-1 (]: On model.ecommerce_analytics.int_orders_enriched: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "ecommerce_analytics", "target_name": "dev", "node_id": "model.ecommerce_analytics.int_orders_enriched"} */

      drop view if exists "dev"."main"."int_orders_enriched__dbt_backup" cascade
    
[0m01:53:13.330013 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m01:53:13.330013 [debug] [Thread-1 (]: On model.ecommerce_analytics.int_orders_enriched: Close
[0m01:53:13.330013 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0d183589-3f22-4564-bfe7-1c842b4ce357', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000010CCDABDC90>]}
[0m01:53:13.330013 [info ] [Thread-1 (]: 5 of 7 OK created sql view model main.int_orders_enriched ...................... [[32mOK[0m in 0.05s]
[0m01:53:13.330013 [debug] [Thread-1 (]: Finished running node model.ecommerce_analytics.int_orders_enriched
[0m01:53:13.339059 [debug] [Thread-1 (]: Began running node model.ecommerce_analytics.dim_products
[0m01:53:13.339059 [info ] [Thread-1 (]: 6 of 7 START sql table model main.dim_products ................................. [RUN]
[0m01:53:13.339059 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ecommerce_analytics.int_orders_enriched, now model.ecommerce_analytics.dim_products)
[0m01:53:13.339059 [debug] [Thread-1 (]: Began compiling node model.ecommerce_analytics.dim_products
[0m01:53:13.345299 [debug] [Thread-1 (]: Writing injected SQL for node "model.ecommerce_analytics.dim_products"
[0m01:53:13.345299 [debug] [Thread-1 (]: Began executing node model.ecommerce_analytics.dim_products
[0m01:53:13.381903 [debug] [Thread-1 (]: Writing runtime sql for node "model.ecommerce_analytics.dim_products"
[0m01:53:13.383880 [debug] [Thread-1 (]: Using duckdb connection "model.ecommerce_analytics.dim_products"
[0m01:53:13.385889 [debug] [Thread-1 (]: On model.ecommerce_analytics.dim_products: BEGIN
[0m01:53:13.385889 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:53:13.387898 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m01:53:13.388405 [debug] [Thread-1 (]: Using duckdb connection "model.ecommerce_analytics.dim_products"
[0m01:53:13.388405 [debug] [Thread-1 (]: On model.ecommerce_analytics.dim_products: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "ecommerce_analytics", "target_name": "dev", "node_id": "model.ecommerce_analytics.dim_products"} */

  
    
    

    create  table
      "dev"."main"."dim_products__dbt_tmp"
  
    as (
      

WITH products AS (
    SELECT DISTINCT
        product_id,
        sku,
        product_name,
        description,
        category_id,
        brand_id,
        supplier_id,
        price,
        cost,
        weight_kg,
        is_active,
        created_at,
        updated_at
    FROM "dev"."main"."stg_products"
)

SELECT * FROM products
    );
  
  
[0m01:53:13.396935 [debug] [Thread-1 (]: SQL status: OK in 0.009 seconds
[0m01:53:13.407189 [debug] [Thread-1 (]: Using duckdb connection "model.ecommerce_analytics.dim_products"
[0m01:53:13.407189 [debug] [Thread-1 (]: On model.ecommerce_analytics.dim_products: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "ecommerce_analytics", "target_name": "dev", "node_id": "model.ecommerce_analytics.dim_products"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'main'
      AND table_name = 'dim_products'
  
[0m01:53:13.407189 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m01:53:13.412621 [debug] [Thread-1 (]: Using duckdb connection "model.ecommerce_analytics.dim_products"
[0m01:53:13.414690 [debug] [Thread-1 (]: On model.ecommerce_analytics.dim_products: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "ecommerce_analytics", "target_name": "dev", "node_id": "model.ecommerce_analytics.dim_products"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'main'
      AND table_name = 'dim_products'
  
[0m01:53:13.414690 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m01:53:13.424183 [debug] [Thread-1 (]: Using duckdb connection "model.ecommerce_analytics.dim_products"
[0m01:53:13.424183 [debug] [Thread-1 (]: On model.ecommerce_analytics.dim_products: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "ecommerce_analytics", "target_name": "dev", "node_id": "model.ecommerce_analytics.dim_products"} */
alter table "dev"."main"."dim_products" rename to "dim_products__dbt_backup"
[0m01:53:13.427884 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m01:53:13.433581 [debug] [Thread-1 (]: Using duckdb connection "model.ecommerce_analytics.dim_products"
[0m01:53:13.433581 [debug] [Thread-1 (]: On model.ecommerce_analytics.dim_products: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "ecommerce_analytics", "target_name": "dev", "node_id": "model.ecommerce_analytics.dim_products"} */
alter table "dev"."main"."dim_products__dbt_tmp" rename to "dim_products"
[0m01:53:13.436189 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m01:53:13.440056 [debug] [Thread-1 (]: On model.ecommerce_analytics.dim_products: COMMIT
[0m01:53:13.440056 [debug] [Thread-1 (]: Using duckdb connection "model.ecommerce_analytics.dim_products"
[0m01:53:13.440056 [debug] [Thread-1 (]: On model.ecommerce_analytics.dim_products: COMMIT
[0m01:53:13.444095 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m01:53:13.447288 [debug] [Thread-1 (]: Using duckdb connection "model.ecommerce_analytics.dim_products"
[0m01:53:13.447288 [debug] [Thread-1 (]: On model.ecommerce_analytics.dim_products: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "ecommerce_analytics", "target_name": "dev", "node_id": "model.ecommerce_analytics.dim_products"} */

      drop table if exists "dev"."main"."dim_products__dbt_backup" cascade
    
[0m01:53:13.452135 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m01:53:13.452135 [debug] [Thread-1 (]: On model.ecommerce_analytics.dim_products: Close
[0m01:53:13.455294 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0d183589-3f22-4564-bfe7-1c842b4ce357', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000010CCE0C4910>]}
[0m01:53:13.455294 [info ] [Thread-1 (]: 6 of 7 OK created sql table model main.dim_products ............................ [[32mOK[0m in 0.12s]
[0m01:53:13.455294 [debug] [Thread-1 (]: Finished running node model.ecommerce_analytics.dim_products
[0m01:53:13.455294 [debug] [Thread-1 (]: Began running node model.ecommerce_analytics.fct_orders
[0m01:53:13.455294 [info ] [Thread-1 (]: 7 of 7 START sql table model main.fct_orders ................................... [RUN]
[0m01:53:13.455294 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ecommerce_analytics.dim_products, now model.ecommerce_analytics.fct_orders)
[0m01:53:13.455294 [debug] [Thread-1 (]: Began compiling node model.ecommerce_analytics.fct_orders
[0m01:53:13.469296 [debug] [Thread-1 (]: Writing injected SQL for node "model.ecommerce_analytics.fct_orders"
[0m01:53:13.471306 [debug] [Thread-1 (]: Began executing node model.ecommerce_analytics.fct_orders
[0m01:53:13.477901 [debug] [Thread-1 (]: Writing runtime sql for node "model.ecommerce_analytics.fct_orders"
[0m01:53:13.477901 [debug] [Thread-1 (]: Using duckdb connection "model.ecommerce_analytics.fct_orders"
[0m01:53:13.480723 [debug] [Thread-1 (]: On model.ecommerce_analytics.fct_orders: BEGIN
[0m01:53:13.480723 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:53:13.480723 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m01:53:13.480723 [debug] [Thread-1 (]: Using duckdb connection "model.ecommerce_analytics.fct_orders"
[0m01:53:13.483827 [debug] [Thread-1 (]: On model.ecommerce_analytics.fct_orders: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "ecommerce_analytics", "target_name": "dev", "node_id": "model.ecommerce_analytics.fct_orders"} */

  
    
    

    create  table
      "dev"."main"."fct_orders__dbt_tmp"
  
    as (
      

WITH orders AS (
    SELECT * FROM "dev"."main"."int_orders_enriched"
)

SELECT
    order_id,
    order_number,
    order_date,
    order_month,
    customer_id,
    promotion_id,
    subtotal,
    discount_percent,
    shipping_cost,
    tax_amount,
    total_amount,
    payment_method,
    shipping_method,
    order_tier
FROM orders
    );
  
  
[0m01:53:13.488547 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m01:53:13.491794 [debug] [Thread-1 (]: Using duckdb connection "model.ecommerce_analytics.fct_orders"
[0m01:53:13.491794 [debug] [Thread-1 (]: On model.ecommerce_analytics.fct_orders: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "ecommerce_analytics", "target_name": "dev", "node_id": "model.ecommerce_analytics.fct_orders"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'main'
      AND table_name = 'fct_orders'
  
[0m01:53:13.493811 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m01:53:13.496404 [debug] [Thread-1 (]: Using duckdb connection "model.ecommerce_analytics.fct_orders"
[0m01:53:13.496993 [debug] [Thread-1 (]: On model.ecommerce_analytics.fct_orders: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "ecommerce_analytics", "target_name": "dev", "node_id": "model.ecommerce_analytics.fct_orders"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'main'
      AND table_name = 'fct_orders'
  
[0m01:53:13.496993 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m01:53:13.496993 [debug] [Thread-1 (]: Using duckdb connection "model.ecommerce_analytics.fct_orders"
[0m01:53:13.506860 [debug] [Thread-1 (]: On model.ecommerce_analytics.fct_orders: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "ecommerce_analytics", "target_name": "dev", "node_id": "model.ecommerce_analytics.fct_orders"} */
alter table "dev"."main"."fct_orders" rename to "fct_orders__dbt_backup"
[0m01:53:13.506860 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m01:53:13.512156 [debug] [Thread-1 (]: Using duckdb connection "model.ecommerce_analytics.fct_orders"
[0m01:53:13.512156 [debug] [Thread-1 (]: On model.ecommerce_analytics.fct_orders: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "ecommerce_analytics", "target_name": "dev", "node_id": "model.ecommerce_analytics.fct_orders"} */
alter table "dev"."main"."fct_orders__dbt_tmp" rename to "fct_orders"
[0m01:53:13.512156 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m01:53:13.517049 [debug] [Thread-1 (]: On model.ecommerce_analytics.fct_orders: COMMIT
[0m01:53:13.517049 [debug] [Thread-1 (]: Using duckdb connection "model.ecommerce_analytics.fct_orders"
[0m01:53:13.519662 [debug] [Thread-1 (]: On model.ecommerce_analytics.fct_orders: COMMIT
[0m01:53:13.519662 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m01:53:13.527383 [debug] [Thread-1 (]: Using duckdb connection "model.ecommerce_analytics.fct_orders"
[0m01:53:13.529047 [debug] [Thread-1 (]: On model.ecommerce_analytics.fct_orders: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "ecommerce_analytics", "target_name": "dev", "node_id": "model.ecommerce_analytics.fct_orders"} */

      drop table if exists "dev"."main"."fct_orders__dbt_backup" cascade
    
[0m01:53:13.529047 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m01:53:13.529047 [debug] [Thread-1 (]: On model.ecommerce_analytics.fct_orders: Close
[0m01:53:13.534538 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0d183589-3f22-4564-bfe7-1c842b4ce357', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000010CCE08EC10>]}
[0m01:53:13.535724 [info ] [Thread-1 (]: 7 of 7 OK created sql table model main.fct_orders .............................. [[32mOK[0m in 0.08s]
[0m01:53:13.537190 [debug] [Thread-1 (]: Finished running node model.ecommerce_analytics.fct_orders
[0m01:53:13.539794 [debug] [MainThread]: Using duckdb connection "master"
[0m01:53:13.539794 [debug] [MainThread]: On master: BEGIN
[0m01:53:13.539794 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m01:53:13.539794 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m01:53:13.539794 [debug] [MainThread]: On master: COMMIT
[0m01:53:13.543491 [debug] [MainThread]: Using duckdb connection "master"
[0m01:53:13.545507 [debug] [MainThread]: On master: COMMIT
[0m01:53:13.546337 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m01:53:13.548107 [debug] [MainThread]: On master: Close
[0m01:53:13.549462 [debug] [MainThread]: Connection 'master' was properly closed.
[0m01:53:13.550293 [debug] [MainThread]: Connection 'create_dev_main' was properly closed.
[0m01:53:13.550293 [debug] [MainThread]: Connection 'list_dev_main' was properly closed.
[0m01:53:13.552402 [debug] [MainThread]: Connection 'model.ecommerce_analytics.fct_orders' was properly closed.
[0m01:53:13.552402 [info ] [MainThread]: 
[0m01:53:13.552402 [info ] [MainThread]: Finished running 2 table models, 5 view models in 0 hours 0 minutes and 0.71 seconds (0.71s).
[0m01:53:13.552402 [debug] [MainThread]: Command end result
[0m01:53:13.589785 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\Lenovo\Desktop\Proyectos\dbt-proyect\ecommerce_analytics\target\manifest.json
[0m01:53:13.598831 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\Lenovo\Desktop\Proyectos\dbt-proyect\ecommerce_analytics\target\semantic_manifest.json
[0m01:53:13.600348 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\Lenovo\Desktop\Proyectos\dbt-proyect\ecommerce_analytics\target\run_results.json
[0m01:53:13.610567 [info ] [MainThread]: 
[0m01:53:13.612087 [info ] [MainThread]: [32mCompleted successfully[0m
[0m01:53:13.612087 [info ] [MainThread]: 
[0m01:53:13.613742 [info ] [MainThread]: Done. PASS=7 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=7
[0m01:53:13.613742 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- MissingArgumentsPropertyInGenericTestDeprecation: 3 occurrences
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m01:53:13.613742 [debug] [MainThread]: Command `dbt run` succeeded at 01:53:13.613742 after 2.33 seconds
[0m01:53:13.619560 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000010CCC3B25D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000010CCC0C3590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000010CC55C4A90>]}
[0m01:53:13.619560 [debug] [MainThread]: Flushing usage events
[0m01:53:15.017084 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m01:53:57.378408 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F22C6FF6D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F22C72F7D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F22C72F750>]}


============================== 01:53:57.383700 | 087013c3-413c-4634-91f0-d0c59ab1284c ==============================
[0m01:53:57.383700 [info ] [MainThread]: Running with dbt=1.11.2
[0m01:53:57.383700 [debug] [MainThread]: running dbt with arguments {'static_parser': 'True', 'no_print': 'None', 'version_check': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'target_path': 'None', 'printer_width': '80', 'write_json': 'True', 'empty': 'None', 'log_cache_events': 'False', 'introspect': 'True', 'cache_selected_only': 'False', 'log_format': 'default', 'debug': 'False', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\Lenovo\\.dbt', 'send_anonymous_usage_stats': 'True', 'quiet': 'False', 'warn_error': 'None', 'partial_parse': 'True', 'invocation_command': 'dbt test', 'indirect_selection': 'eager', 'use_colors': 'True', 'use_experimental_parser': 'False', 'log_path': 'C:\\Users\\Lenovo\\Desktop\\Proyectos\\dbt-proyect\\ecommerce_analytics\\logs'}
[0m01:53:57.657407 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '087013c3-413c-4634-91f0-d0c59ab1284c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F22C7CACD0>]}
[0m01:53:57.717633 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '087013c3-413c-4634-91f0-d0c59ab1284c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F229071C90>]}
[0m01:53:57.717633 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m01:53:57.981088 [debug] [MainThread]: checksum: 3d40d8bbe1bef07db1c24822f2dbfff8bc07f2a48ed4fe2658a40653aec0b54b, vars: {}, profile: , target: , version: 1.11.2
[0m01:53:58.215596 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m01:53:58.215596 [debug] [MainThread]: Nothing changed, skipping partial parsing.
[0m01:53:58.215596 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m01:53:58.276099 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '087013c3-413c-4634-91f0-d0c59ab1284c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F22DB63CD0>]}
[0m01:53:58.361499 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\Lenovo\Desktop\Proyectos\dbt-proyect\ecommerce_analytics\target\manifest.json
[0m01:53:58.366028 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\Lenovo\Desktop\Proyectos\dbt-proyect\ecommerce_analytics\target\semantic_manifest.json
[0m01:53:58.471583 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '087013c3-413c-4634-91f0-d0c59ab1284c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F22D8ECC90>]}
[0m01:53:58.471583 [info ] [MainThread]: Found 3 seeds, 7 models, 14 data tests, 587 macros
[0m01:53:58.476270 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '087013c3-413c-4634-91f0-d0c59ab1284c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F22DE8EB50>]}
[0m01:53:58.476270 [info ] [MainThread]: 
[0m01:53:58.476270 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m01:53:58.476270 [info ] [MainThread]: 
[0m01:53:58.476270 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m01:53:58.490847 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_dev_main'
[0m01:53:58.564847 [debug] [ThreadPool]: Using duckdb connection "list_dev_main"
[0m01:53:58.564847 [debug] [ThreadPool]: On list_dev_main: BEGIN
[0m01:53:58.564847 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:53:58.602605 [debug] [ThreadPool]: SQL status: OK in 0.041 seconds
[0m01:53:58.602605 [debug] [ThreadPool]: Using duckdb connection "list_dev_main"
[0m01:53:58.602605 [debug] [ThreadPool]: On list_dev_main: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "ecommerce_analytics", "target_name": "dev", "connection_name": "list_dev_main"} */
select
      'dev' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'dev'
  
[0m01:53:58.621326 [debug] [ThreadPool]: SQL status: OK in 0.013 seconds
[0m01:53:58.623433 [debug] [ThreadPool]: On list_dev_main: ROLLBACK
[0m01:53:58.623433 [debug] [ThreadPool]: Failed to rollback 'list_dev_main'
[0m01:53:58.623433 [debug] [ThreadPool]: On list_dev_main: Close
[0m01:53:58.628366 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '087013c3-413c-4634-91f0-d0c59ab1284c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F22DB8FC90>]}
[0m01:53:58.629416 [debug] [MainThread]: Using duckdb connection "master"
[0m01:53:58.629416 [debug] [MainThread]: On master: BEGIN
[0m01:53:58.629416 [debug] [MainThread]: Opening a new connection, currently in state init
[0m01:53:58.629416 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m01:53:58.629416 [debug] [MainThread]: On master: COMMIT
[0m01:53:58.629416 [debug] [MainThread]: Using duckdb connection "master"
[0m01:53:58.629416 [debug] [MainThread]: On master: COMMIT
[0m01:53:58.633494 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m01:53:58.634017 [debug] [MainThread]: On master: Close
[0m01:53:58.634017 [debug] [Thread-1 (]: Began running node test.ecommerce_analytics.dbt_utils_accepted_range_stg_orders_total_amount__0.2895a1f8db
[0m01:53:58.634017 [info ] [Thread-1 (]: 1 of 14 START test dbt_utils_accepted_range_stg_orders_total_amount__0 ......... [RUN]
[0m01:53:58.641310 [debug] [Thread-1 (]: Acquiring new duckdb connection 'test.ecommerce_analytics.dbt_utils_accepted_range_stg_orders_total_amount__0.2895a1f8db'
[0m01:53:58.641310 [debug] [Thread-1 (]: Began compiling node test.ecommerce_analytics.dbt_utils_accepted_range_stg_orders_total_amount__0.2895a1f8db
[0m01:53:58.654613 [debug] [Thread-1 (]: Writing injected SQL for node "test.ecommerce_analytics.dbt_utils_accepted_range_stg_orders_total_amount__0.2895a1f8db"
[0m01:53:58.654613 [debug] [Thread-1 (]: Began executing node test.ecommerce_analytics.dbt_utils_accepted_range_stg_orders_total_amount__0.2895a1f8db
[0m01:53:58.675399 [debug] [Thread-1 (]: Writing runtime sql for node "test.ecommerce_analytics.dbt_utils_accepted_range_stg_orders_total_amount__0.2895a1f8db"
[0m01:53:58.675399 [debug] [Thread-1 (]: Using duckdb connection "test.ecommerce_analytics.dbt_utils_accepted_range_stg_orders_total_amount__0.2895a1f8db"
[0m01:53:58.680550 [debug] [Thread-1 (]: On test.ecommerce_analytics.dbt_utils_accepted_range_stg_orders_total_amount__0.2895a1f8db: BEGIN
[0m01:53:58.680550 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m01:53:58.680550 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m01:53:58.680550 [debug] [Thread-1 (]: Using duckdb connection "test.ecommerce_analytics.dbt_utils_accepted_range_stg_orders_total_amount__0.2895a1f8db"
[0m01:53:58.680550 [debug] [Thread-1 (]: On test.ecommerce_analytics.dbt_utils_accepted_range_stg_orders_total_amount__0.2895a1f8db: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "ecommerce_analytics", "target_name": "dev", "node_id": "test.ecommerce_analytics.dbt_utils_accepted_range_stg_orders_total_amount__0.2895a1f8db"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  

with meet_condition as(
  select *
  from "dev"."main"."stg_orders"
),

validation_errors as (
  select *
  from meet_condition
  where
    -- never true, defaults to an empty result set. Exists to ensure any combo of the `or` clauses below succeeds
    1 = 2
    -- records with a value >= min_value are permitted. The `not` flips this to find records that don't meet the rule.
    or not total_amount >= 0
)

select *
from validation_errors


  
  
      
    ) dbt_internal_test
[0m01:53:58.685941 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m01:53:58.685941 [debug] [Thread-1 (]: On test.ecommerce_analytics.dbt_utils_accepted_range_stg_orders_total_amount__0.2895a1f8db: ROLLBACK
[0m01:53:58.685941 [debug] [Thread-1 (]: Failed to rollback 'test.ecommerce_analytics.dbt_utils_accepted_range_stg_orders_total_amount__0.2895a1f8db'
[0m01:53:58.685941 [debug] [Thread-1 (]: On test.ecommerce_analytics.dbt_utils_accepted_range_stg_orders_total_amount__0.2895a1f8db: Close
[0m01:53:58.691437 [info ] [Thread-1 (]: 1 of 14 PASS dbt_utils_accepted_range_stg_orders_total_amount__0 ............... [[32mPASS[0m in 0.05s]
[0m01:53:58.691437 [debug] [Thread-1 (]: Finished running node test.ecommerce_analytics.dbt_utils_accepted_range_stg_orders_total_amount__0.2895a1f8db
[0m01:53:58.691437 [debug] [Thread-1 (]: Began running node test.ecommerce_analytics.dbt_utils_accepted_range_stg_products_price__0.26bfce9c9f
[0m01:53:58.691437 [info ] [Thread-1 (]: 2 of 14 START test dbt_utils_accepted_range_stg_products_price__0 .............. [RUN]
[0m01:53:58.694441 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.ecommerce_analytics.dbt_utils_accepted_range_stg_orders_total_amount__0.2895a1f8db, now test.ecommerce_analytics.dbt_utils_accepted_range_stg_products_price__0.26bfce9c9f)
[0m01:53:58.694441 [debug] [Thread-1 (]: Began compiling node test.ecommerce_analytics.dbt_utils_accepted_range_stg_products_price__0.26bfce9c9f
[0m01:53:58.700024 [debug] [Thread-1 (]: Writing injected SQL for node "test.ecommerce_analytics.dbt_utils_accepted_range_stg_products_price__0.26bfce9c9f"
[0m01:53:58.700024 [debug] [Thread-1 (]: Began executing node test.ecommerce_analytics.dbt_utils_accepted_range_stg_products_price__0.26bfce9c9f
[0m01:53:58.700024 [debug] [Thread-1 (]: Writing runtime sql for node "test.ecommerce_analytics.dbt_utils_accepted_range_stg_products_price__0.26bfce9c9f"
[0m01:53:58.700024 [debug] [Thread-1 (]: Using duckdb connection "test.ecommerce_analytics.dbt_utils_accepted_range_stg_products_price__0.26bfce9c9f"
[0m01:53:58.700024 [debug] [Thread-1 (]: On test.ecommerce_analytics.dbt_utils_accepted_range_stg_products_price__0.26bfce9c9f: BEGIN
[0m01:53:58.700024 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:53:58.708219 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m01:53:58.708219 [debug] [Thread-1 (]: Using duckdb connection "test.ecommerce_analytics.dbt_utils_accepted_range_stg_products_price__0.26bfce9c9f"
[0m01:53:58.708219 [debug] [Thread-1 (]: On test.ecommerce_analytics.dbt_utils_accepted_range_stg_products_price__0.26bfce9c9f: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "ecommerce_analytics", "target_name": "dev", "node_id": "test.ecommerce_analytics.dbt_utils_accepted_range_stg_products_price__0.26bfce9c9f"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  

with meet_condition as(
  select *
  from "dev"."main"."stg_products"
),

validation_errors as (
  select *
  from meet_condition
  where
    -- never true, defaults to an empty result set. Exists to ensure any combo of the `or` clauses below succeeds
    1 = 2
    -- records with a value >= min_value are permitted. The `not` flips this to find records that don't meet the rule.
    or not price >= 0
)

select *
from validation_errors


  
  
      
    ) dbt_internal_test
[0m01:53:58.708219 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m01:53:58.708219 [debug] [Thread-1 (]: On test.ecommerce_analytics.dbt_utils_accepted_range_stg_products_price__0.26bfce9c9f: ROLLBACK
[0m01:53:58.714674 [debug] [Thread-1 (]: Failed to rollback 'test.ecommerce_analytics.dbt_utils_accepted_range_stg_products_price__0.26bfce9c9f'
[0m01:53:58.716292 [debug] [Thread-1 (]: On test.ecommerce_analytics.dbt_utils_accepted_range_stg_products_price__0.26bfce9c9f: Close
[0m01:53:58.717300 [info ] [Thread-1 (]: 2 of 14 PASS dbt_utils_accepted_range_stg_products_price__0 .................... [[32mPASS[0m in 0.02s]
[0m01:53:58.717300 [debug] [Thread-1 (]: Finished running node test.ecommerce_analytics.dbt_utils_accepted_range_stg_products_price__0.26bfce9c9f
[0m01:53:58.717300 [debug] [Thread-1 (]: Began running node test.ecommerce_analytics.not_null_stg_customers_customer_email.3267d739f2
[0m01:53:58.717300 [info ] [Thread-1 (]: 3 of 14 START test not_null_stg_customers_customer_email ....................... [RUN]
[0m01:53:58.722261 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.ecommerce_analytics.dbt_utils_accepted_range_stg_products_price__0.26bfce9c9f, now test.ecommerce_analytics.not_null_stg_customers_customer_email.3267d739f2)
[0m01:53:58.722261 [debug] [Thread-1 (]: Began compiling node test.ecommerce_analytics.not_null_stg_customers_customer_email.3267d739f2
[0m01:53:58.730603 [debug] [Thread-1 (]: Writing injected SQL for node "test.ecommerce_analytics.not_null_stg_customers_customer_email.3267d739f2"
[0m01:53:58.746732 [debug] [Thread-1 (]: Began executing node test.ecommerce_analytics.not_null_stg_customers_customer_email.3267d739f2
[0m01:53:58.750839 [debug] [Thread-1 (]: Writing runtime sql for node "test.ecommerce_analytics.not_null_stg_customers_customer_email.3267d739f2"
[0m01:53:58.754870 [debug] [Thread-1 (]: Using duckdb connection "test.ecommerce_analytics.not_null_stg_customers_customer_email.3267d739f2"
[0m01:53:58.754870 [debug] [Thread-1 (]: On test.ecommerce_analytics.not_null_stg_customers_customer_email.3267d739f2: BEGIN
[0m01:53:58.756377 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:53:58.756377 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m01:53:58.756377 [debug] [Thread-1 (]: Using duckdb connection "test.ecommerce_analytics.not_null_stg_customers_customer_email.3267d739f2"
[0m01:53:58.758396 [debug] [Thread-1 (]: On test.ecommerce_analytics.not_null_stg_customers_customer_email.3267d739f2: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "ecommerce_analytics", "target_name": "dev", "node_id": "test.ecommerce_analytics.not_null_stg_customers_customer_email.3267d739f2"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select customer_email
from "dev"."main"."stg_customers"
where customer_email is null



  
  
      
    ) dbt_internal_test
[0m01:53:58.758908 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m01:53:58.763508 [debug] [Thread-1 (]: On test.ecommerce_analytics.not_null_stg_customers_customer_email.3267d739f2: ROLLBACK
[0m01:53:58.764026 [debug] [Thread-1 (]: Failed to rollback 'test.ecommerce_analytics.not_null_stg_customers_customer_email.3267d739f2'
[0m01:53:58.764026 [debug] [Thread-1 (]: On test.ecommerce_analytics.not_null_stg_customers_customer_email.3267d739f2: Close
[0m01:53:58.767838 [info ] [Thread-1 (]: 3 of 14 PASS not_null_stg_customers_customer_email ............................. [[32mPASS[0m in 0.05s]
[0m01:53:58.769347 [debug] [Thread-1 (]: Finished running node test.ecommerce_analytics.not_null_stg_customers_customer_email.3267d739f2
[0m01:53:58.769347 [debug] [Thread-1 (]: Began running node test.ecommerce_analytics.not_null_stg_customers_customer_id.e2cfb1f9aa
[0m01:53:58.769347 [info ] [Thread-1 (]: 4 of 14 START test not_null_stg_customers_customer_id .......................... [RUN]
[0m01:53:58.769347 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.ecommerce_analytics.not_null_stg_customers_customer_email.3267d739f2, now test.ecommerce_analytics.not_null_stg_customers_customer_id.e2cfb1f9aa)
[0m01:53:58.769347 [debug] [Thread-1 (]: Began compiling node test.ecommerce_analytics.not_null_stg_customers_customer_id.e2cfb1f9aa
[0m01:53:58.777650 [debug] [Thread-1 (]: Writing injected SQL for node "test.ecommerce_analytics.not_null_stg_customers_customer_id.e2cfb1f9aa"
[0m01:53:58.779810 [debug] [Thread-1 (]: Began executing node test.ecommerce_analytics.not_null_stg_customers_customer_id.e2cfb1f9aa
[0m01:53:58.784360 [debug] [Thread-1 (]: Writing runtime sql for node "test.ecommerce_analytics.not_null_stg_customers_customer_id.e2cfb1f9aa"
[0m01:53:58.786244 [debug] [Thread-1 (]: Using duckdb connection "test.ecommerce_analytics.not_null_stg_customers_customer_id.e2cfb1f9aa"
[0m01:53:58.786244 [debug] [Thread-1 (]: On test.ecommerce_analytics.not_null_stg_customers_customer_id.e2cfb1f9aa: BEGIN
[0m01:53:58.786244 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:53:58.786244 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m01:53:58.786244 [debug] [Thread-1 (]: Using duckdb connection "test.ecommerce_analytics.not_null_stg_customers_customer_id.e2cfb1f9aa"
[0m01:53:58.790313 [debug] [Thread-1 (]: On test.ecommerce_analytics.not_null_stg_customers_customer_id.e2cfb1f9aa: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "ecommerce_analytics", "target_name": "dev", "node_id": "test.ecommerce_analytics.not_null_stg_customers_customer_id.e2cfb1f9aa"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select customer_id
from "dev"."main"."stg_customers"
where customer_id is null



  
  
      
    ) dbt_internal_test
[0m01:53:58.792046 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m01:53:58.792046 [debug] [Thread-1 (]: On test.ecommerce_analytics.not_null_stg_customers_customer_id.e2cfb1f9aa: ROLLBACK
[0m01:53:58.794638 [debug] [Thread-1 (]: Failed to rollback 'test.ecommerce_analytics.not_null_stg_customers_customer_id.e2cfb1f9aa'
[0m01:53:58.794638 [debug] [Thread-1 (]: On test.ecommerce_analytics.not_null_stg_customers_customer_id.e2cfb1f9aa: Close
[0m01:53:58.794638 [info ] [Thread-1 (]: 4 of 14 PASS not_null_stg_customers_customer_id ................................ [[32mPASS[0m in 0.03s]
[0m01:53:58.797492 [debug] [Thread-1 (]: Finished running node test.ecommerce_analytics.not_null_stg_customers_customer_id.e2cfb1f9aa
[0m01:53:58.797492 [debug] [Thread-1 (]: Began running node test.ecommerce_analytics.not_null_stg_orders_customer_id.af79d5e4b5
[0m01:53:58.800711 [info ] [Thread-1 (]: 5 of 14 START test not_null_stg_orders_customer_id ............................. [RUN]
[0m01:53:58.800711 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.ecommerce_analytics.not_null_stg_customers_customer_id.e2cfb1f9aa, now test.ecommerce_analytics.not_null_stg_orders_customer_id.af79d5e4b5)
[0m01:53:58.800711 [debug] [Thread-1 (]: Began compiling node test.ecommerce_analytics.not_null_stg_orders_customer_id.af79d5e4b5
[0m01:53:58.800711 [debug] [Thread-1 (]: Writing injected SQL for node "test.ecommerce_analytics.not_null_stg_orders_customer_id.af79d5e4b5"
[0m01:53:58.800711 [debug] [Thread-1 (]: Began executing node test.ecommerce_analytics.not_null_stg_orders_customer_id.af79d5e4b5
[0m01:53:58.811344 [debug] [Thread-1 (]: Writing runtime sql for node "test.ecommerce_analytics.not_null_stg_orders_customer_id.af79d5e4b5"
[0m01:53:58.813919 [debug] [Thread-1 (]: Using duckdb connection "test.ecommerce_analytics.not_null_stg_orders_customer_id.af79d5e4b5"
[0m01:53:58.813919 [debug] [Thread-1 (]: On test.ecommerce_analytics.not_null_stg_orders_customer_id.af79d5e4b5: BEGIN
[0m01:53:58.816403 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:53:58.816403 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m01:53:58.818412 [debug] [Thread-1 (]: Using duckdb connection "test.ecommerce_analytics.not_null_stg_orders_customer_id.af79d5e4b5"
[0m01:53:58.818412 [debug] [Thread-1 (]: On test.ecommerce_analytics.not_null_stg_orders_customer_id.af79d5e4b5: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "ecommerce_analytics", "target_name": "dev", "node_id": "test.ecommerce_analytics.not_null_stg_orders_customer_id.af79d5e4b5"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select customer_id
from "dev"."main"."stg_orders"
where customer_id is null



  
  
      
    ) dbt_internal_test
[0m01:53:58.821899 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m01:53:58.821899 [debug] [Thread-1 (]: On test.ecommerce_analytics.not_null_stg_orders_customer_id.af79d5e4b5: ROLLBACK
[0m01:53:58.821899 [debug] [Thread-1 (]: Failed to rollback 'test.ecommerce_analytics.not_null_stg_orders_customer_id.af79d5e4b5'
[0m01:53:58.821899 [debug] [Thread-1 (]: On test.ecommerce_analytics.not_null_stg_orders_customer_id.af79d5e4b5: Close
[0m01:53:58.821899 [info ] [Thread-1 (]: 5 of 14 PASS not_null_stg_orders_customer_id ................................... [[32mPASS[0m in 0.02s]
[0m01:53:58.826730 [debug] [Thread-1 (]: Finished running node test.ecommerce_analytics.not_null_stg_orders_customer_id.af79d5e4b5
[0m01:53:58.826730 [debug] [Thread-1 (]: Began running node test.ecommerce_analytics.not_null_stg_orders_order_id.81cfe2fe64
[0m01:53:58.826730 [info ] [Thread-1 (]: 6 of 14 START test not_null_stg_orders_order_id ................................ [RUN]
[0m01:53:58.829670 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.ecommerce_analytics.not_null_stg_orders_customer_id.af79d5e4b5, now test.ecommerce_analytics.not_null_stg_orders_order_id.81cfe2fe64)
[0m01:53:58.830094 [debug] [Thread-1 (]: Began compiling node test.ecommerce_analytics.not_null_stg_orders_order_id.81cfe2fe64
[0m01:53:58.832371 [debug] [Thread-1 (]: Writing injected SQL for node "test.ecommerce_analytics.not_null_stg_orders_order_id.81cfe2fe64"
[0m01:53:58.832371 [debug] [Thread-1 (]: Began executing node test.ecommerce_analytics.not_null_stg_orders_order_id.81cfe2fe64
[0m01:53:58.842610 [debug] [Thread-1 (]: Writing runtime sql for node "test.ecommerce_analytics.not_null_stg_orders_order_id.81cfe2fe64"
[0m01:53:58.845404 [debug] [Thread-1 (]: Using duckdb connection "test.ecommerce_analytics.not_null_stg_orders_order_id.81cfe2fe64"
[0m01:53:58.847248 [debug] [Thread-1 (]: On test.ecommerce_analytics.not_null_stg_orders_order_id.81cfe2fe64: BEGIN
[0m01:53:58.847248 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:53:58.849219 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m01:53:58.849726 [debug] [Thread-1 (]: Using duckdb connection "test.ecommerce_analytics.not_null_stg_orders_order_id.81cfe2fe64"
[0m01:53:58.850734 [debug] [Thread-1 (]: On test.ecommerce_analytics.not_null_stg_orders_order_id.81cfe2fe64: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "ecommerce_analytics", "target_name": "dev", "node_id": "test.ecommerce_analytics.not_null_stg_orders_order_id.81cfe2fe64"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select order_id
from "dev"."main"."stg_orders"
where order_id is null



  
  
      
    ) dbt_internal_test
[0m01:53:58.850734 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m01:53:58.853250 [debug] [Thread-1 (]: On test.ecommerce_analytics.not_null_stg_orders_order_id.81cfe2fe64: ROLLBACK
[0m01:53:58.855496 [debug] [Thread-1 (]: Failed to rollback 'test.ecommerce_analytics.not_null_stg_orders_order_id.81cfe2fe64'
[0m01:53:58.855496 [debug] [Thread-1 (]: On test.ecommerce_analytics.not_null_stg_orders_order_id.81cfe2fe64: Close
[0m01:53:58.855496 [info ] [Thread-1 (]: 6 of 14 PASS not_null_stg_orders_order_id ...................................... [[32mPASS[0m in 0.03s]
[0m01:53:58.855496 [debug] [Thread-1 (]: Finished running node test.ecommerce_analytics.not_null_stg_orders_order_id.81cfe2fe64
[0m01:53:58.855496 [debug] [Thread-1 (]: Began running node test.ecommerce_analytics.not_null_stg_orders_total_amount.f31d98d41b
[0m01:53:58.858964 [info ] [Thread-1 (]: 7 of 14 START test not_null_stg_orders_total_amount ............................ [RUN]
[0m01:53:58.858964 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.ecommerce_analytics.not_null_stg_orders_order_id.81cfe2fe64, now test.ecommerce_analytics.not_null_stg_orders_total_amount.f31d98d41b)
[0m01:53:58.858964 [debug] [Thread-1 (]: Began compiling node test.ecommerce_analytics.not_null_stg_orders_total_amount.f31d98d41b
[0m01:53:58.863792 [debug] [Thread-1 (]: Writing injected SQL for node "test.ecommerce_analytics.not_null_stg_orders_total_amount.f31d98d41b"
[0m01:53:58.863792 [debug] [Thread-1 (]: Began executing node test.ecommerce_analytics.not_null_stg_orders_total_amount.f31d98d41b
[0m01:53:58.868414 [debug] [Thread-1 (]: Writing runtime sql for node "test.ecommerce_analytics.not_null_stg_orders_total_amount.f31d98d41b"
[0m01:53:58.868414 [debug] [Thread-1 (]: Using duckdb connection "test.ecommerce_analytics.not_null_stg_orders_total_amount.f31d98d41b"
[0m01:53:58.868414 [debug] [Thread-1 (]: On test.ecommerce_analytics.not_null_stg_orders_total_amount.f31d98d41b: BEGIN
[0m01:53:58.868414 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:53:58.868414 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m01:53:58.868414 [debug] [Thread-1 (]: Using duckdb connection "test.ecommerce_analytics.not_null_stg_orders_total_amount.f31d98d41b"
[0m01:53:58.873159 [debug] [Thread-1 (]: On test.ecommerce_analytics.not_null_stg_orders_total_amount.f31d98d41b: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "ecommerce_analytics", "target_name": "dev", "node_id": "test.ecommerce_analytics.not_null_stg_orders_total_amount.f31d98d41b"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select total_amount
from "dev"."main"."stg_orders"
where total_amount is null



  
  
      
    ) dbt_internal_test
[0m01:53:58.874212 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m01:53:58.876908 [debug] [Thread-1 (]: On test.ecommerce_analytics.not_null_stg_orders_total_amount.f31d98d41b: ROLLBACK
[0m01:53:58.876908 [debug] [Thread-1 (]: Failed to rollback 'test.ecommerce_analytics.not_null_stg_orders_total_amount.f31d98d41b'
[0m01:53:58.876908 [debug] [Thread-1 (]: On test.ecommerce_analytics.not_null_stg_orders_total_amount.f31d98d41b: Close
[0m01:53:58.876908 [info ] [Thread-1 (]: 7 of 14 PASS not_null_stg_orders_total_amount .................................. [[32mPASS[0m in 0.02s]
[0m01:53:58.880012 [debug] [Thread-1 (]: Finished running node test.ecommerce_analytics.not_null_stg_orders_total_amount.f31d98d41b
[0m01:53:58.880479 [debug] [Thread-1 (]: Began running node test.ecommerce_analytics.not_null_stg_products_price.2d147627d4
[0m01:53:58.880479 [info ] [Thread-1 (]: 8 of 14 START test not_null_stg_products_price ................................. [RUN]
[0m01:53:58.880479 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.ecommerce_analytics.not_null_stg_orders_total_amount.f31d98d41b, now test.ecommerce_analytics.not_null_stg_products_price.2d147627d4)
[0m01:53:58.884685 [debug] [Thread-1 (]: Began compiling node test.ecommerce_analytics.not_null_stg_products_price.2d147627d4
[0m01:53:58.887632 [debug] [Thread-1 (]: Writing injected SQL for node "test.ecommerce_analytics.not_null_stg_products_price.2d147627d4"
[0m01:53:58.887632 [debug] [Thread-1 (]: Began executing node test.ecommerce_analytics.not_null_stg_products_price.2d147627d4
[0m01:53:58.895361 [debug] [Thread-1 (]: Writing runtime sql for node "test.ecommerce_analytics.not_null_stg_products_price.2d147627d4"
[0m01:53:58.897105 [debug] [Thread-1 (]: Using duckdb connection "test.ecommerce_analytics.not_null_stg_products_price.2d147627d4"
[0m01:53:58.898504 [debug] [Thread-1 (]: On test.ecommerce_analytics.not_null_stg_products_price.2d147627d4: BEGIN
[0m01:53:58.898504 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:53:58.898504 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m01:53:58.898504 [debug] [Thread-1 (]: Using duckdb connection "test.ecommerce_analytics.not_null_stg_products_price.2d147627d4"
[0m01:53:58.898504 [debug] [Thread-1 (]: On test.ecommerce_analytics.not_null_stg_products_price.2d147627d4: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "ecommerce_analytics", "target_name": "dev", "node_id": "test.ecommerce_analytics.not_null_stg_products_price.2d147627d4"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select price
from "dev"."main"."stg_products"
where price is null



  
  
      
    ) dbt_internal_test
[0m01:53:58.901893 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m01:53:58.904976 [debug] [Thread-1 (]: On test.ecommerce_analytics.not_null_stg_products_price.2d147627d4: ROLLBACK
[0m01:53:58.905520 [debug] [Thread-1 (]: Failed to rollback 'test.ecommerce_analytics.not_null_stg_products_price.2d147627d4'
[0m01:53:58.905520 [debug] [Thread-1 (]: On test.ecommerce_analytics.not_null_stg_products_price.2d147627d4: Close
[0m01:53:58.905520 [info ] [Thread-1 (]: 8 of 14 PASS not_null_stg_products_price ....................................... [[32mPASS[0m in 0.03s]
[0m01:53:58.905520 [debug] [Thread-1 (]: Finished running node test.ecommerce_analytics.not_null_stg_products_price.2d147627d4
[0m01:53:58.905520 [debug] [Thread-1 (]: Began running node test.ecommerce_analytics.not_null_stg_products_product_id.6373b0acf3
[0m01:53:58.905520 [info ] [Thread-1 (]: 9 of 14 START test not_null_stg_products_product_id ............................ [RUN]
[0m01:53:58.905520 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.ecommerce_analytics.not_null_stg_products_price.2d147627d4, now test.ecommerce_analytics.not_null_stg_products_product_id.6373b0acf3)
[0m01:53:58.905520 [debug] [Thread-1 (]: Began compiling node test.ecommerce_analytics.not_null_stg_products_product_id.6373b0acf3
[0m01:53:58.917435 [debug] [Thread-1 (]: Writing injected SQL for node "test.ecommerce_analytics.not_null_stg_products_product_id.6373b0acf3"
[0m01:53:58.917435 [debug] [Thread-1 (]: Began executing node test.ecommerce_analytics.not_null_stg_products_product_id.6373b0acf3
[0m01:53:58.923579 [debug] [Thread-1 (]: Writing runtime sql for node "test.ecommerce_analytics.not_null_stg_products_product_id.6373b0acf3"
[0m01:53:58.923579 [debug] [Thread-1 (]: Using duckdb connection "test.ecommerce_analytics.not_null_stg_products_product_id.6373b0acf3"
[0m01:53:58.923579 [debug] [Thread-1 (]: On test.ecommerce_analytics.not_null_stg_products_product_id.6373b0acf3: BEGIN
[0m01:53:58.926619 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:53:58.926619 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m01:53:58.926619 [debug] [Thread-1 (]: Using duckdb connection "test.ecommerce_analytics.not_null_stg_products_product_id.6373b0acf3"
[0m01:53:58.926619 [debug] [Thread-1 (]: On test.ecommerce_analytics.not_null_stg_products_product_id.6373b0acf3: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "ecommerce_analytics", "target_name": "dev", "node_id": "test.ecommerce_analytics.not_null_stg_products_product_id.6373b0acf3"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select product_id
from "dev"."main"."stg_products"
where product_id is null



  
  
      
    ) dbt_internal_test
[0m01:53:58.930572 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m01:53:58.930572 [debug] [Thread-1 (]: On test.ecommerce_analytics.not_null_stg_products_product_id.6373b0acf3: ROLLBACK
[0m01:53:58.930572 [debug] [Thread-1 (]: Failed to rollback 'test.ecommerce_analytics.not_null_stg_products_product_id.6373b0acf3'
[0m01:53:58.930572 [debug] [Thread-1 (]: On test.ecommerce_analytics.not_null_stg_products_product_id.6373b0acf3: Close
[0m01:53:58.930572 [info ] [Thread-1 (]: 9 of 14 PASS not_null_stg_products_product_id .................................. [[32mPASS[0m in 0.03s]
[0m01:53:58.930572 [debug] [Thread-1 (]: Finished running node test.ecommerce_analytics.not_null_stg_products_product_id.6373b0acf3
[0m01:53:58.937233 [debug] [Thread-1 (]: Began running node test.ecommerce_analytics.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500
[0m01:53:58.937755 [info ] [Thread-1 (]: 10 of 14 START test relationships_stg_orders_customer_id__customer_id__ref_stg_customers_  [RUN]
[0m01:53:58.937755 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.ecommerce_analytics.not_null_stg_products_product_id.6373b0acf3, now test.ecommerce_analytics.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500)
[0m01:53:58.937755 [debug] [Thread-1 (]: Began compiling node test.ecommerce_analytics.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500
[0m01:53:58.948270 [debug] [Thread-1 (]: Writing injected SQL for node "test.ecommerce_analytics.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500"
[0m01:53:58.950220 [debug] [Thread-1 (]: Began executing node test.ecommerce_analytics.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500
[0m01:53:58.958037 [debug] [Thread-1 (]: Writing runtime sql for node "test.ecommerce_analytics.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500"
[0m01:53:58.958037 [debug] [Thread-1 (]: Using duckdb connection "test.ecommerce_analytics.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500"
[0m01:53:58.960132 [debug] [Thread-1 (]: On test.ecommerce_analytics.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500: BEGIN
[0m01:53:58.960132 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:53:58.960132 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m01:53:58.960132 [debug] [Thread-1 (]: Using duckdb connection "test.ecommerce_analytics.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500"
[0m01:53:58.962138 [debug] [Thread-1 (]: On test.ecommerce_analytics.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "ecommerce_analytics", "target_name": "dev", "node_id": "test.ecommerce_analytics.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with child as (
    select customer_id as from_field
    from "dev"."main"."stg_orders"
    where customer_id is not null
),

parent as (
    select customer_id as to_field
    from "dev"."main"."stg_customers"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



  
  
      
    ) dbt_internal_test
[0m01:53:58.966151 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m01:53:58.968682 [debug] [Thread-1 (]: On test.ecommerce_analytics.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500: ROLLBACK
[0m01:53:58.970426 [debug] [Thread-1 (]: Failed to rollback 'test.ecommerce_analytics.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500'
[0m01:53:58.970426 [debug] [Thread-1 (]: On test.ecommerce_analytics.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500: Close
[0m01:53:58.972432 [info ] [Thread-1 (]: 10 of 14 PASS relationships_stg_orders_customer_id__customer_id__ref_stg_customers_  [[32mPASS[0m in 0.03s]
[0m01:53:58.972432 [debug] [Thread-1 (]: Finished running node test.ecommerce_analytics.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500
[0m01:53:58.974441 [debug] [Thread-1 (]: Began running node test.ecommerce_analytics.unique_stg_customers_customer_email.1a5cbb3bc8
[0m01:53:58.974441 [info ] [Thread-1 (]: 11 of 14 START test unique_stg_customers_customer_email ........................ [RUN]
[0m01:53:58.976450 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.ecommerce_analytics.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500, now test.ecommerce_analytics.unique_stg_customers_customer_email.1a5cbb3bc8)
[0m01:53:58.976450 [debug] [Thread-1 (]: Began compiling node test.ecommerce_analytics.unique_stg_customers_customer_email.1a5cbb3bc8
[0m01:53:58.985063 [debug] [Thread-1 (]: Writing injected SQL for node "test.ecommerce_analytics.unique_stg_customers_customer_email.1a5cbb3bc8"
[0m01:53:58.986811 [debug] [Thread-1 (]: Began executing node test.ecommerce_analytics.unique_stg_customers_customer_email.1a5cbb3bc8
[0m01:53:58.991333 [debug] [Thread-1 (]: Writing runtime sql for node "test.ecommerce_analytics.unique_stg_customers_customer_email.1a5cbb3bc8"
[0m01:53:58.993337 [debug] [Thread-1 (]: Using duckdb connection "test.ecommerce_analytics.unique_stg_customers_customer_email.1a5cbb3bc8"
[0m01:53:58.993337 [debug] [Thread-1 (]: On test.ecommerce_analytics.unique_stg_customers_customer_email.1a5cbb3bc8: BEGIN
[0m01:53:58.994842 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:53:58.994842 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m01:53:58.994842 [debug] [Thread-1 (]: Using duckdb connection "test.ecommerce_analytics.unique_stg_customers_customer_email.1a5cbb3bc8"
[0m01:53:58.997361 [debug] [Thread-1 (]: On test.ecommerce_analytics.unique_stg_customers_customer_email.1a5cbb3bc8: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "ecommerce_analytics", "target_name": "dev", "node_id": "test.ecommerce_analytics.unique_stg_customers_customer_email.1a5cbb3bc8"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    customer_email as unique_field,
    count(*) as n_records

from "dev"."main"."stg_customers"
where customer_email is not null
group by customer_email
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m01:53:59.000197 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m01:53:59.003221 [debug] [Thread-1 (]: On test.ecommerce_analytics.unique_stg_customers_customer_email.1a5cbb3bc8: ROLLBACK
[0m01:53:59.003221 [debug] [Thread-1 (]: Failed to rollback 'test.ecommerce_analytics.unique_stg_customers_customer_email.1a5cbb3bc8'
[0m01:53:59.003221 [debug] [Thread-1 (]: On test.ecommerce_analytics.unique_stg_customers_customer_email.1a5cbb3bc8: Close
[0m01:53:59.005226 [info ] [Thread-1 (]: 11 of 14 PASS unique_stg_customers_customer_email .............................. [[32mPASS[0m in 0.03s]
[0m01:53:59.005226 [debug] [Thread-1 (]: Finished running node test.ecommerce_analytics.unique_stg_customers_customer_email.1a5cbb3bc8
[0m01:53:59.007230 [debug] [Thread-1 (]: Began running node test.ecommerce_analytics.unique_stg_customers_customer_id.c7614daada
[0m01:53:59.007230 [info ] [Thread-1 (]: 12 of 14 START test unique_stg_customers_customer_id ........................... [RUN]
[0m01:53:59.009237 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.ecommerce_analytics.unique_stg_customers_customer_email.1a5cbb3bc8, now test.ecommerce_analytics.unique_stg_customers_customer_id.c7614daada)
[0m01:53:59.009237 [debug] [Thread-1 (]: Began compiling node test.ecommerce_analytics.unique_stg_customers_customer_id.c7614daada
[0m01:53:59.014810 [debug] [Thread-1 (]: Writing injected SQL for node "test.ecommerce_analytics.unique_stg_customers_customer_id.c7614daada"
[0m01:53:59.016817 [debug] [Thread-1 (]: Began executing node test.ecommerce_analytics.unique_stg_customers_customer_id.c7614daada
[0m01:53:59.020827 [debug] [Thread-1 (]: Writing runtime sql for node "test.ecommerce_analytics.unique_stg_customers_customer_id.c7614daada"
[0m01:53:59.023059 [debug] [Thread-1 (]: Using duckdb connection "test.ecommerce_analytics.unique_stg_customers_customer_id.c7614daada"
[0m01:53:59.023059 [debug] [Thread-1 (]: On test.ecommerce_analytics.unique_stg_customers_customer_id.c7614daada: BEGIN
[0m01:53:59.023059 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:53:59.025065 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m01:53:59.025065 [debug] [Thread-1 (]: Using duckdb connection "test.ecommerce_analytics.unique_stg_customers_customer_id.c7614daada"
[0m01:53:59.025065 [debug] [Thread-1 (]: On test.ecommerce_analytics.unique_stg_customers_customer_id.c7614daada: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "ecommerce_analytics", "target_name": "dev", "node_id": "test.ecommerce_analytics.unique_stg_customers_customer_id.c7614daada"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    customer_id as unique_field,
    count(*) as n_records

from "dev"."main"."stg_customers"
where customer_id is not null
group by customer_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m01:53:59.030082 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m01:53:59.033185 [debug] [Thread-1 (]: On test.ecommerce_analytics.unique_stg_customers_customer_id.c7614daada: ROLLBACK
[0m01:53:59.033185 [debug] [Thread-1 (]: Failed to rollback 'test.ecommerce_analytics.unique_stg_customers_customer_id.c7614daada'
[0m01:53:59.033185 [debug] [Thread-1 (]: On test.ecommerce_analytics.unique_stg_customers_customer_id.c7614daada: Close
[0m01:53:59.035192 [info ] [Thread-1 (]: 12 of 14 PASS unique_stg_customers_customer_id ................................. [[32mPASS[0m in 0.03s]
[0m01:53:59.035192 [debug] [Thread-1 (]: Finished running node test.ecommerce_analytics.unique_stg_customers_customer_id.c7614daada
[0m01:53:59.035192 [debug] [Thread-1 (]: Began running node test.ecommerce_analytics.unique_stg_orders_order_id.e3b841c71a
[0m01:53:59.037700 [info ] [Thread-1 (]: 13 of 14 START test unique_stg_orders_order_id ................................. [RUN]
[0m01:53:59.037700 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.ecommerce_analytics.unique_stg_customers_customer_id.c7614daada, now test.ecommerce_analytics.unique_stg_orders_order_id.e3b841c71a)
[0m01:53:59.039763 [debug] [Thread-1 (]: Began compiling node test.ecommerce_analytics.unique_stg_orders_order_id.e3b841c71a
[0m01:53:59.045451 [debug] [Thread-1 (]: Writing injected SQL for node "test.ecommerce_analytics.unique_stg_orders_order_id.e3b841c71a"
[0m01:53:59.047457 [debug] [Thread-1 (]: Began executing node test.ecommerce_analytics.unique_stg_orders_order_id.e3b841c71a
[0m01:53:59.051479 [debug] [Thread-1 (]: Writing runtime sql for node "test.ecommerce_analytics.unique_stg_orders_order_id.e3b841c71a"
[0m01:53:59.053502 [debug] [Thread-1 (]: Using duckdb connection "test.ecommerce_analytics.unique_stg_orders_order_id.e3b841c71a"
[0m01:53:59.053502 [debug] [Thread-1 (]: On test.ecommerce_analytics.unique_stg_orders_order_id.e3b841c71a: BEGIN
[0m01:53:59.053502 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:53:59.055508 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m01:53:59.055508 [debug] [Thread-1 (]: Using duckdb connection "test.ecommerce_analytics.unique_stg_orders_order_id.e3b841c71a"
[0m01:53:59.057513 [debug] [Thread-1 (]: On test.ecommerce_analytics.unique_stg_orders_order_id.e3b841c71a: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "ecommerce_analytics", "target_name": "dev", "node_id": "test.ecommerce_analytics.unique_stg_orders_order_id.e3b841c71a"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    order_id as unique_field,
    count(*) as n_records

from "dev"."main"."stg_orders"
where order_id is not null
group by order_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m01:53:59.060017 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m01:53:59.062052 [debug] [Thread-1 (]: On test.ecommerce_analytics.unique_stg_orders_order_id.e3b841c71a: ROLLBACK
[0m01:53:59.062052 [debug] [Thread-1 (]: Failed to rollback 'test.ecommerce_analytics.unique_stg_orders_order_id.e3b841c71a'
[0m01:53:59.062052 [debug] [Thread-1 (]: On test.ecommerce_analytics.unique_stg_orders_order_id.e3b841c71a: Close
[0m01:53:59.064227 [info ] [Thread-1 (]: 13 of 14 PASS unique_stg_orders_order_id ....................................... [[32mPASS[0m in 0.03s]
[0m01:53:59.064227 [debug] [Thread-1 (]: Finished running node test.ecommerce_analytics.unique_stg_orders_order_id.e3b841c71a
[0m01:53:59.066232 [debug] [Thread-1 (]: Began running node test.ecommerce_analytics.unique_stg_products_product_id.7d950a1467
[0m01:53:59.066232 [info ] [Thread-1 (]: 14 of 14 START test unique_stg_products_product_id ............................. [RUN]
[0m01:53:59.068243 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.ecommerce_analytics.unique_stg_orders_order_id.e3b841c71a, now test.ecommerce_analytics.unique_stg_products_product_id.7d950a1467)
[0m01:53:59.068243 [debug] [Thread-1 (]: Began compiling node test.ecommerce_analytics.unique_stg_products_product_id.7d950a1467
[0m01:53:59.074277 [debug] [Thread-1 (]: Writing injected SQL for node "test.ecommerce_analytics.unique_stg_products_product_id.7d950a1467"
[0m01:53:59.076282 [debug] [Thread-1 (]: Began executing node test.ecommerce_analytics.unique_stg_products_product_id.7d950a1467
[0m01:53:59.078288 [debug] [Thread-1 (]: Writing runtime sql for node "test.ecommerce_analytics.unique_stg_products_product_id.7d950a1467"
[0m01:53:59.080793 [debug] [Thread-1 (]: Using duckdb connection "test.ecommerce_analytics.unique_stg_products_product_id.7d950a1467"
[0m01:53:59.080793 [debug] [Thread-1 (]: On test.ecommerce_analytics.unique_stg_products_product_id.7d950a1467: BEGIN
[0m01:53:59.082825 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:53:59.082825 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m01:53:59.084574 [debug] [Thread-1 (]: Using duckdb connection "test.ecommerce_analytics.unique_stg_products_product_id.7d950a1467"
[0m01:53:59.084574 [debug] [Thread-1 (]: On test.ecommerce_analytics.unique_stg_products_product_id.7d950a1467: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "ecommerce_analytics", "target_name": "dev", "node_id": "test.ecommerce_analytics.unique_stg_products_product_id.7d950a1467"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    product_id as unique_field,
    count(*) as n_records

from "dev"."main"."stg_products"
where product_id is not null
group by product_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m01:53:59.086579 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m01:53:59.088585 [debug] [Thread-1 (]: On test.ecommerce_analytics.unique_stg_products_product_id.7d950a1467: ROLLBACK
[0m01:53:59.090590 [debug] [Thread-1 (]: Failed to rollback 'test.ecommerce_analytics.unique_stg_products_product_id.7d950a1467'
[0m01:53:59.090590 [debug] [Thread-1 (]: On test.ecommerce_analytics.unique_stg_products_product_id.7d950a1467: Close
[0m01:53:59.090590 [info ] [Thread-1 (]: 14 of 14 PASS unique_stg_products_product_id ................................... [[32mPASS[0m in 0.02s]
[0m01:53:59.093109 [debug] [Thread-1 (]: Finished running node test.ecommerce_analytics.unique_stg_products_product_id.7d950a1467
[0m01:53:59.095140 [debug] [MainThread]: Using duckdb connection "master"
[0m01:53:59.095140 [debug] [MainThread]: On master: BEGIN
[0m01:53:59.095140 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m01:53:59.097155 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m01:53:59.097155 [debug] [MainThread]: On master: COMMIT
[0m01:53:59.099160 [debug] [MainThread]: Using duckdb connection "master"
[0m01:53:59.099160 [debug] [MainThread]: On master: COMMIT
[0m01:53:59.099160 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m01:53:59.100664 [debug] [MainThread]: On master: Close
[0m01:53:59.100664 [debug] [MainThread]: Connection 'master' was properly closed.
[0m01:53:59.100664 [debug] [MainThread]: Connection 'list_dev_main' was properly closed.
[0m01:53:59.100664 [debug] [MainThread]: Connection 'test.ecommerce_analytics.unique_stg_products_product_id.7d950a1467' was properly closed.
[0m01:53:59.102692 [info ] [MainThread]: 
[0m01:53:59.103232 [info ] [MainThread]: Finished running 14 data tests in 0 hours 0 minutes and 0.63 seconds (0.63s).
[0m01:53:59.107437 [debug] [MainThread]: Command end result
[0m01:53:59.145137 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\Lenovo\Desktop\Proyectos\dbt-proyect\ecommerce_analytics\target\manifest.json
[0m01:53:59.148801 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\Lenovo\Desktop\Proyectos\dbt-proyect\ecommerce_analytics\target\semantic_manifest.json
[0m01:53:59.155507 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\Lenovo\Desktop\Proyectos\dbt-proyect\ecommerce_analytics\target\run_results.json
[0m01:53:59.157535 [info ] [MainThread]: 
[0m01:53:59.159042 [info ] [MainThread]: [32mCompleted successfully[0m
[0m01:53:59.159042 [info ] [MainThread]: 
[0m01:53:59.159042 [info ] [MainThread]: Done. PASS=14 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=14
[0m01:53:59.161063 [debug] [MainThread]: Command `dbt test` succeeded at 01:53:59.161063 after 1.87 seconds
[0m01:53:59.161063 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F22C4933D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F22C6F79D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F22C6F7B50>]}
[0m01:53:59.161063 [debug] [MainThread]: Flushing usage events
[0m01:54:00.234530 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m01:56:15.200987 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E18F6BC4D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E18F71FF50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E18F721C50>]}


============================== 01:56:15.210075 | cae51a66-a492-4c2b-9b28-df9a888d3e8a ==============================
[0m01:56:15.210075 [info ] [MainThread]: Running with dbt=1.11.2
[0m01:56:15.210075 [debug] [MainThread]: running dbt with arguments {'version_check': 'True', 'no_print': 'None', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'target_path': 'None', 'printer_width': '80', 'write_json': 'True', 'introspect': 'True', 'log_cache_events': 'False', 'empty': 'False', 'cache_selected_only': 'False', 'log_format': 'default', 'debug': 'False', 'fail_fast': 'False', 'partial_parse': 'True', 'send_anonymous_usage_stats': 'True', 'quiet': 'False', 'warn_error': 'None', 'profiles_dir': 'C:\\Users\\Lenovo\\.dbt', 'use_colors': 'True', 'invocation_command': 'dbt run', 'indirect_selection': 'eager', 'use_experimental_parser': 'False', 'log_path': 'C:\\Users\\Lenovo\\Desktop\\Proyectos\\dbt-proyect\\ecommerce_analytics\\logs'}
[0m01:56:15.664477 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'cae51a66-a492-4c2b-9b28-df9a888d3e8a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E18F797690>]}
[0m01:56:15.725795 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'cae51a66-a492-4c2b-9b28-df9a888d3e8a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E18C0480D0>]}
[0m01:56:15.730710 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m01:56:16.076372 [debug] [MainThread]: checksum: 3d40d8bbe1bef07db1c24822f2dbfff8bc07f2a48ed4fe2658a40653aec0b54b, vars: {}, profile: , target: , version: 1.11.2
[0m01:56:16.313374 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m01:56:16.317276 [debug] [MainThread]: Partial parsing: added file: ecommerce_analytics://models\example\marts\schema.yml
[0m01:56:16.476050 [warn ] [MainThread]: [[33mWARNING[0m][MissingArgumentsPropertyInGenericTestDeprecation]: Deprecated
functionality
Found top-level arguments to test `relationships` defined on 'fct_orders' in
package 'ecommerce_analytics' (models\example\marts\schema.yml). Arguments to
generic tests should be nested under the `arguments` property.
[0m01:56:16.477114 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'cae51a66-a492-4c2b-9b28-df9a888d3e8a', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E18F79EE50>]}
[0m01:56:16.676426 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'cae51a66-a492-4c2b-9b28-df9a888d3e8a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E1907B2B50>]}
[0m01:56:16.771090 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\Lenovo\Desktop\Proyectos\dbt-proyect\ecommerce_analytics\target\manifest.json
[0m01:56:16.779544 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\Lenovo\Desktop\Proyectos\dbt-proyect\ecommerce_analytics\target\semantic_manifest.json
[0m01:56:16.825026 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'cae51a66-a492-4c2b-9b28-df9a888d3e8a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E190957150>]}
[0m01:56:16.825026 [info ] [MainThread]: Found 3 seeds, 7 models, 28 data tests, 587 macros
[0m01:56:16.825026 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'cae51a66-a492-4c2b-9b28-df9a888d3e8a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E19093D710>]}
[0m01:56:16.831360 [info ] [MainThread]: 
[0m01:56:16.831360 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m01:56:16.831360 [info ] [MainThread]: 
[0m01:56:16.831360 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m01:56:16.841744 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_dev'
[0m01:56:16.917170 [debug] [ThreadPool]: Using duckdb connection "list_dev"
[0m01:56:16.917170 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "ecommerce_analytics", "target_name": "dev", "connection_name": "list_dev"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"dev"'
    
  
  
[0m01:56:16.924434 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:56:16.966600 [debug] [ThreadPool]: SQL status: OK in 0.045 seconds
[0m01:56:16.966600 [debug] [ThreadPool]: On list_dev: Close
[0m01:56:16.972256 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev, now create_dev_main)
[0m01:56:16.972827 [debug] [ThreadPool]: Creating schema "database: "dev"
schema: "main"
"
[0m01:56:16.977222 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m01:56:16.977222 [debug] [ThreadPool]: On create_dev_main: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "ecommerce_analytics", "target_name": "dev", "connection_name": "create_dev_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='dev'
        and type='sqlite'
    
  
[0m01:56:16.977222 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m01:56:16.977222 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m01:56:16.977222 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m01:56:16.977222 [debug] [ThreadPool]: On create_dev_main: BEGIN
[0m01:56:16.977222 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m01:56:16.977222 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m01:56:16.987547 [debug] [ThreadPool]: On create_dev_main: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "ecommerce_analytics", "target_name": "dev", "connection_name": "create_dev_main"} */

    
    
        create schema if not exists "dev"."main"
    
[0m01:56:16.987547 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m01:56:16.987547 [debug] [ThreadPool]: On create_dev_main: COMMIT
[0m01:56:16.987547 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m01:56:16.987547 [debug] [ThreadPool]: On create_dev_main: COMMIT
[0m01:56:16.987547 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m01:56:16.987547 [debug] [ThreadPool]: On create_dev_main: Close
[0m01:56:16.987547 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_dev_main'
[0m01:56:16.998574 [debug] [ThreadPool]: Using duckdb connection "list_dev_main"
[0m01:56:16.998574 [debug] [ThreadPool]: On list_dev_main: BEGIN
[0m01:56:16.998574 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:56:16.998574 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m01:56:16.998574 [debug] [ThreadPool]: Using duckdb connection "list_dev_main"
[0m01:56:17.003643 [debug] [ThreadPool]: On list_dev_main: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "ecommerce_analytics", "target_name": "dev", "connection_name": "list_dev_main"} */
select
      'dev' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'dev'
  
[0m01:56:17.024029 [debug] [ThreadPool]: SQL status: OK in 0.021 seconds
[0m01:56:17.024029 [debug] [ThreadPool]: On list_dev_main: ROLLBACK
[0m01:56:17.024029 [debug] [ThreadPool]: Failed to rollback 'list_dev_main'
[0m01:56:17.029398 [debug] [ThreadPool]: On list_dev_main: Close
[0m01:56:17.029398 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'cae51a66-a492-4c2b-9b28-df9a888d3e8a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E18F70E310>]}
[0m01:56:17.029398 [debug] [MainThread]: Using duckdb connection "master"
[0m01:56:17.033396 [debug] [MainThread]: On master: BEGIN
[0m01:56:17.033396 [debug] [MainThread]: Opening a new connection, currently in state init
[0m01:56:17.033396 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m01:56:17.033396 [debug] [MainThread]: On master: COMMIT
[0m01:56:17.033396 [debug] [MainThread]: Using duckdb connection "master"
[0m01:56:17.035402 [debug] [MainThread]: On master: COMMIT
[0m01:56:17.035402 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m01:56:17.035402 [debug] [MainThread]: On master: Close
[0m01:56:17.040894 [debug] [Thread-1 (]: Began running node model.ecommerce_analytics.dim_customers
[0m01:56:17.040894 [info ] [Thread-1 (]: 1 of 7 START sql view model main.dim_customers ................................. [RUN]
[0m01:56:17.040894 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.ecommerce_analytics.dim_customers'
[0m01:56:17.040894 [debug] [Thread-1 (]: Began compiling node model.ecommerce_analytics.dim_customers
[0m01:56:17.053943 [debug] [Thread-1 (]: Writing injected SQL for node "model.ecommerce_analytics.dim_customers"
[0m01:56:17.056422 [debug] [Thread-1 (]: Began executing node model.ecommerce_analytics.dim_customers
[0m01:56:17.085254 [debug] [Thread-1 (]: Writing runtime sql for node "model.ecommerce_analytics.dim_customers"
[0m01:56:17.092023 [debug] [Thread-1 (]: Using duckdb connection "model.ecommerce_analytics.dim_customers"
[0m01:56:17.093540 [debug] [Thread-1 (]: On model.ecommerce_analytics.dim_customers: BEGIN
[0m01:56:17.093540 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m01:56:17.093540 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m01:56:17.095556 [debug] [Thread-1 (]: Using duckdb connection "model.ecommerce_analytics.dim_customers"
[0m01:56:17.095556 [debug] [Thread-1 (]: On model.ecommerce_analytics.dim_customers: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "ecommerce_analytics", "target_name": "dev", "node_id": "model.ecommerce_analytics.dim_customers"} */

  
  create view "dev"."main"."dim_customers__dbt_tmp" as (
    WITH source AS (
    SELECT * FROM "dev"."main"."raw_customers"
),

renamed AS (
    SELECT
        customer_id,
        first_name || ' ' || last_name AS customer_name,
        email AS customer_email,
        phone,
        CAST(birth_date AS DATE) AS birth_date,
        city AS customer_city,
        country,
        postal_code,
        segment,
        CAST(registration_date AS DATE) AS registration_date,
        CAST(last_login AS DATE) AS last_login,
        is_verified,
        accepts_marketing
    FROM source
)

SELECT * FROM renamed
  );

[0m01:56:17.095556 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m01:56:17.102831 [debug] [Thread-1 (]: Using duckdb connection "model.ecommerce_analytics.dim_customers"
[0m01:56:17.102831 [debug] [Thread-1 (]: On model.ecommerce_analytics.dim_customers: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "ecommerce_analytics", "target_name": "dev", "node_id": "model.ecommerce_analytics.dim_customers"} */
alter view "dev"."main"."dim_customers" rename to "dim_customers__dbt_backup"
[0m01:56:17.102831 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m01:56:17.107680 [debug] [Thread-1 (]: Using duckdb connection "model.ecommerce_analytics.dim_customers"
[0m01:56:17.107680 [debug] [Thread-1 (]: On model.ecommerce_analytics.dim_customers: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "ecommerce_analytics", "target_name": "dev", "node_id": "model.ecommerce_analytics.dim_customers"} */
alter view "dev"."main"."dim_customers__dbt_tmp" rename to "dim_customers"
[0m01:56:17.107680 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m01:56:17.115929 [debug] [Thread-1 (]: On model.ecommerce_analytics.dim_customers: COMMIT
[0m01:56:17.115929 [debug] [Thread-1 (]: Using duckdb connection "model.ecommerce_analytics.dim_customers"
[0m01:56:17.115929 [debug] [Thread-1 (]: On model.ecommerce_analytics.dim_customers: COMMIT
[0m01:56:17.123441 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m01:56:17.133913 [debug] [Thread-1 (]: Using duckdb connection "model.ecommerce_analytics.dim_customers"
[0m01:56:17.133913 [debug] [Thread-1 (]: On model.ecommerce_analytics.dim_customers: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "ecommerce_analytics", "target_name": "dev", "node_id": "model.ecommerce_analytics.dim_customers"} */

      drop view if exists "dev"."main"."dim_customers__dbt_backup" cascade
    
[0m01:56:17.137093 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m01:56:17.140320 [debug] [Thread-1 (]: On model.ecommerce_analytics.dim_customers: Close
[0m01:56:17.140906 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cae51a66-a492-4c2b-9b28-df9a888d3e8a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E1912ED7D0>]}
[0m01:56:17.140906 [info ] [Thread-1 (]: 1 of 7 OK created sql view model main.dim_customers ............................ [[32mOK[0m in 0.10s]
[0m01:56:17.144449 [debug] [Thread-1 (]: Finished running node model.ecommerce_analytics.dim_customers
[0m01:56:17.144449 [debug] [Thread-1 (]: Began running node model.ecommerce_analytics.stg_customers
[0m01:56:17.146540 [info ] [Thread-1 (]: 2 of 7 START sql view model main.stg_customers ................................. [RUN]
[0m01:56:17.146540 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ecommerce_analytics.dim_customers, now model.ecommerce_analytics.stg_customers)
[0m01:56:17.148692 [debug] [Thread-1 (]: Began compiling node model.ecommerce_analytics.stg_customers
[0m01:56:17.151172 [debug] [Thread-1 (]: Writing injected SQL for node "model.ecommerce_analytics.stg_customers"
[0m01:56:17.154691 [debug] [Thread-1 (]: Began executing node model.ecommerce_analytics.stg_customers
[0m01:56:17.156921 [debug] [Thread-1 (]: Writing runtime sql for node "model.ecommerce_analytics.stg_customers"
[0m01:56:17.156921 [debug] [Thread-1 (]: Using duckdb connection "model.ecommerce_analytics.stg_customers"
[0m01:56:17.156921 [debug] [Thread-1 (]: On model.ecommerce_analytics.stg_customers: BEGIN
[0m01:56:17.156921 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:56:17.156921 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m01:56:17.156921 [debug] [Thread-1 (]: Using duckdb connection "model.ecommerce_analytics.stg_customers"
[0m01:56:17.156921 [debug] [Thread-1 (]: On model.ecommerce_analytics.stg_customers: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "ecommerce_analytics", "target_name": "dev", "node_id": "model.ecommerce_analytics.stg_customers"} */

  
  create view "dev"."main"."stg_customers__dbt_tmp" as (
    WITH source AS (
    SELECT * FROM "dev"."main"."raw_customers"
),

renamed AS (
    SELECT
        customer_id,
        first_name || ' ' || last_name AS customer_name,
        email AS customer_email,
        phone,
        CAST(birth_date AS DATE) AS birth_date,
        city AS customer_city,
        country,
        postal_code,
        segment,
        CAST(registration_date AS DATE) AS registration_date,
        CAST(last_login AS DATE) AS last_login,
        is_verified,
        accepts_marketing
    FROM source
)

SELECT * FROM renamed
  );

[0m01:56:17.156921 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m01:56:17.167576 [debug] [Thread-1 (]: Using duckdb connection "model.ecommerce_analytics.stg_customers"
[0m01:56:17.167576 [debug] [Thread-1 (]: On model.ecommerce_analytics.stg_customers: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "ecommerce_analytics", "target_name": "dev", "node_id": "model.ecommerce_analytics.stg_customers"} */
alter view "dev"."main"."stg_customers" rename to "stg_customers__dbt_backup"
[0m01:56:17.167576 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m01:56:17.167576 [debug] [Thread-1 (]: Using duckdb connection "model.ecommerce_analytics.stg_customers"
[0m01:56:17.167576 [debug] [Thread-1 (]: On model.ecommerce_analytics.stg_customers: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "ecommerce_analytics", "target_name": "dev", "node_id": "model.ecommerce_analytics.stg_customers"} */
alter view "dev"."main"."stg_customers__dbt_tmp" rename to "stg_customers"
[0m01:56:17.175411 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m01:56:17.175411 [debug] [Thread-1 (]: On model.ecommerce_analytics.stg_customers: COMMIT
[0m01:56:17.175411 [debug] [Thread-1 (]: Using duckdb connection "model.ecommerce_analytics.stg_customers"
[0m01:56:17.175411 [debug] [Thread-1 (]: On model.ecommerce_analytics.stg_customers: COMMIT
[0m01:56:17.175411 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m01:56:17.184756 [debug] [Thread-1 (]: Using duckdb connection "model.ecommerce_analytics.stg_customers"
[0m01:56:17.185902 [debug] [Thread-1 (]: On model.ecommerce_analytics.stg_customers: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "ecommerce_analytics", "target_name": "dev", "node_id": "model.ecommerce_analytics.stg_customers"} */

      drop view if exists "dev"."main"."stg_customers__dbt_backup" cascade
    
[0m01:56:17.185902 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m01:56:17.189535 [debug] [Thread-1 (]: On model.ecommerce_analytics.stg_customers: Close
[0m01:56:17.189535 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cae51a66-a492-4c2b-9b28-df9a888d3e8a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E191337710>]}
[0m01:56:17.189535 [info ] [Thread-1 (]: 2 of 7 OK created sql view model main.stg_customers ............................ [[32mOK[0m in 0.04s]
[0m01:56:17.189535 [debug] [Thread-1 (]: Finished running node model.ecommerce_analytics.stg_customers
[0m01:56:17.189535 [debug] [Thread-1 (]: Began running node model.ecommerce_analytics.stg_orders
[0m01:56:17.189535 [info ] [Thread-1 (]: 3 of 7 START sql view model main.stg_orders .................................... [RUN]
[0m01:56:17.189535 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ecommerce_analytics.stg_customers, now model.ecommerce_analytics.stg_orders)
[0m01:56:17.189535 [debug] [Thread-1 (]: Began compiling node model.ecommerce_analytics.stg_orders
[0m01:56:17.196241 [debug] [Thread-1 (]: Writing injected SQL for node "model.ecommerce_analytics.stg_orders"
[0m01:56:17.198466 [debug] [Thread-1 (]: Began executing node model.ecommerce_analytics.stg_orders
[0m01:56:17.201822 [debug] [Thread-1 (]: Writing runtime sql for node "model.ecommerce_analytics.stg_orders"
[0m01:56:17.201822 [debug] [Thread-1 (]: Using duckdb connection "model.ecommerce_analytics.stg_orders"
[0m01:56:17.207158 [debug] [Thread-1 (]: On model.ecommerce_analytics.stg_orders: BEGIN
[0m01:56:17.207158 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:56:17.207158 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m01:56:17.207158 [debug] [Thread-1 (]: Using duckdb connection "model.ecommerce_analytics.stg_orders"
[0m01:56:17.207158 [debug] [Thread-1 (]: On model.ecommerce_analytics.stg_orders: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "ecommerce_analytics", "target_name": "dev", "node_id": "model.ecommerce_analytics.stg_orders"} */

  
  create view "dev"."main"."stg_orders__dbt_tmp" as (
    WITH source AS (
    SELECT * FROM "dev"."main"."raw_orders"
),

renamed AS (
    SELECT
        order_id,
        order_number,
        customer_id,
        CAST(order_date AS DATE) AS order_date,
        status,
        CAST(subtotal AS DECIMAL(10,2)) AS subtotal,
        CAST(discount_percent AS DECIMAL(10,2)) AS discount_percent,
        CAST(shipping_cost AS DECIMAL(10,2)) AS shipping_cost,
        CAST(tax_amount AS DECIMAL(10,2)) AS tax_amount,
        CAST(total_amount AS DECIMAL(10,2)) AS total_amount,
        payment_method,
        shipping_method,
        promotion_id,
        notes
    FROM source
)

SELECT * FROM renamed
  );

[0m01:56:17.207158 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m01:56:17.207158 [debug] [Thread-1 (]: Using duckdb connection "model.ecommerce_analytics.stg_orders"
[0m01:56:17.207158 [debug] [Thread-1 (]: On model.ecommerce_analytics.stg_orders: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "ecommerce_analytics", "target_name": "dev", "node_id": "model.ecommerce_analytics.stg_orders"} */
alter view "dev"."main"."stg_orders" rename to "stg_orders__dbt_backup"
[0m01:56:17.217570 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m01:56:17.221830 [debug] [Thread-1 (]: Using duckdb connection "model.ecommerce_analytics.stg_orders"
[0m01:56:17.221830 [debug] [Thread-1 (]: On model.ecommerce_analytics.stg_orders: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "ecommerce_analytics", "target_name": "dev", "node_id": "model.ecommerce_analytics.stg_orders"} */
alter view "dev"."main"."stg_orders__dbt_tmp" rename to "stg_orders"
[0m01:56:17.221830 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m01:56:17.224714 [debug] [Thread-1 (]: On model.ecommerce_analytics.stg_orders: COMMIT
[0m01:56:17.224714 [debug] [Thread-1 (]: Using duckdb connection "model.ecommerce_analytics.stg_orders"
[0m01:56:17.227181 [debug] [Thread-1 (]: On model.ecommerce_analytics.stg_orders: COMMIT
[0m01:56:17.227685 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m01:56:17.227685 [debug] [Thread-1 (]: Using duckdb connection "model.ecommerce_analytics.stg_orders"
[0m01:56:17.227685 [debug] [Thread-1 (]: On model.ecommerce_analytics.stg_orders: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "ecommerce_analytics", "target_name": "dev", "node_id": "model.ecommerce_analytics.stg_orders"} */

      drop view if exists "dev"."main"."stg_orders__dbt_backup" cascade
    
[0m01:56:17.233182 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m01:56:17.234955 [debug] [Thread-1 (]: On model.ecommerce_analytics.stg_orders: Close
[0m01:56:17.237819 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cae51a66-a492-4c2b-9b28-df9a888d3e8a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E19249C750>]}
[0m01:56:17.237819 [info ] [Thread-1 (]: 3 of 7 OK created sql view model main.stg_orders ............................... [[32mOK[0m in 0.05s]
[0m01:56:17.237819 [debug] [Thread-1 (]: Finished running node model.ecommerce_analytics.stg_orders
[0m01:56:17.240891 [debug] [Thread-1 (]: Began running node model.ecommerce_analytics.stg_products
[0m01:56:17.240891 [info ] [Thread-1 (]: 4 of 7 START sql view model main.stg_products .................................. [RUN]
[0m01:56:17.240891 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ecommerce_analytics.stg_orders, now model.ecommerce_analytics.stg_products)
[0m01:56:17.240891 [debug] [Thread-1 (]: Began compiling node model.ecommerce_analytics.stg_products
[0m01:56:17.243786 [debug] [Thread-1 (]: Writing injected SQL for node "model.ecommerce_analytics.stg_products"
[0m01:56:17.243786 [debug] [Thread-1 (]: Began executing node model.ecommerce_analytics.stg_products
[0m01:56:17.253309 [debug] [Thread-1 (]: Writing runtime sql for node "model.ecommerce_analytics.stg_products"
[0m01:56:17.253309 [debug] [Thread-1 (]: Using duckdb connection "model.ecommerce_analytics.stg_products"
[0m01:56:17.256385 [debug] [Thread-1 (]: On model.ecommerce_analytics.stg_products: BEGIN
[0m01:56:17.256385 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:56:17.258943 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m01:56:17.258943 [debug] [Thread-1 (]: Using duckdb connection "model.ecommerce_analytics.stg_products"
[0m01:56:17.258943 [debug] [Thread-1 (]: On model.ecommerce_analytics.stg_products: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "ecommerce_analytics", "target_name": "dev", "node_id": "model.ecommerce_analytics.stg_products"} */

  
  create view "dev"."main"."stg_products__dbt_tmp" as (
    WITH source AS (
    SELECT * FROM "dev"."main"."raw_products"
),

renamed AS (
    SELECT
        product_id,
        sku,
        product_name,
        description,
        category_id,
        brand_id,
        supplier_id,
        CAST(price AS DECIMAL(10,2)) AS price,
        CAST(cost AS DECIMAL(10,2)) AS cost,
        CAST(weight_kg AS DECIMAL(10,2)) AS weight_kg,
        is_active,
        CAST(created_at AS DATE) AS created_at,
        CAST(updated_at AS DATE) AS updated_at
    FROM source
)

SELECT * FROM renamed
  );

[0m01:56:17.258943 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m01:56:17.258943 [debug] [Thread-1 (]: Using duckdb connection "model.ecommerce_analytics.stg_products"
[0m01:56:17.258943 [debug] [Thread-1 (]: On model.ecommerce_analytics.stg_products: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "ecommerce_analytics", "target_name": "dev", "node_id": "model.ecommerce_analytics.stg_products"} */
alter view "dev"."main"."stg_products" rename to "stg_products__dbt_backup"
[0m01:56:17.258943 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m01:56:17.269441 [debug] [Thread-1 (]: Using duckdb connection "model.ecommerce_analytics.stg_products"
[0m01:56:17.269441 [debug] [Thread-1 (]: On model.ecommerce_analytics.stg_products: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "ecommerce_analytics", "target_name": "dev", "node_id": "model.ecommerce_analytics.stg_products"} */
alter view "dev"."main"."stg_products__dbt_tmp" rename to "stg_products"
[0m01:56:17.269441 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m01:56:17.275326 [debug] [Thread-1 (]: On model.ecommerce_analytics.stg_products: COMMIT
[0m01:56:17.275326 [debug] [Thread-1 (]: Using duckdb connection "model.ecommerce_analytics.stg_products"
[0m01:56:17.275326 [debug] [Thread-1 (]: On model.ecommerce_analytics.stg_products: COMMIT
[0m01:56:17.275326 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m01:56:17.279915 [debug] [Thread-1 (]: Using duckdb connection "model.ecommerce_analytics.stg_products"
[0m01:56:17.279915 [debug] [Thread-1 (]: On model.ecommerce_analytics.stg_products: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "ecommerce_analytics", "target_name": "dev", "node_id": "model.ecommerce_analytics.stg_products"} */

      drop view if exists "dev"."main"."stg_products__dbt_backup" cascade
    
[0m01:56:17.283838 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m01:56:17.285141 [debug] [Thread-1 (]: On model.ecommerce_analytics.stg_products: Close
[0m01:56:17.285141 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cae51a66-a492-4c2b-9b28-df9a888d3e8a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E1924C0810>]}
[0m01:56:17.285141 [info ] [Thread-1 (]: 4 of 7 OK created sql view model main.stg_products ............................. [[32mOK[0m in 0.04s]
[0m01:56:17.290312 [debug] [Thread-1 (]: Finished running node model.ecommerce_analytics.stg_products
[0m01:56:17.290312 [debug] [Thread-1 (]: Began running node model.ecommerce_analytics.int_orders_enriched
[0m01:56:17.290312 [info ] [Thread-1 (]: 5 of 7 START sql view model main.int_orders_enriched ........................... [RUN]
[0m01:56:17.293428 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ecommerce_analytics.stg_products, now model.ecommerce_analytics.int_orders_enriched)
[0m01:56:17.293428 [debug] [Thread-1 (]: Began compiling node model.ecommerce_analytics.int_orders_enriched
[0m01:56:17.293428 [debug] [Thread-1 (]: Writing injected SQL for node "model.ecommerce_analytics.int_orders_enriched"
[0m01:56:17.300415 [debug] [Thread-1 (]: Began executing node model.ecommerce_analytics.int_orders_enriched
[0m01:56:17.307345 [debug] [Thread-1 (]: Writing runtime sql for node "model.ecommerce_analytics.int_orders_enriched"
[0m01:56:17.309163 [debug] [Thread-1 (]: Using duckdb connection "model.ecommerce_analytics.int_orders_enriched"
[0m01:56:17.310670 [debug] [Thread-1 (]: On model.ecommerce_analytics.int_orders_enriched: BEGIN
[0m01:56:17.310670 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:56:17.310670 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m01:56:17.310670 [debug] [Thread-1 (]: Using duckdb connection "model.ecommerce_analytics.int_orders_enriched"
[0m01:56:17.310670 [debug] [Thread-1 (]: On model.ecommerce_analytics.int_orders_enriched: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "ecommerce_analytics", "target_name": "dev", "node_id": "model.ecommerce_analytics.int_orders_enriched"} */

  
  create view "dev"."main"."int_orders_enriched__dbt_tmp" as (
    WITH orders AS (
    SELECT * FROM "dev"."main"."stg_orders"
),

customers AS (
    SELECT * FROM "dev"."main"."stg_customers"
),

enriched AS (
    SELECT
        o.order_id,
        o.order_number,
        o.order_date,
        o.status,
        o.subtotal,
        o.discount_percent,
        o.shipping_cost,
        o.tax_amount,
        o.total_amount,
        o.payment_method,
        o.shipping_method,
        o.promotion_id,
        o.notes,
        
        -- Customer info
        c.customer_id,
        c.customer_name,
        c.customer_email,
        c.customer_city,
        
        -- Calculated fields
        DATE_TRUNC('month', o.order_date) AS order_month,
        CASE 
            WHEN o.total_amount > 1000 THEN 'High Value'
            WHEN o.total_amount > 500 THEN 'Medium Value'
            ELSE 'Low Value'
        END AS order_tier
        
    FROM orders o
    LEFT JOIN customers c ON o.customer_id = c.customer_id
)

SELECT * FROM enriched
  );

[0m01:56:17.315624 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m01:56:17.321318 [debug] [Thread-1 (]: Using duckdb connection "model.ecommerce_analytics.int_orders_enriched"
[0m01:56:17.321318 [debug] [Thread-1 (]: On model.ecommerce_analytics.int_orders_enriched: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "ecommerce_analytics", "target_name": "dev", "node_id": "model.ecommerce_analytics.int_orders_enriched"} */
alter view "dev"."main"."int_orders_enriched" rename to "int_orders_enriched__dbt_backup"
[0m01:56:17.321318 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m01:56:17.321318 [debug] [Thread-1 (]: Using duckdb connection "model.ecommerce_analytics.int_orders_enriched"
[0m01:56:17.321318 [debug] [Thread-1 (]: On model.ecommerce_analytics.int_orders_enriched: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "ecommerce_analytics", "target_name": "dev", "node_id": "model.ecommerce_analytics.int_orders_enriched"} */
alter view "dev"."main"."int_orders_enriched__dbt_tmp" rename to "int_orders_enriched"
[0m01:56:17.321318 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m01:56:17.321318 [debug] [Thread-1 (]: On model.ecommerce_analytics.int_orders_enriched: COMMIT
[0m01:56:17.321318 [debug] [Thread-1 (]: Using duckdb connection "model.ecommerce_analytics.int_orders_enriched"
[0m01:56:17.321318 [debug] [Thread-1 (]: On model.ecommerce_analytics.int_orders_enriched: COMMIT
[0m01:56:17.331833 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m01:56:17.335066 [debug] [Thread-1 (]: Using duckdb connection "model.ecommerce_analytics.int_orders_enriched"
[0m01:56:17.335066 [debug] [Thread-1 (]: On model.ecommerce_analytics.int_orders_enriched: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "ecommerce_analytics", "target_name": "dev", "node_id": "model.ecommerce_analytics.int_orders_enriched"} */

      drop view if exists "dev"."main"."int_orders_enriched__dbt_backup" cascade
    
[0m01:56:17.335066 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m01:56:17.340833 [debug] [Thread-1 (]: On model.ecommerce_analytics.int_orders_enriched: Close
[0m01:56:17.340833 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cae51a66-a492-4c2b-9b28-df9a888d3e8a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E1912D9190>]}
[0m01:56:17.342355 [info ] [Thread-1 (]: 5 of 7 OK created sql view model main.int_orders_enriched ...................... [[32mOK[0m in 0.05s]
[0m01:56:17.342355 [debug] [Thread-1 (]: Finished running node model.ecommerce_analytics.int_orders_enriched
[0m01:56:17.342355 [debug] [Thread-1 (]: Began running node model.ecommerce_analytics.dim_products
[0m01:56:17.342355 [info ] [Thread-1 (]: 6 of 7 START sql table model main.dim_products ................................. [RUN]
[0m01:56:17.342355 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ecommerce_analytics.int_orders_enriched, now model.ecommerce_analytics.dim_products)
[0m01:56:17.342355 [debug] [Thread-1 (]: Began compiling node model.ecommerce_analytics.dim_products
[0m01:56:17.350660 [debug] [Thread-1 (]: Writing injected SQL for node "model.ecommerce_analytics.dim_products"
[0m01:56:17.352720 [debug] [Thread-1 (]: Began executing node model.ecommerce_analytics.dim_products
[0m01:56:17.373769 [debug] [Thread-1 (]: Writing runtime sql for node "model.ecommerce_analytics.dim_products"
[0m01:56:17.373769 [debug] [Thread-1 (]: Using duckdb connection "model.ecommerce_analytics.dim_products"
[0m01:56:17.373769 [debug] [Thread-1 (]: On model.ecommerce_analytics.dim_products: BEGIN
[0m01:56:17.373769 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:56:17.380562 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m01:56:17.381903 [debug] [Thread-1 (]: Using duckdb connection "model.ecommerce_analytics.dim_products"
[0m01:56:17.381903 [debug] [Thread-1 (]: On model.ecommerce_analytics.dim_products: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "ecommerce_analytics", "target_name": "dev", "node_id": "model.ecommerce_analytics.dim_products"} */

  
    
    

    create  table
      "dev"."main"."dim_products__dbt_tmp"
  
    as (
      

WITH products AS (
    SELECT DISTINCT
        product_id,
        sku,
        product_name,
        description,
        category_id,
        brand_id,
        supplier_id,
        price,
        cost,
        weight_kg,
        is_active,
        created_at,
        updated_at
    FROM "dev"."main"."stg_products"
)

SELECT * FROM products
    );
  
  
[0m01:56:17.396860 [debug] [Thread-1 (]: SQL status: OK in 0.015 seconds
[0m01:56:17.404386 [debug] [Thread-1 (]: Using duckdb connection "model.ecommerce_analytics.dim_products"
[0m01:56:17.404386 [debug] [Thread-1 (]: On model.ecommerce_analytics.dim_products: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "ecommerce_analytics", "target_name": "dev", "node_id": "model.ecommerce_analytics.dim_products"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'main'
      AND table_name = 'dim_products'
  
[0m01:56:17.406498 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m01:56:17.408506 [debug] [Thread-1 (]: Using duckdb connection "model.ecommerce_analytics.dim_products"
[0m01:56:17.408506 [debug] [Thread-1 (]: On model.ecommerce_analytics.dim_products: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "ecommerce_analytics", "target_name": "dev", "node_id": "model.ecommerce_analytics.dim_products"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'main'
      AND table_name = 'dim_products'
  
[0m01:56:17.408506 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m01:56:17.412771 [debug] [Thread-1 (]: Using duckdb connection "model.ecommerce_analytics.dim_products"
[0m01:56:17.412771 [debug] [Thread-1 (]: On model.ecommerce_analytics.dim_products: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "ecommerce_analytics", "target_name": "dev", "node_id": "model.ecommerce_analytics.dim_products"} */
alter table "dev"."main"."dim_products" rename to "dim_products__dbt_backup"
[0m01:56:17.414866 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m01:56:17.416522 [debug] [Thread-1 (]: Using duckdb connection "model.ecommerce_analytics.dim_products"
[0m01:56:17.416522 [debug] [Thread-1 (]: On model.ecommerce_analytics.dim_products: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "ecommerce_analytics", "target_name": "dev", "node_id": "model.ecommerce_analytics.dim_products"} */
alter table "dev"."main"."dim_products__dbt_tmp" rename to "dim_products"
[0m01:56:17.416522 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m01:56:17.425058 [debug] [Thread-1 (]: On model.ecommerce_analytics.dim_products: COMMIT
[0m01:56:17.425058 [debug] [Thread-1 (]: Using duckdb connection "model.ecommerce_analytics.dim_products"
[0m01:56:17.425058 [debug] [Thread-1 (]: On model.ecommerce_analytics.dim_products: COMMIT
[0m01:56:17.428718 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m01:56:17.433194 [debug] [Thread-1 (]: Using duckdb connection "model.ecommerce_analytics.dim_products"
[0m01:56:17.433194 [debug] [Thread-1 (]: On model.ecommerce_analytics.dim_products: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "ecommerce_analytics", "target_name": "dev", "node_id": "model.ecommerce_analytics.dim_products"} */

      drop table if exists "dev"."main"."dim_products__dbt_backup" cascade
    
[0m01:56:17.435205 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m01:56:17.437111 [debug] [Thread-1 (]: On model.ecommerce_analytics.dim_products: Close
[0m01:56:17.437111 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cae51a66-a492-4c2b-9b28-df9a888d3e8a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E1924C1E10>]}
[0m01:56:17.437111 [info ] [Thread-1 (]: 6 of 7 OK created sql table model main.dim_products ............................ [[32mOK[0m in 0.09s]
[0m01:56:17.437111 [debug] [Thread-1 (]: Finished running node model.ecommerce_analytics.dim_products
[0m01:56:17.437111 [debug] [Thread-1 (]: Began running node model.ecommerce_analytics.fct_orders
[0m01:56:17.440825 [info ] [Thread-1 (]: 7 of 7 START sql table model main.fct_orders ................................... [RUN]
[0m01:56:17.440825 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ecommerce_analytics.dim_products, now model.ecommerce_analytics.fct_orders)
[0m01:56:17.440825 [debug] [Thread-1 (]: Began compiling node model.ecommerce_analytics.fct_orders
[0m01:56:17.445313 [debug] [Thread-1 (]: Writing injected SQL for node "model.ecommerce_analytics.fct_orders"
[0m01:56:17.445313 [debug] [Thread-1 (]: Began executing node model.ecommerce_analytics.fct_orders
[0m01:56:17.449933 [debug] [Thread-1 (]: Writing runtime sql for node "model.ecommerce_analytics.fct_orders"
[0m01:56:17.452477 [debug] [Thread-1 (]: Using duckdb connection "model.ecommerce_analytics.fct_orders"
[0m01:56:17.452477 [debug] [Thread-1 (]: On model.ecommerce_analytics.fct_orders: BEGIN
[0m01:56:17.453495 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:56:17.454435 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m01:56:17.455156 [debug] [Thread-1 (]: Using duckdb connection "model.ecommerce_analytics.fct_orders"
[0m01:56:17.455772 [debug] [Thread-1 (]: On model.ecommerce_analytics.fct_orders: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "ecommerce_analytics", "target_name": "dev", "node_id": "model.ecommerce_analytics.fct_orders"} */

  
    
    

    create  table
      "dev"."main"."fct_orders__dbt_tmp"
  
    as (
      

WITH orders AS (
    SELECT * FROM "dev"."main"."int_orders_enriched"
)

SELECT
    order_id,
    order_number,
    order_date,
    order_month,
    customer_id,
    promotion_id,
    subtotal,
    discount_percent,
    shipping_cost,
    tax_amount,
    total_amount,
    payment_method,
    shipping_method,
    order_tier
FROM orders
    );
  
  
[0m01:56:17.461598 [debug] [Thread-1 (]: SQL status: OK in 0.008 seconds
[0m01:56:17.466025 [debug] [Thread-1 (]: Using duckdb connection "model.ecommerce_analytics.fct_orders"
[0m01:56:17.467226 [debug] [Thread-1 (]: On model.ecommerce_analytics.fct_orders: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "ecommerce_analytics", "target_name": "dev", "node_id": "model.ecommerce_analytics.fct_orders"} */

    SELECT index_name
    FROM duckdb_indexes()
    WHERE schema_name = 'main'
      AND table_name = 'fct_orders'
  
[0m01:56:17.467226 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m01:56:17.467226 [debug] [Thread-1 (]: Using duckdb connection "model.ecommerce_analytics.fct_orders"
[0m01:56:17.467226 [debug] [Thread-1 (]: On model.ecommerce_analytics.fct_orders: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "ecommerce_analytics", "target_name": "dev", "node_id": "model.ecommerce_analytics.fct_orders"} */

    SELECT COUNT(*) as remaining_indexes
    FROM duckdb_indexes()
    WHERE schema_name = 'main'
      AND table_name = 'fct_orders'
  
[0m01:56:17.467226 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m01:56:17.467226 [debug] [Thread-1 (]: Using duckdb connection "model.ecommerce_analytics.fct_orders"
[0m01:56:17.476238 [debug] [Thread-1 (]: On model.ecommerce_analytics.fct_orders: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "ecommerce_analytics", "target_name": "dev", "node_id": "model.ecommerce_analytics.fct_orders"} */
alter table "dev"."main"."fct_orders" rename to "fct_orders__dbt_backup"
[0m01:56:17.477372 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m01:56:17.481111 [debug] [Thread-1 (]: Using duckdb connection "model.ecommerce_analytics.fct_orders"
[0m01:56:17.481111 [debug] [Thread-1 (]: On model.ecommerce_analytics.fct_orders: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "ecommerce_analytics", "target_name": "dev", "node_id": "model.ecommerce_analytics.fct_orders"} */
alter table "dev"."main"."fct_orders__dbt_tmp" rename to "fct_orders"
[0m01:56:17.484576 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m01:56:17.486587 [debug] [Thread-1 (]: On model.ecommerce_analytics.fct_orders: COMMIT
[0m01:56:17.488110 [debug] [Thread-1 (]: Using duckdb connection "model.ecommerce_analytics.fct_orders"
[0m01:56:17.488110 [debug] [Thread-1 (]: On model.ecommerce_analytics.fct_orders: COMMIT
[0m01:56:17.488110 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m01:56:17.493070 [debug] [Thread-1 (]: Using duckdb connection "model.ecommerce_analytics.fct_orders"
[0m01:56:17.493070 [debug] [Thread-1 (]: On model.ecommerce_analytics.fct_orders: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "ecommerce_analytics", "target_name": "dev", "node_id": "model.ecommerce_analytics.fct_orders"} */

      drop table if exists "dev"."main"."fct_orders__dbt_backup" cascade
    
[0m01:56:17.496855 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m01:56:17.496855 [debug] [Thread-1 (]: On model.ecommerce_analytics.fct_orders: Close
[0m01:56:17.499745 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cae51a66-a492-4c2b-9b28-df9a888d3e8a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E1924FD550>]}
[0m01:56:17.499745 [info ] [Thread-1 (]: 7 of 7 OK created sql table model main.fct_orders .............................. [[32mOK[0m in 0.06s]
[0m01:56:17.501494 [debug] [Thread-1 (]: Finished running node model.ecommerce_analytics.fct_orders
[0m01:56:17.501494 [debug] [MainThread]: Using duckdb connection "master"
[0m01:56:17.501494 [debug] [MainThread]: On master: BEGIN
[0m01:56:17.501494 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m01:56:17.501494 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m01:56:17.507435 [debug] [MainThread]: On master: COMMIT
[0m01:56:17.507435 [debug] [MainThread]: Using duckdb connection "master"
[0m01:56:17.507435 [debug] [MainThread]: On master: COMMIT
[0m01:56:17.507435 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m01:56:17.509458 [debug] [MainThread]: On master: Close
[0m01:56:17.509458 [debug] [MainThread]: Connection 'master' was properly closed.
[0m01:56:17.509458 [debug] [MainThread]: Connection 'create_dev_main' was properly closed.
[0m01:56:17.509458 [debug] [MainThread]: Connection 'list_dev_main' was properly closed.
[0m01:56:17.509458 [debug] [MainThread]: Connection 'model.ecommerce_analytics.fct_orders' was properly closed.
[0m01:56:17.511965 [info ] [MainThread]: 
[0m01:56:17.511965 [info ] [MainThread]: Finished running 2 table models, 5 view models in 0 hours 0 minutes and 0.68 seconds (0.68s).
[0m01:56:17.514333 [debug] [MainThread]: Command end result
[0m01:56:17.551919 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\Lenovo\Desktop\Proyectos\dbt-proyect\ecommerce_analytics\target\manifest.json
[0m01:56:17.559278 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\Lenovo\Desktop\Proyectos\dbt-proyect\ecommerce_analytics\target\semantic_manifest.json
[0m01:56:17.569778 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\Lenovo\Desktop\Proyectos\dbt-proyect\ecommerce_analytics\target\run_results.json
[0m01:56:17.569778 [info ] [MainThread]: 
[0m01:56:17.569778 [info ] [MainThread]: [32mCompleted successfully[0m
[0m01:56:17.569778 [info ] [MainThread]: 
[0m01:56:17.569778 [info ] [MainThread]: Done. PASS=7 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=7
[0m01:56:17.569778 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- MissingArgumentsPropertyInGenericTestDeprecation: 3 occurrences
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m01:56:17.578170 [debug] [MainThread]: Command `dbt run` succeeded at 01:56:17.569778 after 2.47 seconds
[0m01:56:17.578170 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E18F6BFC50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E18F6BC390>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E18F6B7C10>]}
[0m01:56:17.578170 [debug] [MainThread]: Flushing usage events
[0m01:56:19.334497 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m01:56:27.097644 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CAC17AC4D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CAC1542C10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CAC17DFA10>]}


============================== 01:56:27.105016 | 3c7fdf0f-5b41-4267-b422-3f1483996552 ==============================
[0m01:56:27.105016 [info ] [MainThread]: Running with dbt=1.11.2
[0m01:56:27.105016 [debug] [MainThread]: running dbt with arguments {'static_parser': 'True', 'no_print': 'None', 'version_check': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'printer_width': '80', 'write_json': 'True', 'introspect': 'True', 'log_cache_events': 'False', 'empty': 'None', 'cache_selected_only': 'False', 'log_format': 'default', 'debug': 'False', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\Lenovo\\.dbt', 'send_anonymous_usage_stats': 'True', 'quiet': 'False', 'warn_error': 'None', 'partial_parse': 'True', 'indirect_selection': 'eager', 'use_colors': 'True', 'invocation_command': 'dbt test', 'use_experimental_parser': 'False', 'log_path': 'C:\\Users\\Lenovo\\Desktop\\Proyectos\\dbt-proyect\\ecommerce_analytics\\logs'}
[0m01:56:27.350228 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '3c7fdf0f-5b41-4267-b422-3f1483996552', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CAC17DF950>]}
[0m01:56:27.412841 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '3c7fdf0f-5b41-4267-b422-3f1483996552', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CAC1853350>]}
[0m01:56:27.416498 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m01:56:27.637888 [debug] [MainThread]: checksum: 3d40d8bbe1bef07db1c24822f2dbfff8bc07f2a48ed4fe2658a40653aec0b54b, vars: {}, profile: , target: , version: 1.11.2
[0m01:56:27.888291 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m01:56:27.889803 [debug] [MainThread]: Nothing changed, skipping partial parsing.
[0m01:56:27.889803 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m01:56:27.953077 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '3c7fdf0f-5b41-4267-b422-3f1483996552', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CAC2C8BC50>]}
[0m01:56:28.060324 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\Lenovo\Desktop\Proyectos\dbt-proyect\ecommerce_analytics\target\manifest.json
[0m01:56:28.061369 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\Lenovo\Desktop\Proyectos\dbt-proyect\ecommerce_analytics\target\semantic_manifest.json
[0m01:56:28.165691 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '3c7fdf0f-5b41-4267-b422-3f1483996552', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CAC3097ED0>]}
[0m01:56:28.166741 [info ] [MainThread]: Found 3 seeds, 7 models, 28 data tests, 587 macros
[0m01:56:28.167797 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3c7fdf0f-5b41-4267-b422-3f1483996552', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CAC1876FD0>]}
[0m01:56:28.173386 [info ] [MainThread]: 
[0m01:56:28.174555 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m01:56:28.175141 [info ] [MainThread]: 
[0m01:56:28.176196 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m01:56:28.185190 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_dev_main'
[0m01:56:28.261659 [debug] [ThreadPool]: Using duckdb connection "list_dev_main"
[0m01:56:28.261659 [debug] [ThreadPool]: On list_dev_main: BEGIN
[0m01:56:28.261659 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:56:28.343690 [debug] [ThreadPool]: SQL status: OK in 0.080 seconds
[0m01:56:28.346979 [debug] [ThreadPool]: Using duckdb connection "list_dev_main"
[0m01:56:28.348716 [debug] [ThreadPool]: On list_dev_main: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "ecommerce_analytics", "target_name": "dev", "connection_name": "list_dev_main"} */
select
      'dev' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'dev'
  
[0m01:56:28.373083 [debug] [ThreadPool]: SQL status: OK in 0.024 seconds
[0m01:56:28.374590 [debug] [ThreadPool]: On list_dev_main: ROLLBACK
[0m01:56:28.376669 [debug] [ThreadPool]: Failed to rollback 'list_dev_main'
[0m01:56:28.376669 [debug] [ThreadPool]: On list_dev_main: Close
[0m01:56:28.376669 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3c7fdf0f-5b41-4267-b422-3f1483996552', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CAC185E850>]}
[0m01:56:28.380917 [debug] [MainThread]: Using duckdb connection "master"
[0m01:56:28.381557 [debug] [MainThread]: On master: BEGIN
[0m01:56:28.381557 [debug] [MainThread]: Opening a new connection, currently in state init
[0m01:56:28.383356 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m01:56:28.383356 [debug] [MainThread]: On master: COMMIT
[0m01:56:28.383356 [debug] [MainThread]: Using duckdb connection "master"
[0m01:56:28.384866 [debug] [MainThread]: On master: COMMIT
[0m01:56:28.384866 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m01:56:28.384866 [debug] [MainThread]: On master: Close
[0m01:56:28.393036 [debug] [Thread-1 (]: Began running node test.ecommerce_analytics.dbt_utils_accepted_range_dim_products_price__0.872688f741
[0m01:56:28.393036 [info ] [Thread-1 (]: 1 of 28 START test dbt_utils_accepted_range_dim_products_price__0 .............. [RUN]
[0m01:56:28.395047 [debug] [Thread-1 (]: Acquiring new duckdb connection 'test.ecommerce_analytics.dbt_utils_accepted_range_dim_products_price__0.872688f741'
[0m01:56:28.396262 [debug] [Thread-1 (]: Began compiling node test.ecommerce_analytics.dbt_utils_accepted_range_dim_products_price__0.872688f741
[0m01:56:28.415548 [debug] [Thread-1 (]: Writing injected SQL for node "test.ecommerce_analytics.dbt_utils_accepted_range_dim_products_price__0.872688f741"
[0m01:56:28.456101 [debug] [Thread-1 (]: Began executing node test.ecommerce_analytics.dbt_utils_accepted_range_dim_products_price__0.872688f741
[0m01:56:28.486991 [debug] [Thread-1 (]: Writing runtime sql for node "test.ecommerce_analytics.dbt_utils_accepted_range_dim_products_price__0.872688f741"
[0m01:56:28.486991 [debug] [Thread-1 (]: Using duckdb connection "test.ecommerce_analytics.dbt_utils_accepted_range_dim_products_price__0.872688f741"
[0m01:56:28.486991 [debug] [Thread-1 (]: On test.ecommerce_analytics.dbt_utils_accepted_range_dim_products_price__0.872688f741: BEGIN
[0m01:56:28.486991 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m01:56:28.495294 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m01:56:28.495294 [debug] [Thread-1 (]: Using duckdb connection "test.ecommerce_analytics.dbt_utils_accepted_range_dim_products_price__0.872688f741"
[0m01:56:28.495294 [debug] [Thread-1 (]: On test.ecommerce_analytics.dbt_utils_accepted_range_dim_products_price__0.872688f741: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "ecommerce_analytics", "target_name": "dev", "node_id": "test.ecommerce_analytics.dbt_utils_accepted_range_dim_products_price__0.872688f741"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  

with meet_condition as(
  select *
  from "dev"."main"."dim_products"
),

validation_errors as (
  select *
  from meet_condition
  where
    -- never true, defaults to an empty result set. Exists to ensure any combo of the `or` clauses below succeeds
    1 = 2
    -- records with a value >= min_value are permitted. The `not` flips this to find records that don't meet the rule.
    or not price >= 0
)

select *
from validation_errors


  
  
      
    ) dbt_internal_test
[0m01:56:28.500029 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m01:56:28.504897 [debug] [Thread-1 (]: On test.ecommerce_analytics.dbt_utils_accepted_range_dim_products_price__0.872688f741: ROLLBACK
[0m01:56:28.504897 [debug] [Thread-1 (]: Failed to rollback 'test.ecommerce_analytics.dbt_utils_accepted_range_dim_products_price__0.872688f741'
[0m01:56:28.504897 [debug] [Thread-1 (]: On test.ecommerce_analytics.dbt_utils_accepted_range_dim_products_price__0.872688f741: Close
[0m01:56:28.504897 [info ] [Thread-1 (]: 1 of 28 PASS dbt_utils_accepted_range_dim_products_price__0 .................... [[32mPASS[0m in 0.11s]
[0m01:56:28.504897 [debug] [Thread-1 (]: Finished running node test.ecommerce_analytics.dbt_utils_accepted_range_dim_products_price__0.872688f741
[0m01:56:28.504897 [debug] [Thread-1 (]: Began running node test.ecommerce_analytics.dbt_utils_accepted_range_fct_orders_total_amount__0.1899fe7826
[0m01:56:28.504897 [info ] [Thread-1 (]: 2 of 28 START test dbt_utils_accepted_range_fct_orders_total_amount__0 ......... [RUN]
[0m01:56:28.504897 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.ecommerce_analytics.dbt_utils_accepted_range_dim_products_price__0.872688f741, now test.ecommerce_analytics.dbt_utils_accepted_range_fct_orders_total_amount__0.1899fe7826)
[0m01:56:28.504897 [debug] [Thread-1 (]: Began compiling node test.ecommerce_analytics.dbt_utils_accepted_range_fct_orders_total_amount__0.1899fe7826
[0m01:56:28.516776 [debug] [Thread-1 (]: Writing injected SQL for node "test.ecommerce_analytics.dbt_utils_accepted_range_fct_orders_total_amount__0.1899fe7826"
[0m01:56:28.518198 [debug] [Thread-1 (]: Began executing node test.ecommerce_analytics.dbt_utils_accepted_range_fct_orders_total_amount__0.1899fe7826
[0m01:56:28.520149 [debug] [Thread-1 (]: Writing runtime sql for node "test.ecommerce_analytics.dbt_utils_accepted_range_fct_orders_total_amount__0.1899fe7826"
[0m01:56:28.523163 [debug] [Thread-1 (]: Using duckdb connection "test.ecommerce_analytics.dbt_utils_accepted_range_fct_orders_total_amount__0.1899fe7826"
[0m01:56:28.524295 [debug] [Thread-1 (]: On test.ecommerce_analytics.dbt_utils_accepted_range_fct_orders_total_amount__0.1899fe7826: BEGIN
[0m01:56:28.525302 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:56:28.525302 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m01:56:28.525302 [debug] [Thread-1 (]: Using duckdb connection "test.ecommerce_analytics.dbt_utils_accepted_range_fct_orders_total_amount__0.1899fe7826"
[0m01:56:28.525302 [debug] [Thread-1 (]: On test.ecommerce_analytics.dbt_utils_accepted_range_fct_orders_total_amount__0.1899fe7826: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "ecommerce_analytics", "target_name": "dev", "node_id": "test.ecommerce_analytics.dbt_utils_accepted_range_fct_orders_total_amount__0.1899fe7826"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  

with meet_condition as(
  select *
  from "dev"."main"."fct_orders"
),

validation_errors as (
  select *
  from meet_condition
  where
    -- never true, defaults to an empty result set. Exists to ensure any combo of the `or` clauses below succeeds
    1 = 2
    -- records with a value >= min_value are permitted. The `not` flips this to find records that don't meet the rule.
    or not total_amount >= 0
)

select *
from validation_errors


  
  
      
    ) dbt_internal_test
[0m01:56:28.530903 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m01:56:28.531836 [debug] [Thread-1 (]: On test.ecommerce_analytics.dbt_utils_accepted_range_fct_orders_total_amount__0.1899fe7826: ROLLBACK
[0m01:56:28.533842 [debug] [Thread-1 (]: Failed to rollback 'test.ecommerce_analytics.dbt_utils_accepted_range_fct_orders_total_amount__0.1899fe7826'
[0m01:56:28.535023 [debug] [Thread-1 (]: On test.ecommerce_analytics.dbt_utils_accepted_range_fct_orders_total_amount__0.1899fe7826: Close
[0m01:56:28.535548 [info ] [Thread-1 (]: 2 of 28 PASS dbt_utils_accepted_range_fct_orders_total_amount__0 ............... [[32mPASS[0m in 0.03s]
[0m01:56:28.535548 [debug] [Thread-1 (]: Finished running node test.ecommerce_analytics.dbt_utils_accepted_range_fct_orders_total_amount__0.1899fe7826
[0m01:56:28.537520 [debug] [Thread-1 (]: Began running node test.ecommerce_analytics.dbt_utils_accepted_range_stg_orders_total_amount__0.2895a1f8db
[0m01:56:28.537520 [info ] [Thread-1 (]: 3 of 28 START test dbt_utils_accepted_range_stg_orders_total_amount__0 ......... [RUN]
[0m01:56:28.539529 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.ecommerce_analytics.dbt_utils_accepted_range_fct_orders_total_amount__0.1899fe7826, now test.ecommerce_analytics.dbt_utils_accepted_range_stg_orders_total_amount__0.2895a1f8db)
[0m01:56:28.539529 [debug] [Thread-1 (]: Began compiling node test.ecommerce_analytics.dbt_utils_accepted_range_stg_orders_total_amount__0.2895a1f8db
[0m01:56:28.545012 [debug] [Thread-1 (]: Writing injected SQL for node "test.ecommerce_analytics.dbt_utils_accepted_range_stg_orders_total_amount__0.2895a1f8db"
[0m01:56:28.546566 [debug] [Thread-1 (]: Began executing node test.ecommerce_analytics.dbt_utils_accepted_range_stg_orders_total_amount__0.2895a1f8db
[0m01:56:28.553180 [debug] [Thread-1 (]: Writing runtime sql for node "test.ecommerce_analytics.dbt_utils_accepted_range_stg_orders_total_amount__0.2895a1f8db"
[0m01:56:28.553180 [debug] [Thread-1 (]: Using duckdb connection "test.ecommerce_analytics.dbt_utils_accepted_range_stg_orders_total_amount__0.2895a1f8db"
[0m01:56:28.556430 [debug] [Thread-1 (]: On test.ecommerce_analytics.dbt_utils_accepted_range_stg_orders_total_amount__0.2895a1f8db: BEGIN
[0m01:56:28.558612 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:56:28.560625 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m01:56:28.562037 [debug] [Thread-1 (]: Using duckdb connection "test.ecommerce_analytics.dbt_utils_accepted_range_stg_orders_total_amount__0.2895a1f8db"
[0m01:56:28.562616 [debug] [Thread-1 (]: On test.ecommerce_analytics.dbt_utils_accepted_range_stg_orders_total_amount__0.2895a1f8db: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "ecommerce_analytics", "target_name": "dev", "node_id": "test.ecommerce_analytics.dbt_utils_accepted_range_stg_orders_total_amount__0.2895a1f8db"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  

with meet_condition as(
  select *
  from "dev"."main"."stg_orders"
),

validation_errors as (
  select *
  from meet_condition
  where
    -- never true, defaults to an empty result set. Exists to ensure any combo of the `or` clauses below succeeds
    1 = 2
    -- records with a value >= min_value are permitted. The `not` flips this to find records that don't meet the rule.
    or not total_amount >= 0
)

select *
from validation_errors


  
  
      
    ) dbt_internal_test
[0m01:56:28.566546 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m01:56:28.568972 [debug] [Thread-1 (]: On test.ecommerce_analytics.dbt_utils_accepted_range_stg_orders_total_amount__0.2895a1f8db: ROLLBACK
[0m01:56:28.570979 [debug] [Thread-1 (]: Failed to rollback 'test.ecommerce_analytics.dbt_utils_accepted_range_stg_orders_total_amount__0.2895a1f8db'
[0m01:56:28.570979 [debug] [Thread-1 (]: On test.ecommerce_analytics.dbt_utils_accepted_range_stg_orders_total_amount__0.2895a1f8db: Close
[0m01:56:28.570979 [info ] [Thread-1 (]: 3 of 28 PASS dbt_utils_accepted_range_stg_orders_total_amount__0 ............... [[32mPASS[0m in 0.03s]
[0m01:56:28.570979 [debug] [Thread-1 (]: Finished running node test.ecommerce_analytics.dbt_utils_accepted_range_stg_orders_total_amount__0.2895a1f8db
[0m01:56:28.570979 [debug] [Thread-1 (]: Began running node test.ecommerce_analytics.dbt_utils_accepted_range_stg_products_price__0.26bfce9c9f
[0m01:56:28.570979 [info ] [Thread-1 (]: 4 of 28 START test dbt_utils_accepted_range_stg_products_price__0 .............. [RUN]
[0m01:56:28.570979 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.ecommerce_analytics.dbt_utils_accepted_range_stg_orders_total_amount__0.2895a1f8db, now test.ecommerce_analytics.dbt_utils_accepted_range_stg_products_price__0.26bfce9c9f)
[0m01:56:28.570979 [debug] [Thread-1 (]: Began compiling node test.ecommerce_analytics.dbt_utils_accepted_range_stg_products_price__0.26bfce9c9f
[0m01:56:28.580349 [debug] [Thread-1 (]: Writing injected SQL for node "test.ecommerce_analytics.dbt_utils_accepted_range_stg_products_price__0.26bfce9c9f"
[0m01:56:28.580349 [debug] [Thread-1 (]: Began executing node test.ecommerce_analytics.dbt_utils_accepted_range_stg_products_price__0.26bfce9c9f
[0m01:56:28.587492 [debug] [Thread-1 (]: Writing runtime sql for node "test.ecommerce_analytics.dbt_utils_accepted_range_stg_products_price__0.26bfce9c9f"
[0m01:56:28.588094 [debug] [Thread-1 (]: Using duckdb connection "test.ecommerce_analytics.dbt_utils_accepted_range_stg_products_price__0.26bfce9c9f"
[0m01:56:28.588094 [debug] [Thread-1 (]: On test.ecommerce_analytics.dbt_utils_accepted_range_stg_products_price__0.26bfce9c9f: BEGIN
[0m01:56:28.588094 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:56:28.588094 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m01:56:28.588094 [debug] [Thread-1 (]: Using duckdb connection "test.ecommerce_analytics.dbt_utils_accepted_range_stg_products_price__0.26bfce9c9f"
[0m01:56:28.588094 [debug] [Thread-1 (]: On test.ecommerce_analytics.dbt_utils_accepted_range_stg_products_price__0.26bfce9c9f: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "ecommerce_analytics", "target_name": "dev", "node_id": "test.ecommerce_analytics.dbt_utils_accepted_range_stg_products_price__0.26bfce9c9f"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  

with meet_condition as(
  select *
  from "dev"."main"."stg_products"
),

validation_errors as (
  select *
  from meet_condition
  where
    -- never true, defaults to an empty result set. Exists to ensure any combo of the `or` clauses below succeeds
    1 = 2
    -- records with a value >= min_value are permitted. The `not` flips this to find records that don't meet the rule.
    or not price >= 0
)

select *
from validation_errors


  
  
      
    ) dbt_internal_test
[0m01:56:28.594597 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m01:56:28.596062 [debug] [Thread-1 (]: On test.ecommerce_analytics.dbt_utils_accepted_range_stg_products_price__0.26bfce9c9f: ROLLBACK
[0m01:56:28.598138 [debug] [Thread-1 (]: Failed to rollback 'test.ecommerce_analytics.dbt_utils_accepted_range_stg_products_price__0.26bfce9c9f'
[0m01:56:28.598138 [debug] [Thread-1 (]: On test.ecommerce_analytics.dbt_utils_accepted_range_stg_products_price__0.26bfce9c9f: Close
[0m01:56:28.598138 [info ] [Thread-1 (]: 4 of 28 PASS dbt_utils_accepted_range_stg_products_price__0 .................... [[32mPASS[0m in 0.03s]
[0m01:56:28.598138 [debug] [Thread-1 (]: Finished running node test.ecommerce_analytics.dbt_utils_accepted_range_stg_products_price__0.26bfce9c9f
[0m01:56:28.598138 [debug] [Thread-1 (]: Began running node test.ecommerce_analytics.not_null_dim_customers_customer_email.0effd35874
[0m01:56:28.598138 [info ] [Thread-1 (]: 5 of 28 START test not_null_dim_customers_customer_email ....................... [RUN]
[0m01:56:28.598138 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.ecommerce_analytics.dbt_utils_accepted_range_stg_products_price__0.26bfce9c9f, now test.ecommerce_analytics.not_null_dim_customers_customer_email.0effd35874)
[0m01:56:28.602602 [debug] [Thread-1 (]: Began compiling node test.ecommerce_analytics.not_null_dim_customers_customer_email.0effd35874
[0m01:56:28.608273 [debug] [Thread-1 (]: Writing injected SQL for node "test.ecommerce_analytics.not_null_dim_customers_customer_email.0effd35874"
[0m01:56:28.612811 [debug] [Thread-1 (]: Began executing node test.ecommerce_analytics.not_null_dim_customers_customer_email.0effd35874
[0m01:56:28.616609 [debug] [Thread-1 (]: Writing runtime sql for node "test.ecommerce_analytics.not_null_dim_customers_customer_email.0effd35874"
[0m01:56:28.618711 [debug] [Thread-1 (]: Using duckdb connection "test.ecommerce_analytics.not_null_dim_customers_customer_email.0effd35874"
[0m01:56:28.618711 [debug] [Thread-1 (]: On test.ecommerce_analytics.not_null_dim_customers_customer_email.0effd35874: BEGIN
[0m01:56:28.618711 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:56:28.621447 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m01:56:28.621447 [debug] [Thread-1 (]: Using duckdb connection "test.ecommerce_analytics.not_null_dim_customers_customer_email.0effd35874"
[0m01:56:28.621447 [debug] [Thread-1 (]: On test.ecommerce_analytics.not_null_dim_customers_customer_email.0effd35874: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "ecommerce_analytics", "target_name": "dev", "node_id": "test.ecommerce_analytics.not_null_dim_customers_customer_email.0effd35874"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select customer_email
from "dev"."main"."dim_customers"
where customer_email is null



  
  
      
    ) dbt_internal_test
[0m01:56:28.621447 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m01:56:28.627280 [debug] [Thread-1 (]: On test.ecommerce_analytics.not_null_dim_customers_customer_email.0effd35874: ROLLBACK
[0m01:56:28.629300 [debug] [Thread-1 (]: Failed to rollback 'test.ecommerce_analytics.not_null_dim_customers_customer_email.0effd35874'
[0m01:56:28.629300 [debug] [Thread-1 (]: On test.ecommerce_analytics.not_null_dim_customers_customer_email.0effd35874: Close
[0m01:56:28.630299 [info ] [Thread-1 (]: 5 of 28 PASS not_null_dim_customers_customer_email ............................. [[32mPASS[0m in 0.03s]
[0m01:56:28.630299 [debug] [Thread-1 (]: Finished running node test.ecommerce_analytics.not_null_dim_customers_customer_email.0effd35874
[0m01:56:28.630299 [debug] [Thread-1 (]: Began running node test.ecommerce_analytics.not_null_dim_customers_customer_id.dd91cd1c8d
[0m01:56:28.630299 [info ] [Thread-1 (]: 6 of 28 START test not_null_dim_customers_customer_id .......................... [RUN]
[0m01:56:28.630299 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.ecommerce_analytics.not_null_dim_customers_customer_email.0effd35874, now test.ecommerce_analytics.not_null_dim_customers_customer_id.dd91cd1c8d)
[0m01:56:28.630299 [debug] [Thread-1 (]: Began compiling node test.ecommerce_analytics.not_null_dim_customers_customer_id.dd91cd1c8d
[0m01:56:28.630299 [debug] [Thread-1 (]: Writing injected SQL for node "test.ecommerce_analytics.not_null_dim_customers_customer_id.dd91cd1c8d"
[0m01:56:28.639780 [debug] [Thread-1 (]: Began executing node test.ecommerce_analytics.not_null_dim_customers_customer_id.dd91cd1c8d
[0m01:56:28.643178 [debug] [Thread-1 (]: Writing runtime sql for node "test.ecommerce_analytics.not_null_dim_customers_customer_id.dd91cd1c8d"
[0m01:56:28.644380 [debug] [Thread-1 (]: Using duckdb connection "test.ecommerce_analytics.not_null_dim_customers_customer_id.dd91cd1c8d"
[0m01:56:28.644380 [debug] [Thread-1 (]: On test.ecommerce_analytics.not_null_dim_customers_customer_id.dd91cd1c8d: BEGIN
[0m01:56:28.644380 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:56:28.644380 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m01:56:28.648354 [debug] [Thread-1 (]: Using duckdb connection "test.ecommerce_analytics.not_null_dim_customers_customer_id.dd91cd1c8d"
[0m01:56:28.648354 [debug] [Thread-1 (]: On test.ecommerce_analytics.not_null_dim_customers_customer_id.dd91cd1c8d: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "ecommerce_analytics", "target_name": "dev", "node_id": "test.ecommerce_analytics.not_null_dim_customers_customer_id.dd91cd1c8d"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select customer_id
from "dev"."main"."dim_customers"
where customer_id is null



  
  
      
    ) dbt_internal_test
[0m01:56:28.650405 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m01:56:28.650405 [debug] [Thread-1 (]: On test.ecommerce_analytics.not_null_dim_customers_customer_id.dd91cd1c8d: ROLLBACK
[0m01:56:28.650405 [debug] [Thread-1 (]: Failed to rollback 'test.ecommerce_analytics.not_null_dim_customers_customer_id.dd91cd1c8d'
[0m01:56:28.650405 [debug] [Thread-1 (]: On test.ecommerce_analytics.not_null_dim_customers_customer_id.dd91cd1c8d: Close
[0m01:56:28.655223 [info ] [Thread-1 (]: 6 of 28 PASS not_null_dim_customers_customer_id ................................ [[32mPASS[0m in 0.02s]
[0m01:56:28.655223 [debug] [Thread-1 (]: Finished running node test.ecommerce_analytics.not_null_dim_customers_customer_id.dd91cd1c8d
[0m01:56:28.655223 [debug] [Thread-1 (]: Began running node test.ecommerce_analytics.not_null_dim_products_price.93519fc0ed
[0m01:56:28.655223 [info ] [Thread-1 (]: 7 of 28 START test not_null_dim_products_price ................................. [RUN]
[0m01:56:28.658919 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.ecommerce_analytics.not_null_dim_customers_customer_id.dd91cd1c8d, now test.ecommerce_analytics.not_null_dim_products_price.93519fc0ed)
[0m01:56:28.658919 [debug] [Thread-1 (]: Began compiling node test.ecommerce_analytics.not_null_dim_products_price.93519fc0ed
[0m01:56:28.664776 [debug] [Thread-1 (]: Writing injected SQL for node "test.ecommerce_analytics.not_null_dim_products_price.93519fc0ed"
[0m01:56:28.664776 [debug] [Thread-1 (]: Began executing node test.ecommerce_analytics.not_null_dim_products_price.93519fc0ed
[0m01:56:28.669151 [debug] [Thread-1 (]: Writing runtime sql for node "test.ecommerce_analytics.not_null_dim_products_price.93519fc0ed"
[0m01:56:28.671156 [debug] [Thread-1 (]: Using duckdb connection "test.ecommerce_analytics.not_null_dim_products_price.93519fc0ed"
[0m01:56:28.671156 [debug] [Thread-1 (]: On test.ecommerce_analytics.not_null_dim_products_price.93519fc0ed: BEGIN
[0m01:56:28.671156 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:56:28.674537 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m01:56:28.675622 [debug] [Thread-1 (]: Using duckdb connection "test.ecommerce_analytics.not_null_dim_products_price.93519fc0ed"
[0m01:56:28.675622 [debug] [Thread-1 (]: On test.ecommerce_analytics.not_null_dim_products_price.93519fc0ed: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "ecommerce_analytics", "target_name": "dev", "node_id": "test.ecommerce_analytics.not_null_dim_products_price.93519fc0ed"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select price
from "dev"."main"."dim_products"
where price is null



  
  
      
    ) dbt_internal_test
[0m01:56:28.675622 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m01:56:28.675622 [debug] [Thread-1 (]: On test.ecommerce_analytics.not_null_dim_products_price.93519fc0ed: ROLLBACK
[0m01:56:28.675622 [debug] [Thread-1 (]: Failed to rollback 'test.ecommerce_analytics.not_null_dim_products_price.93519fc0ed'
[0m01:56:28.680851 [debug] [Thread-1 (]: On test.ecommerce_analytics.not_null_dim_products_price.93519fc0ed: Close
[0m01:56:28.681360 [info ] [Thread-1 (]: 7 of 28 PASS not_null_dim_products_price ....................................... [[32mPASS[0m in 0.02s]
[0m01:56:28.681360 [debug] [Thread-1 (]: Finished running node test.ecommerce_analytics.not_null_dim_products_price.93519fc0ed
[0m01:56:28.684023 [debug] [Thread-1 (]: Began running node test.ecommerce_analytics.not_null_dim_products_product_id.c8aba288d1
[0m01:56:28.684770 [info ] [Thread-1 (]: 8 of 28 START test not_null_dim_products_product_id ............................ [RUN]
[0m01:56:28.685348 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.ecommerce_analytics.not_null_dim_products_price.93519fc0ed, now test.ecommerce_analytics.not_null_dim_products_product_id.c8aba288d1)
[0m01:56:28.685348 [debug] [Thread-1 (]: Began compiling node test.ecommerce_analytics.not_null_dim_products_product_id.c8aba288d1
[0m01:56:28.691880 [debug] [Thread-1 (]: Writing injected SQL for node "test.ecommerce_analytics.not_null_dim_products_product_id.c8aba288d1"
[0m01:56:28.693005 [debug] [Thread-1 (]: Began executing node test.ecommerce_analytics.not_null_dim_products_product_id.c8aba288d1
[0m01:56:28.697934 [debug] [Thread-1 (]: Writing runtime sql for node "test.ecommerce_analytics.not_null_dim_products_product_id.c8aba288d1"
[0m01:56:28.697934 [debug] [Thread-1 (]: Using duckdb connection "test.ecommerce_analytics.not_null_dim_products_product_id.c8aba288d1"
[0m01:56:28.697934 [debug] [Thread-1 (]: On test.ecommerce_analytics.not_null_dim_products_product_id.c8aba288d1: BEGIN
[0m01:56:28.702342 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:56:28.702952 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m01:56:28.702952 [debug] [Thread-1 (]: Using duckdb connection "test.ecommerce_analytics.not_null_dim_products_product_id.c8aba288d1"
[0m01:56:28.704972 [debug] [Thread-1 (]: On test.ecommerce_analytics.not_null_dim_products_product_id.c8aba288d1: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "ecommerce_analytics", "target_name": "dev", "node_id": "test.ecommerce_analytics.not_null_dim_products_product_id.c8aba288d1"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select product_id
from "dev"."main"."dim_products"
where product_id is null



  
  
      
    ) dbt_internal_test
[0m01:56:28.704972 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m01:56:28.704972 [debug] [Thread-1 (]: On test.ecommerce_analytics.not_null_dim_products_product_id.c8aba288d1: ROLLBACK
[0m01:56:28.704972 [debug] [Thread-1 (]: Failed to rollback 'test.ecommerce_analytics.not_null_dim_products_product_id.c8aba288d1'
[0m01:56:28.704972 [debug] [Thread-1 (]: On test.ecommerce_analytics.not_null_dim_products_product_id.c8aba288d1: Close
[0m01:56:28.704972 [info ] [Thread-1 (]: 8 of 28 PASS not_null_dim_products_product_id .................................. [[32mPASS[0m in 0.02s]
[0m01:56:28.712754 [debug] [Thread-1 (]: Finished running node test.ecommerce_analytics.not_null_dim_products_product_id.c8aba288d1
[0m01:56:28.713372 [debug] [Thread-1 (]: Began running node test.ecommerce_analytics.not_null_fct_orders_customer_id.16fe324f7b
[0m01:56:28.713372 [info ] [Thread-1 (]: 9 of 28 START test not_null_fct_orders_customer_id ............................. [RUN]
[0m01:56:28.714839 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.ecommerce_analytics.not_null_dim_products_product_id.c8aba288d1, now test.ecommerce_analytics.not_null_fct_orders_customer_id.16fe324f7b)
[0m01:56:28.714839 [debug] [Thread-1 (]: Began compiling node test.ecommerce_analytics.not_null_fct_orders_customer_id.16fe324f7b
[0m01:56:28.722926 [debug] [Thread-1 (]: Writing injected SQL for node "test.ecommerce_analytics.not_null_fct_orders_customer_id.16fe324f7b"
[0m01:56:28.722926 [debug] [Thread-1 (]: Began executing node test.ecommerce_analytics.not_null_fct_orders_customer_id.16fe324f7b
[0m01:56:28.729969 [debug] [Thread-1 (]: Writing runtime sql for node "test.ecommerce_analytics.not_null_fct_orders_customer_id.16fe324f7b"
[0m01:56:28.733287 [debug] [Thread-1 (]: Using duckdb connection "test.ecommerce_analytics.not_null_fct_orders_customer_id.16fe324f7b"
[0m01:56:28.733287 [debug] [Thread-1 (]: On test.ecommerce_analytics.not_null_fct_orders_customer_id.16fe324f7b: BEGIN
[0m01:56:28.733287 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:56:28.733287 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m01:56:28.735391 [debug] [Thread-1 (]: Using duckdb connection "test.ecommerce_analytics.not_null_fct_orders_customer_id.16fe324f7b"
[0m01:56:28.735391 [debug] [Thread-1 (]: On test.ecommerce_analytics.not_null_fct_orders_customer_id.16fe324f7b: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "ecommerce_analytics", "target_name": "dev", "node_id": "test.ecommerce_analytics.not_null_fct_orders_customer_id.16fe324f7b"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select customer_id
from "dev"."main"."fct_orders"
where customer_id is null



  
  
      
    ) dbt_internal_test
[0m01:56:28.735391 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m01:56:28.737398 [debug] [Thread-1 (]: On test.ecommerce_analytics.not_null_fct_orders_customer_id.16fe324f7b: ROLLBACK
[0m01:56:28.737398 [debug] [Thread-1 (]: Failed to rollback 'test.ecommerce_analytics.not_null_fct_orders_customer_id.16fe324f7b'
[0m01:56:28.737398 [debug] [Thread-1 (]: On test.ecommerce_analytics.not_null_fct_orders_customer_id.16fe324f7b: Close
[0m01:56:28.737398 [info ] [Thread-1 (]: 9 of 28 PASS not_null_fct_orders_customer_id ................................... [[32mPASS[0m in 0.02s]
[0m01:56:28.737398 [debug] [Thread-1 (]: Finished running node test.ecommerce_analytics.not_null_fct_orders_customer_id.16fe324f7b
[0m01:56:28.737398 [debug] [Thread-1 (]: Began running node test.ecommerce_analytics.not_null_fct_orders_order_id.4e687af8d0
[0m01:56:28.737398 [info ] [Thread-1 (]: 10 of 28 START test not_null_fct_orders_order_id ............................... [RUN]
[0m01:56:28.743472 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.ecommerce_analytics.not_null_fct_orders_customer_id.16fe324f7b, now test.ecommerce_analytics.not_null_fct_orders_order_id.4e687af8d0)
[0m01:56:28.743472 [debug] [Thread-1 (]: Began compiling node test.ecommerce_analytics.not_null_fct_orders_order_id.4e687af8d0
[0m01:56:28.748073 [debug] [Thread-1 (]: Writing injected SQL for node "test.ecommerce_analytics.not_null_fct_orders_order_id.4e687af8d0"
[0m01:56:28.748073 [debug] [Thread-1 (]: Began executing node test.ecommerce_analytics.not_null_fct_orders_order_id.4e687af8d0
[0m01:56:28.753611 [debug] [Thread-1 (]: Writing runtime sql for node "test.ecommerce_analytics.not_null_fct_orders_order_id.4e687af8d0"
[0m01:56:28.753611 [debug] [Thread-1 (]: Using duckdb connection "test.ecommerce_analytics.not_null_fct_orders_order_id.4e687af8d0"
[0m01:56:28.753611 [debug] [Thread-1 (]: On test.ecommerce_analytics.not_null_fct_orders_order_id.4e687af8d0: BEGIN
[0m01:56:28.753611 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:56:28.753611 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m01:56:28.753611 [debug] [Thread-1 (]: Using duckdb connection "test.ecommerce_analytics.not_null_fct_orders_order_id.4e687af8d0"
[0m01:56:28.753611 [debug] [Thread-1 (]: On test.ecommerce_analytics.not_null_fct_orders_order_id.4e687af8d0: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "ecommerce_analytics", "target_name": "dev", "node_id": "test.ecommerce_analytics.not_null_fct_orders_order_id.4e687af8d0"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select order_id
from "dev"."main"."fct_orders"
where order_id is null



  
  
      
    ) dbt_internal_test
[0m01:56:28.753611 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m01:56:28.762581 [debug] [Thread-1 (]: On test.ecommerce_analytics.not_null_fct_orders_order_id.4e687af8d0: ROLLBACK
[0m01:56:28.763808 [debug] [Thread-1 (]: Failed to rollback 'test.ecommerce_analytics.not_null_fct_orders_order_id.4e687af8d0'
[0m01:56:28.763808 [debug] [Thread-1 (]: On test.ecommerce_analytics.not_null_fct_orders_order_id.4e687af8d0: Close
[0m01:56:28.766088 [info ] [Thread-1 (]: 10 of 28 PASS not_null_fct_orders_order_id ..................................... [[32mPASS[0m in 0.02s]
[0m01:56:28.767642 [debug] [Thread-1 (]: Finished running node test.ecommerce_analytics.not_null_fct_orders_order_id.4e687af8d0
[0m01:56:28.767642 [debug] [Thread-1 (]: Began running node test.ecommerce_analytics.not_null_fct_orders_total_amount.f8b7bfac38
[0m01:56:28.769138 [info ] [Thread-1 (]: 11 of 28 START test not_null_fct_orders_total_amount ........................... [RUN]
[0m01:56:28.770156 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.ecommerce_analytics.not_null_fct_orders_order_id.4e687af8d0, now test.ecommerce_analytics.not_null_fct_orders_total_amount.f8b7bfac38)
[0m01:56:28.770156 [debug] [Thread-1 (]: Began compiling node test.ecommerce_analytics.not_null_fct_orders_total_amount.f8b7bfac38
[0m01:56:28.777858 [debug] [Thread-1 (]: Writing injected SQL for node "test.ecommerce_analytics.not_null_fct_orders_total_amount.f8b7bfac38"
[0m01:56:28.780306 [debug] [Thread-1 (]: Began executing node test.ecommerce_analytics.not_null_fct_orders_total_amount.f8b7bfac38
[0m01:56:28.784776 [debug] [Thread-1 (]: Writing runtime sql for node "test.ecommerce_analytics.not_null_fct_orders_total_amount.f8b7bfac38"
[0m01:56:28.786405 [debug] [Thread-1 (]: Using duckdb connection "test.ecommerce_analytics.not_null_fct_orders_total_amount.f8b7bfac38"
[0m01:56:28.786405 [debug] [Thread-1 (]: On test.ecommerce_analytics.not_null_fct_orders_total_amount.f8b7bfac38: BEGIN
[0m01:56:28.786405 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:56:28.786405 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m01:56:28.786405 [debug] [Thread-1 (]: Using duckdb connection "test.ecommerce_analytics.not_null_fct_orders_total_amount.f8b7bfac38"
[0m01:56:28.786405 [debug] [Thread-1 (]: On test.ecommerce_analytics.not_null_fct_orders_total_amount.f8b7bfac38: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "ecommerce_analytics", "target_name": "dev", "node_id": "test.ecommerce_analytics.not_null_fct_orders_total_amount.f8b7bfac38"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select total_amount
from "dev"."main"."fct_orders"
where total_amount is null



  
  
      
    ) dbt_internal_test
[0m01:56:28.786405 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m01:56:28.786405 [debug] [Thread-1 (]: On test.ecommerce_analytics.not_null_fct_orders_total_amount.f8b7bfac38: ROLLBACK
[0m01:56:28.786405 [debug] [Thread-1 (]: Failed to rollback 'test.ecommerce_analytics.not_null_fct_orders_total_amount.f8b7bfac38'
[0m01:56:28.794945 [debug] [Thread-1 (]: On test.ecommerce_analytics.not_null_fct_orders_total_amount.f8b7bfac38: Close
[0m01:56:28.795969 [info ] [Thread-1 (]: 11 of 28 PASS not_null_fct_orders_total_amount ................................. [[32mPASS[0m in 0.03s]
[0m01:56:28.798195 [debug] [Thread-1 (]: Finished running node test.ecommerce_analytics.not_null_fct_orders_total_amount.f8b7bfac38
[0m01:56:28.798195 [debug] [Thread-1 (]: Began running node test.ecommerce_analytics.not_null_stg_customers_customer_email.3267d739f2
[0m01:56:28.798195 [info ] [Thread-1 (]: 12 of 28 START test not_null_stg_customers_customer_email ...................... [RUN]
[0m01:56:28.798195 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.ecommerce_analytics.not_null_fct_orders_total_amount.f8b7bfac38, now test.ecommerce_analytics.not_null_stg_customers_customer_email.3267d739f2)
[0m01:56:28.803187 [debug] [Thread-1 (]: Began compiling node test.ecommerce_analytics.not_null_stg_customers_customer_email.3267d739f2
[0m01:56:28.805209 [debug] [Thread-1 (]: Writing injected SQL for node "test.ecommerce_analytics.not_null_stg_customers_customer_email.3267d739f2"
[0m01:56:28.805209 [debug] [Thread-1 (]: Began executing node test.ecommerce_analytics.not_null_stg_customers_customer_email.3267d739f2
[0m01:56:28.815722 [debug] [Thread-1 (]: Writing runtime sql for node "test.ecommerce_analytics.not_null_stg_customers_customer_email.3267d739f2"
[0m01:56:28.815722 [debug] [Thread-1 (]: Using duckdb connection "test.ecommerce_analytics.not_null_stg_customers_customer_email.3267d739f2"
[0m01:56:28.815722 [debug] [Thread-1 (]: On test.ecommerce_analytics.not_null_stg_customers_customer_email.3267d739f2: BEGIN
[0m01:56:28.819246 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:56:28.819246 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m01:56:28.819246 [debug] [Thread-1 (]: Using duckdb connection "test.ecommerce_analytics.not_null_stg_customers_customer_email.3267d739f2"
[0m01:56:28.819246 [debug] [Thread-1 (]: On test.ecommerce_analytics.not_null_stg_customers_customer_email.3267d739f2: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "ecommerce_analytics", "target_name": "dev", "node_id": "test.ecommerce_analytics.not_null_stg_customers_customer_email.3267d739f2"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select customer_email
from "dev"."main"."stg_customers"
where customer_email is null



  
  
      
    ) dbt_internal_test
[0m01:56:28.819246 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m01:56:28.825911 [debug] [Thread-1 (]: On test.ecommerce_analytics.not_null_stg_customers_customer_email.3267d739f2: ROLLBACK
[0m01:56:28.825911 [debug] [Thread-1 (]: Failed to rollback 'test.ecommerce_analytics.not_null_stg_customers_customer_email.3267d739f2'
[0m01:56:28.827048 [debug] [Thread-1 (]: On test.ecommerce_analytics.not_null_stg_customers_customer_email.3267d739f2: Close
[0m01:56:28.827670 [info ] [Thread-1 (]: 12 of 28 PASS not_null_stg_customers_customer_email ............................ [[32mPASS[0m in 0.03s]
[0m01:56:28.829230 [debug] [Thread-1 (]: Finished running node test.ecommerce_analytics.not_null_stg_customers_customer_email.3267d739f2
[0m01:56:28.829230 [debug] [Thread-1 (]: Began running node test.ecommerce_analytics.not_null_stg_customers_customer_id.e2cfb1f9aa
[0m01:56:28.829230 [info ] [Thread-1 (]: 13 of 28 START test not_null_stg_customers_customer_id ......................... [RUN]
[0m01:56:28.831704 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.ecommerce_analytics.not_null_stg_customers_customer_email.3267d739f2, now test.ecommerce_analytics.not_null_stg_customers_customer_id.e2cfb1f9aa)
[0m01:56:28.831704 [debug] [Thread-1 (]: Began compiling node test.ecommerce_analytics.not_null_stg_customers_customer_id.e2cfb1f9aa
[0m01:56:28.837496 [debug] [Thread-1 (]: Writing injected SQL for node "test.ecommerce_analytics.not_null_stg_customers_customer_id.e2cfb1f9aa"
[0m01:56:28.837496 [debug] [Thread-1 (]: Began executing node test.ecommerce_analytics.not_null_stg_customers_customer_id.e2cfb1f9aa
[0m01:56:28.837496 [debug] [Thread-1 (]: Writing runtime sql for node "test.ecommerce_analytics.not_null_stg_customers_customer_id.e2cfb1f9aa"
[0m01:56:28.837496 [debug] [Thread-1 (]: Using duckdb connection "test.ecommerce_analytics.not_null_stg_customers_customer_id.e2cfb1f9aa"
[0m01:56:28.837496 [debug] [Thread-1 (]: On test.ecommerce_analytics.not_null_stg_customers_customer_id.e2cfb1f9aa: BEGIN
[0m01:56:28.837496 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:56:28.845951 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m01:56:28.847385 [debug] [Thread-1 (]: Using duckdb connection "test.ecommerce_analytics.not_null_stg_customers_customer_id.e2cfb1f9aa"
[0m01:56:28.849152 [debug] [Thread-1 (]: On test.ecommerce_analytics.not_null_stg_customers_customer_id.e2cfb1f9aa: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "ecommerce_analytics", "target_name": "dev", "node_id": "test.ecommerce_analytics.not_null_stg_customers_customer_id.e2cfb1f9aa"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select customer_id
from "dev"."main"."stg_customers"
where customer_id is null



  
  
      
    ) dbt_internal_test
[0m01:56:28.850290 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m01:56:28.853981 [debug] [Thread-1 (]: On test.ecommerce_analytics.not_null_stg_customers_customer_id.e2cfb1f9aa: ROLLBACK
[0m01:56:28.853981 [debug] [Thread-1 (]: Failed to rollback 'test.ecommerce_analytics.not_null_stg_customers_customer_id.e2cfb1f9aa'
[0m01:56:28.853981 [debug] [Thread-1 (]: On test.ecommerce_analytics.not_null_stg_customers_customer_id.e2cfb1f9aa: Close
[0m01:56:28.856497 [info ] [Thread-1 (]: 13 of 28 PASS not_null_stg_customers_customer_id ............................... [[32mPASS[0m in 0.02s]
[0m01:56:28.857658 [debug] [Thread-1 (]: Finished running node test.ecommerce_analytics.not_null_stg_customers_customer_id.e2cfb1f9aa
[0m01:56:28.857658 [debug] [Thread-1 (]: Began running node test.ecommerce_analytics.not_null_stg_orders_customer_id.af79d5e4b5
[0m01:56:28.859196 [info ] [Thread-1 (]: 14 of 28 START test not_null_stg_orders_customer_id ............................ [RUN]
[0m01:56:28.859196 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.ecommerce_analytics.not_null_stg_customers_customer_id.e2cfb1f9aa, now test.ecommerce_analytics.not_null_stg_orders_customer_id.af79d5e4b5)
[0m01:56:28.861203 [debug] [Thread-1 (]: Began compiling node test.ecommerce_analytics.not_null_stg_orders_customer_id.af79d5e4b5
[0m01:56:28.864368 [debug] [Thread-1 (]: Writing injected SQL for node "test.ecommerce_analytics.not_null_stg_orders_customer_id.af79d5e4b5"
[0m01:56:28.867985 [debug] [Thread-1 (]: Began executing node test.ecommerce_analytics.not_null_stg_orders_customer_id.af79d5e4b5
[0m01:56:28.870912 [debug] [Thread-1 (]: Writing runtime sql for node "test.ecommerce_analytics.not_null_stg_orders_customer_id.af79d5e4b5"
[0m01:56:28.870912 [debug] [Thread-1 (]: Using duckdb connection "test.ecommerce_analytics.not_null_stg_orders_customer_id.af79d5e4b5"
[0m01:56:28.870912 [debug] [Thread-1 (]: On test.ecommerce_analytics.not_null_stg_orders_customer_id.af79d5e4b5: BEGIN
[0m01:56:28.877474 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:56:28.878572 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m01:56:28.879157 [debug] [Thread-1 (]: Using duckdb connection "test.ecommerce_analytics.not_null_stg_orders_customer_id.af79d5e4b5"
[0m01:56:28.879157 [debug] [Thread-1 (]: On test.ecommerce_analytics.not_null_stg_orders_customer_id.af79d5e4b5: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "ecommerce_analytics", "target_name": "dev", "node_id": "test.ecommerce_analytics.not_null_stg_orders_customer_id.af79d5e4b5"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select customer_id
from "dev"."main"."stg_orders"
where customer_id is null



  
  
      
    ) dbt_internal_test
[0m01:56:28.881664 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m01:56:28.885296 [debug] [Thread-1 (]: On test.ecommerce_analytics.not_null_stg_orders_customer_id.af79d5e4b5: ROLLBACK
[0m01:56:28.885296 [debug] [Thread-1 (]: Failed to rollback 'test.ecommerce_analytics.not_null_stg_orders_customer_id.af79d5e4b5'
[0m01:56:28.885296 [debug] [Thread-1 (]: On test.ecommerce_analytics.not_null_stg_orders_customer_id.af79d5e4b5: Close
[0m01:56:28.885296 [info ] [Thread-1 (]: 14 of 28 PASS not_null_stg_orders_customer_id .................................. [[32mPASS[0m in 0.03s]
[0m01:56:28.888850 [debug] [Thread-1 (]: Finished running node test.ecommerce_analytics.not_null_stg_orders_customer_id.af79d5e4b5
[0m01:56:28.888850 [debug] [Thread-1 (]: Began running node test.ecommerce_analytics.not_null_stg_orders_order_id.81cfe2fe64
[0m01:56:28.888850 [info ] [Thread-1 (]: 15 of 28 START test not_null_stg_orders_order_id ............................... [RUN]
[0m01:56:28.888850 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.ecommerce_analytics.not_null_stg_orders_customer_id.af79d5e4b5, now test.ecommerce_analytics.not_null_stg_orders_order_id.81cfe2fe64)
[0m01:56:28.888850 [debug] [Thread-1 (]: Began compiling node test.ecommerce_analytics.not_null_stg_orders_order_id.81cfe2fe64
[0m01:56:28.899327 [debug] [Thread-1 (]: Writing injected SQL for node "test.ecommerce_analytics.not_null_stg_orders_order_id.81cfe2fe64"
[0m01:56:28.901671 [debug] [Thread-1 (]: Began executing node test.ecommerce_analytics.not_null_stg_orders_order_id.81cfe2fe64
[0m01:56:28.906957 [debug] [Thread-1 (]: Writing runtime sql for node "test.ecommerce_analytics.not_null_stg_orders_order_id.81cfe2fe64"
[0m01:56:28.906957 [debug] [Thread-1 (]: Using duckdb connection "test.ecommerce_analytics.not_null_stg_orders_order_id.81cfe2fe64"
[0m01:56:28.909754 [debug] [Thread-1 (]: On test.ecommerce_analytics.not_null_stg_orders_order_id.81cfe2fe64: BEGIN
[0m01:56:28.910440 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:56:28.910440 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m01:56:28.910440 [debug] [Thread-1 (]: Using duckdb connection "test.ecommerce_analytics.not_null_stg_orders_order_id.81cfe2fe64"
[0m01:56:28.912643 [debug] [Thread-1 (]: On test.ecommerce_analytics.not_null_stg_orders_order_id.81cfe2fe64: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "ecommerce_analytics", "target_name": "dev", "node_id": "test.ecommerce_analytics.not_null_stg_orders_order_id.81cfe2fe64"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select order_id
from "dev"."main"."stg_orders"
where order_id is null



  
  
      
    ) dbt_internal_test
[0m01:56:28.915728 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m01:56:28.916539 [debug] [Thread-1 (]: On test.ecommerce_analytics.not_null_stg_orders_order_id.81cfe2fe64: ROLLBACK
[0m01:56:28.916539 [debug] [Thread-1 (]: Failed to rollback 'test.ecommerce_analytics.not_null_stg_orders_order_id.81cfe2fe64'
[0m01:56:28.916539 [debug] [Thread-1 (]: On test.ecommerce_analytics.not_null_stg_orders_order_id.81cfe2fe64: Close
[0m01:56:28.919919 [info ] [Thread-1 (]: 15 of 28 PASS not_null_stg_orders_order_id ..................................... [[32mPASS[0m in 0.03s]
[0m01:56:28.921008 [debug] [Thread-1 (]: Finished running node test.ecommerce_analytics.not_null_stg_orders_order_id.81cfe2fe64
[0m01:56:28.921008 [debug] [Thread-1 (]: Began running node test.ecommerce_analytics.not_null_stg_orders_total_amount.f31d98d41b
[0m01:56:28.921008 [info ] [Thread-1 (]: 16 of 28 START test not_null_stg_orders_total_amount ........................... [RUN]
[0m01:56:28.921008 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.ecommerce_analytics.not_null_stg_orders_order_id.81cfe2fe64, now test.ecommerce_analytics.not_null_stg_orders_total_amount.f31d98d41b)
[0m01:56:28.921008 [debug] [Thread-1 (]: Began compiling node test.ecommerce_analytics.not_null_stg_orders_total_amount.f31d98d41b
[0m01:56:28.921008 [debug] [Thread-1 (]: Writing injected SQL for node "test.ecommerce_analytics.not_null_stg_orders_total_amount.f31d98d41b"
[0m01:56:28.921008 [debug] [Thread-1 (]: Began executing node test.ecommerce_analytics.not_null_stg_orders_total_amount.f31d98d41b
[0m01:56:28.933036 [debug] [Thread-1 (]: Writing runtime sql for node "test.ecommerce_analytics.not_null_stg_orders_total_amount.f31d98d41b"
[0m01:56:28.933036 [debug] [Thread-1 (]: Using duckdb connection "test.ecommerce_analytics.not_null_stg_orders_total_amount.f31d98d41b"
[0m01:56:28.933036 [debug] [Thread-1 (]: On test.ecommerce_analytics.not_null_stg_orders_total_amount.f31d98d41b: BEGIN
[0m01:56:28.933036 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:56:28.933036 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m01:56:28.937198 [debug] [Thread-1 (]: Using duckdb connection "test.ecommerce_analytics.not_null_stg_orders_total_amount.f31d98d41b"
[0m01:56:28.937198 [debug] [Thread-1 (]: On test.ecommerce_analytics.not_null_stg_orders_total_amount.f31d98d41b: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "ecommerce_analytics", "target_name": "dev", "node_id": "test.ecommerce_analytics.not_null_stg_orders_total_amount.f31d98d41b"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select total_amount
from "dev"."main"."stg_orders"
where total_amount is null



  
  
      
    ) dbt_internal_test
[0m01:56:28.937198 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m01:56:28.940378 [debug] [Thread-1 (]: On test.ecommerce_analytics.not_null_stg_orders_total_amount.f31d98d41b: ROLLBACK
[0m01:56:28.940378 [debug] [Thread-1 (]: Failed to rollback 'test.ecommerce_analytics.not_null_stg_orders_total_amount.f31d98d41b'
[0m01:56:28.940378 [debug] [Thread-1 (]: On test.ecommerce_analytics.not_null_stg_orders_total_amount.f31d98d41b: Close
[0m01:56:28.940378 [info ] [Thread-1 (]: 16 of 28 PASS not_null_stg_orders_total_amount ................................. [[32mPASS[0m in 0.02s]
[0m01:56:28.940378 [debug] [Thread-1 (]: Finished running node test.ecommerce_analytics.not_null_stg_orders_total_amount.f31d98d41b
[0m01:56:28.940378 [debug] [Thread-1 (]: Began running node test.ecommerce_analytics.not_null_stg_products_price.2d147627d4
[0m01:56:28.940378 [info ] [Thread-1 (]: 17 of 28 START test not_null_stg_products_price ................................ [RUN]
[0m01:56:28.944823 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.ecommerce_analytics.not_null_stg_orders_total_amount.f31d98d41b, now test.ecommerce_analytics.not_null_stg_products_price.2d147627d4)
[0m01:56:28.944823 [debug] [Thread-1 (]: Began compiling node test.ecommerce_analytics.not_null_stg_products_price.2d147627d4
[0m01:56:28.953037 [debug] [Thread-1 (]: Writing injected SQL for node "test.ecommerce_analytics.not_null_stg_products_price.2d147627d4"
[0m01:56:28.953037 [debug] [Thread-1 (]: Began executing node test.ecommerce_analytics.not_null_stg_products_price.2d147627d4
[0m01:56:28.955279 [debug] [Thread-1 (]: Writing runtime sql for node "test.ecommerce_analytics.not_null_stg_products_price.2d147627d4"
[0m01:56:28.955279 [debug] [Thread-1 (]: Using duckdb connection "test.ecommerce_analytics.not_null_stg_products_price.2d147627d4"
[0m01:56:28.955279 [debug] [Thread-1 (]: On test.ecommerce_analytics.not_null_stg_products_price.2d147627d4: BEGIN
[0m01:56:28.955279 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:56:28.960685 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m01:56:28.961258 [debug] [Thread-1 (]: Using duckdb connection "test.ecommerce_analytics.not_null_stg_products_price.2d147627d4"
[0m01:56:28.961258 [debug] [Thread-1 (]: On test.ecommerce_analytics.not_null_stg_products_price.2d147627d4: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "ecommerce_analytics", "target_name": "dev", "node_id": "test.ecommerce_analytics.not_null_stg_products_price.2d147627d4"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select price
from "dev"."main"."stg_products"
where price is null



  
  
      
    ) dbt_internal_test
[0m01:56:28.964080 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m01:56:28.964080 [debug] [Thread-1 (]: On test.ecommerce_analytics.not_null_stg_products_price.2d147627d4: ROLLBACK
[0m01:56:28.964080 [debug] [Thread-1 (]: Failed to rollback 'test.ecommerce_analytics.not_null_stg_products_price.2d147627d4'
[0m01:56:28.964080 [debug] [Thread-1 (]: On test.ecommerce_analytics.not_null_stg_products_price.2d147627d4: Close
[0m01:56:28.964080 [info ] [Thread-1 (]: 17 of 28 PASS not_null_stg_products_price ...................................... [[32mPASS[0m in 0.02s]
[0m01:56:28.971012 [debug] [Thread-1 (]: Finished running node test.ecommerce_analytics.not_null_stg_products_price.2d147627d4
[0m01:56:28.972699 [debug] [Thread-1 (]: Began running node test.ecommerce_analytics.not_null_stg_products_product_id.6373b0acf3
[0m01:56:28.972699 [info ] [Thread-1 (]: 18 of 28 START test not_null_stg_products_product_id ........................... [RUN]
[0m01:56:28.972699 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.ecommerce_analytics.not_null_stg_products_price.2d147627d4, now test.ecommerce_analytics.not_null_stg_products_product_id.6373b0acf3)
[0m01:56:28.972699 [debug] [Thread-1 (]: Began compiling node test.ecommerce_analytics.not_null_stg_products_product_id.6373b0acf3
[0m01:56:28.984476 [debug] [Thread-1 (]: Writing injected SQL for node "test.ecommerce_analytics.not_null_stg_products_product_id.6373b0acf3"
[0m01:56:28.984476 [debug] [Thread-1 (]: Began executing node test.ecommerce_analytics.not_null_stg_products_product_id.6373b0acf3
[0m01:56:28.991308 [debug] [Thread-1 (]: Writing runtime sql for node "test.ecommerce_analytics.not_null_stg_products_product_id.6373b0acf3"
[0m01:56:28.991308 [debug] [Thread-1 (]: Using duckdb connection "test.ecommerce_analytics.not_null_stg_products_product_id.6373b0acf3"
[0m01:56:28.995194 [debug] [Thread-1 (]: On test.ecommerce_analytics.not_null_stg_products_product_id.6373b0acf3: BEGIN
[0m01:56:28.995194 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:56:28.997848 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m01:56:28.997848 [debug] [Thread-1 (]: Using duckdb connection "test.ecommerce_analytics.not_null_stg_products_product_id.6373b0acf3"
[0m01:56:28.997848 [debug] [Thread-1 (]: On test.ecommerce_analytics.not_null_stg_products_product_id.6373b0acf3: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "ecommerce_analytics", "target_name": "dev", "node_id": "test.ecommerce_analytics.not_null_stg_products_product_id.6373b0acf3"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select product_id
from "dev"."main"."stg_products"
where product_id is null



  
  
      
    ) dbt_internal_test
[0m01:56:29.001608 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m01:56:29.001608 [debug] [Thread-1 (]: On test.ecommerce_analytics.not_null_stg_products_product_id.6373b0acf3: ROLLBACK
[0m01:56:29.001608 [debug] [Thread-1 (]: Failed to rollback 'test.ecommerce_analytics.not_null_stg_products_product_id.6373b0acf3'
[0m01:56:29.012868 [debug] [Thread-1 (]: On test.ecommerce_analytics.not_null_stg_products_product_id.6373b0acf3: Close
[0m01:56:29.014517 [info ] [Thread-1 (]: 18 of 28 PASS not_null_stg_products_product_id ................................. [[32mPASS[0m in 0.04s]
[0m01:56:29.014517 [debug] [Thread-1 (]: Finished running node test.ecommerce_analytics.not_null_stg_products_product_id.6373b0acf3
[0m01:56:29.014517 [debug] [Thread-1 (]: Began running node test.ecommerce_analytics.relationships_fct_orders_customer_id__customer_id__ref_dim_customers_.d5636051d4
[0m01:56:29.014517 [info ] [Thread-1 (]: 19 of 28 START test relationships_fct_orders_customer_id__customer_id__ref_dim_customers_  [RUN]
[0m01:56:29.014517 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.ecommerce_analytics.not_null_stg_products_product_id.6373b0acf3, now test.ecommerce_analytics.relationships_fct_orders_customer_id__customer_id__ref_dim_customers_.d5636051d4)
[0m01:56:29.022092 [debug] [Thread-1 (]: Began compiling node test.ecommerce_analytics.relationships_fct_orders_customer_id__customer_id__ref_dim_customers_.d5636051d4
[0m01:56:29.037395 [debug] [Thread-1 (]: Writing injected SQL for node "test.ecommerce_analytics.relationships_fct_orders_customer_id__customer_id__ref_dim_customers_.d5636051d4"
[0m01:56:29.041439 [debug] [Thread-1 (]: Began executing node test.ecommerce_analytics.relationships_fct_orders_customer_id__customer_id__ref_dim_customers_.d5636051d4
[0m01:56:29.042453 [debug] [Thread-1 (]: Writing runtime sql for node "test.ecommerce_analytics.relationships_fct_orders_customer_id__customer_id__ref_dim_customers_.d5636051d4"
[0m01:56:29.048018 [debug] [Thread-1 (]: Using duckdb connection "test.ecommerce_analytics.relationships_fct_orders_customer_id__customer_id__ref_dim_customers_.d5636051d4"
[0m01:56:29.048018 [debug] [Thread-1 (]: On test.ecommerce_analytics.relationships_fct_orders_customer_id__customer_id__ref_dim_customers_.d5636051d4: BEGIN
[0m01:56:29.049810 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:56:29.049810 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m01:56:29.049810 [debug] [Thread-1 (]: Using duckdb connection "test.ecommerce_analytics.relationships_fct_orders_customer_id__customer_id__ref_dim_customers_.d5636051d4"
[0m01:56:29.052714 [debug] [Thread-1 (]: On test.ecommerce_analytics.relationships_fct_orders_customer_id__customer_id__ref_dim_customers_.d5636051d4: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "ecommerce_analytics", "target_name": "dev", "node_id": "test.ecommerce_analytics.relationships_fct_orders_customer_id__customer_id__ref_dim_customers_.d5636051d4"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with child as (
    select customer_id as from_field
    from "dev"."main"."fct_orders"
    where customer_id is not null
),

parent as (
    select customer_id as to_field
    from "dev"."main"."dim_customers"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



  
  
      
    ) dbt_internal_test
[0m01:56:29.057080 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m01:56:29.057080 [debug] [Thread-1 (]: On test.ecommerce_analytics.relationships_fct_orders_customer_id__customer_id__ref_dim_customers_.d5636051d4: ROLLBACK
[0m01:56:29.057080 [debug] [Thread-1 (]: Failed to rollback 'test.ecommerce_analytics.relationships_fct_orders_customer_id__customer_id__ref_dim_customers_.d5636051d4'
[0m01:56:29.057080 [debug] [Thread-1 (]: On test.ecommerce_analytics.relationships_fct_orders_customer_id__customer_id__ref_dim_customers_.d5636051d4: Close
[0m01:56:29.061425 [info ] [Thread-1 (]: 19 of 28 PASS relationships_fct_orders_customer_id__customer_id__ref_dim_customers_  [[32mPASS[0m in 0.04s]
[0m01:56:29.061425 [debug] [Thread-1 (]: Finished running node test.ecommerce_analytics.relationships_fct_orders_customer_id__customer_id__ref_dim_customers_.d5636051d4
[0m01:56:29.063026 [debug] [Thread-1 (]: Began running node test.ecommerce_analytics.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500
[0m01:56:29.063026 [info ] [Thread-1 (]: 20 of 28 START test relationships_stg_orders_customer_id__customer_id__ref_stg_customers_  [RUN]
[0m01:56:29.064482 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.ecommerce_analytics.relationships_fct_orders_customer_id__customer_id__ref_dim_customers_.d5636051d4, now test.ecommerce_analytics.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500)
[0m01:56:29.064482 [debug] [Thread-1 (]: Began compiling node test.ecommerce_analytics.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500
[0m01:56:29.064482 [debug] [Thread-1 (]: Writing injected SQL for node "test.ecommerce_analytics.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500"
[0m01:56:29.064482 [debug] [Thread-1 (]: Began executing node test.ecommerce_analytics.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500
[0m01:56:29.073176 [debug] [Thread-1 (]: Writing runtime sql for node "test.ecommerce_analytics.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500"
[0m01:56:29.075476 [debug] [Thread-1 (]: Using duckdb connection "test.ecommerce_analytics.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500"
[0m01:56:29.075476 [debug] [Thread-1 (]: On test.ecommerce_analytics.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500: BEGIN
[0m01:56:29.075476 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:56:29.075476 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m01:56:29.075476 [debug] [Thread-1 (]: Using duckdb connection "test.ecommerce_analytics.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500"
[0m01:56:29.075476 [debug] [Thread-1 (]: On test.ecommerce_analytics.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "ecommerce_analytics", "target_name": "dev", "node_id": "test.ecommerce_analytics.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with child as (
    select customer_id as from_field
    from "dev"."main"."stg_orders"
    where customer_id is not null
),

parent as (
    select customer_id as to_field
    from "dev"."main"."stg_customers"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



  
  
      
    ) dbt_internal_test
[0m01:56:29.081069 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m01:56:29.083474 [debug] [Thread-1 (]: On test.ecommerce_analytics.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500: ROLLBACK
[0m01:56:29.085196 [debug] [Thread-1 (]: Failed to rollback 'test.ecommerce_analytics.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500'
[0m01:56:29.085196 [debug] [Thread-1 (]: On test.ecommerce_analytics.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500: Close
[0m01:56:29.085196 [info ] [Thread-1 (]: 20 of 28 PASS relationships_stg_orders_customer_id__customer_id__ref_stg_customers_  [[32mPASS[0m in 0.02s]
[0m01:56:29.085196 [debug] [Thread-1 (]: Finished running node test.ecommerce_analytics.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500
[0m01:56:29.085196 [debug] [Thread-1 (]: Began running node test.ecommerce_analytics.unique_dim_customers_customer_email.8ca8334c57
[0m01:56:29.085196 [info ] [Thread-1 (]: 21 of 28 START test unique_dim_customers_customer_email ........................ [RUN]
[0m01:56:29.085196 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.ecommerce_analytics.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500, now test.ecommerce_analytics.unique_dim_customers_customer_email.8ca8334c57)
[0m01:56:29.085196 [debug] [Thread-1 (]: Began compiling node test.ecommerce_analytics.unique_dim_customers_customer_email.8ca8334c57
[0m01:56:29.093747 [debug] [Thread-1 (]: Writing injected SQL for node "test.ecommerce_analytics.unique_dim_customers_customer_email.8ca8334c57"
[0m01:56:29.095895 [debug] [Thread-1 (]: Began executing node test.ecommerce_analytics.unique_dim_customers_customer_email.8ca8334c57
[0m01:56:29.098090 [debug] [Thread-1 (]: Writing runtime sql for node "test.ecommerce_analytics.unique_dim_customers_customer_email.8ca8334c57"
[0m01:56:29.104321 [debug] [Thread-1 (]: Using duckdb connection "test.ecommerce_analytics.unique_dim_customers_customer_email.8ca8334c57"
[0m01:56:29.104321 [debug] [Thread-1 (]: On test.ecommerce_analytics.unique_dim_customers_customer_email.8ca8334c57: BEGIN
[0m01:56:29.107519 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:56:29.107519 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m01:56:29.110112 [debug] [Thread-1 (]: Using duckdb connection "test.ecommerce_analytics.unique_dim_customers_customer_email.8ca8334c57"
[0m01:56:29.110112 [debug] [Thread-1 (]: On test.ecommerce_analytics.unique_dim_customers_customer_email.8ca8334c57: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "ecommerce_analytics", "target_name": "dev", "node_id": "test.ecommerce_analytics.unique_dim_customers_customer_email.8ca8334c57"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    customer_email as unique_field,
    count(*) as n_records

from "dev"."main"."dim_customers"
where customer_email is not null
group by customer_email
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m01:56:29.115687 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m01:56:29.115687 [debug] [Thread-1 (]: On test.ecommerce_analytics.unique_dim_customers_customer_email.8ca8334c57: ROLLBACK
[0m01:56:29.115687 [debug] [Thread-1 (]: Failed to rollback 'test.ecommerce_analytics.unique_dim_customers_customer_email.8ca8334c57'
[0m01:56:29.115687 [debug] [Thread-1 (]: On test.ecommerce_analytics.unique_dim_customers_customer_email.8ca8334c57: Close
[0m01:56:29.115687 [info ] [Thread-1 (]: 21 of 28 PASS unique_dim_customers_customer_email .............................. [[32mPASS[0m in 0.03s]
[0m01:56:29.115687 [debug] [Thread-1 (]: Finished running node test.ecommerce_analytics.unique_dim_customers_customer_email.8ca8334c57
[0m01:56:29.115687 [debug] [Thread-1 (]: Began running node test.ecommerce_analytics.unique_dim_customers_customer_id.15c9f1e2fd
[0m01:56:29.115687 [info ] [Thread-1 (]: 22 of 28 START test unique_dim_customers_customer_id ........................... [RUN]
[0m01:56:29.115687 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.ecommerce_analytics.unique_dim_customers_customer_email.8ca8334c57, now test.ecommerce_analytics.unique_dim_customers_customer_id.15c9f1e2fd)
[0m01:56:29.115687 [debug] [Thread-1 (]: Began compiling node test.ecommerce_analytics.unique_dim_customers_customer_id.15c9f1e2fd
[0m01:56:29.130367 [debug] [Thread-1 (]: Writing injected SQL for node "test.ecommerce_analytics.unique_dim_customers_customer_id.15c9f1e2fd"
[0m01:56:29.133170 [debug] [Thread-1 (]: Began executing node test.ecommerce_analytics.unique_dim_customers_customer_id.15c9f1e2fd
[0m01:56:29.137456 [debug] [Thread-1 (]: Writing runtime sql for node "test.ecommerce_analytics.unique_dim_customers_customer_id.15c9f1e2fd"
[0m01:56:29.137456 [debug] [Thread-1 (]: Using duckdb connection "test.ecommerce_analytics.unique_dim_customers_customer_id.15c9f1e2fd"
[0m01:56:29.145471 [debug] [Thread-1 (]: On test.ecommerce_analytics.unique_dim_customers_customer_id.15c9f1e2fd: BEGIN
[0m01:56:29.146143 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:56:29.147700 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m01:56:29.147700 [debug] [Thread-1 (]: Using duckdb connection "test.ecommerce_analytics.unique_dim_customers_customer_id.15c9f1e2fd"
[0m01:56:29.149604 [debug] [Thread-1 (]: On test.ecommerce_analytics.unique_dim_customers_customer_id.15c9f1e2fd: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "ecommerce_analytics", "target_name": "dev", "node_id": "test.ecommerce_analytics.unique_dim_customers_customer_id.15c9f1e2fd"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    customer_id as unique_field,
    count(*) as n_records

from "dev"."main"."dim_customers"
where customer_id is not null
group by customer_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m01:56:29.149604 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m01:56:29.153708 [debug] [Thread-1 (]: On test.ecommerce_analytics.unique_dim_customers_customer_id.15c9f1e2fd: ROLLBACK
[0m01:56:29.153708 [debug] [Thread-1 (]: Failed to rollback 'test.ecommerce_analytics.unique_dim_customers_customer_id.15c9f1e2fd'
[0m01:56:29.153708 [debug] [Thread-1 (]: On test.ecommerce_analytics.unique_dim_customers_customer_id.15c9f1e2fd: Close
[0m01:56:29.155757 [info ] [Thread-1 (]: 22 of 28 PASS unique_dim_customers_customer_id ................................. [[32mPASS[0m in 0.04s]
[0m01:56:29.155757 [debug] [Thread-1 (]: Finished running node test.ecommerce_analytics.unique_dim_customers_customer_id.15c9f1e2fd
[0m01:56:29.155757 [debug] [Thread-1 (]: Began running node test.ecommerce_analytics.unique_dim_products_product_id.ef7b2a9985
[0m01:56:29.155757 [info ] [Thread-1 (]: 23 of 28 START test unique_dim_products_product_id ............................. [RUN]
[0m01:56:29.155757 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.ecommerce_analytics.unique_dim_customers_customer_id.15c9f1e2fd, now test.ecommerce_analytics.unique_dim_products_product_id.ef7b2a9985)
[0m01:56:29.155757 [debug] [Thread-1 (]: Began compiling node test.ecommerce_analytics.unique_dim_products_product_id.ef7b2a9985
[0m01:56:29.162545 [debug] [Thread-1 (]: Writing injected SQL for node "test.ecommerce_analytics.unique_dim_products_product_id.ef7b2a9985"
[0m01:56:29.162545 [debug] [Thread-1 (]: Began executing node test.ecommerce_analytics.unique_dim_products_product_id.ef7b2a9985
[0m01:56:29.170661 [debug] [Thread-1 (]: Writing runtime sql for node "test.ecommerce_analytics.unique_dim_products_product_id.ef7b2a9985"
[0m01:56:29.170661 [debug] [Thread-1 (]: Using duckdb connection "test.ecommerce_analytics.unique_dim_products_product_id.ef7b2a9985"
[0m01:56:29.170661 [debug] [Thread-1 (]: On test.ecommerce_analytics.unique_dim_products_product_id.ef7b2a9985: BEGIN
[0m01:56:29.170661 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:56:29.170661 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m01:56:29.170661 [debug] [Thread-1 (]: Using duckdb connection "test.ecommerce_analytics.unique_dim_products_product_id.ef7b2a9985"
[0m01:56:29.176543 [debug] [Thread-1 (]: On test.ecommerce_analytics.unique_dim_products_product_id.ef7b2a9985: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "ecommerce_analytics", "target_name": "dev", "node_id": "test.ecommerce_analytics.unique_dim_products_product_id.ef7b2a9985"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    product_id as unique_field,
    count(*) as n_records

from "dev"."main"."dim_products"
where product_id is not null
group by product_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m01:56:29.176543 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m01:56:29.180546 [debug] [Thread-1 (]: On test.ecommerce_analytics.unique_dim_products_product_id.ef7b2a9985: ROLLBACK
[0m01:56:29.181089 [debug] [Thread-1 (]: Failed to rollback 'test.ecommerce_analytics.unique_dim_products_product_id.ef7b2a9985'
[0m01:56:29.181089 [debug] [Thread-1 (]: On test.ecommerce_analytics.unique_dim_products_product_id.ef7b2a9985: Close
[0m01:56:29.183512 [info ] [Thread-1 (]: 23 of 28 PASS unique_dim_products_product_id ................................... [[32mPASS[0m in 0.03s]
[0m01:56:29.183512 [debug] [Thread-1 (]: Finished running node test.ecommerce_analytics.unique_dim_products_product_id.ef7b2a9985
[0m01:56:29.185521 [debug] [Thread-1 (]: Began running node test.ecommerce_analytics.unique_fct_orders_order_id.523ddb6ce5
[0m01:56:29.185521 [info ] [Thread-1 (]: 24 of 28 START test unique_fct_orders_order_id ................................. [RUN]
[0m01:56:29.187031 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.ecommerce_analytics.unique_dim_products_product_id.ef7b2a9985, now test.ecommerce_analytics.unique_fct_orders_order_id.523ddb6ce5)
[0m01:56:29.187031 [debug] [Thread-1 (]: Began compiling node test.ecommerce_analytics.unique_fct_orders_order_id.523ddb6ce5
[0m01:56:29.187031 [debug] [Thread-1 (]: Writing injected SQL for node "test.ecommerce_analytics.unique_fct_orders_order_id.523ddb6ce5"
[0m01:56:29.187031 [debug] [Thread-1 (]: Began executing node test.ecommerce_analytics.unique_fct_orders_order_id.523ddb6ce5
[0m01:56:29.199286 [debug] [Thread-1 (]: Writing runtime sql for node "test.ecommerce_analytics.unique_fct_orders_order_id.523ddb6ce5"
[0m01:56:29.200653 [debug] [Thread-1 (]: Using duckdb connection "test.ecommerce_analytics.unique_fct_orders_order_id.523ddb6ce5"
[0m01:56:29.200653 [debug] [Thread-1 (]: On test.ecommerce_analytics.unique_fct_orders_order_id.523ddb6ce5: BEGIN
[0m01:56:29.200653 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:56:29.204261 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m01:56:29.204261 [debug] [Thread-1 (]: Using duckdb connection "test.ecommerce_analytics.unique_fct_orders_order_id.523ddb6ce5"
[0m01:56:29.204261 [debug] [Thread-1 (]: On test.ecommerce_analytics.unique_fct_orders_order_id.523ddb6ce5: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "ecommerce_analytics", "target_name": "dev", "node_id": "test.ecommerce_analytics.unique_fct_orders_order_id.523ddb6ce5"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    order_id as unique_field,
    count(*) as n_records

from "dev"."main"."fct_orders"
where order_id is not null
group by order_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m01:56:29.207883 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m01:56:29.207883 [debug] [Thread-1 (]: On test.ecommerce_analytics.unique_fct_orders_order_id.523ddb6ce5: ROLLBACK
[0m01:56:29.207883 [debug] [Thread-1 (]: Failed to rollback 'test.ecommerce_analytics.unique_fct_orders_order_id.523ddb6ce5'
[0m01:56:29.207883 [debug] [Thread-1 (]: On test.ecommerce_analytics.unique_fct_orders_order_id.523ddb6ce5: Close
[0m01:56:29.207883 [info ] [Thread-1 (]: 24 of 28 PASS unique_fct_orders_order_id ....................................... [[32mPASS[0m in 0.02s]
[0m01:56:29.215513 [debug] [Thread-1 (]: Finished running node test.ecommerce_analytics.unique_fct_orders_order_id.523ddb6ce5
[0m01:56:29.217112 [debug] [Thread-1 (]: Began running node test.ecommerce_analytics.unique_stg_customers_customer_email.1a5cbb3bc8
[0m01:56:29.218119 [info ] [Thread-1 (]: 25 of 28 START test unique_stg_customers_customer_email ........................ [RUN]
[0m01:56:29.218119 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.ecommerce_analytics.unique_fct_orders_order_id.523ddb6ce5, now test.ecommerce_analytics.unique_stg_customers_customer_email.1a5cbb3bc8)
[0m01:56:29.218119 [debug] [Thread-1 (]: Began compiling node test.ecommerce_analytics.unique_stg_customers_customer_email.1a5cbb3bc8
[0m01:56:29.220830 [debug] [Thread-1 (]: Writing injected SQL for node "test.ecommerce_analytics.unique_stg_customers_customer_email.1a5cbb3bc8"
[0m01:56:29.220830 [debug] [Thread-1 (]: Began executing node test.ecommerce_analytics.unique_stg_customers_customer_email.1a5cbb3bc8
[0m01:56:29.227630 [debug] [Thread-1 (]: Writing runtime sql for node "test.ecommerce_analytics.unique_stg_customers_customer_email.1a5cbb3bc8"
[0m01:56:29.229125 [debug] [Thread-1 (]: Using duckdb connection "test.ecommerce_analytics.unique_stg_customers_customer_email.1a5cbb3bc8"
[0m01:56:29.229125 [debug] [Thread-1 (]: On test.ecommerce_analytics.unique_stg_customers_customer_email.1a5cbb3bc8: BEGIN
[0m01:56:29.229125 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:56:29.231853 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m01:56:29.231853 [debug] [Thread-1 (]: Using duckdb connection "test.ecommerce_analytics.unique_stg_customers_customer_email.1a5cbb3bc8"
[0m01:56:29.231853 [debug] [Thread-1 (]: On test.ecommerce_analytics.unique_stg_customers_customer_email.1a5cbb3bc8: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "ecommerce_analytics", "target_name": "dev", "node_id": "test.ecommerce_analytics.unique_stg_customers_customer_email.1a5cbb3bc8"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    customer_email as unique_field,
    count(*) as n_records

from "dev"."main"."stg_customers"
where customer_email is not null
group by customer_email
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m01:56:29.231853 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m01:56:29.237485 [debug] [Thread-1 (]: On test.ecommerce_analytics.unique_stg_customers_customer_email.1a5cbb3bc8: ROLLBACK
[0m01:56:29.239096 [debug] [Thread-1 (]: Failed to rollback 'test.ecommerce_analytics.unique_stg_customers_customer_email.1a5cbb3bc8'
[0m01:56:29.239096 [debug] [Thread-1 (]: On test.ecommerce_analytics.unique_stg_customers_customer_email.1a5cbb3bc8: Close
[0m01:56:29.239096 [info ] [Thread-1 (]: 25 of 28 PASS unique_stg_customers_customer_email .............................. [[32mPASS[0m in 0.02s]
[0m01:56:29.239096 [debug] [Thread-1 (]: Finished running node test.ecommerce_analytics.unique_stg_customers_customer_email.1a5cbb3bc8
[0m01:56:29.239096 [debug] [Thread-1 (]: Began running node test.ecommerce_analytics.unique_stg_customers_customer_id.c7614daada
[0m01:56:29.239096 [info ] [Thread-1 (]: 26 of 28 START test unique_stg_customers_customer_id ........................... [RUN]
[0m01:56:29.243007 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.ecommerce_analytics.unique_stg_customers_customer_email.1a5cbb3bc8, now test.ecommerce_analytics.unique_stg_customers_customer_id.c7614daada)
[0m01:56:29.243007 [debug] [Thread-1 (]: Began compiling node test.ecommerce_analytics.unique_stg_customers_customer_id.c7614daada
[0m01:56:29.251880 [debug] [Thread-1 (]: Writing injected SQL for node "test.ecommerce_analytics.unique_stg_customers_customer_id.c7614daada"
[0m01:56:29.253892 [debug] [Thread-1 (]: Began executing node test.ecommerce_analytics.unique_stg_customers_customer_id.c7614daada
[0m01:56:29.257785 [debug] [Thread-1 (]: Writing runtime sql for node "test.ecommerce_analytics.unique_stg_customers_customer_id.c7614daada"
[0m01:56:29.260341 [debug] [Thread-1 (]: Using duckdb connection "test.ecommerce_analytics.unique_stg_customers_customer_id.c7614daada"
[0m01:56:29.261367 [debug] [Thread-1 (]: On test.ecommerce_analytics.unique_stg_customers_customer_id.c7614daada: BEGIN
[0m01:56:29.262505 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:56:29.262505 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m01:56:29.262505 [debug] [Thread-1 (]: Using duckdb connection "test.ecommerce_analytics.unique_stg_customers_customer_id.c7614daada"
[0m01:56:29.262505 [debug] [Thread-1 (]: On test.ecommerce_analytics.unique_stg_customers_customer_id.c7614daada: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "ecommerce_analytics", "target_name": "dev", "node_id": "test.ecommerce_analytics.unique_stg_customers_customer_id.c7614daada"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    customer_id as unique_field,
    count(*) as n_records

from "dev"."main"."stg_customers"
where customer_id is not null
group by customer_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m01:56:29.265585 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m01:56:29.265585 [debug] [Thread-1 (]: On test.ecommerce_analytics.unique_stg_customers_customer_id.c7614daada: ROLLBACK
[0m01:56:29.269486 [debug] [Thread-1 (]: Failed to rollback 'test.ecommerce_analytics.unique_stg_customers_customer_id.c7614daada'
[0m01:56:29.270549 [debug] [Thread-1 (]: On test.ecommerce_analytics.unique_stg_customers_customer_id.c7614daada: Close
[0m01:56:29.270549 [info ] [Thread-1 (]: 26 of 28 PASS unique_stg_customers_customer_id ................................. [[32mPASS[0m in 0.03s]
[0m01:56:29.270549 [debug] [Thread-1 (]: Finished running node test.ecommerce_analytics.unique_stg_customers_customer_id.c7614daada
[0m01:56:29.270549 [debug] [Thread-1 (]: Began running node test.ecommerce_analytics.unique_stg_orders_order_id.e3b841c71a
[0m01:56:29.270549 [info ] [Thread-1 (]: 27 of 28 START test unique_stg_orders_order_id ................................. [RUN]
[0m01:56:29.270549 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.ecommerce_analytics.unique_stg_customers_customer_id.c7614daada, now test.ecommerce_analytics.unique_stg_orders_order_id.e3b841c71a)
[0m01:56:29.270549 [debug] [Thread-1 (]: Began compiling node test.ecommerce_analytics.unique_stg_orders_order_id.e3b841c71a
[0m01:56:29.281119 [debug] [Thread-1 (]: Writing injected SQL for node "test.ecommerce_analytics.unique_stg_orders_order_id.e3b841c71a"
[0m01:56:29.282193 [debug] [Thread-1 (]: Began executing node test.ecommerce_analytics.unique_stg_orders_order_id.e3b841c71a
[0m01:56:29.287400 [debug] [Thread-1 (]: Writing runtime sql for node "test.ecommerce_analytics.unique_stg_orders_order_id.e3b841c71a"
[0m01:56:29.289008 [debug] [Thread-1 (]: Using duckdb connection "test.ecommerce_analytics.unique_stg_orders_order_id.e3b841c71a"
[0m01:56:29.289008 [debug] [Thread-1 (]: On test.ecommerce_analytics.unique_stg_orders_order_id.e3b841c71a: BEGIN
[0m01:56:29.291518 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:56:29.291518 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m01:56:29.291518 [debug] [Thread-1 (]: Using duckdb connection "test.ecommerce_analytics.unique_stg_orders_order_id.e3b841c71a"
[0m01:56:29.291518 [debug] [Thread-1 (]: On test.ecommerce_analytics.unique_stg_orders_order_id.e3b841c71a: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "ecommerce_analytics", "target_name": "dev", "node_id": "test.ecommerce_analytics.unique_stg_orders_order_id.e3b841c71a"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    order_id as unique_field,
    count(*) as n_records

from "dev"."main"."stg_orders"
where order_id is not null
group by order_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m01:56:29.296959 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m01:56:29.298916 [debug] [Thread-1 (]: On test.ecommerce_analytics.unique_stg_orders_order_id.e3b841c71a: ROLLBACK
[0m01:56:29.302958 [debug] [Thread-1 (]: Failed to rollback 'test.ecommerce_analytics.unique_stg_orders_order_id.e3b841c71a'
[0m01:56:29.302958 [debug] [Thread-1 (]: On test.ecommerce_analytics.unique_stg_orders_order_id.e3b841c71a: Close
[0m01:56:29.303986 [info ] [Thread-1 (]: 27 of 28 PASS unique_stg_orders_order_id ....................................... [[32mPASS[0m in 0.03s]
[0m01:56:29.303986 [debug] [Thread-1 (]: Finished running node test.ecommerce_analytics.unique_stg_orders_order_id.e3b841c71a
[0m01:56:29.303986 [debug] [Thread-1 (]: Began running node test.ecommerce_analytics.unique_stg_products_product_id.7d950a1467
[0m01:56:29.307352 [info ] [Thread-1 (]: 28 of 28 START test unique_stg_products_product_id ............................. [RUN]
[0m01:56:29.307352 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.ecommerce_analytics.unique_stg_orders_order_id.e3b841c71a, now test.ecommerce_analytics.unique_stg_products_product_id.7d950a1467)
[0m01:56:29.307352 [debug] [Thread-1 (]: Began compiling node test.ecommerce_analytics.unique_stg_products_product_id.7d950a1467
[0m01:56:29.316880 [debug] [Thread-1 (]: Writing injected SQL for node "test.ecommerce_analytics.unique_stg_products_product_id.7d950a1467"
[0m01:56:29.316880 [debug] [Thread-1 (]: Began executing node test.ecommerce_analytics.unique_stg_products_product_id.7d950a1467
[0m01:56:29.323061 [debug] [Thread-1 (]: Writing runtime sql for node "test.ecommerce_analytics.unique_stg_products_product_id.7d950a1467"
[0m01:56:29.323061 [debug] [Thread-1 (]: Using duckdb connection "test.ecommerce_analytics.unique_stg_products_product_id.7d950a1467"
[0m01:56:29.323061 [debug] [Thread-1 (]: On test.ecommerce_analytics.unique_stg_products_product_id.7d950a1467: BEGIN
[0m01:56:29.323061 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:56:29.327189 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m01:56:29.329136 [debug] [Thread-1 (]: Using duckdb connection "test.ecommerce_analytics.unique_stg_products_product_id.7d950a1467"
[0m01:56:29.329136 [debug] [Thread-1 (]: On test.ecommerce_analytics.unique_stg_products_product_id.7d950a1467: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "ecommerce_analytics", "target_name": "dev", "node_id": "test.ecommerce_analytics.unique_stg_products_product_id.7d950a1467"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    product_id as unique_field,
    count(*) as n_records

from "dev"."main"."stg_products"
where product_id is not null
group by product_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m01:56:29.332794 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m01:56:29.332794 [debug] [Thread-1 (]: On test.ecommerce_analytics.unique_stg_products_product_id.7d950a1467: ROLLBACK
[0m01:56:29.332794 [debug] [Thread-1 (]: Failed to rollback 'test.ecommerce_analytics.unique_stg_products_product_id.7d950a1467'
[0m01:56:29.332794 [debug] [Thread-1 (]: On test.ecommerce_analytics.unique_stg_products_product_id.7d950a1467: Close
[0m01:56:29.332794 [info ] [Thread-1 (]: 28 of 28 PASS unique_stg_products_product_id ................................... [[32mPASS[0m in 0.03s]
[0m01:56:29.342981 [debug] [Thread-1 (]: Finished running node test.ecommerce_analytics.unique_stg_products_product_id.7d950a1467
[0m01:56:29.345808 [debug] [MainThread]: Using duckdb connection "master"
[0m01:56:29.347775 [debug] [MainThread]: On master: BEGIN
[0m01:56:29.348349 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m01:56:29.348349 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m01:56:29.348349 [debug] [MainThread]: On master: COMMIT
[0m01:56:29.348349 [debug] [MainThread]: Using duckdb connection "master"
[0m01:56:29.348349 [debug] [MainThread]: On master: COMMIT
[0m01:56:29.353253 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m01:56:29.353253 [debug] [MainThread]: On master: Close
[0m01:56:29.353253 [debug] [MainThread]: Connection 'master' was properly closed.
[0m01:56:29.355353 [debug] [MainThread]: Connection 'list_dev_main' was properly closed.
[0m01:56:29.355353 [debug] [MainThread]: Connection 'test.ecommerce_analytics.unique_stg_products_product_id.7d950a1467' was properly closed.
[0m01:56:29.355353 [info ] [MainThread]: 
[0m01:56:29.355353 [info ] [MainThread]: Finished running 28 data tests in 0 hours 0 minutes and 1.18 seconds (1.18s).
[0m01:56:29.365114 [debug] [MainThread]: Command end result
[0m01:56:29.426088 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\Lenovo\Desktop\Proyectos\dbt-proyect\ecommerce_analytics\target\manifest.json
[0m01:56:29.429460 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\Lenovo\Desktop\Proyectos\dbt-proyect\ecommerce_analytics\target\semantic_manifest.json
[0m01:56:29.436429 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\Lenovo\Desktop\Proyectos\dbt-proyect\ecommerce_analytics\target\run_results.json
[0m01:56:29.436429 [info ] [MainThread]: 
[0m01:56:29.436429 [info ] [MainThread]: [32mCompleted successfully[0m
[0m01:56:29.436429 [info ] [MainThread]: 
[0m01:56:29.436429 [info ] [MainThread]: Done. PASS=28 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=28
[0m01:56:29.436429 [debug] [MainThread]: Command `dbt test` succeeded at 01:56:29.436429 after 2.48 seconds
[0m01:56:29.444812 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CAC182A950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CAC1540C10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CAC1542A90>]}
[0m01:56:29.444812 [debug] [MainThread]: Flushing usage events
[0m01:56:31.262086 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m01:56:39.474120 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C8BE42E0D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C8BE42E250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C8BE42C2D0>]}


============================== 01:56:39.475640 | a719fa38-0b5b-4456-8b9b-0428abebbe24 ==============================
[0m01:56:39.475640 [info ] [MainThread]: Running with dbt=1.11.2
[0m01:56:39.475640 [debug] [MainThread]: running dbt with arguments {'version_check': 'True', 'no_print': 'None', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'target_path': 'None', 'printer_width': '80', 'write_json': 'True', 'empty': 'None', 'log_cache_events': 'False', 'introspect': 'True', 'cache_selected_only': 'False', 'log_format': 'default', 'debug': 'False', 'fail_fast': 'False', 'partial_parse': 'True', 'send_anonymous_usage_stats': 'True', 'quiet': 'False', 'warn_error': 'None', 'profiles_dir': 'C:\\Users\\Lenovo\\.dbt', 'invocation_command': 'dbt docs generate', 'indirect_selection': 'eager', 'use_colors': 'True', 'use_experimental_parser': 'False', 'log_path': 'C:\\Users\\Lenovo\\Desktop\\Proyectos\\dbt-proyect\\ecommerce_analytics\\logs'}
[0m01:56:39.712764 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a719fa38-0b5b-4456-8b9b-0428abebbe24', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C8BE4D3BD0>]}
[0m01:56:39.781319 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a719fa38-0b5b-4456-8b9b-0428abebbe24', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C8BAE36D10>]}
[0m01:56:39.785607 [info ] [MainThread]: Registered adapter: duckdb=1.10.0
[0m01:56:40.017055 [debug] [MainThread]: checksum: 3d40d8bbe1bef07db1c24822f2dbfff8bc07f2a48ed4fe2658a40653aec0b54b, vars: {}, profile: , target: , version: 1.11.2
[0m01:56:40.181777 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m01:56:40.181777 [debug] [MainThread]: Nothing changed, skipping partial parsing.
[0m01:56:40.181777 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m01:56:40.244145 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a719fa38-0b5b-4456-8b9b-0428abebbe24', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C8BF8FBD50>]}
[0m01:56:40.290793 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a719fa38-0b5b-4456-8b9b-0428abebbe24', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C8BFC4BD90>]}
[0m01:56:40.290793 [info ] [MainThread]: Found 3 seeds, 7 models, 28 data tests, 587 macros
[0m01:56:40.295486 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a719fa38-0b5b-4456-8b9b-0428abebbe24', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C8BF8BCE90>]}
[0m01:56:40.299351 [info ] [MainThread]: 
[0m01:56:40.299351 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m01:56:40.299351 [info ] [MainThread]: 
[0m01:56:40.302247 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m01:56:40.310425 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_dev_main'
[0m01:56:40.448711 [debug] [ThreadPool]: Using duckdb connection "list_dev_main"
[0m01:56:40.448711 [debug] [ThreadPool]: On list_dev_main: BEGIN
[0m01:56:40.450716 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:56:40.472217 [debug] [ThreadPool]: SQL status: OK in 0.022 seconds
[0m01:56:40.472217 [debug] [ThreadPool]: Using duckdb connection "list_dev_main"
[0m01:56:40.473966 [debug] [ThreadPool]: On list_dev_main: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "ecommerce_analytics", "target_name": "dev", "connection_name": "list_dev_main"} */
select
      'dev' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'dev'
  
[0m01:56:40.488904 [debug] [ThreadPool]: SQL status: OK in 0.015 seconds
[0m01:56:40.492041 [debug] [ThreadPool]: On list_dev_main: ROLLBACK
[0m01:56:40.493046 [debug] [ThreadPool]: Failed to rollback 'list_dev_main'
[0m01:56:40.493046 [debug] [ThreadPool]: On list_dev_main: Close
[0m01:56:40.496205 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a719fa38-0b5b-4456-8b9b-0428abebbe24', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C8BE49C3D0>]}
[0m01:56:40.498221 [debug] [Thread-1 (]: Began running node seed.ecommerce_analytics.raw_customers
[0m01:56:40.498221 [debug] [Thread-1 (]: Acquiring new duckdb connection 'seed.ecommerce_analytics.raw_customers'
[0m01:56:40.503350 [debug] [Thread-1 (]: Began compiling node seed.ecommerce_analytics.raw_customers
[0m01:56:40.509983 [debug] [Thread-1 (]: Began executing node seed.ecommerce_analytics.raw_customers
[0m01:56:40.509983 [debug] [Thread-1 (]: Finished running node seed.ecommerce_analytics.raw_customers
[0m01:56:40.509983 [debug] [Thread-1 (]: Began running node seed.ecommerce_analytics.raw_orders
[0m01:56:40.514118 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly seed.ecommerce_analytics.raw_customers, now seed.ecommerce_analytics.raw_orders)
[0m01:56:40.514118 [debug] [Thread-1 (]: Began compiling node seed.ecommerce_analytics.raw_orders
[0m01:56:40.514118 [debug] [Thread-1 (]: Began executing node seed.ecommerce_analytics.raw_orders
[0m01:56:40.517621 [debug] [Thread-1 (]: Finished running node seed.ecommerce_analytics.raw_orders
[0m01:56:40.517621 [debug] [Thread-1 (]: Began running node seed.ecommerce_analytics.raw_products
[0m01:56:40.517621 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly seed.ecommerce_analytics.raw_orders, now seed.ecommerce_analytics.raw_products)
[0m01:56:40.517621 [debug] [Thread-1 (]: Began compiling node seed.ecommerce_analytics.raw_products
[0m01:56:40.517621 [debug] [Thread-1 (]: Began executing node seed.ecommerce_analytics.raw_products
[0m01:56:40.523234 [debug] [Thread-1 (]: Finished running node seed.ecommerce_analytics.raw_products
[0m01:56:40.523745 [debug] [Thread-1 (]: Began running node model.ecommerce_analytics.dim_customers
[0m01:56:40.523745 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly seed.ecommerce_analytics.raw_products, now model.ecommerce_analytics.dim_customers)
[0m01:56:40.526046 [debug] [Thread-1 (]: Began compiling node model.ecommerce_analytics.dim_customers
[0m01:56:40.526046 [debug] [Thread-1 (]: Writing injected SQL for node "model.ecommerce_analytics.dim_customers"
[0m01:56:40.526046 [debug] [Thread-1 (]: Began executing node model.ecommerce_analytics.dim_customers
[0m01:56:40.533153 [debug] [Thread-1 (]: Finished running node model.ecommerce_analytics.dim_customers
[0m01:56:40.534161 [debug] [Thread-1 (]: Began running node model.ecommerce_analytics.stg_customers
[0m01:56:40.534161 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ecommerce_analytics.dim_customers, now model.ecommerce_analytics.stg_customers)
[0m01:56:40.535690 [debug] [Thread-1 (]: Began compiling node model.ecommerce_analytics.stg_customers
[0m01:56:40.539207 [debug] [Thread-1 (]: Writing injected SQL for node "model.ecommerce_analytics.stg_customers"
[0m01:56:40.541212 [debug] [Thread-1 (]: Began executing node model.ecommerce_analytics.stg_customers
[0m01:56:40.543218 [debug] [Thread-1 (]: Finished running node model.ecommerce_analytics.stg_customers
[0m01:56:40.544737 [debug] [Thread-1 (]: Began running node model.ecommerce_analytics.stg_orders
[0m01:56:40.544737 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ecommerce_analytics.stg_customers, now model.ecommerce_analytics.stg_orders)
[0m01:56:40.544737 [debug] [Thread-1 (]: Began compiling node model.ecommerce_analytics.stg_orders
[0m01:56:40.549816 [debug] [Thread-1 (]: Writing injected SQL for node "model.ecommerce_analytics.stg_orders"
[0m01:56:40.549816 [debug] [Thread-1 (]: Began executing node model.ecommerce_analytics.stg_orders
[0m01:56:40.549816 [debug] [Thread-1 (]: Finished running node model.ecommerce_analytics.stg_orders
[0m01:56:40.554926 [debug] [Thread-1 (]: Began running node model.ecommerce_analytics.stg_products
[0m01:56:40.554926 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ecommerce_analytics.stg_orders, now model.ecommerce_analytics.stg_products)
[0m01:56:40.554926 [debug] [Thread-1 (]: Began compiling node model.ecommerce_analytics.stg_products
[0m01:56:40.554926 [debug] [Thread-1 (]: Writing injected SQL for node "model.ecommerce_analytics.stg_products"
[0m01:56:40.554926 [debug] [Thread-1 (]: Began executing node model.ecommerce_analytics.stg_products
[0m01:56:40.554926 [debug] [Thread-1 (]: Finished running node model.ecommerce_analytics.stg_products
[0m01:56:40.554926 [debug] [Thread-1 (]: Began running node test.ecommerce_analytics.not_null_dim_customers_customer_email.0effd35874
[0m01:56:40.554926 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ecommerce_analytics.stg_products, now test.ecommerce_analytics.not_null_dim_customers_customer_email.0effd35874)
[0m01:56:40.565053 [debug] [Thread-1 (]: Began compiling node test.ecommerce_analytics.not_null_dim_customers_customer_email.0effd35874
[0m01:56:40.575201 [debug] [Thread-1 (]: Writing injected SQL for node "test.ecommerce_analytics.not_null_dim_customers_customer_email.0effd35874"
[0m01:56:40.575201 [debug] [Thread-1 (]: Began executing node test.ecommerce_analytics.not_null_dim_customers_customer_email.0effd35874
[0m01:56:40.578161 [debug] [Thread-1 (]: Finished running node test.ecommerce_analytics.not_null_dim_customers_customer_email.0effd35874
[0m01:56:40.578161 [debug] [Thread-1 (]: Began running node test.ecommerce_analytics.not_null_dim_customers_customer_id.dd91cd1c8d
[0m01:56:40.578161 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.ecommerce_analytics.not_null_dim_customers_customer_email.0effd35874, now test.ecommerce_analytics.not_null_dim_customers_customer_id.dd91cd1c8d)
[0m01:56:40.578161 [debug] [Thread-1 (]: Began compiling node test.ecommerce_analytics.not_null_dim_customers_customer_id.dd91cd1c8d
[0m01:56:40.582358 [debug] [Thread-1 (]: Writing injected SQL for node "test.ecommerce_analytics.not_null_dim_customers_customer_id.dd91cd1c8d"
[0m01:56:40.585386 [debug] [Thread-1 (]: Began executing node test.ecommerce_analytics.not_null_dim_customers_customer_id.dd91cd1c8d
[0m01:56:40.587064 [debug] [Thread-1 (]: Finished running node test.ecommerce_analytics.not_null_dim_customers_customer_id.dd91cd1c8d
[0m01:56:40.587064 [debug] [Thread-1 (]: Began running node test.ecommerce_analytics.unique_dim_customers_customer_email.8ca8334c57
[0m01:56:40.587064 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.ecommerce_analytics.not_null_dim_customers_customer_id.dd91cd1c8d, now test.ecommerce_analytics.unique_dim_customers_customer_email.8ca8334c57)
[0m01:56:40.587064 [debug] [Thread-1 (]: Began compiling node test.ecommerce_analytics.unique_dim_customers_customer_email.8ca8334c57
[0m01:56:40.595618 [debug] [Thread-1 (]: Writing injected SQL for node "test.ecommerce_analytics.unique_dim_customers_customer_email.8ca8334c57"
[0m01:56:40.595618 [debug] [Thread-1 (]: Began executing node test.ecommerce_analytics.unique_dim_customers_customer_email.8ca8334c57
[0m01:56:40.595618 [debug] [Thread-1 (]: Finished running node test.ecommerce_analytics.unique_dim_customers_customer_email.8ca8334c57
[0m01:56:40.595618 [debug] [Thread-1 (]: Began running node test.ecommerce_analytics.unique_dim_customers_customer_id.15c9f1e2fd
[0m01:56:40.602921 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.ecommerce_analytics.unique_dim_customers_customer_email.8ca8334c57, now test.ecommerce_analytics.unique_dim_customers_customer_id.15c9f1e2fd)
[0m01:56:40.602921 [debug] [Thread-1 (]: Began compiling node test.ecommerce_analytics.unique_dim_customers_customer_id.15c9f1e2fd
[0m01:56:40.607999 [debug] [Thread-1 (]: Writing injected SQL for node "test.ecommerce_analytics.unique_dim_customers_customer_id.15c9f1e2fd"
[0m01:56:40.610005 [debug] [Thread-1 (]: Began executing node test.ecommerce_analytics.unique_dim_customers_customer_id.15c9f1e2fd
[0m01:56:40.612013 [debug] [Thread-1 (]: Finished running node test.ecommerce_analytics.unique_dim_customers_customer_id.15c9f1e2fd
[0m01:56:40.612013 [debug] [Thread-1 (]: Began running node test.ecommerce_analytics.not_null_stg_customers_customer_email.3267d739f2
[0m01:56:40.612013 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.ecommerce_analytics.unique_dim_customers_customer_id.15c9f1e2fd, now test.ecommerce_analytics.not_null_stg_customers_customer_email.3267d739f2)
[0m01:56:40.612013 [debug] [Thread-1 (]: Began compiling node test.ecommerce_analytics.not_null_stg_customers_customer_email.3267d739f2
[0m01:56:40.618653 [debug] [Thread-1 (]: Writing injected SQL for node "test.ecommerce_analytics.not_null_stg_customers_customer_email.3267d739f2"
[0m01:56:40.618653 [debug] [Thread-1 (]: Began executing node test.ecommerce_analytics.not_null_stg_customers_customer_email.3267d739f2
[0m01:56:40.618653 [debug] [Thread-1 (]: Finished running node test.ecommerce_analytics.not_null_stg_customers_customer_email.3267d739f2
[0m01:56:40.618653 [debug] [Thread-1 (]: Began running node test.ecommerce_analytics.not_null_stg_customers_customer_id.e2cfb1f9aa
[0m01:56:40.618653 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.ecommerce_analytics.not_null_stg_customers_customer_email.3267d739f2, now test.ecommerce_analytics.not_null_stg_customers_customer_id.e2cfb1f9aa)
[0m01:56:40.618653 [debug] [Thread-1 (]: Began compiling node test.ecommerce_analytics.not_null_stg_customers_customer_id.e2cfb1f9aa
[0m01:56:40.626464 [debug] [Thread-1 (]: Writing injected SQL for node "test.ecommerce_analytics.not_null_stg_customers_customer_id.e2cfb1f9aa"
[0m01:56:40.626464 [debug] [Thread-1 (]: Began executing node test.ecommerce_analytics.not_null_stg_customers_customer_id.e2cfb1f9aa
[0m01:56:40.626464 [debug] [Thread-1 (]: Finished running node test.ecommerce_analytics.not_null_stg_customers_customer_id.e2cfb1f9aa
[0m01:56:40.626464 [debug] [Thread-1 (]: Began running node test.ecommerce_analytics.unique_stg_customers_customer_email.1a5cbb3bc8
[0m01:56:40.634635 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.ecommerce_analytics.not_null_stg_customers_customer_id.e2cfb1f9aa, now test.ecommerce_analytics.unique_stg_customers_customer_email.1a5cbb3bc8)
[0m01:56:40.635353 [debug] [Thread-1 (]: Began compiling node test.ecommerce_analytics.unique_stg_customers_customer_email.1a5cbb3bc8
[0m01:56:40.636587 [debug] [Thread-1 (]: Writing injected SQL for node "test.ecommerce_analytics.unique_stg_customers_customer_email.1a5cbb3bc8"
[0m01:56:40.636587 [debug] [Thread-1 (]: Began executing node test.ecommerce_analytics.unique_stg_customers_customer_email.1a5cbb3bc8
[0m01:56:40.636587 [debug] [Thread-1 (]: Finished running node test.ecommerce_analytics.unique_stg_customers_customer_email.1a5cbb3bc8
[0m01:56:40.636587 [debug] [Thread-1 (]: Began running node test.ecommerce_analytics.unique_stg_customers_customer_id.c7614daada
[0m01:56:40.636587 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.ecommerce_analytics.unique_stg_customers_customer_email.1a5cbb3bc8, now test.ecommerce_analytics.unique_stg_customers_customer_id.c7614daada)
[0m01:56:40.647341 [debug] [Thread-1 (]: Began compiling node test.ecommerce_analytics.unique_stg_customers_customer_id.c7614daada
[0m01:56:40.650610 [debug] [Thread-1 (]: Writing injected SQL for node "test.ecommerce_analytics.unique_stg_customers_customer_id.c7614daada"
[0m01:56:40.650610 [debug] [Thread-1 (]: Began executing node test.ecommerce_analytics.unique_stg_customers_customer_id.c7614daada
[0m01:56:40.650610 [debug] [Thread-1 (]: Finished running node test.ecommerce_analytics.unique_stg_customers_customer_id.c7614daada
[0m01:56:40.650610 [debug] [Thread-1 (]: Began running node model.ecommerce_analytics.int_orders_enriched
[0m01:56:40.655172 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.ecommerce_analytics.unique_stg_customers_customer_id.c7614daada, now model.ecommerce_analytics.int_orders_enriched)
[0m01:56:40.655172 [debug] [Thread-1 (]: Began compiling node model.ecommerce_analytics.int_orders_enriched
[0m01:56:40.657191 [debug] [Thread-1 (]: Writing injected SQL for node "model.ecommerce_analytics.int_orders_enriched"
[0m01:56:40.657191 [debug] [Thread-1 (]: Began executing node model.ecommerce_analytics.int_orders_enriched
[0m01:56:40.657191 [debug] [Thread-1 (]: Finished running node model.ecommerce_analytics.int_orders_enriched
[0m01:56:40.663824 [debug] [Thread-1 (]: Began running node test.ecommerce_analytics.dbt_utils_accepted_range_stg_orders_total_amount__0.2895a1f8db
[0m01:56:40.663824 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ecommerce_analytics.int_orders_enriched, now test.ecommerce_analytics.dbt_utils_accepted_range_stg_orders_total_amount__0.2895a1f8db)
[0m01:56:40.663824 [debug] [Thread-1 (]: Began compiling node test.ecommerce_analytics.dbt_utils_accepted_range_stg_orders_total_amount__0.2895a1f8db
[0m01:56:40.669567 [debug] [Thread-1 (]: Writing injected SQL for node "test.ecommerce_analytics.dbt_utils_accepted_range_stg_orders_total_amount__0.2895a1f8db"
[0m01:56:40.669567 [debug] [Thread-1 (]: Began executing node test.ecommerce_analytics.dbt_utils_accepted_range_stg_orders_total_amount__0.2895a1f8db
[0m01:56:40.677894 [debug] [Thread-1 (]: Finished running node test.ecommerce_analytics.dbt_utils_accepted_range_stg_orders_total_amount__0.2895a1f8db
[0m01:56:40.677894 [debug] [Thread-1 (]: Began running node test.ecommerce_analytics.not_null_stg_orders_customer_id.af79d5e4b5
[0m01:56:40.677894 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.ecommerce_analytics.dbt_utils_accepted_range_stg_orders_total_amount__0.2895a1f8db, now test.ecommerce_analytics.not_null_stg_orders_customer_id.af79d5e4b5)
[0m01:56:40.677894 [debug] [Thread-1 (]: Began compiling node test.ecommerce_analytics.not_null_stg_orders_customer_id.af79d5e4b5
[0m01:56:40.684624 [debug] [Thread-1 (]: Writing injected SQL for node "test.ecommerce_analytics.not_null_stg_orders_customer_id.af79d5e4b5"
[0m01:56:40.685767 [debug] [Thread-1 (]: Began executing node test.ecommerce_analytics.not_null_stg_orders_customer_id.af79d5e4b5
[0m01:56:40.686866 [debug] [Thread-1 (]: Finished running node test.ecommerce_analytics.not_null_stg_orders_customer_id.af79d5e4b5
[0m01:56:40.687948 [debug] [Thread-1 (]: Began running node test.ecommerce_analytics.not_null_stg_orders_order_id.81cfe2fe64
[0m01:56:40.688478 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.ecommerce_analytics.not_null_stg_orders_customer_id.af79d5e4b5, now test.ecommerce_analytics.not_null_stg_orders_order_id.81cfe2fe64)
[0m01:56:40.689012 [debug] [Thread-1 (]: Began compiling node test.ecommerce_analytics.not_null_stg_orders_order_id.81cfe2fe64
[0m01:56:40.693918 [debug] [Thread-1 (]: Writing injected SQL for node "test.ecommerce_analytics.not_null_stg_orders_order_id.81cfe2fe64"
[0m01:56:40.694970 [debug] [Thread-1 (]: Began executing node test.ecommerce_analytics.not_null_stg_orders_order_id.81cfe2fe64
[0m01:56:40.696143 [debug] [Thread-1 (]: Finished running node test.ecommerce_analytics.not_null_stg_orders_order_id.81cfe2fe64
[0m01:56:40.696669 [debug] [Thread-1 (]: Began running node test.ecommerce_analytics.not_null_stg_orders_total_amount.f31d98d41b
[0m01:56:40.697213 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.ecommerce_analytics.not_null_stg_orders_order_id.81cfe2fe64, now test.ecommerce_analytics.not_null_stg_orders_total_amount.f31d98d41b)
[0m01:56:40.697727 [debug] [Thread-1 (]: Began compiling node test.ecommerce_analytics.not_null_stg_orders_total_amount.f31d98d41b
[0m01:56:40.701805 [debug] [Thread-1 (]: Writing injected SQL for node "test.ecommerce_analytics.not_null_stg_orders_total_amount.f31d98d41b"
[0m01:56:40.703051 [debug] [Thread-1 (]: Began executing node test.ecommerce_analytics.not_null_stg_orders_total_amount.f31d98d41b
[0m01:56:40.704094 [debug] [Thread-1 (]: Finished running node test.ecommerce_analytics.not_null_stg_orders_total_amount.f31d98d41b
[0m01:56:40.704094 [debug] [Thread-1 (]: Began running node test.ecommerce_analytics.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500
[0m01:56:40.705206 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.ecommerce_analytics.not_null_stg_orders_total_amount.f31d98d41b, now test.ecommerce_analytics.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500)
[0m01:56:40.705803 [debug] [Thread-1 (]: Began compiling node test.ecommerce_analytics.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500
[0m01:56:40.714910 [debug] [Thread-1 (]: Writing injected SQL for node "test.ecommerce_analytics.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500"
[0m01:56:40.716588 [debug] [Thread-1 (]: Began executing node test.ecommerce_analytics.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500
[0m01:56:40.717695 [debug] [Thread-1 (]: Finished running node test.ecommerce_analytics.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500
[0m01:56:40.718246 [debug] [Thread-1 (]: Began running node test.ecommerce_analytics.unique_stg_orders_order_id.e3b841c71a
[0m01:56:40.718789 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.ecommerce_analytics.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500, now test.ecommerce_analytics.unique_stg_orders_order_id.e3b841c71a)
[0m01:56:40.719836 [debug] [Thread-1 (]: Began compiling node test.ecommerce_analytics.unique_stg_orders_order_id.e3b841c71a
[0m01:56:40.725506 [debug] [Thread-1 (]: Writing injected SQL for node "test.ecommerce_analytics.unique_stg_orders_order_id.e3b841c71a"
[0m01:56:40.726584 [debug] [Thread-1 (]: Began executing node test.ecommerce_analytics.unique_stg_orders_order_id.e3b841c71a
[0m01:56:40.727779 [debug] [Thread-1 (]: Finished running node test.ecommerce_analytics.unique_stg_orders_order_id.e3b841c71a
[0m01:56:40.727779 [debug] [Thread-1 (]: Began running node model.ecommerce_analytics.dim_products
[0m01:56:40.728359 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.ecommerce_analytics.unique_stg_orders_order_id.e3b841c71a, now model.ecommerce_analytics.dim_products)
[0m01:56:40.728995 [debug] [Thread-1 (]: Began compiling node model.ecommerce_analytics.dim_products
[0m01:56:40.730022 [debug] [Thread-1 (]: Writing injected SQL for node "model.ecommerce_analytics.dim_products"
[0m01:56:40.730022 [debug] [Thread-1 (]: Began executing node model.ecommerce_analytics.dim_products
[0m01:56:40.730022 [debug] [Thread-1 (]: Finished running node model.ecommerce_analytics.dim_products
[0m01:56:40.730022 [debug] [Thread-1 (]: Began running node test.ecommerce_analytics.dbt_utils_accepted_range_stg_products_price__0.26bfce9c9f
[0m01:56:40.730022 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ecommerce_analytics.dim_products, now test.ecommerce_analytics.dbt_utils_accepted_range_stg_products_price__0.26bfce9c9f)
[0m01:56:40.730022 [debug] [Thread-1 (]: Began compiling node test.ecommerce_analytics.dbt_utils_accepted_range_stg_products_price__0.26bfce9c9f
[0m01:56:40.740350 [debug] [Thread-1 (]: Writing injected SQL for node "test.ecommerce_analytics.dbt_utils_accepted_range_stg_products_price__0.26bfce9c9f"
[0m01:56:40.740350 [debug] [Thread-1 (]: Began executing node test.ecommerce_analytics.dbt_utils_accepted_range_stg_products_price__0.26bfce9c9f
[0m01:56:40.740350 [debug] [Thread-1 (]: Finished running node test.ecommerce_analytics.dbt_utils_accepted_range_stg_products_price__0.26bfce9c9f
[0m01:56:40.740350 [debug] [Thread-1 (]: Began running node test.ecommerce_analytics.not_null_stg_products_price.2d147627d4
[0m01:56:40.740350 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.ecommerce_analytics.dbt_utils_accepted_range_stg_products_price__0.26bfce9c9f, now test.ecommerce_analytics.not_null_stg_products_price.2d147627d4)
[0m01:56:40.740350 [debug] [Thread-1 (]: Began compiling node test.ecommerce_analytics.not_null_stg_products_price.2d147627d4
[0m01:56:40.745290 [debug] [Thread-1 (]: Writing injected SQL for node "test.ecommerce_analytics.not_null_stg_products_price.2d147627d4"
[0m01:56:40.745290 [debug] [Thread-1 (]: Began executing node test.ecommerce_analytics.not_null_stg_products_price.2d147627d4
[0m01:56:40.745290 [debug] [Thread-1 (]: Finished running node test.ecommerce_analytics.not_null_stg_products_price.2d147627d4
[0m01:56:40.745290 [debug] [Thread-1 (]: Began running node test.ecommerce_analytics.not_null_stg_products_product_id.6373b0acf3
[0m01:56:40.750824 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.ecommerce_analytics.not_null_stg_products_price.2d147627d4, now test.ecommerce_analytics.not_null_stg_products_product_id.6373b0acf3)
[0m01:56:40.750824 [debug] [Thread-1 (]: Began compiling node test.ecommerce_analytics.not_null_stg_products_product_id.6373b0acf3
[0m01:56:40.750824 [debug] [Thread-1 (]: Writing injected SQL for node "test.ecommerce_analytics.not_null_stg_products_product_id.6373b0acf3"
[0m01:56:40.750824 [debug] [Thread-1 (]: Began executing node test.ecommerce_analytics.not_null_stg_products_product_id.6373b0acf3
[0m01:56:40.750824 [debug] [Thread-1 (]: Finished running node test.ecommerce_analytics.not_null_stg_products_product_id.6373b0acf3
[0m01:56:40.750824 [debug] [Thread-1 (]: Began running node test.ecommerce_analytics.unique_stg_products_product_id.7d950a1467
[0m01:56:40.750824 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.ecommerce_analytics.not_null_stg_products_product_id.6373b0acf3, now test.ecommerce_analytics.unique_stg_products_product_id.7d950a1467)
[0m01:56:40.750824 [debug] [Thread-1 (]: Began compiling node test.ecommerce_analytics.unique_stg_products_product_id.7d950a1467
[0m01:56:40.761493 [debug] [Thread-1 (]: Writing injected SQL for node "test.ecommerce_analytics.unique_stg_products_product_id.7d950a1467"
[0m01:56:40.761493 [debug] [Thread-1 (]: Began executing node test.ecommerce_analytics.unique_stg_products_product_id.7d950a1467
[0m01:56:40.761493 [debug] [Thread-1 (]: Finished running node test.ecommerce_analytics.unique_stg_products_product_id.7d950a1467
[0m01:56:40.761493 [debug] [Thread-1 (]: Began running node model.ecommerce_analytics.fct_orders
[0m01:56:40.761493 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.ecommerce_analytics.unique_stg_products_product_id.7d950a1467, now model.ecommerce_analytics.fct_orders)
[0m01:56:40.761493 [debug] [Thread-1 (]: Began compiling node model.ecommerce_analytics.fct_orders
[0m01:56:40.761493 [debug] [Thread-1 (]: Writing injected SQL for node "model.ecommerce_analytics.fct_orders"
[0m01:56:40.761493 [debug] [Thread-1 (]: Began executing node model.ecommerce_analytics.fct_orders
[0m01:56:40.761493 [debug] [Thread-1 (]: Finished running node model.ecommerce_analytics.fct_orders
[0m01:56:40.761493 [debug] [Thread-1 (]: Began running node test.ecommerce_analytics.dbt_utils_accepted_range_dim_products_price__0.872688f741
[0m01:56:40.771430 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ecommerce_analytics.fct_orders, now test.ecommerce_analytics.dbt_utils_accepted_range_dim_products_price__0.872688f741)
[0m01:56:40.771430 [debug] [Thread-1 (]: Began compiling node test.ecommerce_analytics.dbt_utils_accepted_range_dim_products_price__0.872688f741
[0m01:56:40.777168 [debug] [Thread-1 (]: Writing injected SQL for node "test.ecommerce_analytics.dbt_utils_accepted_range_dim_products_price__0.872688f741"
[0m01:56:40.777168 [debug] [Thread-1 (]: Began executing node test.ecommerce_analytics.dbt_utils_accepted_range_dim_products_price__0.872688f741
[0m01:56:40.777168 [debug] [Thread-1 (]: Finished running node test.ecommerce_analytics.dbt_utils_accepted_range_dim_products_price__0.872688f741
[0m01:56:40.777168 [debug] [Thread-1 (]: Began running node test.ecommerce_analytics.not_null_dim_products_price.93519fc0ed
[0m01:56:40.777168 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.ecommerce_analytics.dbt_utils_accepted_range_dim_products_price__0.872688f741, now test.ecommerce_analytics.not_null_dim_products_price.93519fc0ed)
[0m01:56:40.777168 [debug] [Thread-1 (]: Began compiling node test.ecommerce_analytics.not_null_dim_products_price.93519fc0ed
[0m01:56:40.782626 [debug] [Thread-1 (]: Writing injected SQL for node "test.ecommerce_analytics.not_null_dim_products_price.93519fc0ed"
[0m01:56:40.782626 [debug] [Thread-1 (]: Began executing node test.ecommerce_analytics.not_null_dim_products_price.93519fc0ed
[0m01:56:40.782626 [debug] [Thread-1 (]: Finished running node test.ecommerce_analytics.not_null_dim_products_price.93519fc0ed
[0m01:56:40.782626 [debug] [Thread-1 (]: Began running node test.ecommerce_analytics.not_null_dim_products_product_id.c8aba288d1
[0m01:56:40.782626 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.ecommerce_analytics.not_null_dim_products_price.93519fc0ed, now test.ecommerce_analytics.not_null_dim_products_product_id.c8aba288d1)
[0m01:56:40.782626 [debug] [Thread-1 (]: Began compiling node test.ecommerce_analytics.not_null_dim_products_product_id.c8aba288d1
[0m01:56:40.782626 [debug] [Thread-1 (]: Writing injected SQL for node "test.ecommerce_analytics.not_null_dim_products_product_id.c8aba288d1"
[0m01:56:40.791995 [debug] [Thread-1 (]: Began executing node test.ecommerce_analytics.not_null_dim_products_product_id.c8aba288d1
[0m01:56:40.792668 [debug] [Thread-1 (]: Finished running node test.ecommerce_analytics.not_null_dim_products_product_id.c8aba288d1
[0m01:56:40.792668 [debug] [Thread-1 (]: Began running node test.ecommerce_analytics.unique_dim_products_product_id.ef7b2a9985
[0m01:56:40.792668 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.ecommerce_analytics.not_null_dim_products_product_id.c8aba288d1, now test.ecommerce_analytics.unique_dim_products_product_id.ef7b2a9985)
[0m01:56:40.792668 [debug] [Thread-1 (]: Began compiling node test.ecommerce_analytics.unique_dim_products_product_id.ef7b2a9985
[0m01:56:40.792668 [debug] [Thread-1 (]: Writing injected SQL for node "test.ecommerce_analytics.unique_dim_products_product_id.ef7b2a9985"
[0m01:56:40.792668 [debug] [Thread-1 (]: Began executing node test.ecommerce_analytics.unique_dim_products_product_id.ef7b2a9985
[0m01:56:40.792668 [debug] [Thread-1 (]: Finished running node test.ecommerce_analytics.unique_dim_products_product_id.ef7b2a9985
[0m01:56:40.792668 [debug] [Thread-1 (]: Began running node test.ecommerce_analytics.dbt_utils_accepted_range_fct_orders_total_amount__0.1899fe7826
[0m01:56:40.792668 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.ecommerce_analytics.unique_dim_products_product_id.ef7b2a9985, now test.ecommerce_analytics.dbt_utils_accepted_range_fct_orders_total_amount__0.1899fe7826)
[0m01:56:40.792668 [debug] [Thread-1 (]: Began compiling node test.ecommerce_analytics.dbt_utils_accepted_range_fct_orders_total_amount__0.1899fe7826
[0m01:56:40.802621 [debug] [Thread-1 (]: Writing injected SQL for node "test.ecommerce_analytics.dbt_utils_accepted_range_fct_orders_total_amount__0.1899fe7826"
[0m01:56:40.808411 [debug] [Thread-1 (]: Began executing node test.ecommerce_analytics.dbt_utils_accepted_range_fct_orders_total_amount__0.1899fe7826
[0m01:56:40.808411 [debug] [Thread-1 (]: Finished running node test.ecommerce_analytics.dbt_utils_accepted_range_fct_orders_total_amount__0.1899fe7826
[0m01:56:40.808411 [debug] [Thread-1 (]: Began running node test.ecommerce_analytics.not_null_fct_orders_customer_id.16fe324f7b
[0m01:56:40.808411 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.ecommerce_analytics.dbt_utils_accepted_range_fct_orders_total_amount__0.1899fe7826, now test.ecommerce_analytics.not_null_fct_orders_customer_id.16fe324f7b)
[0m01:56:40.810427 [debug] [Thread-1 (]: Began compiling node test.ecommerce_analytics.not_null_fct_orders_customer_id.16fe324f7b
[0m01:56:40.812990 [debug] [Thread-1 (]: Writing injected SQL for node "test.ecommerce_analytics.not_null_fct_orders_customer_id.16fe324f7b"
[0m01:56:40.812990 [debug] [Thread-1 (]: Began executing node test.ecommerce_analytics.not_null_fct_orders_customer_id.16fe324f7b
[0m01:56:40.812990 [debug] [Thread-1 (]: Finished running node test.ecommerce_analytics.not_null_fct_orders_customer_id.16fe324f7b
[0m01:56:40.812990 [debug] [Thread-1 (]: Began running node test.ecommerce_analytics.not_null_fct_orders_order_id.4e687af8d0
[0m01:56:40.817300 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.ecommerce_analytics.not_null_fct_orders_customer_id.16fe324f7b, now test.ecommerce_analytics.not_null_fct_orders_order_id.4e687af8d0)
[0m01:56:40.817300 [debug] [Thread-1 (]: Began compiling node test.ecommerce_analytics.not_null_fct_orders_order_id.4e687af8d0
[0m01:56:40.817300 [debug] [Thread-1 (]: Writing injected SQL for node "test.ecommerce_analytics.not_null_fct_orders_order_id.4e687af8d0"
[0m01:56:40.817300 [debug] [Thread-1 (]: Began executing node test.ecommerce_analytics.not_null_fct_orders_order_id.4e687af8d0
[0m01:56:40.823121 [debug] [Thread-1 (]: Finished running node test.ecommerce_analytics.not_null_fct_orders_order_id.4e687af8d0
[0m01:56:40.823121 [debug] [Thread-1 (]: Began running node test.ecommerce_analytics.not_null_fct_orders_total_amount.f8b7bfac38
[0m01:56:40.823785 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.ecommerce_analytics.not_null_fct_orders_order_id.4e687af8d0, now test.ecommerce_analytics.not_null_fct_orders_total_amount.f8b7bfac38)
[0m01:56:40.823785 [debug] [Thread-1 (]: Began compiling node test.ecommerce_analytics.not_null_fct_orders_total_amount.f8b7bfac38
[0m01:56:40.823785 [debug] [Thread-1 (]: Writing injected SQL for node "test.ecommerce_analytics.not_null_fct_orders_total_amount.f8b7bfac38"
[0m01:56:40.823785 [debug] [Thread-1 (]: Began executing node test.ecommerce_analytics.not_null_fct_orders_total_amount.f8b7bfac38
[0m01:56:40.823785 [debug] [Thread-1 (]: Finished running node test.ecommerce_analytics.not_null_fct_orders_total_amount.f8b7bfac38
[0m01:56:40.823785 [debug] [Thread-1 (]: Began running node test.ecommerce_analytics.relationships_fct_orders_customer_id__customer_id__ref_dim_customers_.d5636051d4
[0m01:56:40.823785 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.ecommerce_analytics.not_null_fct_orders_total_amount.f8b7bfac38, now test.ecommerce_analytics.relationships_fct_orders_customer_id__customer_id__ref_dim_customers_.d5636051d4)
[0m01:56:40.823785 [debug] [Thread-1 (]: Began compiling node test.ecommerce_analytics.relationships_fct_orders_customer_id__customer_id__ref_dim_customers_.d5636051d4
[0m01:56:40.835877 [debug] [Thread-1 (]: Writing injected SQL for node "test.ecommerce_analytics.relationships_fct_orders_customer_id__customer_id__ref_dim_customers_.d5636051d4"
[0m01:56:40.835877 [debug] [Thread-1 (]: Began executing node test.ecommerce_analytics.relationships_fct_orders_customer_id__customer_id__ref_dim_customers_.d5636051d4
[0m01:56:40.837883 [debug] [Thread-1 (]: Finished running node test.ecommerce_analytics.relationships_fct_orders_customer_id__customer_id__ref_dim_customers_.d5636051d4
[0m01:56:40.838889 [debug] [Thread-1 (]: Began running node test.ecommerce_analytics.unique_fct_orders_order_id.523ddb6ce5
[0m01:56:40.839727 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.ecommerce_analytics.relationships_fct_orders_customer_id__customer_id__ref_dim_customers_.d5636051d4, now test.ecommerce_analytics.unique_fct_orders_order_id.523ddb6ce5)
[0m01:56:40.839727 [debug] [Thread-1 (]: Began compiling node test.ecommerce_analytics.unique_fct_orders_order_id.523ddb6ce5
[0m01:56:40.844130 [debug] [Thread-1 (]: Writing injected SQL for node "test.ecommerce_analytics.unique_fct_orders_order_id.523ddb6ce5"
[0m01:56:40.844130 [debug] [Thread-1 (]: Began executing node test.ecommerce_analytics.unique_fct_orders_order_id.523ddb6ce5
[0m01:56:40.844130 [debug] [Thread-1 (]: Finished running node test.ecommerce_analytics.unique_fct_orders_order_id.523ddb6ce5
[0m01:56:40.844130 [debug] [MainThread]: Connection 'master' was properly closed.
[0m01:56:40.844130 [debug] [MainThread]: Connection 'list_dev_main' was properly closed.
[0m01:56:40.844130 [debug] [MainThread]: Connection 'test.ecommerce_analytics.unique_fct_orders_order_id.523ddb6ce5' was properly closed.
[0m01:56:40.844130 [debug] [MainThread]: Command end result
[0m01:56:40.960553 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\Lenovo\Desktop\Proyectos\dbt-proyect\ecommerce_analytics\target\manifest.json
[0m01:56:40.965292 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\Lenovo\Desktop\Proyectos\dbt-proyect\ecommerce_analytics\target\semantic_manifest.json
[0m01:56:40.970167 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\Lenovo\Desktop\Proyectos\dbt-proyect\ecommerce_analytics\target\run_results.json
[0m01:56:42.270878 [debug] [MainThread]: Acquiring new duckdb connection 'generate_catalog'
[0m01:56:42.270878 [info ] [MainThread]: Building catalog
[0m01:56:42.284700 [debug] [ThreadPool]: Acquiring new duckdb connection 'dev.information_schema'
[0m01:56:42.303570 [debug] [ThreadPool]: Using duckdb connection "dev.information_schema"
[0m01:56:42.303570 [debug] [ThreadPool]: On dev.information_schema: BEGIN
[0m01:56:42.305479 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:56:42.305479 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m01:56:42.305479 [debug] [ThreadPool]: Using duckdb connection "dev.information_schema"
[0m01:56:42.305479 [debug] [ThreadPool]: On dev.information_schema: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "ecommerce_analytics", "target_name": "dev", "connection_name": "dev.information_schema"} */
with relations AS (
      select
        t.table_name
        , t.database_name
        , t.schema_name
        , 'BASE TABLE' as table_type
        , t.comment as table_comment
      from duckdb_tables() t
      WHERE t.database_name = 'dev'
      UNION ALL
      SELECT v.view_name as table_name
      , v.database_name
      , v.schema_name
      , 'VIEW' as table_type
      , v.comment as table_comment
      from duckdb_views() v
      WHERE v.database_name = 'dev'
    )
    select
        'dev' as table_database,
        r.schema_name as table_schema,
        r.table_name,
        r.table_type,
        r.table_comment,
        c.column_name,
        c.column_index as column_index,
        c.data_type as column_type,
        c.comment as column_comment,
        NULL as table_owner
    FROM relations r JOIN duckdb_columns() c ON r.schema_name = c.schema_name AND r.table_name = c.table_name
    WHERE (upper(r.schema_name) = upper('main'))
    ORDER BY
        r.schema_name,
        r.table_name,
        c.column_index
[0m01:56:42.322696 [debug] [ThreadPool]: SQL status: OK in 0.014 seconds
[0m01:56:42.332177 [debug] [ThreadPool]: On dev.information_schema: ROLLBACK
[0m01:56:42.333184 [debug] [ThreadPool]: Failed to rollback 'dev.information_schema'
[0m01:56:42.333184 [debug] [ThreadPool]: On dev.information_schema: Close
[0m01:56:42.353870 [debug] [MainThread]: Wrote artifact CatalogArtifact to C:\Users\Lenovo\Desktop\Proyectos\dbt-proyect\ecommerce_analytics\target\catalog.json
[0m01:56:42.385061 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\Lenovo\Desktop\Proyectos\dbt-proyect\ecommerce_analytics\target\manifest.json
[0m01:56:42.388722 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\Lenovo\Desktop\Proyectos\dbt-proyect\ecommerce_analytics\target\semantic_manifest.json
[0m01:56:42.390698 [info ] [MainThread]: Catalog written to C:\Users\Lenovo\Desktop\Proyectos\dbt-proyect\ecommerce_analytics\target\catalog.json
[0m01:56:42.392944 [debug] [MainThread]: Command `dbt docs generate` succeeded at 01:56:42.392944 after 3.00 seconds
[0m01:56:42.393497 [debug] [MainThread]: Connection 'generate_catalog' was properly closed.
[0m01:56:42.393497 [debug] [MainThread]: Connection 'dev.information_schema' was properly closed.
[0m01:56:42.395511 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C8BF8D25D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C8BFACE990>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C8BF71E750>]}
[0m01:56:42.395511 [debug] [MainThread]: Flushing usage events
[0m01:56:43.503665 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m01:56:52.948078 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002959C02D390>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002959B160ED0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002959BF4A5D0>]}


============================== 01:56:52.953005 | e7f9a291-6ed8-46ee-9f76-db6ba86bbf88 ==============================
[0m01:56:52.953005 [info ] [MainThread]: Running with dbt=1.11.2
[0m01:56:52.954111 [debug] [MainThread]: running dbt with arguments {'static_parser': 'True', 'no_print': 'None', 'version_check': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'target_path': 'None', 'printer_width': '80', 'write_json': 'True', 'empty': 'None', 'log_cache_events': 'False', 'introspect': 'True', 'cache_selected_only': 'False', 'fail_fast': 'False', 'debug': 'False', 'log_format': 'default', 'profiles_dir': 'C:\\Users\\Lenovo\\.dbt', 'send_anonymous_usage_stats': 'True', 'quiet': 'False', 'warn_error': 'None', 'partial_parse': 'True', 'invocation_command': 'dbt docs serve', 'use_colors': 'True', 'indirect_selection': 'eager', 'use_experimental_parser': 'False', 'log_path': 'C:\\Users\\Lenovo\\Desktop\\Proyectos\\dbt-proyect\\ecommerce_analytics\\logs'}
[0m01:56:53.231810 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e7f9a291-6ed8-46ee-9f76-db6ba86bbf88', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002959C0F10D0>]}
[0m01:56:53.297256 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e7f9a291-6ed8-46ee-9f76-db6ba86bbf88', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029598995190>]}
[0m01:56:53.577746 [error] [MainThread]: Encountered an error:
[WinError 10048] Solo se permite un uso de cada dirección de socket (protocolo/dirección de red/puerto)
[0m01:56:53.581696 [error] [MainThread]: Traceback (most recent call last):
  File "C:\Users\Lenovo\Desktop\Proyectos\dbt-proyect\venv\Lib\site-packages\dbt\cli\requires.py", line 182, in wrapper
    result, success = func(*args, **kwargs)
                      ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Lenovo\Desktop\Proyectos\dbt-proyect\venv\Lib\site-packages\dbt\cli\requires.py", line 128, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Lenovo\Desktop\Proyectos\dbt-proyect\venv\Lib\site-packages\dbt\cli\requires.py", line 276, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Lenovo\Desktop\Proyectos\dbt-proyect\venv\Lib\site-packages\dbt\cli\requires.py", line 321, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Lenovo\Desktop\Proyectos\dbt-proyect\venv\Lib\site-packages\dbt\cli\requires.py", line 368, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Lenovo\Desktop\Proyectos\dbt-proyect\venv\Lib\site-packages\dbt\cli\main.py", line 307, in docs_serve
    results = task.run()
              ^^^^^^^^^^
  File "C:\Users\Lenovo\Desktop\Proyectos\dbt-proyect\venv\Lib\site-packages\dbt\task\docs\serve.py", line 24, in run
    with socketserver.TCPServer((host, port), SimpleHTTPRequestHandler) as httpd:
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Lenovo\AppData\Local\Programs\Python\Python311\Lib\socketserver.py", line 456, in __init__
    self.server_bind()
  File "C:\Users\Lenovo\AppData\Local\Programs\Python\Python311\Lib\socketserver.py", line 472, in server_bind
    self.socket.bind(self.server_address)
OSError: [WinError 10048] Solo se permite un uso de cada dirección de socket (protocolo/dirección de red/puerto)

[0m01:56:53.585413 [debug] [MainThread]: Command `dbt docs serve` failed at 01:56:53.585413 after 0.73 seconds
[0m01:56:53.585413 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002959C06C0D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002959C027FD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002959C02EF10>]}
[0m01:56:53.587420 [debug] [MainThread]: Flushing usage events
[0m01:56:55.173383 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m01:57:43.212360 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018EB1CFBF10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018EB1CD58D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018EB1CD6610>]}


============================== 01:57:43.219697 | f19435d7-5d35-420b-aa03-0f7083206c94 ==============================
[0m01:57:43.219697 [info ] [MainThread]: Running with dbt=1.11.2
[0m01:57:43.222534 [debug] [MainThread]: running dbt with arguments {'version_check': 'True', 'no_print': 'None', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'printer_width': '80', 'write_json': 'True', 'introspect': 'True', 'log_cache_events': 'False', 'empty': 'None', 'cache_selected_only': 'False', 'log_format': 'default', 'debug': 'False', 'fail_fast': 'False', 'partial_parse': 'True', 'send_anonymous_usage_stats': 'True', 'quiet': 'False', 'warn_error': 'None', 'profiles_dir': 'C:\\Users\\Lenovo\\.dbt', 'use_colors': 'True', 'invocation_command': 'dbt docs serve --port 8081', 'indirect_selection': 'eager', 'use_experimental_parser': 'False', 'log_path': 'C:\\Users\\Lenovo\\Desktop\\Proyectos\\dbt-proyect\\ecommerce_analytics\\logs'}
[0m01:57:43.587473 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f19435d7-5d35-420b-aa03-0f7083206c94', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018EB1D5B1D0>]}
[0m01:57:43.655450 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f19435d7-5d35-420b-aa03-0f7083206c94', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018EAE654390>]}
